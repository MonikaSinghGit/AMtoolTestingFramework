  APPLICATIONS OF
       ARTIFICIAL
INTELLIGENCE FOR
ORGANIC CHEMISTRY
       The DENDRAL Project

   Robert K. Lindsay

            Research Scientist
       University of Michigan

   Bruce G. Buchanan

Adjunct Professor of Computer Science
         Stanford University
Edward A. Feigenbaum
    Professor of Computer Science
         Stanford University
   Joshua Lederberg
President, The Rockefeller University

   Formerly, Professor of Genetics
         Stanford University

McGraw-Hill Book Company

New York St. Louis San Francisco Auckland Beirut Bogoti Hamburg Johannesburg
       Lisbon London Lucerne Madrid Mexico Montreal New Delhi Panama
          Paris San Juan Silo Paulo Singapore Sydney Tokyo Toronto


APPLICATIONS OF ARTIFICIAL INTELLIGENCE
FOR ORGANIC CHEMISTRY
The DENDRAL Project

Copyright Q 1980 by McGraw-Hill, Inc. All rights reserved.
Printed in the United States of America. No part of this publication
may be reproduced, stored in a retrieval system, or transmitted, in any
form or by and means, electronic, mechanical, photocopying, recording, or
otherwise, without the prior written permission of the publisher.

1234567890MAMA 89876543210

This book was set in Times Roman by The Total Book/ACS.

Library of Congesa Catalowg in Publication Data

Main entry under title:

Applications of artificial intelligence for organic
chemistry.

(McGraw-Hill advanced computer science series)
Bibliography: p.
Includes index.
1. DENDRAL (Computer programs) 2. Artificial
intelligence-Data processing. 3. Chemistry, Organic-
Data processing I. Lindsay, Robert K. II. Series.
QD255.5.E4A66     547'0028'5425    80-12508
ISBN O-07-037895-9


CONTENTS

Foreword
Preface

1 Introduction

2

2.1
2.2
2.3
2.4
2.5
2.6
2.7
2.8

The Structure Elucidation Problem of
Organic Chemistry
Introduction
Isomerism
Organic compounds and Nomenclature
Mass Spectrometry
Some Important Refinements of the MS Technique
Other Analytical Methods
Library Search
Summary

3 Artificial Intelligence                                28

3.1 Introduction                                        28
3.2 Problem-Solving Methods                                30
3.3 DENDRAL                                        35
3.4  Outline of DENDRAL Programs                             39

4 The DENDRAL Generator

4.1  Introduction
4.2  Overview
4.3  Ring Generation
4.4  Tree Generation-The Acyclic Generator
4.5 The Cyclic Generator
4.6  Constraining the Generator: CONGEN

ix

xi

1

3

3
4
5
13
19
24
26
27

40

40
41
44
48
53
53

vii


viii CONTENTS

5  Heuristic DENDRAL Planning
5.1  Introduction
5.2  The Early Planner and the Planning Rule Generator
5.3  MOLION
5.4  Empirical Formula
5.5  Generalized Break Analysis
5.6  Conclusion

68

68
69
70
78
78
85

6

6.1
6.2
6.3
4.4
6.5

Heuristic DENDRAL Testing                         86

Introduction                                         86
Predictor Production System                              87
Graph Structure and Production Representation                   88
Ranking the Candidate Explanations                         100
Summary of Heuristic DENDRAL                          105

7  Meta-DENDRAL                                 107

7.1  Introduction                                       107

7.2  INTSUM-Data Interpretation and Summary                    109

7.3  RULEGENeration                                    115

1.4  RULEMODification                                   123

7.5  Summary                                         125

8  Results

8.1  Introduction
8.2  The Scope of Structural Isomerism
8.3  Acyclic Heuristic DENDRAL
8.4  CONGEN Results
8.5  Planner Results
8.6  Meta-DENDRAL Results
8.7  DENDRAL Predictor Results
8.8  Design Principles

126

126
127
130
134
135
143
144
147

9  Summary and Conclusions                          153

9.1  Introduction                                        153

9.2  Knowledge Engineering                                153

9.3  Scientific Discovery                                   160

9.4  The Prospects for Automatic Science                        168

10  Project Publications                               169

References
Name Index
Subject Index

179

187

189


FOREWORD

It is no pure coincidence that an organic chemist rather than a computer specialist is
writing this foreword. In my opinion the most significant aspect of the development of
DENDRAL is that it can be appreciated and used by a community of scholars that en-
compasses a diverse range from mathematics and computer sciences all the way to
chemistry. The former group has been attracted by DENDRAL's intrinsic interest and
the latter primarily by its applications. As an organic chemist let me emphasize the
applications.

The use of computers as a computational and data acquisition tool is accepted by
most chemists. This use is especially true as an adjunct to instrumentation (for instance
NMR spectrometers, automated x-ray diffractometers, etc.) and to library searches or
spectral file examinations. The use of computers in the manipulation of symbolic
rather than numerical inputs is of much more recent origin and until recently has been
ignored, and for psychologically understandable reasons even opposed, by organic
chemists. I emphasize the organic chemical community because together with bio-
chemistry, it encompasses well over half of all practicing chemists and involves the
least amount of sophisticated mathematics.

Symbolic manipulations by computers are in principle important in two areas of
chemistry-synthesis and structure elucidation. It is the former where the use of com-
puters has not been widely accepted because of the fear that thinking man will simply
be reduced to an appendage to a machine. The synthetic che'mist wishes to be both
architect and building contractor-the former function being the intellectually and
aesthetically more pleasing one-and it is precisely this architectural role that the com-
puter is perceived partially to usurp.

The************************** 6.616000+4 1.585510+2          2          0          0          16637 1451    1
 0.000000+0 0.000000+0          0          0          0          66637 1451    2
 1.000000+0 2.000000+7          7          0         10          66637 1451    3
 3.000000+2 0.000000+0        300          0        111         386637 1451    4
 66-DY-160 ORNL, HEDL EVAL-OCT74 WRIGHT, SCHENTER, SCHMITTROTH    6637 1451    5
                      DIST-APR 0                       20000411   6637 1451    6
----ENDF/B-VI         MATERIAL 6637                               6637 1451    7
-----INCIDENT NEUTRON DATA                                        6637 1451    8
------ENDF-6 FORMAT                                               6637 1451    9
                                                                  6637 1451   10
 *****************************************************************6637 1451   11
                                                                  6637 1451   12
 ENDF/B-VI MOD 1 Revision, April 1998, R.Q. Wright (ORNL)         6637 1451   13
                                                                  6637 1451   14
 MF= 2   RESONANCE PARAMETERS                                     6637 1451   15
                                                                  6637 1451   16
    RESOLVED RESONANCE RANGE- The upper limit of the resolved     6637 1451   17
    increased; revised range is from 24.44 to 1690 eV.  The       6637 1451   18
    number of resolved resonances is increased from 3 to 66. The  6637 1451   19
    resonance parameters are taken from Mughabghab [6]. There are 6637 1451   20
    12 resonances included above the upper cutoff of the resolved 6637 1451   21
    resonance range, 1.69 keV.                                    6637 1451   22
                                                                  6637 1451   23
    UNRESOLVED RESONANCE RANGE (added) 1.69 to 20 keV             6637 1451   24
    The following parameters are used in this range:              6637 1451   25
         S0 = 1.8E-4, S1 = 1.0E-4, D0 = 30 eV,                    6637 1451   26
         GG = 0.108 eV,      GG/D0 = 36.0E-4,                     6637 1451   27
         Scattering radius, R = 7.50 fm                           6637 1451   28
    The same scattering radius also used for resolved range.      6637 1451   29
    The above parameters are based on Mughabghab [1] and RIPL [3].6637 1451   30
                                                                  6637 1451   31
 MF= 3   SMOOTH CROSS SECTIONS                                    6637 1451   32
                                                                  6637 1451   33
   MT=  1  Total below 20 keV is much lower in the REVISED        6637 1451   34
      evaluation relative to ENDF/B-V.  Total cross section above 6637 1451   35
      20 keV is revised to join smoothly at 20 keV.  For all of   6637 1451   36
      the dysprosium isotopes the total cross section is based on 6637 1451   37
      the "eye guide" curve as given on page 546 of McLane [9].   6637 1451   38
   MT=  2  Elastic scattering cross section is revised to reflect 6637 1451   39
      the changes in the total and capture cross sections.        6637 1451   40
      Total = Elastic - Nonelastic.                               6637 1451   41
   MT=102 (capture) is revised above 20 keV                       6637 1451   42
      For the energy range 3 to 700 keV, the revision is based on 6637 1451   43
      the measured data of Beer [7].  Capture above 700 keV is    6637 1451   44
      revised to join smoothly at 700 keV.                        6637 1451   45
                                                                  6637 1451   46
 THERMAL CROSS SECTIONS AND CAPTURE RESONANCE INTEGRAL--          6637 1451   47
                                                                  6637 1451   48
 The revised thermal cross sections and the resonance integral    6637 1451   49
 are compared with the values given by Mughabghab [6].            6637 1451   50
                                                                  6637 1451   51
      2200 m/sec cross sections (barns)                           6637 1451   52
                  Evaluation       Mughabghab                     6637 1451   53
      total           61.91        61.6                           6637 1451   54
      elastic          4.85         5.6  +/- 0.7                  6637 1451   55
      capture         57.06        56.0  +/- 5                    6637 1451   56
                                                                  6637 1451   57
      Capture resonance integral (barns)                          6637 1451   58
                  Evaluation       Mughabghab                     6637 1451   59
                       1108        1160  +/- 130                  6637 1451   60
                                                                  6637 1451   61
 *****************************************************************6637 1451   62
                                                                  6637 1451   63
 ENDF/B-VI MOD 0, February 1990 (NNDC)                            6637 1451   64
                                                                  6637 1451   65
 ENDF/B-V material converted to ENDF-6 format by NNDC.            6637 1451   66
                                                                  6637 1451   67
 *****************************************************************6637 1451   68
                                                                  6637 1451   69
 ENDF/B-V Evaluation, MAT 9864, October 1974, R.E. Schenter and   6637 1451   70
                      F. Schmittroth (HEDL)                       6637 1451   71
                                                                  6637 1451   72
 FILE INFORMATION                                                 6637 1451   73
                                                                  6637 1451   74
 MF=3  SMOOTH CROSS SECTIONS                                      6637 1451   75
   MT=  1  Total cross section calculated using Moldauer          6637 1451   76
         potential [4] for E > EH.                                6637 1451   77
   MT=  2  Elastic cross section from Total-Capture-Inelastic for 6637 1451   78
         E > EH.                                                  6637 1451   79
   MT=  4,51,52,.,.,91  Inelastic cross sections calculated using 6637 1451   80
         COMNUC-3 [5].                                            6637 1451   81
   MT=102  Neutron capture evaluated using methods (NCAP code)    6637 1451   82
         in [1,2] for E > EH. A 1/v component was added to give   6637 1451   83
         the 2200 m/s cross section of Mughabghab [3] for E < EH. 6637 1451   84
                                                                  6637 1451   85
 MF=4  ANGULAR DISTRIBUTIONS                                      6637 1451   86
   MT=  2  Elastic angular distribution assumed isotropic.        6637 1451   87
   MF=  4  Inelastic angular distribution assumed isotropic.      6637 1451   88
                                                                  6637 1451   89
 MF=5  ENERGY DISTRIBUTION OF SECONDARY PARTICLES                 6637 1451   90
   MT= 91  Evaporation spectrum (LF=9) parameters obtained using  6637 1451   91
         NCAP code [2].                                           6637 1451   92
                                                                  6637 1451   93
 **************************************************************** 6637 1451   94
 REFERENCES                                                       6637 1451   95
  1. F. Schmittroth and R.E. Schenter, report HEDL TME 73-63      6637 1451   96
     (1973)                                                       6637 1451   97
  2. F. Schmittroth, report HEDL TME 73-79 (1973)                 6637 1451   98
  3. S.F. Mughabghab and D.I. Garber, report BNL 325, 3 Ed.,      6637 1451   99
     Vol.1 (1973)                                                 6637 1451  100
  4. P.A. Moldauer, Nucl.Phys. 47, 65 (1963)                      6637 1451  101
  5. C.L. Dunford, report AI-AEC-12931 (1970) and private         6637 1451  102
     private communication                                        6637 1451  103
  6. S.F. Mughabghab, Neutron Cross Sections, Vol. 1, Neutron     6637 1451  104
     Resonance Parameters and Thermal Cross Sections, Part B      6637 1451  105
     (Academic Press, 1984)                                       6637 1451  106
  7. H. Beer et. al., Phys.Rev. C 30, 464 (1984)                  6637 1451  107
  8. RIPL project, IAEA, Nuclear Data Project; web address:       6637 1451  108
       //iaeand.iaea.or.at/ripl, select "resonances", then        6637 1451  109
       "obninsk.dat".                                             6637 1451  110
       Note: look under 66-Dy-161 (i.e., Dy-160 + neutron).       6637 1451  111
  9. V. Mclane, C.L. Dunford, and P.F. Rose, Neutron Cross        6637 1451  112
     Sections, Vol. 2, Academic Press (1988)                      6637 1451  113
                                                                  6637 1451  114
 ************************ C O N T E N T S *********************** 6637 1451  115
                                1        451        153          16637 1451  116
                                2        151        111          16637 1451  117
                                3          1       3034          16637 1451  118
                                3          2       1238          16637 1451  119
                                3          4         14          06637 1451  120
                                3         51         14          06637 1451  121
                                3         52         12          06637 1451  122
                                3         53         11          06637 1451  123
                                3         54         11          06637 1451  124
                                3         55         10          06637 1451  125
                                3         56          9          06637 1451  126
                                3         57          9          06637 1451  127
                                3         58          8          06637 1451  128
                                3         59          8          06637 1451  129
                                3         60          8          06637 1451  130
                                3         61          8          06637 1451  131
                                3         62          7          06637 1451  132
                                3         63          6          06637 1451  133
                                3         64          4          06637 1451  134
                                3         91          6          06637 1451  135
                                3        102       1893          16637 1451  136
                                4          2          2          06637 1451  137
                                4         51          2          06637 1451  138
                                4         52          2          06637 1451  139
                                4         53          2          06637 1451  140
                                4         54          2          06637 1451  141
                                4         55          2          06637 1451  142
                                4         56          2          06637 1451  143
                                4         57          2          06637 1451  144
                                4         58          2          06637 1451  145
                                4         59          2          06637 1451  146
                                4         60          2          06637 1451  147
                                4         61          2          06637 1451  148
                                4         62          2          06637 1451  149
                                4         63          2          06637 1451  150
                                4         64          2          06637 1451  151
                                4         91          2          06637 1451  152
                                5         91          7          06637 1451  153
 0.000000+0 0.000000+0          0          0          0          06637 1  099999
 0.000000+0 0.000000+0          0          0          0          06637 0  0    0
 6.616000+4 1.585510+2          0          0          1          06637 2151    1
 6.616000+4 1.000000+0          0          0          2          06637 2151    2
 1.000000-5 1.690000+3          1          2          0          06637 2151    3
 0.000000+0 7.500000-1          0          0          1          06637 2151    4
 1.585510+2 0.000000+0          0          0        396         666637 2151    5
-3.333000+1 5.000000-1 2.722500-1 1.922500-1 8.000000-2 0.000000+06637 2151    6
 1.880000+0 5.000000-1 1.082000-1 2.000000-4 1.080000-1 0.000000+06637 2151    7
 1.045000+1 5.000000-1 1.165000-1 1.650000-2 1.000000-1 0.000000+06637 2151    8
 2.047000+1 5.000000-1 1.390000-1 3.100000-2 1.080000-1 0.000000+06637 2151    9
 3.490000+1 5.000000-1 1.091800-1 1.180000-3 1.080000-1 0.000000+06637 2151   10
 7.314000+1 5.000000-1 1.145000-1 6.500000-3 1.080000-1 0.000000+06637 2151   11
 8.560000+1 5.000000-1 2.030000-1 9.100000-2 1.120000-1 0.000000+06637 2151   12
 1.156000+2 5.000000-1 1.100400-1 2.040000-3 1.080000-1 0.000000+06637 2151   13
 1.364000+2 5.000000-1 1.220000-1 2.600000-2 9.600000-2 0.000000+06637 2151   14
 1.557000+2 5.000000-1 1.900000-1 8.500000-2 1.050000-1 0.000000+06637 2151   15
 1.783000+2 5.000000-1 1.507000-1 3.070000-2 1.200000-1 0.000000+06637 2151   16
 2.022000+2 5.000000-1 1.373000-1 3.130000-2 1.060000-1 0.000000+06637 2151   17
 2.463000+2 5.000000-1 1.168000-1 8.800000-3 1.080000-1 0.000000+06637 2151   18
 2.719000+2 5.000000-1 1.123000-1 4.300000-3 1.080000-1 0.000000+06637 2151   19
 3.207000+2 5.000000-1 1.211000-1 1.310000-2 1.080000-1 0.000000+06637 2151   20
 3.412000+2 5.000000-1 4.980000-1 3.900000-1 1.080000-1 0.000000+06637 2151   21
 3.793000+2 5.000000-1 4.000000-1 2.920000-1 1.080000-1 0.000000+06637 2151   22
 3.943000+2 5.000000-1 1.680000-1 6.000000-2 1.080000-1 0.000000+06637 2151   23
 3.988000+2 5.000000-1 3.180000-1 2.100000-1 1.080000-1 0.000000+06637 2151   24
 4.301000+2 5.000000-1 2.240000-1 1.140000-1 1.100000-1 0.000000+06637 2151   25
 5.222000+2 5.000000-1 2.400000-1 1.330000-1 1.070000-1 0.000000+06637 2151   26
 5.774000+2 5.000000-1 1.360000-1 3.600000-2 1.000000-1 0.000000+06637 2151   27
 5.900000+2 5.000000-1 1.165000-1 8.500000-3 1.080000-1 0.000000+06637 2151   28
 6.256000+2 5.000000-1 1.160000-1 8.000000-3 1.080000-1 0.000000+06637 2151   29
 6.536000+2 5.000000-1 1.136000-1 5.600000-3 1.080000-1 0.000000+06637 2151   30
 6.795000+2 5.000000-1 8.380000-1 7.300000-1 1.080000-1 0.000000+06637 2151   31
 7.036000+2 5.000000-1 9.830000-1 8.750000-1 1.080000-1 0.000000+06637 2151   32
 7.296000+2 5.000000-1 2.330000-1 1.130000-1 1.200000-1 0.000000+06637 2151   33
 7.364000+2 5.000000-1 1.358000+0 1.250000+0 1.080000-1 0.000000+06637 2151   34
 8.172000+2 5.000000-1 1.400000-1 3.200000-2 1.080000-1 0.000000+06637 2151   35
 8.452000+2 5.000000-1 2.180000-1 1.100000-1 1.080000-1 0.000000+06637 2151   36
 8.686000+2 5.000000-1 2.640000-1 1.560000-1 1.080000-1 0.000000+06637 2151   37
 8.891000+2 5.000000-1 1.259000-1 1.790000-2 1.080000-1 0.000000+06637 2151   38
 9.720000+2 5.000000-1 1.149000-1 6.900000-3 1.080000-1 0.000000+06637 2151   39
 9.893000+2 5.000000-1 1.961000-1 8.810000-2 1.080000-1 0.000000+06637 2151   40
 1.053500+3 5.000000-1 1.210000-1 1.300000-2 1.080000-1 0.000000+06637 2151   41
 1.085900+3 5.000000-1 7.980000-1 6.900000-1 1.080000-1 0.000000+06637 2151   42
 1.103000+3 5.000000-1 1.329000-1 2.490000-2 1.080000-1 0.000000+06637 2151   43
 1.133600+3 5.000000-1 2.730000-1 1.650000-1 1.080000-1 0.000000+06637 2151   44
 1.139200+3 5.000000-1 1.161000-1 8.100000-3 1.080000-1 0.000000+06637 2151   45
 1.161500+3 5.000000-1 1.300000-1 2.200000-2 1.080000-1 0.000000+06637 2151   46
 1.201300+3 5.000000-1 1.390000-1 3.100000-2 1.080000-1 0.000000+06637 2151   47
 1.244300+3 5.000000-1 1.530000-1 4.500000-2 1.080000-1 0.000000+06637 2151   48
 1.279400+3 5.000000-1 1.250000-1 1.700000-2 1.080000-1 0.000000+06637 2151   49
 1.313100+3 5.000000-1 3.880000-1 2.800000-1 1.080000-1 0.000000+06637 2151   50
 1.367400+3 5.000000-1 1.260000-1 1.800000-2 1.080000-1 0.000000+06637 2151   51
 1.401400+3 5.000000-1 2.430000-1 1.350000-1 1.080000-1 0.000000+06637 2151   52
 1.411700+3 5.000000-1 2.170000-1 1.090000-1 1.080000-1 0.000000+06637 2151   53
 1.437200+3 5.000000-1 2.860000-1 1.780000-1 1.080000-1 0.000000+06637 2151   54
 1.495300+3 5.000000-1 3.080000-1 2.000000-1 1.080000-1 0.000000+06637 2151   55
 1.541700+3 5.000000-1 2.380000-1 1.300000-1 1.080000-1 0.000000+06637 2151   56
 1.592100+3 5.000000-1 4.870000-1 3.790000-1 1.080000-1 0.000000+06637 2151   57
 1.625300+3 5.000000-1 1.210000-1 1.300000-2 1.080000-1 0.000000+06637 2151   58
 1.648300+3 5.000000-1 4.170000-1 3.090000-1 1.080000-1 0.000000+06637 2151   59
 1.710300+3 5.000000-1 4.180000-1 3.100000-1 1.080000-1 0.000000+06637 2151   60
 1.721000+3 5.000000-1 3.680000-1 2.600000-1 1.080000-1 0.000000+06637 2151   61
 1.746200+3 5.000000-1 1.500000-1 4.200000-2 1.080000-1 0.000000+06637 2151   62
 1.763600+3 5.000000-1 1.340000-1 2.600000-2 1.080000-1 0.000000+06637 2151   63
 1.785600+3 5.000000-1 1.630000-1 5.500000-2 1.080000-1 0.000000+06637 2151   64
 1.829700+3 5.000000-1 2.580000-1 1.500000-1 1.080000-1 0.000000+06637 2151   65
 1.861600+3 5.000000-1 1.398000+0 1.290000+0 1.080000-1 0.000000+06637 2151   66
 1.874900+3 5.000000-1 2.680000-1 1.600000-1 1.080000-1 0.000000+06637 2151   67
 1.899600+3 5.000000-1 3.880000-1 2.800000-1 1.080000-1 0.000000+06637 2151   68
 1.937800+3 5.000000-1 7.280000-1 6.200000-1 1.080000-1 0.000000+06637 2151   69
 1.944300+3 5.000000-1 3.480000-1 2.400000-1 1.080000-1 0.000000+06637 2151   70
 1.994300+3 5.000000-1 3.580000-1 2.500000-1 1.080000-1 0.000000+06637 2151   71
 1.690000+3 2.000000+4          2          2          0          06637 2151   72
 0.000000+0 7.500000-1          0          0          2          06637 2151   73
 1.585510+2 0.000000+0          0          0          1          06637 2151   74
 5.000000-1 0.000000+0          2          0         66         106637 2151   75
 0.000000+0 0.000000+0 0.000000+0 1.000000+0 0.000000+0 0.000000+06637 2151   76
 1.690000+3 3.000000+1 0.000000+0 5.400000-3 1.080000-1 0.000000+06637 2151   77
 2.000000+3 3.000000+1 0.000000+0 5.400000-3 1.080000-1 0.000000+06637 2151   78
 3.000000+3 3.000000+1 0.000000+0 5.400000-3 1.080000-1 0.000000+06637 2151   79
 4.000000+3 3.000000+1 0.000000+0 5.400000-3 1.080000-1 0.000000+06637 2151   80
 5.000000+3 3.000000+1 0.000000+0 5.400000-3 1.080000-1 0.000000+06637 2151   81
 6.000000+3 3.000000+1 0.000000+0 5.400000-3 1.080000-1 0.000000+06637 2151   82
 8.000000+3 3.000000+1 0.000000+0 5.400000-3 1.080000-1 0.000000+06637 2151   83
 1.000000+4 3.000000+1 0.000000+0 5.400000-3 1.080000-1 0.000000+06637 2151   84
 1.400000+4 3.000000+1 0.000000+0 5.400000-3 1.080000-1 0.000000+06637 2151   85
 2.000000+4 3.000000+1 0.000000+0 5.400000-3 1.080000-1 0.000000+06637 2151   86
 1.585510+2 0.000000+0          1          0          2          06637 2151   87
 5.000000-1 0.000000+0          2          0         66         106637 2151   88
 0.000000+0 0.000000+0 0.000000+0 1.000000+0 0.000000+0 0.000000+06637 2151   89
 1.690000+3 3.000000+1 0.000000+0 3.000000-3 1.080000-1 0.000000+06637 2151   90
 2.000000+3 3.000000+1 0.000000+0 3.000000-3 1.080000-1 0.000000+06637 2151   91
 3.000000+3 3.000000+1 0.000000+0 3.000000-3 1.080000-1 0.000000+06637 2151   92
 4.000000+3 3.000000+1 0.000000+0 3.000000-3 1.080000-1 0.000000+06637 2151   93
 5.000000+3 3.000000+1 0.000000+0 3.000000-3 1.080000-1 0.000000+06637 2151   94
 6.000000+3 3.000000+1 0.000000+0 3.000000-3 1.080000-1 0.000000+06637 2151   95
 8.000000+3 3.000000+1 0.000000+0 3.000000-3 1.080000-1 0.000000+06637 2151   96
 1.000000+4 3.000000+1 0.000000+0 3.000000-3 1.080000-1 0.000000+06637 2151   97
 1.400000+4 3.000000+1 0.000000+0 3.000000-3 1.080000-1 0.000000+06637 2151   98
 2.000000+4 3.000000+1 0.000000+0 3.000000-3 1.080000-1 0.000000+06637 2151   99
 1.500000+0 0.000000+0          2          0         66         106637 2151  100
 0.000000+0 0.000000+0 0.000000+0 1.000000+0 0.000000+0 0.000000+06637 2151  101
 1.690000+3 1.500000+1 0.000000+0 1.500000-3 1.080000-1 0.000000+06637 2151  102
 2.000000+3 1.500000+1 0.000000+0 1.500000-3 1.080000-1 0.000000+06637 2151  103
 3.000000+3 1.500000+1 0.000000+0 1.500000-3 1.080000-1 0.000000+06637 2151  104
 4.000000+3 1.500000+1 0.000000+0 1.500000-3 1.080000-1 0.000000+06637 2151  105
 5.000000+3 1.500000+1 0.000000+0 1.500000-3 1.080000-1 0.000000+06637 2151  106
 6.000000+3 1.500000+1 0.000000+0 1.500000-3 1.080000-1 0.000000+06637 2151  107
 8.000000+3 1.500000+1 0.000000+0 1.500000-3 1.080000-1 0.000000+06637 2151  108
 1.000000+4 1.500000+1 0.000000+0 1.500000-3 1.080000-1 0.000000+06637 2151  109
 1.400000+4 1.500000+1 0.000000+0 1.500000-3 1.080000-1 0.000000+06637 2151  110
 2.000000+4 1.500000+1 0.000000+0 1.500000-3 1.080000-1 0.000000+06637 2151  111
 0.000000+0 0.000000+0          0          0          0          06637 2  099999
 0.000000+0 0.000000+0          0          0          0          06637 0  0    0
 6.616000+4 1.585510+2          0          0          0          06637 3  1    1
 0.0        0.0                 0          0          1       90926637 3  1    2
       9092          2                                            6637 3  1    3
 1.000000-5 2.860894+3 1.068966-5 2.767098+3 1.142689-5 2.676378+36637 3  1    4
 1.221496-5 2.588637+3 1.305738-5 2.503772+3 1.395790-5 2.421693+36637 3  1    5
 1.492053-5 2.342306+3 1.594954-5 2.265524+3 1.704952-5 2.191262+36637 3  1    6
 1.822536-5 2.119436+3 1.948230-5 2.049968+3 2.082592-5 1.982779+36637 3  1    7
 2.226221-5 1.917795+3 2.379755-5 1.854943+3 2.543878-5 1.794154+36637 3  1    8
 2.719320-5 1.735361+3 2.906861-5 1.678496+3 3.107337-5 1.623499+36637 3  1    9
 3.321638-5 1.570306+3 3.550719-5 1.518861+3 3.795599-5 1.469103+36637 3  1   10
 4.057368-5 1.420980+3 4.337190-5 1.374437+3 4.636310-5 1.329421+36637 3  1   11
 4.956059-5 1.285884+3 5.297860-5 1.243776+3 5.663234-5 1.203052+36637 3  1   12
 6.053806-5 1.163666+3 6.471315-5 1.125573+3 6.917617-5 1.088730+36637 3  1   13
 7.394700-5 1.053099+3 7.904685-5 1.018638+3 8.449842-5 9.853100+26637 3  1   14
 9.032596-5 9.530771+2 9.655541-5 9.219061+2 9.819243-5 9.144896+26637 3  1   15
 1.032145-4 8.917581+2 1.067143-4 8.774156+2 1.103328-4 8.625998+26637 3  1   16
 1.160080-4 8.415623+2 1.179421-4 8.343989+2 1.260761-4 8.071244+26637 3  1   17
 1.347711-4 7.807511+2 1.370560-4 7.744764+2 1.440657-4 7.552440+26637 3  1   18
 1.489508-4 7.431094+2 1.540014-4 7.305745+2 1.619228-4 7.127760+26637 3  1   19
 1.646223-4 7.067156+2 1.759757-4 6.836407+2 1.881121-4 6.613286+26637 3  1   20
 1.913014-4 6.560204+2 2.010855-4 6.397496+2 2.079040-4 6.294845+26637 3  1   21
 2.149537-4 6.188799+2 2.260103-4 6.038231+2 2.297782-4 5.986961+26637 3  1   22
 2.456252-4 5.791758+2 2.625650-4 5.603010+2 2.670166-4 5.558109+26637 3  1   23
 2.806732-4 5.420478+2 2.951102-4 5.288768+2 3.000302-4 5.243922+26637 3  1   24
 3.207221-4 5.073194+2 3.261597-4 5.032580+2 3.428412-4 4.908096+26637 3  1   25
 3.604760-4 4.788973+2 3.664857-4 4.748411+2 3.917608-4 4.593996+26637 3  1   26
 3.984028-4 4.557263+2 4.187791-4 4.444672+2 4.403200-4 4.336933+26637 3  1   27
 4.476608-4 4.300248+2 4.785343-4 4.160596+2 4.947606-4 4.094158+26637 3  1   28
 5.115370-4 4.025530+2 5.468159-4 3.894906+2 5.560866-4 3.863836+26637 3  1   29
 5.845277-4 3.768599+2 6.248404-4 3.646421+2 6.679334-4 3.528310+26637 3  1   30
 7.139983-4 3.414037+2 7.632401-4 3.303574+2 8.158780-4 3.196701+26637 3  1   31
 8.721461-4 3.093394+2 9.322948-4 2.993447+2 9.481010-4 2.969676+26637 3  1   32
 9.965917-4 2.896815+2 1.065323-3 2.803348+2 1.101446-3 2.758890+26637 3  1   33
 1.138794-3 2.712963+2 1.217333-3 2.625557+2 1.301288-3 2.541001+26637 3  1   34
 1.391033-3 2.459270+2 1.486967-3 2.380204+2 1.563453-3 2.323157+26637 3  1   35
 1.589518-3 2.303733+2 1.699141-3 2.229803+2 1.816324-3 2.158287+26637 3  1   36
 1.909751-3 2.106689+2 1.941590-3 2.089120+2 2.075494-3 2.022257+26637 3  1   37
 2.218633-3 1.957576+2 2.371644-3 1.895011+2 2.411853-3 1.880132+26637 3  1   38
 2.535208-3 1.834526+2 2.710051-3 1.776035+2 2.896954-3 1.719456+26637 3  1   39
 3.096746-3 1.664729+2 3.310317-3 1.611834+2 3.538617-3 1.560674+26637 3  1   40
 3.782663-3 1.511189+2 4.043539-3 1.463325+2 4.112094-3 1.451945+26637 3  1   41
 4.322407-3 1.417062+2 4.620508-3 1.372327+2 4.939167-3 1.329065+26637 3  1   42
 5.279803-3 1.287223+2 5.643932-3 1.246758+2 5.739620-3 1.237136+26637 3  1   43
 6.033173-3 1.207644+2 6.449258-3 1.169823+2 6.894040-3 1.133240+26637 3  1   44
 7.369496-3 1.097855+2 7.877743-3 1.063629+2 8.421042-3 1.030524+26637 3  1   45
 8.706585-3 1.014786+2 9.001811-3 9.985272+1 9.622632-3 9.676025+16637 3  1   46
 0.01028627 9.377069+1 0.01099568 9.088222+1 0.01175401 8.808647+16637 3  1   47
 0.01256464 8.538252+1 0.01343117 8.276722+1 0.01435747 8.023777+16637 3  1   48
 0.01460089 7.963643+1 0.01534765 7.779315+1 0.01640613 7.543012+16637 3  1   49
 0.01753760 7.314587+1 0.01874710 7.093819+1 0.02004002 6.880491+16637 3  1   50
 0.02142210 6.674364+1 0.02289951 6.475158+1 0.02447880 6.282565+16637 3  1   51
 0.02488940 6.235524+1 0.02530000 6.189652+1 0.02704485 6.006589+16637 3  1   52
 0.02891003 5.829560+1 0.03090385 5.658421+1 0.03303517 5.493026+16637 3  1   53
 0.03531349 5.333217+1 0.03774893 5.178818+1 0.04035233 5.029678+16637 3  1   54
 0.04313528 4.885695+1 0.04611017 4.746760+1 0.04929021 4.612624+16637 3  1   55
 0.05268958 4.482973+1 0.05632338 4.357649+1 0.06020780 4.236612+16637 3  1   56
 0.06436011 4.119778+1 0.06879879 4.007027+1 0.07354359 3.898320+16637 3  1   57
 0.07861562 3.793483+1 0.08403745 3.692507+1 0.08983320 3.595302+16637 3  1   58
 0.09602866 3.501464+1 0.10265141 3.410856+1 0.10973090 3.323549+16637 3  1   59
 0.11729863 3.239499+1 0.12538828 3.158624+1 0.13403585 3.080844+16637 3  1   60
 0.14327981 3.006086+1 0.15316129 2.934284+1 0.16372426 2.865400+16637 3  1   61
 0.17501572 2.799557+1 0.18708591 2.736505+1 0.19998853 2.675940+16637 3  1   62
 0.21378100 2.618074+1 0.22852469 2.562918+1 0.24428519 2.510458+16637 3  1   63
 0.26113264 2.460691+1 0.27914200 2.413633+1 0.29839339 2.369310+16637 3  1   64
 0.31897248 2.327780+1 0.34097084 2.289362+1 0.36448634 2.253747+16637 3  1   65
 0.38962362 2.221043+1 0.41649452 2.191595+1 0.42355582 2.185211+16637 3  1   66
 0.44521861 2.165465+1 0.47592369 2.143041+1 0.50874640 2.124744+16637 3  1   67
 0.54383276 2.111050+1 0.58133890 2.102484+1 0.60105109 2.100372+16637 3  1   68
 0.63196753 2.100596+1 0.63284696 2.100594+1 0.66521396 2.104798+16637 3  1   69
 0.69943076 2.113776+1 0.73520318 2.128340+1 0.77302004 2.149700+16637 3  1   70
 0.79812117 2.168278+1 0.81255620 2.178807+1 0************************** structural chemist, on the other hand, has always been receptive to aid from
many different areas-notably a variety of instrumental methods; indeed most physical
methods have entered general organic chemical methodology through the structural
chemist's interests and efforts. It is not surprising, therefore, that computer-aided
structure elucidation has found more favor than computer-aided design of organic
synthesis. While this argument is primarily emotional, there is also a logical one. No

ix


x FOREWORD

synthetic organic chemist claims, or needs to claim, that he or she has thought of all
possible synthetic paths to a given molecule. The structural chemist, on the other hand,
must be able to claim that every possible structure compatible with the available chem-
ical and physical evidence has been considered. It is here that computer-aided structure
elucidation plays an extraordinarily important role, and it is here that DENDRAL has
made it possible for enormous advances to have occurred in a period of less than 10
years.

  It is no mere coincidence that scientists from as diverse disciplines as genetics,
computer sciences, and chemistry collaborated in developing DENDRAL as a logical
and practical concept. The numerous applications of DENDRAL and related computer
programs have now been documented in many scientific publications, and putting all
this material, including the historical background, into one single volume constitutes
an important service for scientists from many fields.

Gzrl Djerassi
Professor of Chemistry
Stanford University


PREFACE

Some explanation of the history and authorship of this book is in order. I began writ-
ing this book while on sabbatical leave from the University of Michigan in 1975. I
had chosen to spend that year at Stanford University to learn firsthand about the
DENDRAL Project. My interest derived from a continuing desire to understand what
has been accomplished by the field of artificial intelligence, with which I have long
been associated but toward which I have tried to maintain a critical stance. DENDRAL
is widely claimed to be one of the most notable successes of this field. I wondered
what generalizable lessons it had to share.

  Ed Feigenbaum suggested that I put my efforts, and my perspective as a sympa-
thetic but critical Project outsider, to productive use by writing a volume summarizing
the DENDRAL research, bringing together in one place for the student, and for archival
purposes as well, the threads of work that had been strung here and there throughout
the literature of computer science and analytic organic chemistry, I agreed to do so.

  This background partially explains the pedigree of this volume. The list of authors
might have included every one of the many contributors to the research, but it has
been limited to the major originators and long-term directors of the computer science
directions of the Project, plus myself. As it has developed, I have written almost all the
text; Bruce Buchanan has made major contributions of text and reviewed every draft
of the entire manuscript. Edward Feigenbaum and Joshua Lederberg, of course, have
been the major forces directing the entire project and gave invaluable assistance and
consultation in the preparation of this book.

  A large number of people remain who deserve a lot of credit. I would first like to
thank Harold Brown, Ray Carhart, Geoff Dromey, and Dennis Smith, who directly
helped me to understand specific aspects of the Project, and who reviewed my telling
of those stories. Each of them has devoted a generous amount of time to this effort.
Also, I would like to give special acknowledgment and thanks to Maija Kibens for her
help with the entire work, and to Nils Nilsson for his valuable comments.
  Additionally, there are many contributors to the Project itself who deserve ac-
knowledgment in this volume. Those, in addition to the authors, who are responsible

xi


xii PREFACE

for most of the artificial intelligence concepts are Raymond Carhart, Carl Djerassi,
Dennis Smith, Harold Brown, Allan Delfino, Geoff Dromey, Alan Duffield, Neil Gray,
Larry Masinter, Tom Mitchell, James Nourse, N. S. Sridharan, Georgia Sutherland, and
William White.

  Other Project contributors have been M. Achenbach, C. Van Antwerp, A. Buchs,
L. Creary, L. Dunham, H. Eggert, R. Engelmore, F. Fisher, R. Gritter, S. Hammerum,
L. Hjelmeland, A. Lavanchy, S. Johnson, J. Konopelski, K. Morrill, T. Rindfleisch, A.
Robertson, G. SchrolI, G. Schwenzer, Y. Sheikh, M. Stefik, T. Varkony, A. Wegmann,
W. Yeager, and A. Yeo.

  The financial sponsorship of such an extended effort is extremely important. The
Project has been made possible by the vision of funding-agency executives who have
realized the importance of long-range commitments for such research. In its early years
DENDRAL research was sponsored by the National Aeronautics and Space Adminis-
tration and the Advanced Research Projects Agency of the Department of Defense.
More recently the Project has been sponsored by the National Institutes of Health
(Grant RR-00612). The Project depends on the SUMEX computing facility located at
Stanford University. This facility is sponsored by the National Institutes of Health
(Grant RR-00785) as a national resource for applications of artificial intelligence to
medicine and biology.

  The expository portions of the manuscript have been written for some time, but
the completion of the book has been delayed. The main reason for this delay, aside
from the inevitable desire to include mention of each new development in a project
that will never be completed, is in the difficulty we, the authors, have had in sum-
marizing (and agreeing on) what we see to be the Project's lessons for computer sci-
ence and artificial intelligence. Its appearance at this time does not signal the resolution
of our problem as much as our frustration with it and with the time it has taken us to
formulate our answers. Needless to say, we are not entirely happy with the result.
Hopes and visions, we suppose, always seem much more grand than can be forcefully
argued to others. We have tried not to overstate the case; I hope the reader will see
some of the vision nonetheless. I especially hope that the importance of some of the
specific insights the project members have developed will be appreciated by and will
benefit at least the sympathetic readers,

  This book is written primarily for an audience of computer scientists (not just
artificial intelligence researchers), but it will be comprehensible to most nonspecialists
who have a general technical background. The book presumes no knowledge of chem-
istry beyond the level of an introductory college course on general chemistry and no
knowledge of computer science beyond the level of a basic course in computer pro-
gramming. Our aim is to describe and evaluate the Project's work as an example of arti-
ficial intelligence research, and only secondarily to discuss its importance to chemistry.

Robert Lindsay
Ann Arbor, Michigan


         APPLICATIONS OF
ARTIFICIAL INTELLIGENCE FOR
       ORGANIC CHEMISTRY
         The DENDRAL Project


CHAPTER
ONE

INTRODUCTION

The DENDRAL Boject began with Lederberg's construction in 1964 of an algo-
rithm for generating canonical names and structural descriptions of molecules. In 1965
the Project's goals broadened to include interpretation of analytical chemical data us-
ing methods of artificial intelligence.

The DENDRAL Project is a study of scientific reasoning. More specifically, it is an ap-
plication of computer science to the problem of molecular structure ehrcidation in or-
ganic chemistry: the determination of the topological structure of organic compounds
from indirect observations of these compounds with the empirical procedures of mod-
ern chemistry such as mass spectrometry. The computer programs that are the result
of this work are products of artificial intelligence (AI) research, the branch of com-
puter science that undertakes the challenging but controversial task of mechanizing
perception and thought. AI is distinguished from other applications of computers by its
attention to problems for which no straightforward, assured solution methods are
known in advance. In particular, the programs we will discuss employ guessing strategies
and similar rules of thumb called heuristics. This approach to artificial intelligence is
called heuristic programming. Our book describes the structure elucidation problem,
the DENDRAL programs, and the current directions of the Project.

Within computer science the DENDRAL Project is noteworthy in several ways. It
was the first major application of heuristic programming to experimental analysis in an
empirical science, a practical problem of some importance. It was the first large-scale
program to embody the strategy of using detailed, task-specific knowledge about the
problem domain as a source of heuristics, and to seek generality through automating
the acquisition of such knowledge. It has achieved a high level of performance because
it uses a substantial amount of knowledge of chemistry. It is one of the larger, more
sustained AI projects undertaken, giving it a certain prominence even apart from its
successes. It is being used by chemists, other than its developers, in the pursuit of their
own research goals. It is an interdisciplinary project that has been continuously pro-

1


2 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

ductive for over a decade. Perhaps most significant is that this research is an extensive
empirical exploration of heuristic programming techniques; as such it is a validation of
the strengths and weaknesses of these techniques and an instantiation of a philosophi-
cal concept of automatic discovery procedures whose status has long been in dispute.

"DENDRAL" is the name of the project and also the name of the programs,
sometimes further distinguished as Heuristic DENDRAL and Meta-DENDRAL.
DENDRAL originally stood for DENDRitic ALgorithm, a procedure for exhaustively
and nonredundantly enumerating all the topologically distinct arrangements of any
given set of atoms, consistent with the rules of chemical valence. The original algo-
rithm, which generated only ring-free (acyclic) structures (i.e., the aliphatic com-
pounds) was devised by one of the authors (Joshua Lederberg). The dendritic algorithm
(as well as its later version, which in addition encompasses ring structures) is the heart
of the DENDRAL programs. This algorithm defines the set of possible solutions
through which the DENDRAL programs search for likely solutions. A basic feature of
DENDRAL, and an important limitation on the range of applicability of its methods,
is its uniform notation for hypotheses, here taking the form of graphs in the abstract
sense of points (nodes) linked by lines (edges), depicting, respectively, the atoms and
bonds of molecules.

The means by which these programs reduce the set of possible chemical graphs
(solutions to the elucidation problem) is the real story of DENDRAL. The heuristics
employed are based on judgment and specific chemical knowledge, the kinds of exper-
tise that are popularly called intuition. Heuristic DENDRAL comprises the programs
that employ these methods. An important point, one on which the success of the
project has turned, is that the constructors of the DENDRAL programs eschewed the
search for general principles of problem solving or learning in favor of specific knowl-
edge of a special problem. The success of this project against the general background
of failure of the search for general systems does not, of course, decide the issue of bet-
ter approach; but it ought to attract careful attention.

The foregoing does not deny the existence of general discovery principles for
science. Rather, generality, if the DENDRAL approach is correct, is to be found at a
more abstract level. That is, there may exist general principles for acquiring specific
knowledge, and general principles for selecting specific methods of applying that knowl-
edge. One attempt to program more general rule-discovering (learning) methods is
called Meta-DENDRAL, to distinguish it from the original (performance) system.

Currently much of the Project's effort is devoted to the CONGEN program. This
program, the CONstrained GENerator, embodies the general (acyclic and cyclic) gen-
eration algorithm in a system that allows the chemist to constrain its enumeration in a
variety of ways. CONGEN is being made available to interested nonproject chemists,
and every effort is being made to provide assistance in its application so that it will be
as readily accessible as is possible for a system of this complexity.

The DENDRAL project, extensive as it is, has been the subject of much attention.
Over 80 scientific papers and a number of popular descriptions have been published,
and the project has received a measure of attention in the review literature. This book,
however, is the first attempt to provide a comprehensive description of the goals and
accomplishments of the entire decade and a half of research. We hope it will provide a
definitive, self-contained source of information about this work.


CHAPTER
TWO

THE STRUCTURE ELUCIDATION PROBLEM
           OF ORGANIC CHEMISTRY

The DENDRAL programs are designed to aid organic chemists interpret data from
samples of unknown compounds. Even after the numbers and types of atoms of a
compound are determined, the problem remains of deciding how the atoms are con-
nected in the molecule. Data useful in structure determination may come from a va-
riety of analytic instruments, as well as from chemical experiments. A mass spectro-
meter is one such instrument that provides valuable structural information.

2.1 INTRODUCTION

This chapter describes the chemistry problems addressed by the DENDRAL programs,
including a description of the technique of mass spectrometry which is a major source
of data from which the system works. Also included is a brief introduction to some of
the terminology and concepts of organic chemistry. The intention is to make this book
self-contained by gathering here the necessary definitions and facts of organic chemistry
needed to understand the remaining chapters. An extensive index is provided so that
this chapter may be used as a reference.

The general problem to which the DENDRAL programs apply is an important,
substantive problem in organic chemistry: structure elucidation, that is, the determina-
tion of the organization of sets of atoms in specific molecules. The problem is impor-
tant because the chemical and physical properties of compounds are determined not
just by their constituent atoms, but by the arrangement of these atoms as well. Several
empirical means are available for obtaining information about the structure of a com-
pound. Prominent among these is mass spectrometry, and DENDRAL originally ad-
dressed problems associated only with this method. DENDRAL has since evolved to

3


4 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

deal with the problems of structure elucidation on more general terms. In order to
understand the problem that DENDRAL faces, it is necessary to introduce some ele-
mentary facts about organic chemistry and mass spectrometry.

2.2 ISOMERISM
**************************.84010857 2.203382+16637 3  1   71
 0.86859520 2.232955+1 0.89804776 2.268329+1 0.92720873 2.308710+16637 3  1   72
 0.92849901 2.310480+1 0.95998280 2.360265+1 0.98439632 2.403970+16637 3  1   73
 1.00936172 2.453755+1 1.03488835 2.510531+1 1.04213721 2.528549+16637 3  1   74
 1.06098558 2.575132+1 1.09092337 2.658687+1 1.11930358 2.748947+16637 3  1   75
 1.12086117 2.753867+1 1.15079897 2.861893+1 1.18073677 2.985592+16637 3  1   76
 1.21405358 3.144897+1 1.24563700 3.321683+1 1.24737040 3.331320+16637 3  1   77
 1.28068721 3.550272+1 1.31400402 3.810654+1 1.34181193 4.067011+16637 3  1   78
 1.34920372 4.146785+1 1.36961984 4.366183+1 1.39742775 4.718875+16637 3  1   79
 1.42325510 5.108766+1 1.42523566 5.138546+1 1.45304357 5.641381+16637 3  1   80
 1.48071126 6.249355+1 1.49758559 6.688863+1 1.49910965 6.728439+16637 3  1   81
 1.51750805 7.280211+1 1.53590644 7.921480+1 1.55354279 8.640269+16637 3  1   82
 1.55430483 8.671250+1 1.57270322 9.552922+1 1.59110161 1.060403+26637 3  1   83
 1.60950000 1.187315+2 1.62775875 1.340830+2 1.64601750 1.530470+26637 3  1   84
 1.65007500 1.581209+2 1.65819000 1.682581+2 1.67036250 1.860684+26637 3  1   85
 1.68253500 2.070993+2 1.69065000 2.238021+2 1.69470750 2.321489+26637 3  1   86
 1.70688000 2.622679+2 1.71803813 2.955247+2 1.72919625 3.356386+26637 3  1   87
 1.73595875 3.652389+2 1.74035438 3.844830+2 1.75151250 4.445290+26637 3  1   88
 1.75878219 4.930466+2 1.76267063 5.190102+2 1.77247625 5.996002+26637 3  1   89
 1.77704094 6.449713+2 1.78160563 6.903585+2 1.78617031 7.447253+26637 3  1   90
 1.79073500 7.991185+2 1.79360906 8.398024+2 1.79935719 9.212052+26637 3  1   91
 1.79986438 9.283911+2 1.80510531 1.015227+3 1.80899375 1.079684+36637 3  1   92
 1.81085344 1.115351+3 1.81660156 1.225647+3 1.82049000 1.300300+36637 3  1   93
 1.82234969 1.339996+3 1.82809781 1.462761+3 1.83384594 1.585596+36637 3  1   94
 1.84010125 1.719349+3 1.84686375 1.864035+3 1.84754000 1.878513+36637 3  1   95
 1.85700750 2.047859+3 1.85836000 2.072063+3 1.86647500 2.175634+36637 3  1   96
 1.87459000 2.231890+3 1.87594250 2.233920+3 1.88000000 2.239956+36637 3  1   97
 1.88811500 2.200567+3 1.89014375 2.190672+3 1.89724438 2.103108+36637 3  1   98
 1.90028750 2.065504+3 1.90637375 1.960799+3 1.90705000 1.949146+36637 3  1   99
 1.91617938 1.756899+3 1.92361813 1.600087+3 1.92733750 1.521609+36637 3  1  100
 1.93477625 1.363875+3 1.93951000 1.263402+3 1.95033000 1.058030+36637 3  1  101
 1.95709250 9.484290+2 1.96115000 8.826458+2 1.97197000 7.376166+26637 3  1  102
 1.98076125 6.400739+2 1.99090500 5.468314+2 1.99766750 4.960864+26637 3  1  103
 2.00104875 4.707423+2 2.01119250 4.084859+2 2.02133625 3.572142+26637 3  1  104
 2.02336500 3.487093+2 2.03148000 3.147540+2 2.04568125 2.667467+26637 3  1  105
 2.05988250 2.288596+2 2.06191125 2.245248+2 2.07408375 1.985885+26637 3  1  106
 2.08828500 1.740351+2 2.09369500 1.663507+2 2.10248625 1.539023+26637 3  1  107
 2.12209750 1.315908+2 2.14441375 1.118757+2 2.15050000 1.076753+26637 3  1  108
 2.16673000 9.653281+1 2.18904625 8.432660+1 2.21136250 7.445100+16637 3  1  109
 2.22624000 6.913005+1 2.23706000 6.528504+1 2.26952000 5.621540+16637 3  1  110
 2.30198000 4.914294+1 2.32046662 4.593988+1 2.33444000 4.354023+16637 3  1  111
 2.36690000 3.904595+1 2.39936000 3.538131+1 2.45013700 3.083710+16637 3  1  112
 2.47751099 2.894523+1 2.50091400 2.734968+1 2.55169101 2.465067+16637 3  1  113
 2.60246801 2.248878+1 2.67017068 2.021925+1 2.68723455 1.978093+16637 3  1  114
 2.74551480 1.831541+1 2.82085893 1.685608+1 2.89620305 1.570636+16637 3  1  115
 3.01347121 1.434534+1 3.06833522 1.387966+1 3.13924330 1.329811+16637 3  1  116
 3.26501538 1.253470+1 3.40025122 1.191649+1 3.58687484 1.129603+16637 3  1  117
 3.78403037 1.083765+1 3.80005621 1.081359+1 4.09556152 1.038676+16637 3  1  118
 4.26040000 1.023892+1 4.62104674 1.007364+1 5.00883043 1.009229+16637 3  1  119
 5.23746151 1.021801+1 5.42528252 1.030717+1 5.82860269 1.074405+16637 3  1  120
 5.87193446 1.078740+1 6.20331086 1.133348+1 6.48646471 1.204051+16637 3  1  121
 6.62688179 1.237757+1 6.90346540 1.334822+1 7.03554986 1.396979+16637 3  1  122
 7.18004901 1.463778+1 7.47744423 1.652401+1 7.68264491 1.825110+16637 3  1  123
 7.71989456 1.865144+1 7.88784558 2.045738+1 7.95981250 2.145714+16637 3  1  124
 8.09304626 2.331582+1 8.10543750 2.353275+1 8.17825000 2.481174+16637 3  1  125
 8.23967735 2.589492+1 8.26562500 2.645823+1 8.33115625 2.788611+16637 3  1  126
 8.38212500 2.900054+1 8.38630844 2.909232+1 8.42581250 3.017329+16637 3  1  127
 8.45493750 3.097216+1 8.47860156 3.162248+1 8.50590625 3.237435+16637 3  1  128
 8.52410938 3.287656+1 8.53867188 3.327898+1 8.54231250 3.340496+16637 3  1  129
 8.55869531 3.397263+1 8.56961719 3.435149+1 8.58053906 3.473068+16637 3  1  130
 8.59100586 3.509441+1 8.60101758 3.544264+1 8.61102930 3.579119+16637 3  1  131
 8.62104102 3.614006+1 8.62923243 3.642575+1 8.63401074 3.659251+16637 3  1  132
 8.64186084 3.686665+1 8.65107617 3.718875+1 8.66029150 3.751117+16637 3  1  133
 8.66950684 3.783390+1 8.67337500 3.796951+1 8.67872217 3.820352+16637 3  1  134
 8.68793750 3.860715+1 8.69703906 3.900614+1 8.70614063 3.940549+16637 3  1  135
 8.71979297 4.000520+1 8.73071484 4.048559+1 8.74345703 4.104676+16637 3  1  136
 8.75619922 4.160875+1 8.76894141 4.217157+1 8.78259375 4.277558+16637 3  1  137
 8.79715625 4.342102+1 8.80443750 4.374453+1 8.81900000 4.453377+16637 3  1  138
 8.84266406 4.581973+1 8.86086719 4.681155+1 8.88817188 4.830390+16637 3  1  139
 8.89909375 4.890282+1 8.90637500 4.937969+1 8.93550000 5.129310+16637 3  1  140
 8.96462500 5.321448+1 8.99375000 5.514466+1 9.02287500 5.751993+16637 3  1  141
 9.05928125 6.050433+1 9.09568750 6.350795+1 9.10296875 6.411305+16637 3  1  142
 9.13209375 6.716497+1 9.16850000 7.100493+1 9.20490625 7.487362+16637 3  1  143
 9.21218750 7.565396+1 9.24131250 7.948407+1 9.27771875 8.430978+16637 3  1  144
 9.28500000 8.528373+1 9.31412500 8.992983+1 9.35781250 9.696714+16637 3  1  145
 9.40150000 1.055532+2 9.43062500 1.113486+2 9.44518750 1.148896+26637 3  1  146
 9.48887500 1.256430+2 9.50343750 1.292807+2 9.53256250 1.382937+26637 3  1  147
 9.57625000 1.520107+2 9.61993750 1.694036+2 9.64323750 1.788215+26637 3  1  148
 9.65270313 1.834895+2 9.68328438 1.987578+2 9.69347813 2.039309+26637 3  1  149
 9.72260313 2.216697+2 9.74371875 2.347734+2 9.76192188 2.485237+26637 3  1  150
 9.79395938 2.731973+2 9.80124063 2.801370+2 9.83837500 3.162186+26637 3  1  151
 9.84420000 3.220107+2 9.87332500 3.580456+2 9.89080000 3.800949+26637 3  1  152
 9.89953750 3.935527+2 9.92575000 4.346167+2 9.95196250 4.849494+26637 3  1  153
 9.96070000 5.020629+2 9.97526250 5.368302+2 9.99565000 5.865596+26637 3  1  154
 10.0043875 6.129981+2 10.0262313 6.804900+2 10.0306000 6.942943+26637 3  1  155
 10.0480750 7.611915+2 10.0546281 7.868597+2 10.0699188 8.578460+26637 3  1  156
 10.0786563 8.993688+2 10.0903063 9.658351+2 10.1026844 1.038117+36637 3  1  157
 10.1099656 1.089963+3 10.1267125 1.212080+3 10.1296250 1.238467+36637 3  1  158
 10.1492844 1.421024+3 10.1507406 1.434990+3 10.1689438 1.650100+36637 3  1  159
 10.1704000 1.667890+3 10.1871469 1.915911+3 10.1878750 1.927041+36637 3  1  160
 10.2024375 2.197588+3 10.2053500 2.253386+3 10.2177281 2.545456+36637 3  1  161
 10.2228250 2.669611+3 10.2330188 2.967154+3 10.2344750 3.010837+36637 3  1  162
 10.2432125 3.315499+3 10.2461250 3.419371+3 10.2534063 3.728256+36637 3  1  163
 10.2606875 4.045403+3 10.2672406 4.388107+3 10.2737938 4.739995+36637 3  1  164
 10.2781625 5.018217+3 10.2869000 5.587387+3 10.2890844 5.755029+36637 3  1  165
 10.3000063 6.611288+3 10.3131125 7.836521+3 10.3145688 7.994207+36637 3  1  166
 10.3276750 9.445806+3 10.3284031 9.528403+3 10.3451500 1.171691+46637 3  1  167
 10.3480625 1.210565+4 10.3684500 1.513750+4 10.3873813 1.796419+46637 3  1  168
 10.3975750 1.935511+4 10.4070406 2.061457+4 10.4150500 2.142094+46637 3  1  169
 10.4267000 2.253040+4 10.4325250 2.282704+4 10.4441750 2.334760+46637 3  1  170
 10.4456313 2.336647+4 10.4500000 2.340584+4 10.4645625 2.305681+46637 3  1  171
 10.4660188 2.296661+4 10.4791250 2.206385+4 10.4820375 2.177105+46637 3  1  172
 10.4936875 2.053327+4 10.4980563 1.994713+4 10.5140750 1.773533+46637 3  1  173
 10.5199000 1.692038+4 10.5533938 1.199830+4 10.5548500 1.178696+46637 3  1  174
 10.5665000 1.027596+4 10.5694125 9.904823+3 10.5839750 8.257890+36637 3  1  175
 10.5970813 7.005399+3 10.5985375 6.869276+3 10.6101875 5.946851+36637 3  1  176
 10.6131000 5.721815+3 10.6232938 5.066516+3 10.6283906 4.747424+36637 3  1  177
 10.6364000 4.335394+3 10.6436813 3.971695+3 10.6509625 3.673498+36637 3  1  178
 10.6589719 3.355759+3 10.6655250 3.142091+3 10.6742625 2.866121+36637 3  1  179
 10.6800875 2.713975+3 10.6895531 2.474349+3 10.6946500 2.365435+36637 3  1  180
 10.7026594 2.199338+3 10.7092125 2.084013+3 10.7186781 1.923090+36637 3  1  181
 10.7310563 1.745871+3 10.7346969 1.695671+3 10.7507156 1.507930+36637 3  1  182
 10.7529000 1.486576+3 10.7732875 1.294823+3 10.7747438 1.281514+36637 3  1  183
 10.7936750 1.141072+3 10.7987719 1.104513+3 10.8228000 9.621720+26637 3  1  184
 10.8242563 9.550497+2 10.8533813 8.188541+2 10.8548375 8.132743+26637 3  1  185
 10.8839625 7.061668+2 10.8854188 7.017098+2 10.9145438 6.158995+26637 3  1  186
 10.9160000 6.122818+2 10.9451250 5.426448+2 10.9524063 5.278050+26637 3  1  187
 10.9757063 4.820930+2 10.9888125 4.598228+2 11.0033750 4.360787+26637 3  1  188
 11.0383250 3.868177+2 11.0434219 3.806208+2 11.0732750 3.460688+26637 3  1  189
 11.0980313 3.219594+2 11.1257000 2.961542+2 11.1526406 2.754751+26637 3  1  190
 11.1781250 2.566809+2 11.2072500 2.387329+2 11.2305500 2.249402+26637 3  1  191
 11.2727813 2.039201+2 11.2873438 1.969586+2 11.3383125 1.766303+26637 3  1  192
 11.3528750 1.710793+2 11.4184063 1.502600+2 11.4366094 1.453445+26637 3  1  193
 11.4839375 1.332707+2 11.5276250 1.234893+2 11.5349063 1.220714+26637 3  1  194
 11.6004375 1.098977+2 11.6150000 1.073054+2 11.7132969 9.290570+16637 3  1  195
 11.7315000 9.068183+1 11.8115938 8.151865+1 11.8771250 7.519621+16637 3  1  196
 11.9098906 7.221679+1 12.0081875 6.460580+1 12.0227500 6.364983+16637 3  1  197
 12.1392500 5.645262+1 12.1683750 5.492603+1 12.2484688 5.099786+16637 3  1  198
 12.3868125 4.530467+1 12.4122969 4.432411+1 12.5761250 3.910679+16637 3  1  199
 12.6052500 3.832358+1 12.7399531 3.498068+1 12.8965000 3.167203+16637 3  1  200
 12.9037813 3.152953+1 13.0858125 2.849847+1 13.1877500 2.705845+16637 3  1  201
 13.3042500 2.553331+1 13.4790000 2.360416+1 13.5226875 2.315537+16637 3  1  202
 13.7411250 2.124811+1 13.8285000 2.060352+1 14.0323750 1.923608+16637 3  1  203
 14.3216250 1.763539+1 14.3527500 1.749197+1 14.6088750 1.643562+16637 3  1  204
 14.8770000 1.551493+1 14.8961250 1.545504+1 15.3270000 1.444765+16637 3  1  205
 15.6580000 1.394342+1 15.6745000 1.392009+1 16.0220000 1.366076+16637 3  1  206
 16.3695000 1.369253+1 16.7170000 1.407115+1 16.9776250 1.464762+16637 3  1  207
 17.1340000 1.519147+1 17.2382500 1.554784+1 17.4988750 1.687810+16637 3  1  208
 17.7595000 1.881436+1 17.8985000 2.021502+1 17.9332500 2.056978+16637 3  1  209
 18.1070000 2.282612+1 18.2112500 2.456133+1 18.2633750 2.543616+16637 3  1  210
 18.2894375 2.599042+1 18.3502500 2.729194+1 18.4023750 2.841460+16637 3  1  211
 18.4197500 2.879095+1 18.4371250 2.927307+1 18.4762188 3.036249+16637 3  1  212
 18.5087969 3.127450+1 18.5305156 3.188484+1 18.5544063 3.255855+16637 3  1  213
 18.5739531 3.311171+1 18.5804688 3.329672+1 18.5935000 3.377242+16637 3  1  214
 18.6065313 3.424921+1 18.6195625 3.472692+1 18.6325938 3.520560+16637 3  1  215
 18.6456250 3.568528+1 18.6586563 3.616601+1 18.6716875 3.664782+16637 3  1  216
 18.6847188 3.713077+1 18.6977500 3.761490+1 18.7107813 3.810027+16637 3  1  217
 18.7238125 3.858692+1 18.7281563 3.874954+1 18.7346719 3.905292+16637 3  1  218
 18.7509609 3.981318+1 18.7672500 4.057572+1 18.7802813 4.118749+16637 3  1  219
 18.7998281 4.210817+1 18.8193750 4.303272+1 18.8367500 4.385798+16637 3  1  220
 18.8541250 4.488756+1 18.8801875 4.643883+1 18.8997344 4.760813+16637 3  1  221
 18.9214531 4.891367+1 18.9431719 5.022639+1 18.9670625 5.168112+16637 3  1  222
 18.9757500 5.233368+1 19.0018125 5.430523+1 19.0278750 5.629036+16637 3  1  223
 19.0539375 5.829033+1 19.0582813 5.862638+1 19.0800000 6.064395+16637 3  1  224
 19.1147500 6.390016+1 19.1495000 6.719247+1 19.1842500 7.121366+16637 3  1  225
 19.2190000 7.528173+1 19.2363750 7.734628+1 19.2624375 8.111033+16637 3  1  226
 19.3058750 8.748334+1 19.3232500 9.008007+1 19.3493125 9.487443+16637 3  1  227
 19.3927500 1.030075+2 19.4101250 1.063296+2 19.4361875 1.123664+26637 3  1  228
 19.4752813 1.216095+2 19.4796250 1.228272+2 19.5230625 1.352598+26637 3  1  229
 19.5352250 1.388289+2 19.5665000 1.496727+2 19.5925625 1.589141+26637 3  1  230
 19.6003813 1.622181+2 19.6342625 1.768181+2 19.6499000 1.837137+26637 3  1  231
 19.6681438 1.934040+2 19.7020250 2.118122+2 19.7072375 2.147216+26637 3  1  232
 19.7359063 2.342301+2 19.7645750 2.542467+2 19.7680500 2.572312+26637 3  1  233
 19.7993250 2.847464+2 19.8167000 3.004760+2 19.8306000 3.156739+26637 3  1  234
 19.8584000 3.469536+2 19.8618750 3.516511+2 19.8931500 3.951820+26637 3  1  235
 19.9001000 4.051997+2 19.9226875 4.447146+2 19.9418000 4.792492+26637 3  1  236
 19.9487500 4.941973+2 19.9696000 5.404684+2 19.9748125 5.539286+26637 3  1  237
 19.9974000 6.142292+2 20.0008750 6.251430+2 20.0252000 7.042976+26637 3  1  238
 20.0269375 7.109951+2 20.0512625 8.084111+2 20.0530000 8.167201+26637 3  1  239
 20.0738500 9.201507+2 20.0773250 9.381160+2 20.0947000 1.046308+36637 3  1  240
 20.1033875 1.102788+3 20.1155500 1.196146+3 20.1207625 1.238057+36637 3  1  241
 20.1364000 1.382918+3 20.1381375 1.399697+3 20.1503000 1.535968+36637 3  1  242
 20.1555125 1.596887+3 20.1694125 1.789836+3 20.1763625 1.890764+36637 3  1  243
 20.1850500 2.042073+3 20.1946063 2.215474+3 20.2006875 2.346883+36637 3  1  244
 20.2128500 2.620619+3 20.2163250 2.713844+3 20.2310938 3.126168+36637 3  1  245
 20.2319625 3.154989+3 20.2476000 3.694179+3 20.2493375 3.756884+36637 3  1  246
 20.2615000 4.257593+3 20.2649750 4.421005+3 20.2806125 5.186447+36637 3  1  247
 20.2823500 5.284801+3 20.2997250 6.304682+3 20.3171000 7.494639+36637 3  1  248
 20.3188375 7.617385+3 20.3379500 9.131698+3 20.3518500 1.026101+46637 3  1  249
 20.3935500 1.379102+4 20.4005000 1.430365+4 20.4213500 1.577244+46637 3  1  250
 20.4283000 1.614210+4 20.4422000 1.680935+4 20.4491500 1.701838+46637 3  1  251
 20.4595750 1.727152+4 20.4700000 1.737443+4 20.4771672 1.730957+46637 3  1  252
 20.4873750 1.717314+4 20.4986688 1.682459+4 20.5047500 1.660262+46637 3  1  253
 20.5177813 1.588805+4 20.5308125 1.510686+4 20.5464500 1.391510+46637 3  1  254
 20.5673000 1.225322+4 20.6037875 9.221369+3 20.6194250 8.035869+36637 3  1  255
 20.6298500 7.270508+3 20.6402750 6.589431+3 20.6472250 6.150850+36637 3  1  256
 20.6611250 5.371035+3 20.6646000 5.183976+3 20.6819750 4.369548+36637 3  1  257
 20.6828438 4.330576+3 20.7010875 3.630416+3 20.7184625 3.088919+36637 3  1  258
 20.7193313 3.062971+3 20.7358375 2.647017+3 20.7375750 2.605102+36637 3  1  259
 20.7532125 2.286996+3 20.7558188 2.236259+3 20.7705875 1.990398+36637 3  1  260
 20.7714563 1.976545+3 20.7879625 1.751160+3 20.7905688 1.717338+36637 3  1  261
 20.8096813 1.507083+3 20.8140250 1.465920+3 20.8287938 1.333654+36637 3  1  262
 20.8314000 1.313392+3 20.8479063 1.191676+3 20.8592000 1.120958+36637 3  1  263
 20.8765750 1.018556+3 20.8870000 9.673580+2 20.9052438 8.826562+26637 3  1  264
 20.9148000 8.455758+2 20.9391250 7.570323+2 20.9565000 7.044333+26637 3  1  265
 20.9756125 6.504751+2 20.9982000 5.970048+2 21.0121000 5.660902+26637 3  1  266
 21.0399000 5.135482+2 21.0485875 4.980010+2 21.0781250 4.525505+26637 3  1  267
 21.0850750 4.424176+2 21.1267750 3.904192+2 21.1302500 3.863205+26637 3  1  268
 21.1719500 3.442136+2 21.1754250 3.411351+2 21.2136500 3.095761+26637 3  1  269
 21.2484000 2.849400+2 21.2762000 2.666561+2 21.3213750 2.416473+26637 3  1  270
 21.3387500 2.326544+2 21.3943500 2.081151+2 21.4013000 2.052484+26637 3  1  271
 21.4690625 1.813016+2 21.4864375 1.760204+2 21.5472500 1.589083+26637 3  1  272
 21.5733125 1.526054+2 21.6254375 1.409923+2 21.7036250 1.258916+26637 3  1  273
 21.7557500 1.176587+2 21.8339375 1.067247+2 21.8600000 1.033617+26637 3  1  274
 21.9642500 9.194774+1 21.9772813 9.063412+1 22.0945625 8.057916+16637 3  1  275
 22.1380000 7.733725+1 22.2118438 7.237146+1 22.3291250 6.546473+16637 3  1  276
 22.3465000 6.456816+1 22.4855000 5.814348+1 22.5550000 5.537897+16637 3  1  277
 22.6549063 5.177587+1 22.7635000 4.838873+1 22.8243125 4.664676+16637 3  1  278
 22.9720000 4.292734+1 22.9937188 4.243221+1 23.1631250 3.902674+16637 3  1  279
 23.3195000 3.625289+1 23.3890000 3.516159+1 23.6235625 3.195711+16637 3  1  280
 23.6670000 3.143000+1 23.8581250 2.941790+1 24.0926875 2.721625+16637 3  1  281
 24.1882500 2.640249+1 24.3272500 2.540464+1 24.6400000 2.339991+16637 3  1  282
 24.8485000 2.221038+1 25.0048750 2.146370+1 25.3697500 1.992792+16637 3  1  283
 25.5782500 1.913003+1 25.7346250 1.862198+1 26.0995000 1.754797+16637 3  1  284
 26.3080000 1.698886+1 26.5860000 1.636733+1 27.1486323 1.524266+16637 3  1  285
 27.4214981 1.474801+1 27.7112645 1.431633+1 28.2738968 1.354879+16637 3  1  286
 28.5349961 1.321953+1 28.8365291 1.290646+1 29.3991614 1.236697+16637 3  1  287
 30.0415891 1.179531+1 30.1234241 1.172812+1 30.7239145 1.131242+16637 3  1  288
 31.1787982 1.102473+1 31.7337800 1.071020+1 32.1022625 1.053239+16637 3  1  289
 32.4707450 1.039321+1 32.7164000 1.033378+1 32.9074650 1.031576+16637 3  1  290
 33.0985300 1.033372+1 33.2077100 1.036967+1 33.2418288 1.036974+16637 3  1  291
 33.3851275 1.041253+1 33.5147788 1.050319+1 33.6171350 1.062400+16637 3  1  292
 33.7194913 1.080590+1 33.8218475 1.107418+1 33.8873555 1.131009+16637 3  1  293
 33.8900850 1.131809+1 33.9583225 1.159144+1 34.0265600 1.196372+16637 3  1  294
 34.0838795 1.237998+1 34.1411990 1.292523+1 34.1548465 1.309740+16637 3  1  295
 34.1985185 1.360265+1 34.2367315 1.417940+1 34.2749445 1.490113+16637 3  1  296
 34.3131575 1.581523+1 34.3445468 1.675840+1 34.3541000 1.712429+16637 3  1  297
 34.3813950 1.812101+1 34.4059605 1.926536+1 34.4305260 2.067871+16637 3  1  298
 34.4550915 2.245123+1 34.4796570 2.471271+1 34.4851160 2.534284+16637 3  1  299
 34.4980811 2.681484+1 34.5165053 2.939224+1 34.5362941 3.285981+16637 3  1  300
 34.5513064 3.610287+1 34.5663186 4.000172+1 34.5813309 4.469216+16637 3  1  301
 34.5963431 5.032841+1 34.6113554 5.708044+1 34.6263676 6.512865+16637 3  1  302
 34.6270500 6.556171+1 34.6413799 7.470293+1 34.6598040 8.872887+16637 3  1  303
 34.6700396 9.772499+1 34.6707220 9.832822+1 34.6925580 1.206708+26637 3  1  304
 34.6939228 1.223224+2 34.7143940 1.472050+2 34.7164411 1.500445+26637 3  1  305
 34.7362300 1.776333+2 34.7423714 1.871819+2 34.7683016 2.277277+26637 3  1  306
 34.7942319 2.685153+2 34.8126560 2.976685+2 34.8263035 3.154556+26637 3  1  307
 34.8454100 3.404808+2 34.8727050 3.639290+2 34.8931763 3.720596+26637 3  1  308
 34.9000000 3.728189+2 34.9136475 3.704005+2 34.9204713 3.691156+26637 3  1  309
 34.9409425 3.568000+2 34.9436720 3.540880+2 34.9655080 3.321017+26637 3  1  310
 34.9764260 3.172445+2 34.9982620 2.872035+2 35.0091800 2.703994+26637 3  1  311
 35.0200980 2.534945+2 35.0624053 1.876075+2 35.0637700 1.857453+26637 3  1  312
 35.0910650 1.482530+2 35.1101715 1.256326+2 35.1292780 1.061323+26637 3  1  313
 35.1442903 9.295820+1 35.1593025 8.156116+1 35.1743148 7.179270+16637 3  1  314
 35.1893270 6.348108+1 35.2043393 5.644592+1 35.2111630 5.374753+16637 3  1  315
 35.2193515 5.056138+1 35.2343638 4.565170+1 35.2548350 4.018728+16637 3  1  316
 35.2712120 3.663851+1 35.2930480 3.278717+1 35.3148840 2.981307+16637 3  1  317
 35.3367200 2.741249+1 35.3585560 2.544123+1 35.3803920 2.379459+16637 3  1  318
 35.4022280 2.244719+1 35.4131460 2.180787+1 35.4424881 2.042461+16637 3  1  319
 35.4793364 1.900772+1 35.5161846 1.785102+1 35.5530329 1.688557+16637 3  1  320
 35.5823750 1.625504+1 35.6083053 1.574398+1 35.6635776 1.487921+16637 3  1  321
 35.7188500 1.417431+1 35.7734400 1.359350+1 35.8280300 1.309918+16637 3  1  322
 35.8826200 1.268505+1 35.9099150 1.250339+1 35.9918000 1.206365+16637 3  1  323
 36.0736850 1.169947+1 36.1555700 1.139103+1 36.2681619 1.103347+16637 3  1  324
 36.3807538 1.073189+1 36.4285200 1.062335+1 36.5308763 1.043442+16637 3  1  325
 36.6809988 1.020621+1 36.8242975 1.001984+1 37.0290100 9.790695+06637 3  1  326
 37.2337225 9.592324+0 37.3019600 9.533293+0 37.4384350 9.443292+06637 3  1  327
 37.7113850 9.286168+0 38.0252775 9.127481+0 38.3801125 8.966874+06637 3  1  328
 38.9123650 8.749802+0 39.2672000 8.615248+0 39.3763800 8.576249+06637 3  1  329
 39.9768700 8.419156+0 40.6865400 8.247055+0 41.7510450 8.003985+06637 3  1  330
 42.6366174 7.810834+0 42.6999302 7.800006+0 43.8880305 7.605903+06637 3  1  331
 45.6701811 7.325014+0 47.4489220 7.054640+0 47.5193808 7.045543+06637 3  1  332
 49.5026789 6.798809+0 51.4859769 6.557205+0 53.5652504 6.310279+06637 3  1  333
 55.8324240 6.048958+0 58.0995976 5.795978+0 59.6110467 5.633058+06637 3  1  334
 61.2930898 5.458680+0 61.9034464 5.399324+0 62.9751329 5.262230+06637 3  1  335
 64.6571760 5.063561+0 65.4981976 4.974521+0 65.5218616 4.972307+06637 3  1  336
 66.3392191 4.855845+0 66.9516643 4.778191+0 67.5641096 4.712018+06637 3  1  337
 67.9875000 4.678231+0 68.1765548 4.648215+0 68.6358887 4.592064+06637 3  1  338
 69.1325000 4.555820+0 69.4760000 4.552392+0 69.5332500 4.556339+06637 3  1  339
 69.8195000 4.544195+0 70.0771250 4.558307+0 70.3061250 4.596139+06637 3  1  340
 70.3920000 4.622187+0 70.5208125 4.641683+0 70.7355000 4.713877+06637 3  1  341
 70.9501875 4.842280+0 71.0360625 4.919693+0 71.0933125 4.959872+06637 3  1  342
 71.2364375 5.107649+0 71.3795625 5.319413+0 71.4225000 5.409755+06637 3  1  343
 71.5226875 5.597336+0 71.6300313 5.879325+0 71.7087500 6.155960+06637 3  1  344
 71.7373750 6.248706+0 71.8447188 6.726846+0 71.9234375 7.195648+06637 3  1  345
 71.9305938 7.235833+0 72.0057344 7.785600+0 72.0808750 8.495812+06637 3  1  346
 72.1209500 8.991163+0 72.1560156 9.411694+0 72.2311563 1.061986+16637 3  1  347
 72.2469000 1.094757+1 72.2812500 1.165077+1 72.3306281 1.291750+16637 3  1  348
 72.3728500 1.429688+1 72.3800063 1.452939+1 72.4293844 1.662495+16637 3  1  349
 72.4623031 1.840785+1 72.4952219 2.062309+1 72.4988000 2.092847+16637 3  1  350
 72.5281406 2.344769+1 72.5488938 2.570530+1 72.5560500 2.649021+16637 3  1  351
 72.5789500 2.958945+1 72.5889688 3.125405+1 72.6018500 3.340426+16637 3  1  352
 72.6090063 3.487364+1 72.6247500 3.812747+1 72.6290438 3.922461+16637 3  1  353
 72.6440719 4.308778+1 72.6476500 4.401356+1 72.6591000 4.768197+16637 3  1  354
 72.6705500 5.137375+1 72.6741281 5.280281+1 72.6891563 5.884209+16637 3  1  355
 72.6934500 6.058027+1 72.7041844 6.594273+1 72.7163500 7.206283+16637 3  1  356
 72.7192125 7.381946+1 72.7342406 8.310358+1 72.7378188 8.532903+16637 3  1  357
 72.7456906 9.118108+1 72.7578563 1.002779+2 72.7585719 1.009090+26637 3  1  358
 72.7714531 1.123341+2 72.7778938 1.180832+2 72.7843344 1.247968+26637 3  1  359
 72.7979313 1.390669+2 72.8007938 1.425738+2 72.8168953 1.624403+26637 3  1  360
 72.8208313 1.673364+2 72.8351438 1.881750+2 72.8465938 2.049781+26637 3  1  361
 72.8533922 2.165547+2 72.8737875 2.515482+2 72.8952563 2.937270+26637 3  1  362
 72.9024125 3.078904+2 72.9167250 3.396029+2 72.9453500 4.035178+26637 3  1  363
 72.9510750 4.169166+2 73.0026000 5.384356+2 73.0426750 6.237267+26637 3  1  364
 73.0541250 6.429787+2 73.0770250 6.810646+2 73.0827500 6.872012+26637 3  1  365
 73.1113750 7.171000+2 73.1171000 7.194228+2 73.1400000 7.278133+26637 3  1  366
 73.1514500 7.250321+2 73.1686250 7.200374+2 73.1900938 7.012787+26637 3  1  367
 73.1972500 6.946961+2 73.2215813 6.588602+2 73.2316000 6.437074+26637 3  1  368
 73.2587938 5.896738+2 73.2716750 5.636220+2 73.3060250 4.854432+26637 3  1  369
 73.3604125 3.605700+2 73.3919000 2.953205+2 73.3961938 2.864734+26637 3  1  370
 73.4276813 2.299909+2 73.4434250 2.055599+2 73.4512969 1.934904+26637 3  1  371
 73.4749125 1.621707+2 73.4820688 1.540820+2 73.4985281 1.357599+26637 3  1  372
 73.5164188 1.186739+2 73.5207125 1.151311+2 73.5364563 1.023874+26637 3  1  373
 73.5564938 8.860515+1 73.5593563 8.693788+1 73.5765313 7.715907+16637 3  1  374
 73.5965688 6.755012+1 73.5980000 6.697182+1 73.6166063 5.964208+16637 3  1  375
 73.6355703 5.336005+1 73.6366438 5.301250+1 73.6566813 4.755790+16637 3  1  376
 73.6731406 4.387375+1 73.6838750 4.153794+1 73.7096375 3.701616+16637 3  1  377
 73.7232344 3.505044+1 73.7354000 3.335047+1 73.7697500 2.946728+16637 3  1  378
 73.7733281 2.914165+1 73.8041000 2.645699+1 73.8384500 2.399866+16637 3  1  379
 73.8484688 2.339595+1 73.8728000 2.200722+1 73.9243250 1.959290+16637 3  1  380
 73.9486563 1.864971+1 73.9665469 1.799506+1 74.0166406 1.645092+16637 3  1  381
 74.0667344 1.514276+1 74.0703125 1.506475+1 74.1418750 1.360929+16637 3  1  382
 74.2134375 1.242207+1 74.2170156 1.236664+1 74.2921563 1.140472+16637 3  1  383
 74.3780313 1.048575+1 74.4281250 1.004087+1 74.4853750 9.576206+06637 3  1  384
 74.5927188 8.860364+0 74.6642813 8.457676+0 74.7000625 8.273395+06637 3  1  385
 74.8431875 7.661352+0 74.9433750 7.304000+0 74.9827344 7.176549+06637 3  1  386
 75.1187031 6.803610+0 75.3155000 6.349151+0 75.3226563 6.334345+06637 3  1  387
 75.5266094 5.987905+0 75.7305625 5.694680+0 75.8880000 5.502185+06637 3  1  388
 76.0025000 5.380953+0 76.3460000 5.083731+0 76.6895000 4.838297+06637 3  1  389
 76.9183750 4.696614+0 76.9185000 4.696542+0 77.3282813 4.497950+06637 3  1  390
 77.7380625 4.337666+0 78.2844375 4.180866+0 78.7995000 4.092935+06637 3  1  391
 78.8308125 4.086035+0 79.3577500 4.046836+0 79.7383750 4.076801+06637 3  1  392
 79.8145000 4.095257+0 80.1190000 4.155190+0 80.4996250 4.310261+06637 3  1  393
 80.8802500 4.571233+0 81.2608750 4.975823+0 81.3370000 5.088285+06637 3  1  394
 81.5146250 5.359454+0 81.5907500 5.509160+0 81.7430000 5.816204+06637 3  1  395
 81.7683750 5.868650+0 81.8698750 6.136993+0 81.9650313 6.393403+06637 3  1  396
 82.0221250 6.549853+0 82.0348125 6.593655+0 82.0919063 6.793078+06637 3  1  397
 82.1490000 6.994843+0 82.1997500 7.176371+0 82.2378125 7.313994+06637 3  1  398
 82.2505000 7.360286+0 82.2695313 7.447506+0 82.2980781 7.579198+06637 3  1  399
 82.3266250 7.711753+0 82.3520000 7.830342+0 82.3773750 7.949685+06637 3  1  400
 82.3995782 8.054759+0 82.4217813 8.160463+0 82.4297110 8.198372+06637 3  1  401
 82.4535000 8.312617+0 82.4749102 8.416122+0 82.4963204 8.520303+06637 3  1  402
 82.4979063 8.528064+0 82.5105938 8.604527+0 82.5327969 8.738981+06637 3  1  403
 82.5550000 8.874245+0 82.5803750 9.029872+0 82.6057500 9.186658+06637 3  1  404
 82.6342969 9.364500+0 82.6628438 9.543968+0 82.6882188 9.705111+06637 3  1  405
 82.6945625 9.753669+0 82.7326250 1.004801+1 82.7706875 1.034584+16637 3  1  406
 82.8150938 1.069808+1 82.8626719 1.108169+1 82.8785313 1.121190+16637 3  1  407
 82.9102500 1.152673+1 82.9610000 1.203898+1 83.0117500 1.256095+16637 3  1  408
 83.0625000 1.309366+1 83.0688438 1.316173+1 83.1132500 1.373035+16637 3  1  409
 83.1640000**************************
Several models of molecules are used in chemistry. The one appropriate to our pur-
poses is the ball-and-stick model, in which the "balls" are atoms, and the "sticks" are
bonds between atoms. The bonds may be of different types, corresponding to the
number of electrons shared by two atoms to form the bonds. Single, double, and triple
bonds, denoted "-" "=", and "z", respectively, correspond to two, four, and six
shared electrons. A ball-and-stickmodel of the water molecule is presented in Figure 2-1.

  It is known that a water molecule is composed of two hydrogen atoms and one
oxygen atom. This information about the molecular structure is given by the empirical
formula of the molecule: HZ0 in the case of water. A given collection of atoms may,
of course, be arranged in numerous ways. If atoms were really just balls of various sizes
that could be stacked up in arbitrary arrangements, there would be many possible con-
figurations. This number is limited by the known facts of chemical valence, i.e., the
number of bonding sites available to an atom. These are topological constraints on the
set of all possible organizations of atoms. Other constraints are geometric; these limit
the molecular possibilities in accordance with facts about bond lengths and the angles
between bonds. In our example, it is known that the topology of water is H-O-H,
not H-H-O, because hydrogen has a valence of 1 not 2, and oxygen has a valence of
2 not 1. It is known further that the geometry of the water molecule, as shown in
Figure 2-1, is such that the lengths of the bonds (the distances between atomic centers)
is 0.0965 millimicron (a millimicron is 10m9 meter), and that the angle between the
bonds is 104.5".

  It is useful at times to ignore some of the known constraints on molecular organ-
ization. Molecular organizations that are the same up to a point, but differ in some
further regard, are called isomers. For example, two molecules with the same empirical
formula but different topology (connectivity) are called structural isomers or con-
nectivity isomers. We will use the latter term since it is more explicit. Usually the term
"isomers," without further qualification, denotes connectivity isomers. Two molecules
that have the same empirical formula and the same connectivity, but are not congruent
(superimposable) in threedimensional space, are stereoisdners. One type of stereo-
isomer arises because double bonds cannot in fact undergo the topology-preserving

Figure 2-1 A water molecule. DENDRAL does not consider
the lengths of bonds or the angles between them.


THE STRUCTURE ELUCIDATION PROBLEM OF ORGANIC CHEMISTRY 5

transformation of twisting. Thus these two arrangements

H \C=(fH     CH3,      H
CH,'   `CH,     H' c=o'
              `CH,

are topologically equivalent but chemically distinct. In general, different isomers have
different chemical and physical properties.

DENDRAL is mostly concerned with connectivity information about molecules
because the context of its development was mass spectrometry, which is largely insen-
sitive to stereoisomerism. Thus to most of DENDRAL, different geometric forms of
the same topology are entirely equivalent. ' The identification of a molecule means at
least that its topological organization is known. One representation of molecular topol-
ogy is the chemical graph.2 In such graphs atoms are represented by nodes and bonds
by edges connecting the nodes.

This graphical representation of chemical structure is used to considerable advan-
tage by DENDRAL. DENDRAL's immediate and final hypotheses and its problem def-
inition are all characterized by the common language of graphs. Thus there is a single
representation language in which the various parts of DENDRAL communicate.

Graphs are often abbreviated when the nature of the bonding is invariant for cer-
tain substituents. Thus the notation CFs-CN looks like an empirical formula but is
actually a graph in abbreviated form, it being understood that the three fluorine atoms
(F's) adjacent to the left-hand carbon atom (C) are singly bonded to the carbon atom,
which in turn is singly bonded to the carbon in the right constituent; and that the car-
bon and nitrogen (IV) in the right constituent are triply bonded. When bonds are not
indicated explicitly, i.e., two atom names are simply juxtaposed, it is necessary to de-
termine the nature of the implied bond (single, double, or triple) by resorting to knowl-
edge of valences. For example, in Rr -CO-R2, with the R's being abbreviations for
constituents singly bonded to the carbon, 3 it is understood that R2 is bonded to C and
the carbon to oxygen bond is double, since the valence of oxygen is 2. The most fre-
quent abbreviation is the omission of hydrogen atoms. All bonding sites that are un-
specified are thus assumed to be bonded to hydrogen atoms. We will adopt this con-
vention throughout. In many illustrations, carbon atoms are left as unnamed nodes of
graphs.

2.3 ORGANIC COMPOUNDS AND NOMENCLATURE

In this book reference will be made to several classes of compounds. Definitions of
these are gathered here for ease of reference. This section may be skipped by readers
familiar with the basic terminology of organic chemistry.

`Recent work by James Nourse, described in Sec. 4.6.3, is an exception to this statement.
2Unfortunately, gruph commonly refers to a plot of one variable as a function of another. In
this book, graph will be used exclusively in the sense of mathematical graph theory: a set of dis-
crete points, called nodes, connected by lines, called edges.
31n keeping with conventional chemical notation, R will denote arbitrary substructures of
molecules.


6 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

An element of valence 4 offers more possibilities for forming compounds than
does any other. Carbon is the lightest and most abundant element of this valence, and
thus the chemistry of carbon compounds, organic chemistry, comprises a rich and
enormous field, including most biologically active compounds.

Hydrocarbons are compounds composed solely of hydrogen and carbon. Satu-
rated hydrocarbons are those in which all carbon-carbon bonds are single, and the re-
maining bonding potential of the carbon atoms is used by hydrogen atoms. These com-
pounds are saturated in the sense that they contain as much hydrogen as possible.

The saturated hydrocarbons are also called alkanes, the simplest of which is
methane (CH,). In methane each hydrogen is singly bonded to the single carbon atom.
A chain of two carbon atoms fully saturated (i.e., six hydrogens) is called ethane; three
carbons fully saturated is propane. The general empirical formula for alkanes is
CnH 2n + 2. Some examples are diagrammed in Figure 2-2.
  If a hydrocarbon of n carbons contains fewer than 2n + 2 hydrogens, it is unsatu-

rated. This state will occur only if two or more carbons are multiply bonded to one
another or linked into a ring. Each double bond will reduce the hydrogen count by 2,
each triple bond by 4. The amount by which a hydrocarbon falls short of saturation is
measured by the degree of unsaturation, which is defined as half the difference be-
tween 2n t 2 and the actual hydrogen count. This concept is explored more fully in
Section 2.3.3.

  A radical or group is a substructure of a molecule that does not exist as a stable
compound because it has bonding potential (valence). If one hydrogen is missing from a
methane molecule, we are left with the radical -CH3, called methyl. Similarly, re-
moving a hydrogen from the other alkanes results in a radical whose name is the same
as that of its parent alkane, but with the suffix "yl" in place of "-ane": ethyl, propyl,
etc. These radicals are referred to generically as alkyZs (Figure 2-2).

We have discussed only those alkanes in which the carbons line up in a chain. If
there are more than three carbons, however, they might be arranged in a branching
structure. The last alkane in Figure 2-2 is a branched version. It contains four carbons,
but is not butane because they are not chained. Rather it is given a compound name
deriving from the name of the molecule associated with its longest chain, preceded by
the names of the radicals that form the side chains. The compound depicted is methyl-
propane. Butane and methylpropane have the same empirical formula (&HI,,), but
different structures. That is, they are connectivity isomers and have different chemical
properties.

For longer main chains, not only might different radicals be side chains, but the
same radical might be in a different location. This phenomenon is not possible in the
case of methylpropane, because putting the methyl radical on the end would yield
butane. The naming conventions become increasingly complex and are not important
for our purposes.4

Alkenes are ring-free hydrocarbons, but are unsaturated because there is double
bonding between at least one pair of carbons and thus fewer hydrogens than in an

40ne of the original motivations for developing the DENDRAL notation (a linear canonical
naming convention described in Section 4.4.1) was the confusion resulting from the traditional
naming schemes.


THE STRUCTURE ELUCIDATION PROBLEM OF ORGANIC CHEMISTRY 7

alkane containing the same number of carbons. Alkynes are ring-free unsaturated
hydrocarbons containing one or more carbon-carbon triple bonds. The locations of the
multiple bonds in the carbon chain must also be accounted for in naming and picturing
the alkenes and alkynes.

The aromatic hydrocarbons are compounds containing one or more aromatic
rings, an important structure illustrated in Figure 2-3. It is not possible to represent
this structure correctly in such a diagram, because the bonds are equivalent; they are
not single and double bonds, as suggested by the figure. Rather all bonds are some-
thing "in between" single and double. They are said to resonate, but to explain further
involves detailed understanding of the role of orbital electrons in chemical bonding, a
subject that is involved and not important for our purposes.

Other important classes of organic compounds may be considered as derivatives of
the hydrocarbons. They contain heteroutoms-atoms other than carbon and hydrogen,
Certain groups containing heteroatoms are called functional groups, and are important
in the classification of compounds because their presence usually is predictive of one
or more significant chemical and physical properties. They thus defme families of simi-
lar compounds.

AZcohoZs result when a hydroxyZ radical (-OH) replaces a hydrogen. The simplest
alcohol is methanol, CH3-OH. Although extrapolation suggests that the simplest
"alcohol" is water, H-OH, it is not classified as an alcohol because it does not share
the physical and chemical properties of this class. The ethers are closely related to the
alcohols. The simplest ether derives from methanol and is CH3-0-CH3, dimethyl
ether. In general, replacing (substituting) the H of an OH radical in an alcohol with an
alkyl radical results in an ether. The names of alcohols and ethers derive from the name
of the chain containing the defining radical. Further examples appear in Figure 2-4.

A carbonyl group is a carbon doubly bonded to an oxygen:

If the carbonyl is bonded to two hydrogens or one hydrogen and one alkyl, it forms an
aldehyde. If it is bonded to ?wo alkyl groups, it is a keto group, and the compound is a
ketone. See Figure 2-5.

Oxidation of the aldehyde radical

                     H
        -;=o

yields the carboxyl radical

OH

-c=o

Compounds containing this radical are carboxyZic acids. The simplest of these are
methanoic acid, H-CO-OH, and acetic acid,CH,-CO-OH. These react with alco-
hols to produce esters, of which fats and oils are important subclasses.


8 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Amines and amides contain nitrogen. They may be considered derivatives of the
basic nitrogen compound NH,, ammonia. Amines result when one or more of the hy-
drogens is replaced by an alkyl group. Amides result from a reaction between ammonia
and carboxylic acids. See Figure 2-6.

An important subclass of carboxylic acids is that which contains an ammo group,
-NH2, on a carbon adjacent to the carbon of a carboxyl group. These compounds are
the amino acids, from which all proteins are formed.
The thiols are sulfur compounds that are analogs of the alcohols, the sulfhydryl
group -SH playing the role played by -OH in alcohols. Derivatives of thiols are anal-
ogous to the derivatives of alcohols: thioethers and thioesters. They appear in proteins
and since they are easily oxidized they frequently convert to -S-S- links that at-
tach two proteins, or a single protein to itself. These linkages, among others, are im-

H-C-H                   H-C-
  l                I
   H                         H

Methane                 Methyl

Ethane

Ethyl

Normal propyl
Cn-ProPYu

H-C-C-C-H
  I I I
   H      H

Isopropyl

H-C-C-C-C-H         H-C-C-C-C-H
I I I I          I I I I
   H H H H                H H      H

Butane

Secondary butyl
(set-butyl)

Figure 2-2 Alkanes and alkyl radicals.


THE STRUCTURE ELUCIDATION PROBLEM OF ORGANIC CHEMISTRY 9

H`c/c\ c/H
I   (I
/\\/\ti

I
H

Figure 2-3 Benzene (a single aromatic ring).

portant in determining the three-dimensional geometry of protein molecules, from
which many important biological properties derive.

2.3 .l Aliphatic versus Cyclic Compounds
The examples given above, with the exception of the aromatic compounds, have been
described as structures with no rings. Such structures are called trees in graph theory,
and aliphatik or acyclic compounds in chemistry. They are characterized by the fact
that cutting any bond necessarily results in two separate pieces. All the classes dis-
cussed, except the alkanes, also contain members with rings. For example, consider the
cyclic ketone depicted in Figure 2-7. In addition, there are important classes of com-
pounds defined by particular ring structures. The estrogens are an example. Estrogens
are members of the class of compounds called steroids characterized by a kernel struc-
ture consisting of four connected rings, as seen in Figure 2-g. Sterols are another type
of steroid based on the same kernel structure.

2.3.2 First DENDRAL Applications

The first versions of DENDRAL were applied to the mass spectra of aliphatic com-
pounds only, since an enumeration algorithm for cyclic compounds had not yet been

7
H-C-OH

Methanol

H-C-O-C-H         H-C-C-O-C-C-C-H
I I         I I
   H      H                H H

Dimethyl ether            Ethyl propyl ether

Figure 2-4 Alcohols and ethers.


1;        `; ii
H-C-H               H-C-C-H

Formaldehyde

H-C-C-C-H
  I I
   H      H

Acetone
(propanone)

i
H-C-OH

Methanoic acid
(formic acid)

I
H

Acetaldehyde
(ethanal)

H-C-C-C-C-H
     I I
   H      H H

Methyl ethyl ketone
(butanone)

`I' P
H-C-C-OH
  I

  Ii

Acetic acid

Figure 2-5 Aldehydes and ketones.

`I' B
H-C-N-H

Methyl amine

ii          ii
CH,-C-OH + NH,    __)   CH,-C-NH, + H,O

Acetic acid           Ammonia         Acetamide            Water

Figure 2-6 Amines and amides.

H

Figure 2-7 A cyclic ketone (cyclohexanone).


THE STRUCTURE ELUCIDATION PROBLEM OF ORGANIC CHEMISTRY  11

I   II   I
"+c5\cI/c7

Figure 2-8 The estrogen skeleton. Numbers
associated with the carbon atoms reflect the
conventional numbering of node positions.

programmed. The compounds studied were, in roughly chronological order, amino
acids, ketones, ethers, alcohols, amines, thiols, and thioethers.

Later versions of DENDRAL, incorporating a version of the cyclic structure gen-
erator, have been applied primarily to steroids, in particular estrogens, marine sterols,
and related compounds.

The DENDRAL programs are not limited in application to these classes of com-
pounds, but are general mechanisms that could be applied to any compounds for which
certain types of information are available. A practical limit on size of molecules amen-
able to the DENDRAL methods is, roughly, 100 atoms. This number is approximately
the limit of mass spectrometric methods as well. Thus proteins, which are generally
much larger, are among the compounds to which the DENDRAL system (and mass
spectrometry) do not apply.

As will be described in Chapter 8, the above list of applications was selected in
part for their value in developing the DENDRAL concepts and in part because they
were of interest for their importance to contemporary chemistry.

2.3.3 Degree of Unsaturation

It may surprise those who are not chemists to learn that, given an empirical formula,
it is possible to determine exactly the number of cycles (rings and multiple bonds)
each connectivity isomer of that formula must contain. This number is the degree of
unsaturation of the empirical formula, a generalization of the concept introduced for
hydrocarbons.

We note that univalent atoms, such as H, Cl, and F, cannot b;e part of a ring, since
each atom of a ring must be connected to at least two other atoms, otherwise there
would be no closure. Recall that a saturated hydrocarbon is one that contains the max-
imum possible number of hydrogens, and hence can contain no carbon-carbon double
or triple bonds. It is also true that a hydrocarbon containing a ring cannot be saturated,
since two of the carbon valences are used not for hydrogen atoms but to "close the
ring."

Two doubly bonded atoms may be considered to be a small ring, and two atoms
triply bonded may be considered as two small, connected rings. In fact, DENDRAL


12 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

so considers them, treating them in the same way as any other ring structures, even
though these bonds are not normally thought of in this way in chemistry.
Indeed, there is some ambiguity in the concept of a ring. For example, two edge-
fused rings

may be viewed as two rings, or as three rings if we count the outer perimeter as a dis-
tinct ring. DENDRAL counts such structures as two rings, although some chemists
count it as three rings.' DENDRAL treats any triple bond as two rings, thereby being
at variance with som************************** 1.439344+1 83.2147500 1.507124+1 83.2274375 1.524479+16637 3  1  410
 83.2655000 1.587207+1 83.3162500 1.672673+1 83.3796875 1.782403+16637 3  1  411
 83.4177500 1.850446+1 83.4431250 1.904398+1 83.5065625 2.043521+16637 3  1  412
 83.5446250 2.129943+1 83.5700000 2.196683+1 83.6461250 2.404526+16637 3  1  413
 83.6715000 2.477112+1 83.7222500 2.646055+1 83.7983750 2.911481+16637 3  1  414
 83.8745000 3.238914+1 83.9252500 3.469209+1 83.9506250 3.605801+16637 3  1  415
 84.0267500 4.037897+1 84.0521250 4.191236+1 84.1028750 4.548639+16637 3  1  416
 84.1472813 4.879007+1 84.1599688 4.987320+1 84.2145250 5.475243+16637 3  1  417
 84.2348250 5.668198+1 84.2855750 6.218975+1 84.3185625 6.599604+16637 3  1  418
 84.3388625 6.869216+1 84.3921500 7.615883+1 84.4023000 7.767227+16637 3  1  419
 84.4454375 8.511816+1 84.4860375 9.255480+1 84.4936500 9.419712+16637 3  1  420
 84.5545500 1.082093+2 84.5697750 1.119823+2 84.6002250 1.206594+26637 3  1  421
 84.6256000 1.283829+2 84.6459000 1.354212+2 84.6865000 1.504966+26637 3  1  422
 84.6915750 1.526854+2 84.7372500 1.738328+2 84.7474000 1.789555+26637 3  1  423
 84.7829250 1.992869+2 84.7880000 2.024760+2 84.8286000 2.309218+26637 3  1  424
 84.8590500 2.570279+2 84.8692000 2.663831+2 84.8895000 2.876679+26637 3  1  425
 84.9098000 3.106098+2 84.9199500 3.238324+2 84.9504000 3.666802+26637 3  1  426
 84.9846563 4.276608+2 84.9884625 4.350545+2 85.0074938 4.777657+26637 3  1  427
 85.0265250 5.235577+2 85.0303313 5.339642+2 85.0519000 5.971419+26637 3  1  428
 85.0531688 6.012753+2 85.0760063 6.810159+2 85.0772750 6.857992+26637 3  1  429
 85.0988438 7.756472+2 85.1026500 7.927530+2 85.1216813 8.872369+26637 3  1  430
 85.1280250 9.215371+2 85.1508625 1.057616+3 85.1534000 1.074146+36637 3  1  431
 85.1775063 1.246910+3 85.1800438 1.266645+3 85.2041500 1.472353+36637 3  1  432
 85.2066875 1.495736+3 85.2244500 1.671631+3 85.2307938 1.740041+36637 3  1  433
 85.2574375 2.046967+3 85.2599750 2.078276+3 85.2878875 2.456160+36637 3  1  434
 85.2955000 2.566492+3 85.3259500 3.044783+3 85.3373688 3.235800+36637 3  1  435
 85.3767000 3.934993+3 85.4680500 5.590716+3 85.4782000 5.756081+36637 3  1  436
 85.5086500 6.203078+3 85.5188000 6.327438+3 85.5492500 6.643405+36637 3  1  437
 85.5543250 6.681414+3 85.5847750 6.847818+3 85.6000000 6.869991+36637 3  1  438
 85.6104672 6.861663+3 85.6380625 6.785540+3 85.6418688 6.763516+36637 3  1  439
 85.6761250 6.484242+3 85.6837375 6.401426+3 85.7116500 6.043866+36637 3  1  440
 85.7218000 5.898881+3 85.7573250 5.315666+3 85.7827000 4.874870+36637 3  1  441
 85.8588250 3.517572+3 85.8791250 3.178402+3 85.9019625 2.822018+36637 3  1  442
 85.9248000 2.493441+3 85.9374875 2.324338+3 85.9628625 2.016442+36637 3  1  443
 85.9730125 1.903354+3 85.9996563 1.633696+3 86.0009250 1.621885+36637 3  1  444
 86.0263000 1.405383+3 86.0516750 1.222101+3 86.0542125 1.205044+36637 3  1  445
 86.0770500 1.066766+3 86.0821250 1.038255+3 86.1024250 9.357279+26637 3  1  446
 86.1100375 9.001318+2 86.1278000 8.254752+2 86.1379500 7.865854+26637 3  1  447
 86.1633250 6.992101+2 86.1658625 6.913482+2 86.1937750 6.136539+26637 3  1  448
 86.1988500 6.008131+2 86.2216875 5.490724+2 86.2343750 5.229022+26637 3  1  449
 86.2496000 4.945688+2 86.2699000 4.604677+2 86.2851250 4.377031+26637 3  1  450
 86.3206500 3.901521+2 86.3231875 3.870587+2 86.3561750 3.520286+26637 3  1  451
 86.3764750 3.327233+2 86.4094625 3.044541+2 86.4120000 3.025257+26637 3  1  452
 86.4627500 2.678143+2 86.4754375 2.600207+2 86.5160375 2.379886+26637 3  1  453
 86.5388750 2.267270+2 86.5642500 2.155174+2 86.6023125 2.002362+26637 3  1  454
 86.6251500 1.921081+2 86.6860500 1.725265+2 86.6974688 1.691549+26637 3  1  455
 86.7469500 1.564487+2 86.7926250 1.458479+2 86.8383000 1.364750+26637 3  1  456
 86.8877813 1.274085+2 86.9296500 1.205531+2 86.9829375 1.126856+26637 3  1  457
 87.0210000 1.076952+2 87.1098125 9.723445+1 87.1351875 9.459446+16637 3  1  458
 87.2366875 8.514414+1 87.2493750 8.411433+1 87.3635625 7.576867+16637 3  1  459
 87.4270000 7.151909+1 87.4777500 6.861885+1 87.6173125 6.138740+16637 3  1  460
 87.6300000 6.081495+1 87.8012813 5.390332+1 87.8076250 5.367054+16637 3  1  461
 87.9345000 4.953280+1 87.9725625 4.843517+1 88.1438438 4.395543+16637 3  1  462
 88.2136250 4.227092+1 88.3151250 4.019747+1 88.4864063 3.696278+16637 3  1  463
 88.4927500 3.685158+1 88.7084375 3.362177+1 88.7718750 3.274919+16637 3  1  464
 88.9558438 3.061015+1 89.1778750 2.823445+1 89.2032500 2.800478+16637 3  1  465
 89.4506563 2.593816+1 89.5585000 2.509563+1 89.6980625 2.418050+16637 3  1  466
 89.9771875 2.247391+1 90.0660000 2.196623+1 90.3197500 2.076218+16637 3  1  467
 90.5735000 1.964183+1 90.6623125 1.930852+1 91.0048750 1.810795+16637 3  1  468
 91.0810000 1.785765+1 91.4616250 1.680611+1 91.7407500 1.608397+16637 3  1  469
 91.8676250 1.581838+1 92.4005000 1.477816+1 92.7303750 1.417358+16637 3  1  470
 92.9333750 1.387677+1 93.4662500 1.314248+1 93.7200000 1.280948+16637 3  1  471
 93.9991250 1.251846+1 94.5320000 1.198976+1 95.0395000 1.150666+16637 3  1  472
 95.0902500 1.146992+1 95.9276250 1.089703+1 96.7650000 1.035252+16637 3  1  473
 97.0187500 1.019390+1 97.6023750 9.920083+0 98.4397500 9.543843+06637 3  1  474
 98.9980000 9.299323+0 100.055380 8.963754+0 101.112760 8.640268+06637 3  1  475
 102.170140 8.326000+0 103.227520 8.094862+0 104.813590 7.759073+06637 3  1  476
 105.342280 7.650611+0 106.399660 7.471763+0 107.869690 7.231175+06637 3  1  477
 109.107640 7.035915+0 109.974205 6.904647+0 110.840770 6.780502+06637 3  1  478
 111.418480 6.704369+0 111.913660 6.646140+0 112.243780 6.613011+06637 3  1  479
 112.408840 6.599956+0 112.573900 6.571591+0 112.876510 6.528788+06637 3  1  480
 113.151610 6.501569+0 113.357935 6.492147+0 113.564260 6.496744+06637 3  1  481
 113.701810 6.510836+0 113.839360 6.537291+0 113.866870 6.546006+06637 3  1  482
 113.976910 6.556615+0 114.080073 6.582050+0 114.183235 6.625691+06637 3  1  483
 114.286398 6.694215+0 114.362050 6.770209+0 114.389560 6.789410+06637 3  1  484
 114.472090 6.883016+0 114.554620 7.022889+0 114.609640 7.152260+06637 3  1  485
 114.637150 7.237219+0 114.664660 7.307912+0 114.719680 7.506133+06637 3  1  486
 114.760945 7.707646+0 114.802210 7.973720+0 114.844851 8.345491+06637 3  1  487
 114.870985 8.645802+0 114.875112 8.690478+0 114.905373 9.113671+06637 3  1  488
 114.935634 9.663865+0 114.965895 1.038232+1 114.988590 1.106304+16637 3  1  489
 115.011286 1.189530+1 115.033982 1.291096+1 115.056678 1.414642+16637 3  1  490
 115.082812 1.589449+1 115.104820 1.768436+1 115.126828 1.981032+16637 3  1  491
 115.148836 2.231576+1 115.170844 2.524260+1 115.184599 2.735895+16637 3  1  492
 115.192852 2.864124+1 115.209358 3.166899+1 115.225864 3.471859+16637 3  1  493
 115.258876 4.202506+1 115.261627 4.264048+1 115.302892 5.351435+16637 3  1  494
 115.308394 5.518575+1 115.357912 7.037730+1 115.412932 8.827458+16637 3  1  495
 115.451446 1.009326+2 115.467952 1.054618+2 115.500964 1.145886+26637 3  1  496
 115.544980 1.232065+2 115.586245 1.273228+2 115.600000 1.277574+26637 3  1  497
 115.622008 1.268208+2 115.645392 1.257295+2 115.682530 1.202854+26637 3  1  498
 115.685281 1.198701+2 115.726546 1.104299+2 115.729297 1.096402+26637 3  1  499
 115.776064 9.602399+1 115.842088 7.495016+1 115.864096 6.783433+16637 3  1  500
 115.913614 5.341696+1 115.946626 4.507244+1 115.963132 4.147302+16637 3  1  501
 115.979638 3.786236+1 116.007148 3.272433+1 116.029156 2.916488+16637 3  1  502
 116.051164 2.606227+1 116.073172 2.337880+1 116.095180 2.111094+16637 3  1  503
 116.117188 1.917745+1 116.139196 1.753572+1 116.161204 1.614520+16637 3  1  504
 116.181837 1.503631+1 116.192841 1.454496+1 116.210722 1.377880+16637 3  1  505
 116.239608 1.278796+1 116.268493 1.198889+1 116.297379 1.133735+16637 3  1  506
 116.322138 1.087562+1 116.326264 1.080383+1 116.364778 1.026401+16637 3  1  507
 116.403292 9.831939+0 116.441806 9.476189+0 116.480320 9.175559+06637 3  1  508
 116.516083 8.940710+0 116.535340 8.830052+0 116.590360 8.570864+06637 3  1  509
 116.645380 8.352277+0 116.727910 8.078590+0 116.810440 7.851133+06637 3  1  510
 116.892970 7.656408+0 116.920480 7.600561+0 117.003010 7.469589+06637 3  1  511
 117.126805 7.307995+0 117.250600 7.172121+0 117.374395 7.054508+06637 3  1  512
 117.498190 6.950213+0 117.649495 6.836002+0 117.663250 6.826741+06637 3  1  513
 117.855820 6.735283+0 118.062145 6.650883+0 118.268470 6.575950+06637 3  1  514
 118.543570 6.486279+0 118.873690 6.389184+0 119.231320 6.292847+06637 3  1  515
 119.258830 6.287303+0 119.836540 6.182746+0 120.496780 6.073593+06637 3  1  516
 121.322080 5.946281+0 122.147380 5.825212+0 122.422480 5.785905+06637 3  1  517
 123.442015 5.643888+0 124.461550 5.507311+0 125.481085 5.376243+06637 3  1  518
 126.500620 5.252111+0 127.266483 5.165516+0 127.520155 5.122992+06637 3  1  519
 128.287000 5.003210+0 128.927500 4.911038+0 129.451494 4.844011+06637 3  1  520
 129.568000 4.820185+0 130.208500 4.703618+0 130.635500 4.637013+06637 3  1  521
 131.062500 4.583086+0 131.489500 4.500525+0 131.809750 4.453726+06637 3  1  522
 132.099500 4.426968+0 132.130000 4.419952+0 132.450250 4.369278+06637 3  1  523
 132.770500 4.350929+0 132.923000 4.359422+0 132.984000 4.353374+06637 3  1  524
 133.258500 4.364711+0 133.380500 4.392257+0 133.464375 4.397206+06637 3  1  525
 133.670250 4.453559+0 133.838000 4.548118+0 133.876125 4.561899+06637 3  1  526
 134.082000 4.718878+0 134.181125 4.839458+0 134.219250 4.878684+06637 3  1  527
 134.356500 5.086570+0 134.409875 5.201635+0 134.493750 5.367358+06637 3  1  528
 134.631000 5.757526+0 134.638625 5.788354+0 134.768250 6.287867+06637 3  1  529
 134.859750 6.775390+0 134.875000 6.854680+0 134.966500 7.479692+06637 3  1  530
 135.058000 8.289432+0 135.149500 9.349981+0 135.180000 9.820943+06637 3  1  531
 135.241000 1.077306+1 135.248625 1.092629+1 135.294375 1.185505+16637 3  1  532
 135.302000 1.201192+1 135.340125 1.297965+1 135.359188 1.347021+16637 3  1  533
 135.374438 1.395974+1 135.397313 1.470189+1 135.408750 1.507588+16637 3  1  534
 135.416375 1.532755+1 135.431625 1.596846+1 135.454500 1.694116+16637 3  1  535
 135.473563 1.776363+1 135.477375 1.797107+1 135.492625 1.881063+16637 3  1  536
 135.507875 1.965950+1 135.516453 2.014356+1 135.525031 2.074598+16637 3  1  537
 135.544094 2.210428+1 135.558867 2.317378+1 135.559344 2.320890+16637 3  1  538
 135.574594 2.456937+1 135.587938 2.577962+1 135.590321 2.604283+16637 3  1  539
 135.604141 2.759183+1 135.621297 2.954929+1 135.626063 3.010525+16637 3  1  540
 135.637500 3.174399+1 135.652750 3.397239+1 135.656182 3.448509+16637 3  1  541
 135.668381 3.668683+1 135.684394 3.963955+1 135.686300 3.999924+16637 3  1  542
 135.698500 4.275120+1 135.712225 4.592163+1 135.716800 4.717384+16637 3  1  543
 135.735100 5.231407+1 135.738150 5.319663+1 135.753400 5.841057+16637 3  1  544
 135.764075 6.216653+1 135.771700 6.533767+1 135.790000 7.316078+16637 3  1  545
 135.805250 8.096684+1 135.812875 8.496594+1 135.820500 8.957138+16637 3  1  546
 135.835750 9.899726+1 135.851000 1.100626+2 135.858625 1.157417+26637 3  1  547
 135.869300 1.248104+2 135.881500 1.354593+2 135.887600 1.416324+26637 3  1  548
 135.905900 1.606256+2 135.912000 1.671301+2 135.924200 1.823286+26637 3  1  549
 135.942500 2.056924+2 135.969950 2.473507+2 135.973000 2.521450+26637 3  1  550
 135.997400 2.956899+2 136.003500 3.069263+2 136.024850 3.509082+26637 3  1  551
 136.034000 3.702932+2 136.052300 4.138410+2 136.079750 4.809796+26637 3  1  552
 136.088900 5.057486+2 136.125500 6.072839+2 136.241400 9.496526+26637 3  1  553
 136.259700 9.968144+2 136.287150 1.064861+3 136.308500 1.107640+36637 3  1  554
 136.326800 1.141723+3 136.351200 1.173842+3 136.363400 1.187851+36637 3  1  555
 136.392375 1.203914+3 136.400000 1.206808+3 136.428975 1.197747+36637 3  1  556
 136.445750 1.189635+3 136.467100 1.164835+3 136.485400 1.140487+36637 3  1  557
 136.508275 1.095940+3 136.540300 1.028154+3 136.564700 9.639554+26637 3  1  558
 136.613500 8.289017+2 136.640950 7.498906+2 136.689750 6.081142+26637 3  1  559
 136.708050 5.592168+2 136.740075 4.753270+2 136.756850 4.357556+26637 3  1  560
 136.773625 3.974049+2 136.802600 3.384500+2 136.811750 3.204414+26637 3  1  561
 136.833100 2.837192+2 136.843775 2.659302+2 136.863600 2.371591+26637 3  1  562
 136.875800 2.200774+2 136.894100 1.980434+2 136.907825 1.821622+26637 3  1  563
 136.924600 1.652023+2 136.929175 1.607681+2 136.950525 1.422905+26637 3  1  564
 136.955100 1.388224+2 136.979500 1.212100+2 136.985600 1.174351+26637 3  1  565
 137.006950 1.049288+2 137.021438 9.764821+1 137.034400 9.151052+16637 3  1  566
 137.057275 8.224379+1 137.061850 8.049491+1 137.089300 7.152612+16637 3  1  567
 137.093113 7.045049+1 137.116750 6.428402+1 137.144200 5.809992+16637 3  1  568
 137.146869 5.758444+1 137.180800 5.163816+1 137.200625 4.871185+16637 3  1  569
 137.217400 4.643590+1 137.254000 4.221111+1 137.254381 4.217339+16637 3  1  570
 137.299750 3.804713+1 137.308138 3.739368+1 137.345500 3.471875+16637 3  1  571
 137.379813 3.258187+1 137.391250 3.193560+1 137.459875 2.862159+16637 3  1  572
 137.487325 2.748619+1 137.528500 2.593957+1 137.559000 2.494271+16637 3  1  573
 137.597125 2.381249+1 137.688625 2.147171+1 137.711500 2.096668+16637 3  1  574
 137.791563 1.941702+1 137.864000 1.820456+1 137.894500 1.775682+16637 3  1  575
 137.997438 1.643977+1 138.092750 1.535351+1 138.100375 1.527781+16637 3  1  576
 138.226188 1.417450+1 138.298625 1.360570+1 138.340563 1.331727+16637 3  1  577
 138.512125 1.227436+1 138.557875 1.202810+1 138.683688 1.145561+16637 3  1  578
 138.855250 1.076084+1 138.946750 1.042427+1 139.026813 1.017219+16637 3  1  579
 139.206000 9.662959+0 139.236500 9.589119+0 139.465250 9.094827+06637 3  1  580
 139.694000 8.646104+0 139.816000 8.424883+0 139.922750 8.268898+06637 3  1  581
 140.151500 7.960485+0 140.426000 7.617255+0 140.441250 7.601710+06637 3  1  582
 140.853000 7.221760+0 141.264750 6.874352+0 141.341000 6.814352+06637 3  1  583
 141.676500 6.609034+0 142.225500 6.299142+0 142.714800 6.041530+06637 3  1  584
 142.866000 5.966408+0 143.359199 5.767174+0 144.003597 5.523973+06637 3  1  585
 144.218397 5.446219+0 145.017448 5.170523+0 145.816498 4.914316+06637 3  1  586
 146.615549 4.679162+0 146.960000 4.589334+0 147.414599 4.444946+06637 3  1  587
 147.947300 4.294454+0 148.480000 4.163470+0 149.050000 4.002251+06637 3  1  588
 149.477500 3.905933+0 149.620000 3.883662+0 149.905000 3.811019+06637 3  1  589
 150.332500 3.740528+0 150.475000 3.734396+0 150.760000 3.693713+06637 3  1  590
 151.080625 3.694202+0 151.187500 3.712158+0 151.401250 3.730283+06637 3  1  591
 151.662500 3.810666+0 151.721875 3.825222+0 152.042500 4.001795+06637 3  1  592
 152.256250 4.192800+0 152.470000 4.460834+0 152.660000 4.783257+06637 3  1  593
 152.665938 4.793704+0 152.850000 5.219926+0 152.861875 5.248235+06637 3  1  594
 152.945000 5.507701+0 153.040000 5.810593+0 153.057813 5.868732+06637 3  1  595
 153.111250 6.096196+0 153.158750 6.301519+0 153.206250 6.509765+06637 3  1  596
 153.253750 6.721344+0 153.289375 6.926783+0 153.325000 7.134576+06637 3  1  597
 153.354688 7.309709+0 153.384375 7.486789+0 153.415547 7.675007+06637 3  1  598
 153.420000 7.702257+0 153.446719 7.906051+0 153.474922 8.123540+06637 3  1  599
 153.494961 8.279547+0 153.520196 8.477870+0 153.543204 8.660619+06637 3  1  600
 153.574375 8.911364+0 153.577344 8.935574+0 153.598125 9.142713+06637 3  1  601
 153.621875 9.381885+0 153.651563 9.684539+0 153.681250 9.991611+06637 3  1  602
 153.710938 1.030402+1 153.716875 1.038065+1 153.752500 1.084812+16637 3  1  603
 153.791094 1.136420+1 153.835625 1.197365+1 153.859375 1.230776+16637 3  1  604
 153.880156 1.266347+1 153.912813 1.323467+1 153.948438 1.387099+16637 3  1  605
 153.978125 1.441403+1 153.984063 1.454467+1 154.019688 1.534560+16637 3  1  606
 154.061250 1.630450+1 154.096875 1.715417+1 154.108750 1.748879+16637 3  1  607
 154.156250 1.887326+1 154.185938 1.977246+1 154.203750 2.039975+16637 3  1  608
 154.251250 2.213684+1 154.275000 2.304368+1 154.298750 2.410556+16637 3  1  609
 154.346250 2.632126+1 154.364063 2.719389+1 154.393750 2.891198+16637 3  1  610
 154.444813 3.201950+1 154.453125 3.255378+1 154.485781 3.504629+16637 3  1  611
 154.526750 3.832674+1 154.536844 3.918133+1 154.567719 4.227519+16637 3  1  612
 154.608688 4.661404+1 154.609875 4.674835+1 154.650250 5.199240+16637 3  1  613
 154.658563 5.315113+1 154.693000 5.857544+1 154.707250 6.100021+16637 3  1  614
 154.735750 6.653764+1 154.755938 7.073455+1 154.764250 7.273549+16637 3  1  615
 154.792750 7.998734+1 154.804625 8.320939+1 154.821250 8.847576+16637 3  1  616
 154.849750 9.809785+1 154.853313 9.938832+1 154.875875 1.087782+26637 3  1  617
 154.889828 1.149658+2 154.899625 1.198373+2 154.918625 1.298777+26637 3  1  618
 154.923375 1.326925+2 154.947125 1.476501+2 154.951875 1.508515+26637 3  1  619
 154.970875 1.652796+2 154.985125 1.768459+2 154.994625 1.855662+26637 3  1  620
 155.018375 2.088293+2 155.042125 2.369096+2 155.051625 2.490691+26637 3  1  621
 155.073000 2.798229+2 155.084875 2.983911+2 155.101500 3.275389+26637 3  1  622
 155.118125 3.590189+2 155.130000 3.841397+2 155.151375 4.327960+26637 3  1  623
 155.158500 4.509620+2 155.187000 5.287918+2 155.189375 5.356699+26637 3  1  624
 155.206000 5.887951+2 155.221438 6.411510+2 155.239250 7.068128+26637 3  1  625
 155.253500 7.630918+2 155.272500 8.448730+2 155.296250 9.535081+26637 3  1  626
 155.305750 1.000688+3 155.339000 1.174569+3 155.396000 1.513753+36637 3  1  627
 155.405500 1.572576+3 155.514750 2.269423+3 155.538500 2.407509+36637 3  1  628
 155.578875 2.623551+3 155.588375 2.666760+3 155.621625 2.795877+36637 3  1  629
 155.643000 2.859125+3 155.671500 2.917052+3 155.700000 2.950075+36637 3  1  630
 155.719594 2.941916+3 155.747500 2.916744+3 155.752250 2.907570+36637 3  1  631
 155.795000 2.793074+3 155.804500 2.758716+3 155.852000 2.546504+36637 3  1  632
 155.868625 2.460127+3 155.918500 2.169103+3 155.947000 1.996394+36637 3  1  633
 156.032500 1.467542+3 156.051500 1.357429+3 156.082375 1.188137+36637 3  1  634
 156.099000 1.103585+3 156.125125 9.790506+2 156.146500 8.853917+26637 3  1  635
 156.164313 8.127031+2 156.182125 7.465252+2 156.203500 6.721903+26637 3  1  636
 156.213000 6.423932+2 156.242688 5.561434+2 156.251000 5.341322+26637 3  1  637
 156.268813 4.910686+2 156.289000 4.459701+2 156.294938 4.338916+26637 3  1  638
 156.324625 3.786636+2 156.327000 3.746472+2 156.357875 3.276271+26637 3  1  639
 156.365000 3.178447+2 156.391125 2.855847+2 156.403000 2.723825+26637 3  1  640
 156.424375 2.509953+2 156.441000 2.360182+2 156.457625 2.225074+26637 3  1  641
 156.479000 2.068459+2 156.490875 1.990937+2 156.524125 1.795065+26637 3  1  642
 156.531250 1.756697+2 156.557375 1.633463+2 156.581125 1.532385+26637 3  1  643
 156.602500 1.451439+2 156.631000 1.353170+2 156.688000 1.195515+26637 3  1  644
 156.697500 1.172016+2 156.745000 1.069243+2 156.764000 1.032099+26637 3  1  645
 156.802000 9.676181+1 156.859000 8.796461+1 156.863750 8.729781+16637 3  1  646
 156.944500 7.762963+1 156.963500 7.558459+1 157.030000 6.944062+16637 3  1  647
 157.089375 6.452197+1 157.136875 6.111967+1 157.208125 5.655451+16637 3  1  648
 157.243750 5.459395+1 157.350625 4.929257+1 157.386250 4.766862+16637 3  1  649
 157.457500 4.493812+1 157.564375 4.116777+1 157.706875 3.721258+16637 3  1  650
 157.742500 3.630949+1 157.867188 3.362515+1 157.980000 3.140610+16637 3  1  651
 158.027500 3.062394+1 158.187813 2.820420+1 158.265000 2.711926+16637 3  1  652
 158.348125 2.614281+1 158.532188 2.413726+1 158.550000 2.395692+16637 3  1  653
 158.763750 2.218865+1 158.977500 2.055527+1 158.995313 2.044324+16637 3  1  654
 159.226875 1.909415+1 159.357500 1.837262+1 159.381250 1.826344+16637 3  1  655
 159.690000 1.693112+1 159.832500 1.635974+1 160.046250 1.567733+16637 3  1  656
 160.402500 1.462371+1 160.545000 1.422655+1 160.758750 1.376579+16637 3  1  657
 161.115000 1.304302+1 161.352500 1.258405+1 161.471250 1.240635+16637 3  1  658
 161.791875 1.194949+1 162.195625 1.139883+1 162.350000 1.119792+16637 3  1  659
 162.801250 1.075260+1 163.406875 1.018828+1 163.680000 9.944883+06637 3  1  660
 164.012500 9.723182+0 164.618125 9.337769+0 165.337075 8.898702+06637 3  1  661
 165.413799 8.853502+0 166.112688 8.532791+0 166.888300 8.190780+06637 3  1  662
 167.147597 8.080501+0 167.663913 7.892144+0 168.439525 7.619258+06637 3  1  663
 168.956600 7.443330+0 169.860800 7.147796+0 170.538950 6.937965+06637 3  1  664
 171.217100 6.740796+0 171.895250 6.561162+0 172.347350 6.454566+06637 3  1  665
 172.498050 6.423824+0 172.799450 6.330038+0 173.251550 6.208474+06637 3  1  666
 173.552950 6.142867+0 173.590625 6.129771+0 173.929700 6.032251+06637 3  1  667
 174.268775 5.961980+0 174.457150 5.941778+0 174.551338 5.915766+06637 3  1  668
 174.805644 5.875242+0 175.022275 5.872981+0 175.059950 5.864515+06637 3  1  669
 175.314256 5.859037+0 175.483794 5.893862+0 175.587400 5.939869+06637 3  1  670
 175.653331 5.952336+0 175.841706 6.049973+0 175.926475 6.129558+06637 3  1  671
 175.997116 6.176373+0 176.152525 6.359062+0 176.265550 6.570202+06637 3  1  672
 176.307934 6.634651+0 176.463344 7.019927+0 176.566950 7.407917+06637 3  1  673
 176.599916 7.520056+0 176.698813 7.995960+0 176.793000 8.600415+06637 3  1  674
 176.797709 8.629498+0 176.896606 9.454164+0 176.995503 1.057633+16637 3  1  675
 177.061434 1.155308+1 177.122656 1.272116+1 177.139610 1.304944+16637 3  1  676
 177.179169 1.405645+1 177.207425 1.478802+1 177.235681 1.570764+16637 3  1  677
 177.252635 1.627077+1 177.278066 1.730150+1 177.297845 1.811779+16637 3  1  678
 177.306322 1.855117+1 177.333636 1.996975+1 177.343055 2.046868+16637 3  1  679
 177.360009 2.159555+1 177.379788 2.293260+1 177.388265 2.351585+16637 3  1  680
 177.399568 2.447298+1 177.419347 2.617667+1 177.422173 2.642453+16637 3  1  681
 177.435359 2.781690+1 177.454196 2.984011+1 177.456080 3.004681+16637 3  1  682
 177.473034 3.233355+1 177.491871 3.492574+1 177.495639 3.545539+16637 3  1  683
 177.507883 3.761133+1 177.527663 4.116430+1 177.535198 4.255220+16637 3  1  684
 177.547442 4.534686+1 177.569105 5.041350+1 177.570989 5.086752+16637 3  1  685
 177.591710 5.683373+1 177.599245 5.906771+1 177.614315 6.429077+16637 3  1  686
 177.627501 6.899295+1 177.636920 7.290767+1 177.653874 8.012454+16637 3  1  687
 177.655758 8.094588+1 177.672711 8.950090+1 177.684014 9.534825+16637 3  1  688
 177.693433 1.009627+2 177.712270 1.124848+2 177.716038 1.151366+26637 3  1  689
 177.742410 1.342190+2 177.765015 1.534669+2 177.772550 1.600516+26637 3  1  690
 177.787620 1.749608+2 177.802690 1.902980+2 177.817760 2.074845+26637 3  1  691
 177.832830 2.251962+2 177.847900 2.450542+2 177.870505 2.756432+26637 3  1  692
 177.876156 2.841707+2 177.904413 3.277989+2 177.908180 3.337654+26637 3  1  693
 177.942088 3.933337+2 177.964693 4.341905+2 177.998600 5.005068+26637 3  1  694
 178.107858 7.192297+2 178.134230 7.662523+2 178.164370 8.186154+26637 3  1  695
 178.186975 8.507156+2 178.209580 8.811174+2 178.232185 9.022582+26637 3  1  696
 178.262325 9.273387+2 178.284930 9.363694+2 178.300000 9.406110+26637 3  1  697
 178.328256 9.353466+2 178.348978 9.297693+2 178.356513 9.271443+26637 3  1  698
 178.390420 8.987103+2 178.405490 8.843488+2 178.446933 8.292785+26637 3  1  699
 178.454468 8.185127+2 178.495910 7.476307+2 178.510980 7.206871+26637 3  1  700
 178.586330 5.756565+2 178.637191 4.768334+2 178.671099 4.156383+26637 3  1  701
 178.678634 4.023142+2 178.720076 3.351622+2 178.727611 3.242215+26637 3  1  702
 178.761519 2.766321+2 178.784124 2.484727+2 178.795426 2.349791+26637 3  1  703
 178.834985 1.936358+2 178.836869 1.919017+2 178.861358 1.705000+26637 3  1  704
 178.885846 1.513285+2 178.887730 1.499284+2 178.914103 1.325095+26637 3  1  705
 178.934824 1.203530+2 178.940475 1.172265+2 178.966848 1.043515+26637 3  1  706
 178.983801 9.703528+1 178.993220 9.322304+1 179.027128 8.136167+16637 3  1  707
 179.032779 7.967311+1 179.061035 7.181732+1 179.081756 6.690422+16637 3  1  708
 179.094943 6.398457+1 179.128850 5.757753+1 179.130734 5.726963+16637 3  1  709
 179.162758 5.248188+1 179.196665 4.809004+1 179.204200 4.724782+16637 3  1  710
 179.241875 4.345261+1 179.274841 4.062843+1 179.287085 3.966540+16637 3  1  711
 179.332295 3.660495+1 179.345481 3.582444+1 179.383156 3.379461+16637 3  1  712
 179.439669 3.114161+1 179.496181 2.905771+1 179.580950 2.633894+16637 3  1  713
 179.665719 2.429883+1 179.750488 2.250906+1 179.769325 2.215543+16637 3  1  714
 179.849384 2.086104+1 179.957700 1.933562+1 179.976538 1.910599+16637 3  1  715
 180.103691 1.776952+1 180.230844 1.658650+1 180.240263 1.650728+16637 3  1  716
 180.357997 1.567719+1 180.485150 1.486666+1 180.522825 1.464975+16637 3  1  717
 180.668816 1.394467+1 180.852481 1.315612+1 180.899575 1.297223+16637 3  1  718
 181.036147 1.254127+1 181.219813 1.201496+1 181.464700 1.137503+16637 3  1  719
 181.747263 1.085828+1 182.029825 1.039069+1 182.218200 1.010267+16637 3  1  720
 182.312388 9.992154+0 182.594950 9.686959+0 182.971700 9.310277+06637 3  1  721
 183.122400 9.169189+0 183.291938 9.045133+0 183.772294 8.718893+06637 3  1  722
 184.026600 8.557533+0 184.252650 8.448205+0 184.733006 8.231473+06637 3  1  723
 185.213363 8.026227+0 185.835000 7.773523+0 185.863125 7.764856+06637 3  1  724
 186.522176 7.573171+0 187.181227 7.389847+0 187.643400 7.265895+06637 3  1  725
 187.840278 7.223079+0 188.828854 7.017154+0 189.817431 6.820062+06637 3  1  726
 190.806007 6.630548+0 191.706681 6.464092+0 192.607354 6.304371+06637 3  1  727
 193.508028 6.152764+0 194.108477 6.057391+0 194.511200 5.997608+06637 3  1  728
 194.708926 5.956205+0 195.309375 5.838480+0 195.901363 5.733240+06637 3  1  729
 196.158800 5.693129+0 196.339006 5.648788+0 196.776650 5.552198+06637 3  1  730
 197.214294 5.470670+0 197.394500 5.445681+0 197.651938 5.378384+06637 3  1  731
 197.943700 5.318427+0 198.218300 5.280619+0 198.286950 5.259533+06637 3  1  732
 198.544388 5.202551+0 198.801825 5.171274+0 198.973450 5.173586+06637 3  1  733
 199.059263 5.155443+0 199.316700 5.149198+0 199.488325 5.187057+06637 3  1  734
 199.539813 5.186396+0 199.707147 5.229990+0 199.831575 5.301722+06637 3  1  735
 199.874481 5.315074+0 200.041816 5.438414+0 200.174825 5.615018+06637 3  1  736
 200.209150 5.650047+0 200.324997 5.847587+0 200.432263 6.111742+06637 3  1  737
 200.440844 6.130158+0 200.556691 6.495903+0 200.672538 7.022281+06637 3  1  738
 200.689700 7.127176+0 200.749769 7.480755+0 200.827000 8.065571+06637 3  1  739
 200.904231 8.823804+0 200.981463 9.821882+0 200.998625 1.010510+16637 3  1  740
 201.032950 1.068489+1 201.075856 1.157887+1 201.084438 1.176276+16637 3  1  741
 201.123053 1.279759+1 201.135925 1.315099+1 201.155233 1.382596+16637 3  1  742
 201.165959 1.420609+1 201.187413 1.497981+1 201.198139 1.546384+16637 3  1  743
 201.219592 1.645276+1 201.226028 1.675581+1 201.241045 1.761879+16637 3  1  744
 201.262498 1.887775+1 201.263786 1.895526+1 201.283952 2.043942+16637 3  1  745
 201.301114 2.173370+1 201.305405 2.213231+1 201.326858 2.417249+16637 3  1  746
 201.338443 2.530507+1 201.348311 2.649460+1 201.366332 2.871939+16637 3  1  747
 201.375771 2.991760+1 201.388214 3.186358+1 201.410096 3**************************e chemists. The virtue of DENDRAL's convention, aside from
topological consistency, is that the computation of degree of unsaturation, defined be-
low, is straightforward. Hereafter, "ring" and YingP refer to double and triple bonds
as well as larger ring structures. It follows that a saturated hydrocarbon is one that
contains no rings and conversely that any molecules with rings must be unsaturated. In
fact the degree of unsaturation of a set of atoms is defined as the number of rings that
must be present in any molecules formed from the set. A molecule containing n rings
will have a degree of unsaturation of n. For example, benzene (Figure 2-3) has a degree
of unsaturation of 4.

The concept of degree of unsaturation generalizes to molecules other than hydro-
carbons: the degree of unsaturation of a compound is the difference between the max-
imum possible number of univalent atoms the set of remaining atoms could bond and
the actual number of univalent atoms available; it equals the number of rings in the
compound's structure. It is important to understand this notion, so we will examine
some examples. Consider the empirical formula CioHr9N. Suppose these atoms were
combined into a connected, ring-free structure. The sum of the valences of the non-
univalent atoms (10 carbons at 4 each plus 1 nitrogen at 3) is 43. Of these valences,
the nonunivalent atoms (11 of them) will use two fewer than twice their number
(22 - 2 = 20) just bonding to one another. (To account for the reduction by two, con-
sider the special case where they are connected into a single chain: each atom uses
two bonds to connect to its immediate neighbors except for the two end atoms that
use only one bond each. The number of bonds required to maintain connectedness re-
mains the same if branching occurs.) Thus 23 valences remain to be divided between
the univalent atoms and the formation of rings. Since there are 19 hydrogens, we have
4 valences remaining for the formation of rings; each ring closure requires 2 valences,
thus we have two unsaturations. The empirical formula may be rewritten as CreNrU,
to indicate this fact. All molecules with this formula will contain 2 rings and have 19
free valences. It is understood that all free valences will be occupied by H's, which by
convention are not indicated.

,

To determine the degree of unsaturation from an empirical formula, compute

u- [S-(2K- 2)-F]
      2

@q. 1)

5However, it is not conventional to consider the triple bond, a topologically equivalent case, as
three rings or, indeed, to consider it a ring structure at all.


THE STRUCTURE ELUCIDATION PROBLEM OF ORGANIC CHEMISTRY 13

where S = sum of valences of multivalent atoms
   K = the number of multivalent atoms
  F = number of free valences (univalent atoms)
  U = degree of unsaturation
Here are more examples of the calculation.

Empirical formula        Abbreviated formula

%HPN
Cld-h~N
GF3N
C6H.5 (e.g., benzene)
ClaH2402 (e.g., estradiol)

C6NU3
`AoNUz
WSJz
c6u4
c 1802U7

2.4 MASS SPECTROMETRY

2.4.1 The Instrument

Atoms and bonds are, of course, much too small to be examined by optical means. To
determine the structure of a molecule of any complexity, chemists must resort to in-
direct methods. One of the most fruitful of these is mass spectrometry (MS). The es-
sence of the technique is to break large molecules into fragments, infer the composition
of these fragments, and use this information to guess the structure of a molecule that
would break in the observed manner. The mass spectrometer breaks molecules into
fragments by bombarding them with electrons at high energy, causing bonds to cleave.
A molecule does not always end up in just two fragments; some fragments are broken
further. Of course it is not possible to examine only one molecule at a time, and this
fact complicates the picture. An electron beam breaks many molecules of a sample,
and these do not all fragment in the same places, although some bonds are more subject
to breaking than others. For example, single bonds generally break more readily than
double bonds.

Also, certain groups are relatively immune from breaking in the mass spectro-
meter. For example, C=O will generally break off as a unit or remain as a constituent
of a larger unit, but will seldom itself break.6

Determining the masses of the fragments requires that they be sorted. To accom-
plish this process, they are fast accelerated. Since most of the fragments are electrically
charged (that is, they are ions, normally singly charged), they can be accelerated by an
electric field. Only positively charged ions are examined, since these are normally
much more abundant than negative ions. The beam of ions thus produced passes into a
magnetic field perpendicular to its path and is deflected, in accordance with the laws
of electromagnetism and mechanics.

6The bonds connecting such a group to a structure are said to be alpha to the group. Thus
R-CO-R has two bonds alpha to the C=O group. Similarly, bonds more distant from a group
are called beta, gamma, and so forth. Breakage of an alpha bond is called alpha cleavage; simi-
larly we have beta cleavage, gamma cleavage, and so forth.


Figure 2-9 A mass spectrometer with friend (Dr. Raymond Carhart). (Photograph by Robert
Lindsay.)


THE STRUCTURE ELUCIDATION PROBLEM OF ORGANIC CHEMISTRY  15

Note that, from Newton's second law of motion, acceleration a equals force/mass;
that the time t that an ion spends being deflected equals the length of the deflecting
section divided by the ion's velocity u in that direction; and that the deflection is the
distance traveled due to the application of a force to a particle with zero initial velocity
in the direction of the force (i.e., perpendicular to its initial velocity), and thus is
3 at 2. It follows that the deflection is proportional to the force and inversely propor-
tional to mu2.

The force exerted on a moving ion in the magnetic field is directly proportional to
its charge e and its velocity; therefore, the amount by which an ion is deflected from a
straight path by the magnetic field is directly proportional to its charge and inversely
proportional to its mass and its velocity. The result is that ions of the same mass-to-
charge ratio m/e entering the magnetic section with the same velocity are deflected by
the same amount.

Separating valve \
Source slit tiltina.

Connection for
monitor amplifier,

/ Analyzer magnet
     Analvzer tube

Reference inlet system
Ion source,

Deflection condenser

HV-pump

Cold

Mercury diffusion
pump

Getter ion pump

Direct evaporation
system

\               \                   I
                 Deflection condenser
  Drift region        (electrostatic analyzer)

Figure 2-10 Schematic of a mass spectrometer (Varian MAT 711). (From the instrument manual.
Reproduced by permission of Vanim MAT GmbH.)


16 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

By placing a photographic emulsion, electron multiplier, or other recording device
in the path of the dispersed beam, one is thus able to measure the relative abundance of
ions of each m/e ratio. From this measurement is constructed a plot of abundance
versus m/e, a mass spectrum of the molecule, and these plots (or the equivalent table)
are the empirical data from which structure elucidation is attempted. Typical problems
involve compounds with up to 50 or so nonhydrogen atoms. Larger molecules as a rule
are not volatile and are thus not amenable to MS techniques in any event.

Figure 2-9 is a photograph of a mass spectrometer and Figure 2-10 is a schematic
diagram of this particular instrument.

One of the convenient aspects of the technique is that less than a milligram (10m3
gram) of sample is enough; in some cases as little as a microgram (lo-" gram) is suffi-
cient. The sample of the unknown compound is placed in the instrument by way of an
inlet system and is vaporized because the sample must be in the gaseous state. A high
vacuum is maintained in the instrument. Molecules diffuse through the opening into
the ionization chamber where they, are bombarded by electrons, causing some of them
to ionize and break into fragments. The largest ion is usually just the total molecule
less one electron (hence it remains positively charged but of the same mass as the
molecule); this important fragment is the moZect.&r ion, denoted M+. Most molecules
will yield a detectable signal for M+. Ions that are positively charged will be acceler-
ated (toward the right of Figure 2-10) by an electric field; the beam of ions is COI-
limated by slits.

2.4.2 Structure Determination From MS Data

Masses of atoms are measured in atomic mass units (amu). An element may exist in
different forms, called isotopes, that are chemically equivalent but of different masses.
Usually one of these forms is far more abundant than the others. When speaking of a
less abundant isotope, it is customary to signify its mass by a preceding superscript.
Thus C normally denotes the most abundant isotope of carbon (or, generically, any
isotope of carbon), while l3 C denotes the carbon isotope of mass 13 atomic mass units.
Table 2-l gives approximate atomic mass, the so-called nominal mass, for the most
abundant isotopes of the elements mentioned in the examples that follow.'

Suppose our unknown compound produced the mass spectrum shown in Figure
2-11. We note first that the largest m/e is 18 amu. Typically, but not always, this larg-
est value corresponds to the molecular ion, the fragment with the total mass of the
molecule and a charge of 1. We can assume we have a compound rather than an ele-
ment since there is more than one peak in the spectrum. We can now speculate as to
what atoms comprise the molecule. We rule out any atoms with mass greater than 18.
Possible candidates are then hydrogen, helium, lithium, beryllium, boron, carbon, ni-
trogen, and oxygen. We rule out boron, carbon, and nitrogen because we have no peaks
at their masses: 11, 12, and 14, respectively. (The spectrum was not recorded below
m/e = 10 in this example; in typical real problems the spectrum is not recorded below
m/e = 30 or 40 because this portion is similar for most compounds and thus is not very
informative.) The peak at m/e = 16 suggests the presence of oxygen. The peak at m/e =
17 suggests the fragment OH. Since the total mass is 18 and oxygen and hydrogen are

`Examples are from McLafferty, Benjamin/Cummings, Inc., 1967, Reading, Massachusetts.


THE STRUCTURE ELUCIDATION PROBLEM OF ORGANIC CHEMISTRY 17

Table 2-l Nominal masses and valences of several
elements

                   Nominal     Common
Element     Symbol      mass       valence

Hydrogen     H          1         1
Helium       He         4         0
Lithium      Li          I         1
Beryllium     Be         9         2
Boron        B         11         3
Carbon       C         12         4
Nitrogen      N        14        3
Oxygen      0        16         2

I-









I-









IO

Mass/charge (m/e)

    Figure 2-11 A mass spectrum from a simple mole-
    cule. (Source: Interpretation of Mass Spectra, Copy-
- right 1966, Benjamin/Cummings, Inc., Reading,
  20  Mass. Reproduced by permission. After MeLafferty
    [I 9661.)

present, helium, lithium, and beryllium cannot be present. We can conclude that the
unknown was water.

A second example is given in the following tabular form. Following convention,
relative abundances are normalized to percent of the highest peak.,

de

1       3.1
2       0.17
12       1.0
13       3.9
14       9.2
15      85.0
16      100.0
17       1.11
18       0.01

Relative abundance


18 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

The peaks at m/e = 1 and 2 must be from hydrogen. The absence of peaks at 4,7,
9, and 11 indicates no He, Li, Be, or B atoms are present. That being the case, the next
peak at m/e = 12 indicates that carbon is one of the constituents. Peaks at 13, 14,15,
and 16 suggest that there are fragments containing one carbon atom and one or more
hydrogen atoms: CH, CH2, CHs , and CH4. The most likely hypothesis is then meth-
ane, with empirical formula CH4. The peak at 17 may be explained as resulting from
methane molecules containing 13C. The small peak at 18 may be dismissed as due to
an impurity (water).

A more complex example is the following.

de    Relative abundance

12      13.0
14       2.1
19       2.0
24       2.7
26      11.0
27       0.11
31      22.0
32       0.28
38       6.2
50      25.0
51       0.31
69     100.0
70       1.08
76      46.0
77       1.0
95       2.4
96       0.06

Suddenly our arithmetic puzzle has increased markedly in difficulty. We note that
there are no series of several peaks differing by m/e steps of 1, unlike the previous ex-
ample. This suggests that hydrogen is absent. The small peak at m/e = 96 can be as-
sumed to be the molecular ion from molecules containing a heavier, less abundant iso-
tope of some atom. If we assume that m/e = 95 is from the molecular ion, we can then
assume that the peaks at 19 and 76 (~95 - 19) and at 26 and 69 (~95 - 26) are due to
fragments of mass 19 and 26 and their residues. Now we need to do some guessing
based on chemical knowledge. The mass of the most abundant isotope of fluorine is
19. The mass of 26 is quite apt to be from a fragment composed of one carbon and
one nitrogen (12 and 14, respectively), a frequently occurring combination. The peak
at 12 confirms the probable presence of carbon. There is a peak at 14 (nitrogen), al-
though it is small. Candidate atoms are thus C, N, and F. Can these be combined in
ways to account for all prominent peaks? Yes, for the only other prominent peaks are
at 31 (=I9 t 12) and 50 (=2 X 19 t 12). This suggests a structure CF3-CN, a com-
pound called trifluoroacetonitrile. Although this possibility may not be the only logi-
cal one, it is known to be a stable compound and is therefore a good guess, one that
might find further support from other evidence. Note that the topological organization


THE STRUCTURE ELUCIDATION PROBLEM OF ORGANIC CHEMISTRY 19

of these atoms suggests that fragmentations will yield pieces whose sizes correspond to
the prominent peaks in the mass spectrum from which we began; for example,CF; and
CN' are of m/e = 69 and 26, respectively.'

One can see that as the molecules become more complex, the problem of struc-
ture elucidation escalates drastically. Determining molecular structures from MS data
is a complex art performed by experienced chemists and cannot be accomplished by
the application of an algorithm to a set of data. We have outlined the process of analy-
sis in these examples. From the spectrum one may find evidence for the presence of
certain atoms or groups of atoms known to be stable. From other data and from
knowledge of molecular structure and stability, one can rule out certain fragments and
assign high probability to others. Hypotheses are then developed for the probable
structure. One guesses how the hypothesized structure might fragment and then looks
for the presence in the spectrum of m/e peaks corresponding to these ions. The search
goes on until one or more structures are obtained that could have given rise to the
spectrum. The problem is complicated by the fact that some peaks may be due to mul-
tiply charged ions; that some peaks have contributions from fragments containing low
abundance isotopes of some elements; that the molecular ion may not bs represented
in the spectrum; that there are impurities in the sample that create noise in the data;
that there are a great many possibilities to consider; and numerous other difficulties.
There are other complications and refinements. We look next at some that are of im-
portance for our purposes.

2.5 SOME IMPORTANT REFINEMENTS OF THE MS TECHNIQUE

2.5.1 High- and Low-Resolution MS

In the preceding examples we have spoken of atomic masses as though they were al-
ways an integral number of atomic mass units. This assumption is not so. By conven-
tion, the most abundant form of carbon is assigned a mass of exactly 12 amu. All
other elements have nonintegral masses, as determined by careful measurements. Also,
as we have noted, most elements occur in more than one form, and these different
forms (isotopes) differ in mass. The mass of an atom, ion, or compound to the nearest
integral value is called its nominuZ mass. The accumte mass of most elements is known
to five or six significant digits. Table 2-2 gives values of accurate mass for the most
abundant isotopes of some of the elements that are important in organic chemistry.

Rather than complicating matters, these nonintegral values are a great blessing, be-
cause an accurate molecular mass is a far less ambiguous indicator of composition than
is nominal mass. See Lederberg (1964a). For example, CH4 has an accurate mass of
16.0312 and oxygen an accurate mass of 15.9949; the difference is 0.0363. If a mass
spectrometer can make sufficiently fine distinctions among (i.e., if it can resolve) m/e
peaks and measure their positions precisely, it will be able to gather much stronger evi-
dence about composition. For example, although there are four common possible con-
tributors to a peak nominally at 28 amu, they differ slightly in accurate mass.

'A superscript "plus" denotes an ion of unit positive charge.


20 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Table 2-2 Accurate masses of several elements

Accurate

Isotope

Symbol

mass

Valence

Hydrogen
Boron
Carbon
Nitrogen
Oxygen
Fluorine
Sulfur

`H        1.0078
roB       10.0129
12C       12.0000
14N       14.0031
I60       15.9949
`9F       18.9984
32s       31.9721

Elemental     Accurate
composition    mass

co        27.9949
N2         28.0062
CH2N       28.0187
C2H4       28.0312

Such slight differences can be measured easily if the contributors are resolved suf-
ficiently. Low-resolution spectra provide information about nominal masses while
high-resolution spectra provide masses to an accuracy sufficient to assign elemental
composition to each peak.'

Referring again to Figures 2-9 and 2-10, note that ions of equal mass/charge ratio
may enter the accelerating field with different velocities; they will thus have different
velocities when they leave the accelerating field and enter the field-free drift region.
Were this difference not compensated for, the magnetic field would not be able to
bring into precise focus all the ions of the same m/e ratio and peaks would not be
sharp and narrow. Instruments, known as double-focusing spectrometers, employ a
"deflection condenser" to correct this aberration. The electrostatic field in this section
exerts a force on an ion that is directly proportional to its charge but independent of
its velocity. As a result, the ion is deflected from a straight path by an amount that is
inversely proportional to its mass and the square of its velocity (i.e., to its energy) and
directly proportional to its charge. The subsequent deflection in the opposite direction
by the magnetic field exactly cancels the deflection in the deflection condenser and
brings all fragments of equal m/e into focus. Thus the electrostatic section sorts ions

9By convention, two peaks are said to be resolved if the height of the valley between them is
no more than 10 percent of their height. The resolution of a mass spectrometer is defined as nomi-
nal mass divided by resolvable mass difference. Thus an ion with a nominal mass of 360 and another
ion of the same nominal mass that differs from the first only in that it contains an oxygen instead
of a CH4 will just be distinguished by an instrument with resolution 10000 (since 360/.036 =
10,000). Ions of larger mass that differ in the same way will be resolved less well (i.e., the valley
between them will exceed 10 percent of their height). Low-resolution MS blurs these Fme distinc-
tions. The instrument depicted can record spectra of resolution 10000 up to m/e = 1500.


THE STRUCTURE ELUCIDATION PROBLEM OF ORGANIC CHEMISTRY 21

Approximate scale:

Figure 2-12 Sample of peaks from a high resolution mass spectrum before digitization: ion inten-
sities plotted against m/e ratios of ions.

of equal charge on the basis of their energies; the magnetic section sorts ions of equal
charge on the basis of their momenta. Ions of the same mass/charge ratio but different
initial velocities will be path-separated when they emerge from the electrostatic sec-
tion. A narrow slit at this position can then select only those of (nearly) equal velocity
for entry into the magnetic section, which will deflect them by (nearly)equal amounts,
resulting in a sharply defined peak accurately corresponding to their mass/charge ratio.

The double-focusing spectrometer is important when one needs to differentiate
among various combinations of atoms possessing the same nominal mass. The bar
plots (and tables) used to depict mass spectra in our examples are convenient means of
recording low-resolution (nominal mass) spectra. A high-resolution (accurate mass)
spectrum is recorded as a continuous curve consisting of peaks and valleys, produced
from the output of the scanning electron multiplier. See Figure 2-l 2.

2.5.2 Metastable Ions

Ions spend very little time in the ionization chamber. In fact some fragmentation pro-
cesses take longer than the fragment's tenure there. This fact means that further frag-
mentations of some ions take place elsewhere along the beam path of the instrument.
Ions that fragment outside the ionization chamber are called metastable ions.

For reasons given in the following section, metastable ions prove to be important
sources of data. If a parent ion of mass p fragments into a neutral fragment plus a
daughter ion of mass d in the drift region after leaving the acceleration field and before


22 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

entering the deflection condenser and magnetic section, the daughter will have been
accelerated as an ion with mass p, but deflected as an ion with mass d. As a result it
wilI not be recorded in the same position as it would have been had it come into exis-
tence in the ionization chamber. (If the fragmentation occurs in the deflection conden-
ser or in the magnetic section, the daughter will not be recorded at all.) If the fragmen-
tation occurs without loss of energy, the daughter ion will be recorded at the position
where an ion of mass m* = d2/p would be normally detected. [See Beynon (1972),
pages 157-158.1 Since the fragmentations are not without energy loss, and since the
energy is released in random directions, the velocities of samecomposition daughters
are distributed about the zero-energy-loss values. This distribution results in a broad,
relatively low peak centered at mass m*, which is easily distinguished from "normal"
peaks because of its breadth. To enhance the detectability of metastable peaks of
low intensity, it may be necessary to widen the exit slit of the electrostatic section.
This widening has relatively little effect on the intensity of sharp peaks, but rela-
tively greater effect on the wide metastable peaks. This technique is called metasta-
ble defocusing.

When first noted, these unsharp metastable peaks were looked on as an anomaly
of the method, and attempts were made to eliminate them. However, they are now
recognized as the source of important information that cannot be obtained from nor-
mal spectral peaks. The instrument we have described is in fact designed to enhance
the chances for the appearance of metastable ions and provide facilities for their mea-
surement without interference from normal ions. The long field-free drift region be-
tween the accelerating field and the deflection condenser is to allow larger numbers of
ions to decay during flight.

2.5.3 Rearrangement of Ions

The jumble of **************************.538443+16637 3  1  748
 201.413099 3.588261+1 201.429404 3.908491+1 201.437985 4.081519+16637 3  1  749
 201.447424 4.305376+1 201.465445 4.743165+1 201.472310 4.914774+16637 3  1  750
 201.486040 5.325960+1 201.504919 5.906764+1 201.506635 5.961295+16637 3  1  751
 201.528946 6.803361+1 201.540960 7.271129+1 201.549541 7.665766+16637 3  1  752
 201.575285 8.885980+1 201.595880 1.006059+2 201.608752 1.081471+26637 3  1  753
 201.616475 1.133659+2 201.640503 1.300445+2 201.642219 1.312726+26637 3  1  754
 201.664530 1.496549+2 201.681693 1.642226+2 201.691990 1.741698+26637 3  1  755
 201.716018 1.980603+2 201.719450 2.018581+2 201.750343 2.370717+26637 3  1  756
 201.753775 2.414517+2 201.788100 2.865487+2 201.801830 3.050900+26637 3  1  757
 201.822425 3.360643+2 201.856750 3.888400+2 201.863615 3.996595+26637 3  1  758
 201.925400 5.032065+2 201.973455 5.845506+2 202.021510 6.602529+26637 3  1  759
 202.038673 6.863178+2 202.090160 7.521186+2 202.097025 7.586956+26637 3  1  760
 202.138215 7.946475+2 202.145080 7.999619+2 202.196568 8.194053+26637 3  1  761
 202.200000 8.202935+2 202.244623 8.130780+2 202.254920 8.102084+26637 3  1  762
 202.299543 7.801213+2 202.309840 7.720438+2 202.351030 7.266192+26637 3  1  763
 202.361328 7.143529+2 202.405950 6.505535+2 202.426545 6.198425+26637 3  1  764
 202.460870 5.650760+2 202.560413 4.036049+2 202.589589 3.602595+26637 3  1  765
 202.611900 3.278538+2 202.641076 2.897042+2 202.659955 2.657341+26637 3  1  766
 202.689131 2.326415+2 202.695996 2.251263+2 202.732038 1.898853+26637 3  1  767
 202.733754 1.883995+2 202.768079 1.599908+2 202.778376 1.525321+26637 3  1  768
 202.804120 1.348059+2 202.822999 1.233476+2 202.831151 1.186596+26637 3  1  769
 202.858182 1.048030+2 202.867621 1.004887+2 202.885213 9.292610+16637 3  1  770
 202.912244 8.262422+1 202.939275 7.407173+1 202.956866 6.914529+16637 3  1  771
 202.966306 6.667095+1 203.001489 5.869501+1 203.002347 5.851481+16637 3  1  772
 203.038388 5.212832+1 203.066706 4.784098+1 203.074429 4.677984+16637 3  1  773
 203.105322 4.311808+1 203.131066 4.045947+1 203.143938 3.925061+16637 3  1  774
 203.182553 3.612974+1 203.195425 3.521712+1 203.221169 3.357472+16637 3  1  775
 203.272656 3.073092+1 203.281238 3.031797+1 203.324144 2.851519+16637 3  1  776
 203.375631 2.661525+1 203.409956 2.550387+1 203.452863 2.429684+16637 3  1  777
 203.538675 2.222428+1 203.607325 2.094540+1 203.710300 1.924424+16637 3  1  778
 203.813275 1.797899+1 203.916250 1.685192+1 203.967738 1.634006+16637 3  1  779
 204.019225 1.591365+1 204.165106 1.483669+1 204.225175 1.444250+16637 3  1  780
 204.332441 1.385729+1 204.499775 1.304827+1 204.568425 1.274696+16637 3  1  781
 204.667109 1.240080+1 204.834444 1.186890+1 205.023231 1.131843+16637 3  1  782
 205.083300 1.115715+1 205.254925 1.080733+1 205.486619 1.037855+16637 3  1  783
 205.718313 9.981837+0 205.769800 9.898286+0 205.872775 9.773301+06637 3  1  784
 206.181700 9.423851+0 206.439138 9.152811+0 206.593600 9.000293+06637 3  1  785
 206.825294 8.825732+0 207.211450 8.556832+0 207.417400 8.421753+06637 3  1  786
 207.597606 8.334807+0 207.983763 8.160218+0 208.464313 7.955134+06637 3  1  787
 208.910538 7.773772+0 209.065000 7.713713+0 209.579875 7.573349+06637 3  1  788
 210.249213 7.400795+0 210.712600 7.286321+0 210.918550 7.251360+06637 3  1  789
 211.587888 7.142797+0 212.289635 7.033056+0 213.246906 6.888452+06637 3  1  790
 214.204176 6.747811+0 214.270911 6.738213+0 215.161446 6.650977+06637 3  1  791
 216.597352 6.514293+0 217.554622 6.425091+0 217.829222 6.399968+06637 3  1  792
 219.469163 6.292663+0 221.483854 6.164007+0 223.498544 6.037608+06637 3  1  793
 225.416785 5.918807+0 225.513235 5.913806+0 228.199489 5.776620+06637 3  1  794
 230.214179 5.675226+0 232.425234 5.565771+0 234.083526 5.485292+06637 3  1  795
 235.741817 5.406994+0 236.381774 5.377892+0 236.847345 5.345788+06637 3  1  796
 237.676490 5.290183+0 238.505636 5.236630+0 239.058400 5.202491+06637 3  1  797
 239.759200 5.161834+0 240.284800 5.134057+0 240.810400 5.109617+06637 3  1  798
 241.044000 5.100943+0 241.336000 5.068936+0 241.686400 5.034415+06637 3  1  799
 242.036800 5.004240+0 242.387200 4.980031+0 242.650000 4.967319+06637 3  1  800
 242.912800 4.961041+0 243.175600 4.932492+0 243.394600 4.917868+06637 3  1  801
 243.591700 4.914441+0 243.759600 4.922210+0 243.788800 4.919028+06637 3  1  802
 243.985900 4.914881+0 244.117300 4.925216+0 244.248700 4.949612+06637 3  1  803
 244.285200 4.961898+0 244.394700 4.974225+0 244.515150 5.011523+06637 3  1  804
 244.635600 5.078580+0 244.694000 5.131400+0 244.756050 5.167071+06637 3  1  805
 244.836350 5.245853+0 244.916650 5.361229+0 244.982350 5.492992+06637 3  1  806
 244.986000 5.503220+0 245.059000 5.682628+0 245.110100 5.860395+06637 3  1  807
 245.132000 5.962303+0 245.161200 6.090577+0 245.212300 6.399336+06637 3  1  808
 245.250625 6.707214+0 245.288950 7.103264+0 245.327275 7.615002+06637 3  1  809
 245.365600 8.278075+0 245.400640 9.055142+0 245.435680 1.003944+16637 3  1  810
 245.447360 1.045381+1 245.470720 1.130333+1 245.505760 1.289702+16637 3  1  811
 245.526200 1.405357+1 245.540800 1.489951+1 245.575840 1.739624+16637 3  1  812
 245.587520 1.841184+1 245.610880 2.048519+1 245.640080 2.360737+16637 3  1  813
 245.645920 2.424561+1 245.685340 2.942021+1 245.692640 3.056782+16637 3  1  814
 245.724760 3.571193+1 245.740820 3.873524+1 245.764180 4.319865+16637 3  1  815
 245.772940 4.512889+1 245.803600 5.196280+1 245.805060 5.233748+16637 3  1  816
 245.853240 6.486937+1 245.856160 6.564170+1 245.901420 7.939789+16637 3  1  817
 245.926240 8.704991+1 245.949600 9.486672+1 246.010920 1.156569+26637 3  1  818
 246.089760 1.426888+2 246.148160 1.599236+2 246.206560 1.732867+26637 3  1  819
 246.253280 1.800641+2 246.276640 1.816294+2 246.300000 1.829925+26637 3  1  820
 246.343800 1.820047+2 246.346720 1.819090+2 246.393440 1.767368+26637 3  1  821
 246.410960 1.734476+2 246.431400 1.694694+2 246.451840 1.653838+26637 3  1  822
 246.481040 1.575871+2 246.513160 1.487789+2 246.539440 1.403899+26637 3  1  823
 246.624120 1.127614+2 246.691280 9.056645+1 246.752600 7.234526+16637 3  1  824
 246.793480 6.158505+1 246.818300 5.574974+1 246.829250 5.321251+16637 3  1  825
 246.875240 4.394975+1 246.901520 3.937779+1 246.905900 3.863303+16637 3  1  826
 246.936560 3.404952+1 246.967220 3.004729+1 246.984740 2.806124+16637 3  1  827
 246.997880 2.662111+1 247.028540 2.373000+1 247.059200 2.125047+16637 3  1  828
 247.067960 2.064703+1 247.092050 1.905107+1 247.123440 1.730119+16637 3  1  829
 247.124900 1.722324+1 247.157750 1.575674+1 247.190600 1.452671+16637 3  1  830
 247.223450 1.348922+1 247.234400 1.319519+1 247.256300 1.265820+16637 3  1  831
 247.289150 1.197720+1 247.322000 1.139535+1 247.365800 1.073908+16637 3  1  832
 247.380400 1.055466+1 247.409600 1.022707+1 247.458875 9.763792+06637 3  1  833
 247.508150 9.369166+0 247.526400 9.243895+0 247.573850 8.963331+06637 3  1  834
 247.639550 8.635079+0 247.705250 8.349235+0 247.803800 7.976467+06637 3  1  835
 247.818400 7.928290+0 247.902350 7.706501+0 247.986300 7.511775+06637 3  1  836
 248.088500 7.299832+0 248.190700 7.109013+0 248.227200 7.047847+06637 3  1  837
 248.344000 6.899339+0 248.497300 6.730150+0 248.650600 6.579553+06637 3  1  838
 248.825800 6.424172+0 248.928000 6.342059+0 249.044800 6.274349+06637 3  1  839
 249.263800 6.162012+0 249.482800 6.060229+0 249.628800 5.996847+06637 3  1  840
 249.804000 5.925676+0 249.920800 5.893407+0 250.169000 5.831374+06637 3  1  841
 250.541300 5.746368+0 250.913600 5.668220+0 251.285900 5.594957+06637 3  1  842
 251.658200 5.525276+0 251.672800 5.522666+0 252.186978 5.467988+06637 3  1  843
 252.748135 5.412318+0 253.309292 5.359517+0 254.151028 5.284033+06637 3  1  844
 254.992763 5.211521+0 255.410400 5.176607+0 255.834498 5.151879+06637 3  1  845
 256.883537 5.092471+0 258.347185 5.012070+0 259.810832 4.933806+06637 3  1  846
 260.298714 4.908100+0 261.711061 4.834838+0 263.123407 4.763440+06637 3  1  847
 264.182667 4.711663+0 264.888840 4.678438+0 265.595013 4.646739+06637 3  1  848
 265.611200 4.646062+0 266.228850 4.606932+0 266.790350 4.573662+06637 3  1  849
 267.211475 4.550835+0 267.632600 4.530657+0 267.969500 4.517605+06637 3  1  850
 268.053725 4.509994+0 268.334475 4.487752+0 268.615225 4.469123+06637 3  1  851
 268.895975 4.455580+0 269.106538 4.450109+0 269.317100 4.450273+06637 3  1  852
 269.485550 4.435501+0 269.654000 4.427464+0 269.822450 4.428686+06637 3  1  853
 269.990900 4.443077+0 270.103200 4.462985+0 270.215500 4.494418+06637 3  1  854
 270.320781 4.510529+0 270.426063 4.546469+0 270.496250 4.586135+06637 3  1  855
 270.566438 4.643862+0 270.636625 4.727639+0 270.689266 4.815295+06637 3  1  856
 270.692775 4.823190+0 270.741906 4.914545+0 270.789283 5.039612+06637 3  1  857
 270.826131 5.169935+0 270.862980 5.338425+0 270.899828 5.556081+06637 3  1  858
 270.936677 5.836773+0 270.973525 6.197731+0 271.010373 6.656957+06637 3  1  859
 271.047222 7.242532+0 271.084070 7.983716+0 271.120919 8.913744+06637 3  1  860
 271.157767 1.006922+1 271.158820 1.010870+1 271.184789 1.109738+16637 3  1  861
 271.214268 1.240012+1 271.243747 1.391046+1 271.248660 1.419987+16637 3  1  862
 271.273226 1.567197+1 271.317444 1.878041+1 271.338500 2.053843+16637 3  1  863
 271.361662 2.250453+1 271.405880 2.685329+1 271.464838 3.362161+16637 3  1  864
 271.473260 3.473256+1 271.544851 4.430788+1 271.563100 4.678336+16637 3  1  865
 271.616443 5.421820+1 271.675400 6.254179+1 271.717513 6.754188+16637 3  1  866
 271.754010 7.189254+1 271.824198 7.771267+1 271.880348 7.994705+16637 3  1  867
 271.888770 8.026171+1 271.900000 8.038403+1 271.950535 7.983242+16637 3  1  868
 271.972995 7.885807+1 271.995455 7.781336+1 272.057220 7.296680+16637 3  1  869
 272.113370 6.664173+1 272.135830 6.406588+1 272.169520 5.958687+16637 3  1  870
 272.281820 4.438903+1 272.298665 4.208075+1 272.357623 3.470940+16637 3  1  871
 272.416580 2.825307+1 272.467115 2.354504+1 272.500805 2.083558+16637 3  1  872
 272.534495 1.845646+1 272.566781 1.647381+1 272.568185 1.638926+16637 3  1  873
 272.601875 1.464523+1 272.635565 1.315737+1 272.669255 1.189569+16637 3  1  874
 272.681889 1.149167+1 272.698383 1.098462+1 272.735231 1.003339+16637 3  1  875
 272.772080 9.252728+0 272.808928 8.611606+0 272.845777 8.083059+06637 3  1  876
 272.854550 7.978586+0 272.882625 7.673722+0 272.919473 7.344417+06637 3  1  877
 272.956322 7.070560+0 272.980888 6.912611+0 273.030019 6.642652+06637 3  1  878
 273.065113 6.482939+0 273.079150 6.428009+0 273.131791 6.258553+06637 3  1  879
 273.184431 6.116041+0 273.254619 5.955278+0 273.324806 5.817822+06637 3  1  880
 273.394994 5.696745+0 273.416050 5.664751+0 273.500275 5.566665+06637 3  1  881
 273.605556 5.462487+0 273.700309 5.380061+0 273.819628 5.287549+06637 3  1  882
 273.938947 5.204497+0 274.047738 5.136584+0 274.117925 5.106144+06637 3  1  883
 274.296903 5.039574+0 274.475881 4.980844+0 274.665388 4.924874+06637 3  1  884
 274.875950 4.868193+0 275.156700 4.799095+0 275.381300 4.748016+06637 3  1  885
 275.437450 4.739701+0 275.718200 4.701843+0 276.027025 4.663275+06637 3  1  886
 276.490263 4.609627+0 276.953500 4.559450+0 277.290400 4.524889+06637 3  1  887
 277.571150 4.506082+0 278.188800 4.467335+0 278.957645 4.421453+06637 3  1  888
 280.110912 4.355627+0 281.264180 4.292000+0 282.801869 4.209069+06637 3  1  889
 284.339559 4.127394+0 287.013859 3.987402+0 287.207822 3.977287+06637 3  1  890
 291.510215 3.756149+0 295.812609 3.538184+0 297.882698 3.434798+06637 3  1  891
 298.680872 3.386355+0 301.549134 3.214368+0 303.317117 3.109978+06637 3  1  892
 303.700331 3.082326+0 305.851528 2.929439+0 307.285659 2.829125+06637 3  1  893
 308.436109 2.750824+0 309.471922 2.661859+0 310.783680 2.552798+06637 3  1  894
 312.095437 2.447861+0 312.275352 2.434241+0 312.969942 2.363306+06637 3  1  895
 313.844447 2.278499+0 314.584450 2.212116+0 314.947750 2.182881+06637 3  1  896
 315.189950 2.155136+0 315.795450 2.093601+0 316.249575 2.055173+06637 3  1  897
 316.340400 2.049503+0 316.703700 2.011494+0 317.006450 1.988094+06637 3  1  898
 317.309200 1.974314+0 317.339475 1.974307+0 317.611950 1.959388+06637 3  1  899
 317.839013 1.959798+0 317.960113 1.967886+0 318.043369 1.968284+06637 3  1  900
 318.236372 1.985161+0 318.391531 2.016163+0 318.429375 2.020529+06637 3  1  901
 318.622378 2.074093+0 318.751047 2.134707+0 318.822950 2.184406+06637 3  1  902
 318.879716 2.217241+0 318.981894 2.304056+0 319.095425 2.441241+06637 3  1  903
 319.125700 2.491195+0 319.171113 2.561744+0 319.246800 2.717584+06637 3  1  904
 319.322488 2.928317+0 319.379253 3.138426+0 319.436019 3.412804+06637 3  1  905
 319.489000 3.754038+0 319.492784 3.779157+0 319.530628 4.099924+06637 3  1  906
 319.572256 4.538454+0 319.579825 4.640428+0 319.617669 5.161169+06637 3  1  907
 319.625238 5.291402+0 319.651728 5.755803+0 319.670650 6.157716+06637 3  1  908
 319.685788 6.486343+0 319.716063 7.280700+0 319.719847 7.381971+06637 3  1  909
 319.746338 8.236257+0 319.753906 8.484358+0 319.776613 9.378242+06637 3  1  910
 319.787966 9.832545+0 319.806888 1.073780+1 319.822025 1.147380+16637 3  1  911
 319.837163 1.234905+1 319.856084 1.346054+1 319.867438 1.424872+16637 3  1  912
 319.890144 1.584960+1 319.897713 1.648145+1 319.922689 1.859488+16637 3  1  913
 319.927988 1.905002+1 319.952208 2.146639+1 319.958263 2.207986+16637 3  1  914
 319.981726 2.486332+1 320.003675 2.750500+1 320.011244 2.858974+16637 3  1  915
 320.040762 3.287598+1 320.049088 3.410207+1 320.070280 3.774993+16637 3  1  916
 320.094500 4.197851+1 320.106610 4.440603+1 320.139913 5.117709+16637 3  1  917
 320.142940 5.187379+1 320.185325 6.176479+1 320.189867 6.284218+16637 3  1  918
 320.238306 7.571547+1 320.251930 7.939663+1 320.306425 9.568716+16637 3  1  919
 320.415415 1.287387+2 320.454773 1.406697+2 320.521378 1.582258+26637 3  1  920
 320.530460 1.605634+2 320.587983 1.721072+2 320.603120 1.742279+26637 3  1  921
 320.639450 1.790127+2 320.663670 1.804844+2 320.700000 1.823387+26637 3  1  922
 320.733303 1.815080+2 320.754495 1.808137+2 320.760550 1.802178+26637 3  1  923
 320.802935 1.757462+2 320.821100 1.726540+2 320.869540 1.639259+26637 3  1  924
 320.893760 1.580120+2 320.954310 1.427140+2 320.960365 1.409531+26637 3  1  925
 321.087520 1.031066+2 321.129905 9.043272+1 321.193483 7.289175+16637 3  1  926
 321.196510 7.215047+1 321.257060 5.751157+1 321.269170 5.498242+16637 3  1  927
 321.311555 4.629882+1 321.341830 4.087723+1 321.347885 3.981598+16637 3  1  928
 321.384215 3.417277+1 321.396703 3.246758+1 321.420545 2.928853+16637 3  1  929
 321.452334 2.559989+1 321.456875 2.508635+1 321.493205 2.154504+16637 3  1  930
 321.507964 2.031055+1 321.529535 1.856145+1 321.560945 1.636969+16637 3  1  931
 321.563594 1.621191+1 321.600681 1.407032+1 321.640417 1.222877+16637 3  1  932
 321.674855 1.090500+1 321.680153 1.071097+1 321.719889 9.509973+06637 3  1  933
 321.749029 8.778378+0 321.759625 8.525925+0 321.799361 7.740178+06637 3  1  934
 321.823203 7.344538+0 321.839097 7.097410+0 321.865588 6.741747+06637 3  1  935
 321.918569 6.135510+0 321.934463 5.985501+0 321.971550 5.664144+06637 3  1  936
 322.028316 5.256021+0 322.047238 5.140548+0 322.085081 4.928997+06637 3  1  937
 322.160769 4.572748+0 322.198613 4.421158+0 322.236456 4.284659+06637 3  1  938
 322.349988 3.941519+0 322.425675 3.748585+0 322.463519 3.663178+06637 3  1  939
 322.577050 3.443737+0 322.720856 3.202970+0 322.864663 3.022073+06637 3  1  940
 323.080372 2.789276+0 323.152275 2.722264+0 323.296081 2.609078+06637 3  1  941
 323.439888 2.508379+0 323.727500 2.328272+0 323.987125 2.207216+06637 3  1  942
 324.376563 2.046612+0 324.506375 1.998837+0 324.766000 1.918078+06637 3  1  943
 325.264000 1.779304+0 325.637500 1.684307+0 325.762000 1.656322+06637 3  1  944
 326.353375 1.535142+0 326.944750 1.426059+0 327.240438 1.376548+06637 3  1  945
 328.127500 1.246383+0 328.750000 1.167832+0 329.014563 1.138310+06637 3  1  946
 329.746000 1.073838+0 329.901625 1.062266+0 330.368500 1.038381+06637 3  1  947
 330.493000 1.033892+0 330.866500 1.031277+0 331.240000 1.034772+06637 3  1  948
 331.302250 1.036235+0 331.473438 1.046573+0 331.706875 1.063720+06637 3  1  949
 331.862500 1.077104+0 331.909188 1.081648+0 332.018125 1.097415+06637 3  1  950
 332.134844 1.115579+0 332.236000 1.132276+0 332.329375 1.148532+06637 3  1  951
 332.391625 1.159846+0 332.461656 1.173052+0 332.520016 1.184462+06637 3  1  952
 332.578375 1.196254+0 332.625063 1.205973+0 332.660078 1.213460+06637 3  1  953
 332.671750 1.216672+0 332.718438 1.229792+0 332.761235 1.242064+06637 3  1  954
 332.788469 1.249998+0 332.837102 1.264417+0 332.872117 1.275001+06637 3  1  955
 332.920750 1.289992+0 332.971328 1.305952+0 333.010235 1.318493+06637 3  1  956
 333.056922 1.333855+0 333.111391 1.352223+0 333.158078 1.368361+06637 3  1  957
 333.216438 1.389065+0 333.232000 1.394749+0 333.274797 1.413314+06637 3  1  958
 333.340938 1.442778+0 333.410969 1.474911+0 333.481000 1.508053+06637 3  1  959
 333.574375 1.553902+0 333.667750 1.601764+0 333.761125 1.651964+06637 3  1  960
 333.776688 1.661643+0 333.870063 1.722218+0 333.963438 1.785273+06637 3  1  961
 334.103500 1.884879+0 334.228000 1.978931+0 334.259125 2.003869+06637 3  1  962
 334.352500 2.088419+0 334.477000 2.207402+0 334.601500 2.333246+06637 3  1  963
 334.726000 2.467643+0 334.757125 2.505429+0 334.912750 2.707649+06637 3  1  964
 335.068375 2.924873+0 335.192875 3.112232+0 335.224000 3.164747+06637 3  1  965
 335.410750 3.505468+0 335.597500 3.878542+0 335.659750 4.015527+06637 3  1  966
 335.784250 4.314726+0 335.971000 4.808064+0 336.157750 5.393675+06637 3  1  967
 336.282250 5.825703+0 336.344500 6.058707+0 336.531250 6.832215+06637 3  1  968
 336.593500 7.119857+0 336.718000 7.739558+0 336.904750 8.777130+06637 3  1  969
 337.091500 1.003497+1 337.216000 1.098097+1 337.278250 1.148830+16637 3  1  970
 337.449438 1.306616+1 337.465000 1.321928+1 337.651750 1.530555+16637 3  1  971
 337.682875 1.570559+1 337.838500 1.782867+1 337.905419 1.886460+16637 3  1  972
 337.978563 2.006694+1 338.106175 2.241340+1 338.118625 2.265720+16637 3  1  973
 338.255575 2.566165+1 338.306931 2.693189+1 338.386300 2.902120+16637 3  1  974
 338.507688 3.262569+1 338.517025 3.292316+1 338.647750 3.763572+16637 3  1  975
 338.708444 4.014352+1 338.778475 4.320674+1 338.842281 4.642630+16637 3  1  976
 338.909200 4.998962+1 338.996350 5.532449+1 339.021250 5.693893+16637 3  1  977
 339.127075 6.479667+1 339.133300 6.528658+1 339.245350 7.546049+16637 3  1  978
 339.257800 7.678796+1 339.357400 8.800611+1 339.388525 9.217023+16637 3  1  979
 339.469450 1.036732+2 339.519250 1.120495+2 339.562825 1.197959+26637 3  1  980
 339.606400 1.288530+2 339.646863 1.377008+2 339.699775 1.512707+26637 3  1  981
 339.730900 1.597215+2 339.793150 1.797657+2 339.814938 1.872330+26637 3  1  982
 339.870963 2.095103+2 339.886525 2.165663+2 339.926988 2.358490+26637 3  1  983
 339.948775 2.479727+2 339.998575 2.768789+2 340.011025 2.854614+26637 3  1  984
 340.063938 3.235220+2 340.073275 3.314766+2 340.126188 3.783548+26637 3  1  985
 340.129300 3.812446+2 340.191550 4.493903+2 340.194663 4.529752+26637 3  1  986
 340.256913 5.374048+2 340.260025 5.418373+2 340.322275 6.454448+26637 3  1  987
 340.378300 7.575844+2 340.387638 7.788322+2 340.434325 8.891918+26637 3  1  988
 340.453000 9.388518+2 340.490350 1.041781+3 340.521475 1.138667+36637 3  1  989
 340.565050 1.278616+3 340.589950 1.369464+3 340.658425 1.626709+36637 3  1  990
 340.692663 1.770591+3 340.826500 2.341564+3 340.926100 2.755834+36637 3  1  991
 340.957225 2.879408+3 341.025700 3.103531+3 341.050600 3.179167+36637 3  1  992
 341.100400 3.287434+3 341.125300 3.335794+3 341.162650 3.371106+36637 3  1  993
 341.200000 3.399574+3 341.208559 3.404014+3 341.217119 3.403178+36637 3  1  994
 341.293375 3.347626+3 341.302713 3.337838+3 341.371188 3.199725+36637 3  1  995
 341.386750 3.154817+3 341.473900 2.880303+3 341.498800 2.783105+36637 3  1  996
 341.641975 2.201931+3 341.710450 1.921866+3 341.772700 1.671652+36637 3  1  997
 341.803825 1.557444+3 341.847400 1.401795+3 341.866075 1.341725+36637 3  1  998
 341.922100 1.167016+3 341.940775 1.115821+3 341.996800 9.679097+26637 3  1  999
 342.006138 9.463766+2 342.059050 8.290668+2 342.071500 8.049209+26637 3  1 1000
 342.121300 7.123094+2 342.136863 6.871860+2 342.183550 6.150350+26637 3  1 1001
 342.202225 5.901066+2 342.245800 5.340813+2 342.308050 4.676727+26637 3  1 1002
 342.314275 4.619381+2 342.370300 4.127106+2 342.382750 4.032470+26637 3  1 1003
 342.432550 3.670673+2 342.451225 3.552888+2 342.494800 3.289543+26637 3  1 1004
 342.519700 3.161498+2 342.581950 2.854212+2 342.588175 2.828477+26637 3  1 1005
 342.656650 2.556444+2 342.669100 2.508894+2 342.756250 2.228193+26637 3  1 1006
 342.759363 2.219858+2 342.837175 2.021073+2 342.886975 1.898077+26637 3  1 1007
 342.924325 1.823190+2 343.017700 1.643868+2 343.055050 1.584369+26637 3  1 1008
 343.148425 1.442591+2 343.185775 1.394531+2 343.269813 1.290952+26637 3  1 1009
 343.316500 1.242227+2 343.425438 1.132945+2 343.447225 1.114549+26637 3  1 1010
 343.565500 1.018188+2 343.581063 1.005893+2 343.714900 9.192029+16637 3  1 1011
 343.814500 8.568239+1 343.864300 8.316541+1 344.047938 7.425232+16637 3  1 1012
 344.088400 7.263164+1 344.281375 6.524509+1 344.312500 6.426597+16637 3  1 1013
 344.536600 5.750637+1 344.577063 5.632634+1 344.779375 5.150509+16637 3  1 1014
 344.857188 4.971561+1 345.059500 4.582605+1 345.137313 4.438180+16637 3  1 1015
 345.339625 4.131368+1 345.557500 3.811805+1 345.619750 3.738482+16637 3  1 1016
 345.806500 3.524590+1 345.977688 3.333713+1 346.180000 3.149063+16637 3  1 1017
 346.397875 2.957339+1 346.600188 2.813676+1 346.989250 2.547210+16637 3  1 1018
 347.020375 2.530276+1 347.440563 2.309473+1 347.611750 2.221908+16637 3  1 1019
 347.860750 2.119189+1 348.234250 1.969663+1 348.421000 1.908014+16637 3  1 1020
 348.856750 1.768394+1 348.887875 1.760334+1 349.588188 1.584684+16637 3  1 1021
 349.790500 1.535341+1 350.288500 1.438594+1 350.724250 1.356178+16637 3  1 1022
 350.988813 1.315295+1 351.658000 1.214450+1 351.689125 1.210622+16637 3  1 1023
 352.467250 1.117299+1 352.903000 1.066191+1 353.401000 1.018611+16637 3  1 1024
 354.148000 9.488567+0 354.334750 9.344112+0 355.268500 8.637119+06637 3  1 1025
 355.642000 8.359754+0 356.513500 7.833725+0 357.634000 7.171207+06637 3  1 1026
 357.883000 7.026719+0 359.128000 6.427080+0 360.124000 5.957465+06637 3  1 1027
 360.622000 5.752356+0 361.120000 5.550354+0 362.565000 4.973107+06637 3  1 1028
 364.010000 4.410559+0 364.109000 4.373022+0 365.093750 4.007957+06637 3  1 1029
 366.177500 3.617540+0 366.900000 3.365641+0 367.400000 3.198270+06637 3  1 1030
 367.900000 3.017483+0 368.900000 2.677293+0 369.650000 2.441384+06637 3  1 1031
 370.400000 2.215353+0 370.900000 2.081298+0 371.525000 1.938597+06637 3  1 1032
 371.850000 1.883482+0 372.150000 1.839739+0 372.300000 1.828145+06637 3  1 1033
 372.618750 1.812459+0 372.700000 1.815018+0 372.962500 1.832313+06637 3  1 1034
 373.087500 1.844561+0 373.150000 1.857278+0 373.337500 1.901751+06637 3  1 1035
 373.475000 1.939197+0 373.531250 1.956294+0 373.587500 1.980673+06637 3  1 1036
 373.662500 2.015176+0 373.743750 2.054539+0 373.809375 2.087964+06637 3  1 1037
 373.875000 2.122963+0 373.925000 2.150758+0 373.975000 2.188190+06637 3  1 1038
 374.031250 2.231611+0 374.075000 2.266396+0 374.115625 2.299531+06637 3  1 1039
 374.156250 2.333508+0 374.199610 2.370744+0 374.243750 2.409731+06637 3  1 1040
 374.275000 2.438021+0 374.325000 2.484529+0 374.350000 2.508483+06637 3  1 1041
 374.362500 2.523452+0 374.400000 2.569302+0 374.450000 2.631972+06637 3  1 1042
 374.500000 2.696490+0 374.556250 2.771417+0 374.612500 2.848983+06637 3  1 1043
 374.675000 2.938477+0 374.750000 3.050825+0 374.825000 3.189115+06637 3  1 1044
 374.912500 3.358593+0 375.006250 3.550938+0 375.025000 3.591892+06637 3  1 1045
 375.100000 3.777598+0 375.175000 3.973245+0 375.250000 4.178653+06637 3  1 1046
 375.300000 4.324666+0 375.362500 4.529892+0 375.450000 4.836233+06637 3  1 1047
 375.550000 5.209527+0 375.650000 5.656536+0 375.750000 6.135663+06637 3  1 1048
 375.800000 6.394928+0 375.862500 6.757142+0 375.987500 7.546145+06637 3  1 1049
 376.050000 7.981186+0 376.112500 8.460566+0 376.237500 9.517183+06637 3  1 1050
 376.362500 1.078995+1 376.415000 1.138569+1 376.487500 1.227840+16637 3  1 1051
 376.587500 1.365374+1 376.612500 1.402878+1 376.737500 1.612874+16637 3  1 1052
 376.760000 1.655050+1 376.831250 1.800498+1 376.925000 2.011009+16637 3  1 1053
 376.932500 2.029703+1 377.018750 2.264452+1 377.105000 2.525251+16637 3  1 1054
 377.112500 2.550210+1 377.206250 2.897170+1 377.260000 3.121159+16637 3  1 1055
 377.300000 3.302028+1 377.380000 3.709957+1 377.390000 3.765215+16637 3  1 1056
 377.480000 4.327675+1 377.500000 4.471474+1 377.570000 5.016216+16637 3  1 1057
 377.620000 5.467704+1 377.660000 5.856013+1 377.700000 6.298673+16637 3  1 1058
 377.720000 6.534697+1 377.780000 7.326443+1 377.855000 8.539935+16637 3  1 1059
 377.860000 8.635571+1 377.930000 1.006820+2 377.942500 1.036418+26637 3  1 1060
 377.980000 1.132205+2 378.025000 1.261825+2 378.030000 1.277261+26637 3  1 1061
 378.080000 1.451650+2 378.130000 1.661183+2 378.135000 1.685134+26637 3  1 1062
 378.180000 1.912418+2 378.190000 1.971018+2 378.240000 2.279937+26637 3  1 1063
 378.245000 2.316251+2 378.300000 2.736827+2 378.360000 3.303869+26637 3  1 1064
 378.420000 4.001114+2 378.480000 4.849298+2 378.530000 5.688168+26637 3  1 1065
 378.540000 5.876373+2 378.590000 6.857638+2 378.600000 7.077018+26637 3  1 1066
 378.650000 8.221408+2 378.680000 8.976219+2 378.710000 9.757514+26637 3  1 1067
 378.740000 1.060731+3 378.785000 1.191899+3 378.860000 1.425465+36637 3  1 1068
 378.995000 1.848254+3 379.040000 1.984046+3 379.085000 2.102997+36637 3  1 1069
 379.115000 2.176506+3 379.175000 2.296794+3 379.185000 2.314293+36637 3  1 1070
 379.260000 2.402803+3 379.300000 2.416894+3 379.325000 2.420830+36637 3  1 1071
 379.375000 2.396721+3 379.400000 2.378644+3 379.450000 2.310386+36637 3  1 1072
 379.475000 2.270707+3 379.540000 2.126936+3 379.580000 2.031052+36637 3  1 1073
 379.660000 1.799651+3 379.720000 1.622222+3 379.810000 1.348636+36637 3  1 1074
 379.840000 1.259471+3 379.895000 1.107816+3 379.940000 9.877350+26637 3  1 1075
 379.965000 9.281180+2 380.020000 8.020821+2 380.035000 7.713819+26637 3  1 1076
 380.080000 6.835471+2 380.105000 6.399241+2 380.140000 5.818231+26637 3  1 1077
 380.167500 5.414926+2 380.200000 4.960429+2 380.222500 4.682650+26637 3  1 1078
 380.252500 4.329143+2 380.277500 4.071925+2 380.317500 3.679822+26637 3  1 1079
 380.332500 3.553807+2 380.382500 3.154355+2 380.387500 3.120144+26637 3  1 1080
 380.442500 2.762715+2 380.447500 2.731635+2 380.497500 2.466879+26637 3  1 1081
 380.512500 2.390906+2 380.552500 2.217512+2 380.577500 2.114072+26637 3  1 1082
 380.615000 1.980443+2 380.642500 1.887246+2 380.685000 1.766257+26637 3  1 1083
 380.740000 1.617481+2 380.755000 1.583805+2 380.825000 1.434239+26637 3  1 1084
 380.830000 1.424059+2 380.920000 1.269438+2 380.930000 1.254931+26637 3  1 1085
 381.035000 1.111815+2 381.040000 1.105313+2 381.140000 9.972352+16637 3  1 1086
 381.160000 9.765966+1**************************ions, hydrogen atoms, and neutral fragments in the ionization chamber
provides opportunity for recombinations that produce ions that were not connected
pieces of the parent molecule. Such rearrangements do in fact occur and complicate
the picture further. The major value of metastable ions is that the presence of a meta-
stable peak establishes a direct parent-daughter relationship between two ions since
metastable ions are not formed in the ionization chamber and are thus not products
of rearrangements. When this relationship exists, it is known that the two ions are con-
nected (or overlap) in the parent molecule.

A very common rearrangement is called hydrogen tr&sfer. This arrangement oc-
curs when hydrogens migrate from one ion to another resulting in a more stable struc-
ture. As it turns out, such transfers frequently cause the appearance of peaks 1 or 2 amu
less than the expected peak. The patterns of transfer are to an extent consistent, and
knowledge of these patterns is important in the interpretation of mass spectra.
  Another important example is the McLaffer@ rearrangement, which is any of a
class of rearrangements in which a hydrogen atom transfers to a polar," odd-electron
ion during the fragmentation process. The peaks produced by such rearrangements fre-

loA polar ion is one whose charge is localized so that the electric field of the ion is not
symmetrical.


THE STRUCTURE ELUCIDATION PROBLEM OF ORGANIC CHEMISTRY 23

Figure 2-13 McLafferty rearrangements. (Source: Mass Spectrometry: Techniques and Applica-
tions, edited by G. W. A. Milne, Copyright 1971, John Wiley & Sons, Inc. Reproduced by permis-
sion. After Buchanan, Duffield, and Robertson [ 1971) .)

quently are quite prominent. Figure 2-l 3 depicts a complex rearrangement process in-
volving four occurrences of McLafferty rearrangement. Metastable peaks correspond-
ing to each of the four transitions might well appear, as well as peaks corresponding to
the distinct ions.

2.5.4 The Nitrogen Rule

Of the elements that predominate in organic compounds, nitrogen is unique in having
an even nominal mass (14) and an odd valence (usually 3, occasionally 5). A moment's
reflection will demonstrate that any hydrocarbon will have an even nominal mass, un-
less it contains 13C. Thus any ion containing only hydrogen and carbon that results
from breaking one single bond will be of odd nominal mass. The picture is not changed
if we include sulfur, with even nominal mass (32) and valence (4). Thus if there are no
nitrogen atoms in the compound (and no phosphorus-mass 3 1, valence 3), all large
ions will be of odd mass, except those that involve the loss of an odd number of hy-
drogens or breaking of double bonds.

If a single nitrogen atom is contained in the compound, the breaking of any one
of its bonds will yield an odd mass ion and an even mass ion (containing the N). Typi-
cally, then, if there are no nitrogens, the major peaks will all be of odd mass, while if
there is one nitrogen, there will be major peaks of even mass.

The reasoning generalizes. An ion containing an odd number of nitrogens (and no
double bonds) has an even mass; an ion containing any even number of nitrogens (and
no double bonds) has an odd mass. It follows that a molecule with no nitrogens will
produce only peaks of odd nominal mass if we ignore the breaking of double bonds
and multiple breaks. A molecule with exactly one nitrogen atom will produce both
odd and even nominal mass peaks. If a molecule contains more than one N (whether
an even or odd number), it can produce both even and odd mass fragments. However,


24 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

if the nitrogen parity is even, it will tend to produce more odd peaks, and conversely.
In particular, if there is a series of even peaks in a low-resolution spectrum that differ
by multiples of 14 amu, these differences probably correspond to ions that contain an
odd number of nitrogens and differ in their count of CH2 radicals, a frequently lost
structure. If there is a series of odd peaks that differ by multiples of 14 amu, these dif-
ferences probably correspond to ions that contain an even number of nitrogens (or
none) and differ by their CH2 count. Thus the nitrogen parity of a molecule can be in-
ferred by the parity of the CH2 series: odd series, even nitrogen parity, and conversely.
This rule is the nitrogen rule. It is not infallible, because double bonds and hydrogen
transfers can cause the appearance of other peaks of substantial relative abundance.
The rule is not important when high-resolution spectra are available, since exact com-
positions are then known in any case.

2.6 OTHER ANALYTICAL METHODS

A chemist can gather other kinds of information about an unknown compound. At the
very least there will be some information about its source and extraction methods,
which often suggests probable constituents. Laboratory analyses may also provide fur-
ther clues of this sort. In addition other instrument-based techniques provide informa-
tion about the compound. The most common among these are gas chromatography,
infrared spectrometry, ultraviolet spectrometry, and nuclear magnetic resonance spec-
frometry (NMR). At the time of writing DENDRAL has not been extended to the in-
terpretation of these data [with one exception, Carhart and Djerassi (1973)] in the
way it interprets MS data. However, this information is employed indirectly in the pro-
cedures that guide the DENDRAL search through the set of possible structures. The
following brief descriptions give some idea of the nature of the information provided
by these other techniques.

2.6.1 Gas Chromatography

This procedure is very important in analytical chemistry. The term chromatography is
historical and can be misleading since most forms of chromatography do not involve
color. A gas chromatograph is a device that separates a mixture of compounds into its
constituents by taking advantage of the differences in partitioning of different com-
pounds between a moving gas stream (the mixture to be analyzed) and a stationary
phase (a viscous liquid). Different constituents interact differently with the stationary
phase; in particular more volatile components move through more rapidly and thus
exit the chromatograph earlier. By collecting and measuring the effluents one can de-
termine their approximate relative abundances, and relative boiling points. Gas chro-
matography is frequently a useful precursor to MS as a means of extracting pure sam-
ples from a mixture of compounds. Such an arrangement is referred to as CC/MS."

`lGas chromatography is the source of many of the high- and low-resolution mass spectra ana-
lyzed by chemists working with DENDRAL. A separate data acquisition system has been devel-
oped for a Digital Equipment Corporation PDP-11 computer to collect CC/MS data. It includes a
program, named CLEANUP, that provides mass spectra of the individual components of mixtures,
such as urine [Dromey et al. (1976)].


THE STRUCTURE ELUCIDATION PROBLEM OF ORGANIC CHEMISTRY 25

2.6.2 Infrared Spectrometry

Just as a piece of colored glass differentially absorbs visible light of different wave-
lengths, a sample of organic compound differentially absorbs electromagnetic radiation
of different wavelengths. From these patterns of absorption some information about
the compound can be obtained. Wavelengths between 2.5 and 15 microns are particu-
larly useful. This radiation is in the infrared region of the electromagnetic spectrum.

The reason that radiation is absorbed by matter is that the energy of the radiation
alters the matter in some way. Since the alterations must be by discrete (quantum)
amounts, the energies absorbed are of particular wavelengths. Wavelengths in the in-
frared region alter molecules by increasing their rates of vibration and bending. Vibra-
tion refers to oscillations in the effective lengths of bonds (as though the atoms were
balls connected by springs), and bending refers to oscillations in the bond angles. Since
different types of bonds have different characteristic rates for these oscillations, the
absorption spectra for infrared radiation yield information about the types of atoms,
and hence the types of compounds, that are present.

This technique can not be used alone to determine the structure of complex or-
ganic compounds, but it is useful for detecting the presence of certain functional
groups. Thus it is useful in conjunction with mass spectrometry, which, as we have
seen, is benefited by any hypotheses about what components are apt to appear as frag-
ments in the mass spectrum."

2.6.3 Ultraviolet Spectrometry

Another band of the electromagnetic spectrum that is differentially absorbed by or-
ganic compounds is the range of wavelengths from 0.01 to 0.38 micron (10 to 380 mil-
limicrons), in the ultraviolet region.

This radiation is of much higher energy than infrared, and the alterations it effects
on the molecules irradiated are of an entirely different nature. Ultraviolet radiation
causes quantum shifts in the energy states of orbital electrons. Since energy states dif-
fer for different types of chemical bonds, the energy needed to cause such shifts is dif-
ferent for different compounds, being dependent mainly on the arrangement of double
and triple bonds. By observing which wavelengths are absorbed, the chemist can infer,
in some cases, some of the functional groups of the complex molecules of the sample.
In general, the information obtained in this way is complementary to that obtained
from infrared spectrometry.

2.6.4 Nuclear Magnetic Resonance Spectrometry

Nuclear magnetic resonance spectrometry can be viewed as another technique involv-
ing differential absorption of energy. In this case the energy is supplied by a magnetic
field that oscillates at radio frequency.

To understand this technique it is necessary to look inside the atomic nucleus.
The protons in the nucleus are spinning, and since they are charged particles, their
spinning causes them to become tiny magnets (magnetic dipoles). If a large steady
"Computer programs written by Woodruff and Munk (1977) analyze infrared spectra in much
the same way that the DENDRAL planning program analyzes mass spectra (see Chapter 5).


26 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

magnetic field He is applied to a sample of a compound, the spinning protons in the
nuclei have only two stable orientations with respect to the direction of He: either
their magnetic fields are parallel to He, or they are antiparallel to it, The former
state is the lower-energy and hence more stable state, and the majority of protons will
be so aligned.

Actually, the protons in the lower-energy state will not be exactly aligned with
He. Rather their axes of rotation will precess about the direction of H,, . Imagine a
spinning top that has lost energy and is slowing down. Its axis will precess about the
direction of the gravitational field with a certain angular velocity (that changes as the
top slows). If we were to tap the side of the top perpendicular to its rotational axis at
just the right frequency (that is, if our tapping were in resonance with the frequency
of precession), the precession angle would increase until the top fell over. This imper-
fect analogy describes what happens to protons in a nuclear magnetic resonance spec-
trometer. An oscillating magnetic field HI at right angles to the fixed field Ho acts as
the tapping finger. Instead of falling over, the protons flip to their higherenergy state.
Since the angular velocity of precession depends on the magnitude of Ho, the correct
tapping frequency also depends on H e. It is because the protons absorb energy of a
particular magnitude when flipping to their higher-energy state that this technique is a
form of spectrometry.

But what makes this energy absorption a function of chemical structure? Since
the nuclei of atoms are surrounded by orbiting electrons, and since these moving
charges set up magnetic fields counter to that of the applied field Ho, the electrons
shield the protons from the effects of H,, and HI. The effectiveness of the shielding
depends on the details of the motion of the electrons. But these motions in turn de-
pend on the atoms present (in particular whether an atom has an even or an odd num-
ber of electrons), and on the type of bonding, since bonding is effected by sharing of
orbital electrons in complex ways.

The result is that shifts in absorption frequency with respect to a fixed standard
compound enable the detection of certain substructures in an unknown compound,
which, again, is the information needed to help interpret mass spectra. The first NMR
techniques to be developed detected hydrogen nuclei (protons). In particular, NMR
can be used to determine the number of carbon-bonded protons (hence the number of
methyl radicals) in a compound, and also the number of nitrogen-bonded protons. It is
now possible to gather information about the nuclei 2H, l1 B, l3 C, is N, 29 Si, and " P.

2.7 LIBRARY SEARCH

With each of the spectroscopic methods just discussed, a standard method of interpre-
tation is to compare the spectrum of the unknown compound against a library of spec-
tra of known compounds [McLafferty and Venkataraghaven (1978) Heller et al.
(1977)] . Because of experimental variables, an exact match is seldom expected. How-
ever, numerous closenessof-fit criteria have been developed to find the "closest"
match to the unknown in the library.

13AntiparaUel means parallel but of opposite polarity.


THE STRUCTURE ELUCIDATION PROBLEM OF ORGANIC CHEMISTRY 27

A library of mass spectra is routinely checked as part of the data acquisition sys-
tem used to collect spectra for Stanford University chemists and for DENDRAL. The
spectra found in the library do not require further interpretation.

2.8 SUMMARY

We have described the structure elucidation problem, which is ubiquitous in modern
chemistry. In solving such problems, the chemist may have access to useful infor-
mation from many sources, including data from the several powerful analytic methods
just described. Matching new data against libraries is a standard method of structure
identification. However, when new compounds are encountered, as frequently hap-
pens,14 library matching is insufficient and the chemist must interpret the data from
sources such as the ones described here. These various sources of information provide
different types of facts about the structure of the molecule being investigated. All,
however, can be cast in terms of constraints on the connectivity of the molecule's con-
stituent atoms. The chemist thus is faced with a sort of jigsaw puzzle and has to fit to-
gether the various facts into a coherent "ball-and-stick" picture of the molecule.

14New chemical compounds are discovered at the rate of about 100,000 per year.


CHAPTER
THREE

ARTIFICIAL INTELLIGENCE

Artificial intelligence is that part of computer science that studies computational
methods for complex symbolic (not necessarily numerical) problem solving. Such
mechanization of symbolic reasoning stands in marked contrast to traditional formal
methods of problem solving used in science and mathematics. The major approach of
artificial intelligence is heuristic programming, which replaces exhaustive enumeration
of cases with selective consideration of alternatives. DENDRAL applies a specific
heuristic programming paradigm to the structure elucidation problem and to the task
of hypothesis formation,

3.1 INTRODUCTION

The DENDRAL Project spans approximately half the history of artificial Intelligence
(AI) research. This period has been one of great change in computer technology and in
the attitudes, aspirations, and activities of the research community working on prob-
lems of artificial intelligence. To place DENDRAL in the context of its parent disci-
pline so that we may see how it has drawn from and contributed to this development,
we first look at the short history of AI.

The major goal of AI research is a productive understanding of the processes of in-
telligent thought. The major method of AI distinguishes this discipline from others
with similar goals. That method is the creation of intelligent artifacts, currently in the
form of computer programs. As yet the field has little of what could be called formal
theory, and thus to some it appears to be a curious gallimaufry of hardware technol-
ogy, software packages, programming tricks, specialized problem-solving procedures,
information representation schemes, human intuition, examples of things that do not
work, game-playing strategies, mathematical theorems, debugging techniques, primitive

28


ARTIFICIAL INTELLIGENCE 29

robots, and endless specialized knowledge at many levels of abstraction. A closer look
reveals, we believe, an emerging discipline with a measure of cohesiveness of concepts
and techniques.

In its first decade (approximately 1954-1964) AI was characterized by enthusi-
asm and optimistic forecasts of the imminent solution of many problems of psychol-
ogy, linguistics, mathematics, philosophy, technology, and management. By the end of
the decade, when DENDRAL was in its initial stages, these optimistic forecasts were
being reevaluated. The now classic example of unfulfilled forecast is mechanical trans-
lation of natural languages. This and most other problems outside previously formal-
ized domains have proved far more difficult than many AI pioneers imagined. From
the vantage point of perfect hindsight it seems remarkably bold to have forecast im-
mediate solutions to problems with which other disciplines had struggled for decades
or centuries. But from the less humble perspective of a young idea, the possibilities did
indeed look promising. Many of the abilities to be automated were, after all, common-
place things done by ordinary people. Why, every five-year-old can speak at least one
language! Technology had brought us from horseback to supersonic flight, from pony
express to satellite video links, and from steam engine to atomic energy in less than a
century. With that acceleration and the newfound power of computation, solutions to
the problems of human thought, though they had a long history, might well have been
just around the corner.

In the mid-1960s AI was in a transition stage. On the one hand the newly dis-
covered difficulty of the adopted problems was tempering optimism and in some quar-
ters producing pessimists. Long-standing critics of determinism in general, and technol-
ogy in particular, were coming out of the closet. `On the other hand, some work on
general problem-solving procedures still held promise in the view of many researchers.
The General Problem Solver (GPS) [Ernst and Newell (1969)] had yet to have its
limitations established. A bright light was the resolution procedure [Robinson (1965)]
for proving theorems in the predicate calculus: a complete, uniform proof procedure
for a general calculus seemed promising indeed. Ironically, the search for general
problem-solving methods was being pursued on a broad front at the same time that
specific solutions to special problems were failing to produce results.

A second aspect of this transition stage was the astoundingly rapid development
of computer technology. Solid-state, second-generation hardware was replacing the
slower, less reliable equipment. Telecommunications technology was being interfaced
with computers on a large scale. Time-sharing of computers had been conceived and
was to become a reality in the 1960s. Software in general and executive systems
in particular were reaching new levels of sophistication. List-processing and string-
processing languages were becoming readily available. These developments combined,
in the early 197Os, into facilities that eclipsed in power those available 10 years earlier.
Today's student using a high-level language on an interactive terminal is interminably
amused by tales of the days when a programmer would carry a box of punched cards
to a computing center and return some days later only to find that a bug in the com-
piler, a mispunched control card, or an operator error had terminated the job. Although
none of today's wealth of computer sophistication would have struck the early workers
as science fiction beyond their dreams, the additional load imposed by the bothersome


30 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

conditions of the time were enough to swamp many well-conceived projects of realistic
scope.

It was in this milieu that DENDRAL began. An important fact about DENDRAL,
though not unique to it, is that it undertook a relatively narrow and well-defined prob-
lem for which there was a clear measure of success. To this problem it applied specific,
task-directed methods and knowledge. The major lesson DENDRAL has for artificial
intelligence, and for those disciplines interested in the application of AI techniques, is
that it is possible to select problems of modest complexity that nonetheless baffle the
novice, and to reduce these problems to some order, resulting in a problem-solving sys-
tem that lends needed assistance to human intelligence. By lowering one's sights from
solving broad, general problems to solving a particular problem, by applying as much
specific knowledge to that problem as can be garnered from human experts, and by
systematizing and automating the application of this knowledge, a useful system can
be produced.

3.2 PROBLEM-SOLVING METHODS

We use problem solving as a generic term for a broad class of cognitive activities inves-
tigated by AI. Other terms would do as well and many have been used in that capacity
from time to time. The field is not yet plotted sufficiently well to draw sharp distlnc-
tions between question answering, information retrieval, pattern recognition, intelli-
gence engineering, concept formation, learning, induction, abstraction, hypothesis
formation, or any of a number of other processes that have been suggested simultane-
ously as manageable subproblems and exhaustive paradigms. We rather arbitrarily prefer
our unassuming generic term, What we embrace under the problem-solving label is a
specific set of programs, real and imagined, that have been produced or proposed by
AI researchers.

Digital computers are most naturally suited for manipulating finite data structures
composed of tokens from a finite alphabet of discrete symbols. The simplest such data
structures are numbers. Formulas of a formal language are a more general and relatively
common example. Arbitrarily complex graph structures are frequently manipulated by
AI programs. For a machine that deals only with such objects, we must define problem
and problem soZving in terms of finite structures and transformations on them. In gen-
eral, problem solving may be thought of as taking place in a problem space whose
points, called problem states, are defined in a language for representing data structures
[Nilsson (197 l)] . Goals are distinguished problem states, and solving a problem means
locating a goal state. Accordingly, we introduce the following problem-solving para-
digm in order that we may properly characterize the DENDRAL problem-solving
methods.

(1) A problem-state Zanguage is a formal language that defines a class of data struc-
tures constructed from discrete symbols. Each expression in such a language defines a
potential problem state. (2) There are transformations that are rules for changing one
problem state into another. Together, the set of problem states and transformations
determine a problem space whose connectivity is defined by the transformations.


ARTIFICIAL INTELLIGENCE 3 1

(3) A goal sfate is a distinguished problem state. (4) An initial Gate is a distinguished
problem state; any problem state may serve as an initial state if it is assumed that it can
be reached (constructed) a priori. (5) The space may or may not have other properties.
For example, it may have a metric defined on it; it may be dense, it may be contin-
uous, and so forth. (6) There may be one or more secondary problem-state languages
in which descriptions of the states can be expressed. These descriptions are in terms
other than those that directly define the connectivity of the space, sometimes in a
well-constructed language of abstractions. (For example, in chess, piece advantage is a
description that is not a defining characteristic of board configurations or legal moves.)
Transformations may or may not be defined for these languages. (7) A problem solver
is a procedure that attempts to find one or more goal states.

Though it cannot be shown that this conception of problem solving encompasses
all problem-solving activities, it is in fact very general. Most board games readily fall
into this scheme: initial states are board configurations, the legal moves define changes
in board configurations, and goal states are positions that meet certain formally de-
fined critieria. A player qua problem solver seeks a sequence of moves that takes him
from initial position to a win. Theorem proving is problem solving that seeks a path
of legal inferential steps from axioms to theorem. Symbolic integration and simi-
lar formal mathematics is a matter of finding a sequence of legal transformations that
lead one from integrand to integral, from equation in unknown x to an expression de-
fining the value of x.

Finding the maximum of a function is a search through the continuous metric
space defined by the variables, looking for a point at which the function has its
greatest value. Repair of a television set requires finding a set of realizable modifica-
tions that will convert the set that malfunctions in a particular way (the initial state)
into a functioning set (the goal state). Finding a misplaced object involves thinking of
all places it might be and looking at each one (no initial state); the goal state is the
place where the object is. Building a house is a problem of finding a sequence of pos-
sible building activities, defined by the functions of the available tools, that leads from
a pile of materials to a house-shaped arrangement of materials. Science as problem
solving is the search through the space of possible explanations to find one that meets
criteria of parsimony, empirical validity, and usefulness; the grammar of a formal or
natural language defines the space of possible explanations.

However, simply because a problem can be seen to fit the general paradigm as
we have defined it does not mean that seeing it in this light is helpful. Carpenters would
find our analysis of their problem of little use. Scientists would find the above formu-
lation of their problem a poor characterization of their own activity.
Furthermore, an intuitively conceived problem can always be forced into the para-
digm in a number of ways and the representation chosen will often make the differ-
ence between trivial and impossible. We know of no nontrivial exceptions to the claim
that all AI problem-solving approaches have finessed this representation problem by
leaving it to the human programmer/scientist.

Nonetheless there are many problems that fit naturally into the paradigm, and
for which an appropriate representation is available. For these it is yet necessary to de-
fine the methods of exploring the space. A number of them have been studied. The


32 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

analysis of these methods and the related problems comprises an important part of AI
theory. It will be clear that different problem-solving strategies are appropriate for dif-
ferent problems.

3.2.1 Nouheuristic Methods

Random exploration This method is random selection of problem states (with replace-
ment); the probability of selection is uniformly distributed over the set of accessible
states. For large spaces the random procedure is a last resort. It may however be the
best strategy for some problems, such as finding a cross-eyed tiger in the jungle or
looking for an adaptive mutation. For difficult problems this method offerslittle hope,
and, in general, effective problem solving requires the use of additional knowledge. A
variation on random search is to employ a nonuniform probability distribution that
makes use of some knowledge about the distribution of solutions.

Systematic exhaustive exploration Searching the space exhaustively and nonredun-
dantly (i.e., without replacement), is superior to random search if the memory and
time costs of the additional computation for record keeping are not excessive. It is the
method of choice for finding needles in a haystack. However, in some cases this proce-
dure may work less well than random search if the system of searching tends to con-
fine activity to a localized region of a large space.

Algorithmic methods An algorithm for a class of problems is a procedure that is guar-
anteed to find a solution to any problem in the class if a solution exists (this property
is called completeness), that will indicate that no solution exists when that is the case,
and in either case will terminate in finite time. For some classes of problems it is pos-
sible to construct an algorithm based on systematic exhaustive exploration. However,
"good" algorithms generally do not naturally fall into the paradigm of problem-space
exploration because there is a directness and efficiency about their discovery methods.
For example, in differentiating a polynomial there is no explicit consideration of the
space of all polynomials; the correct one is "computed directly" from the given expres-
sion. On the other hand, collecting terms and simplifying the answer after differentia-
tion clearly has the character of choosing among possible transformations and con-
sidering alternatives in search of the one that meets certain criteria of, for example,
simplicity.

3.2.2 Heuristic Methods

Cousins to algorithmic methods are heuristic methods. A heuristic program for a class
of problems is usually defined as one that does not guarantee a solution to every prob-
lem in the class, or that has no known bounds to its inefficiency. We hope these liabil-
ities are offset by a measure of efficiency in solving interesting and important members
of the problem class.

Heuristic programs characteristically have the flavor of exploration that is suggested


ARTIFICIAL INTELLIGENCE 33

by our problem-solving paradigm. In addition, however, the exploration is selective
rather than exhaustive.

We distinguish two types of problem-space exploration that we call search (not to
be confused with exploration in general) and generation. Search is the production and
examination of problem states. Generation is the production and examination of can-
didate solutions.

3.2.2.1 Heuristic search Those search procedures whose performance on a class of
problems cannot be guaranteed, either as to completeness or as to cost, but that make
use of knowledge of the problem space over and above its abstract definition, are
called heuristic search procedures. They are of many varieties, characterized by the
kind of additional knowledge of the problem space on which they attempt to capitalize.

Statistical Our paradigm permits that problem states may sometimes be characterized
by certain properties or features, stated in what we have called secondary problem-
state languages, that add a new set of dimensions to the space independent of the de-
fining transformations and formulas. When such problem-state descriptors exist, par-
ticular features of the initial states might be associated for some reason with particular
features of the goal states for problems of interest. Statistically guided search attempts
to capitalize on this situation, either by employing known associations or searching for
some.

Hill climbing Hill-climbing methods (1) select a point in the space, (2) search in the
local area of that point for the direction that maximizes a gradient, and (3) move in
the direction of maximum gradient to a new point where the process is repeated. The
name derives from situations in which the problem is to find the maximum of a con-
tinuous function of one or more real variables. In the case of a continuous function of
two variables, the plot of the function is a surface and the problem is to find the peak
of the highest hill on that surface. By moving in the direction of steepest ascent (readily
determined if the function is differentiable), the search climbs to the top of the near-
est hill. The strengths and weaknesses of this method are readily apparent from this
image. Local maxima (peaks and mesas) capture the climber who can not descend to
find a higher hill. Methods to select starting points are crucial, therefore, and it is ad-
visable to use more than one starting point. Also critical is the step size: too small is in-
efficient and too large may step the climber past the peak, so it may be wise to vary
step size as a function of the current position and the selected gradient. Likewise one
cannot afford to compute gradients in all directions, so selection is necessary here
too.

Abstraction planning It may be possible to take a coarser view of the problem space,
as though we could back off and see the general features while omitting the details.
This is one form of planning (a different form than embodied in Heuristic DENDRAL,
to be described shortly). We will call it abstraction to keep the terminology clear.

In the terms of our paradigm of problem solving, abstraction can be achieved by
defining a new set of problem-state descriptions, based on a language that is an abstrac-


34 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

tion of the basic language in the sense that one problem-state description in the ab-
straction language corresponds to many problem-state descriptions in the basic lan-
guage. The new view of the problem space now offers a diminished set of states and
therefore reduces the complexity of the problem. Transformations for the abstraction
language defme the connectivity of the abstracted space. If the problem solver can
discover a path from initial state to goal state in the abstracted space, he has not
solved the original problem but has established a plan. Each step of the plan then be-
comes a problem in the original space, but the combined complexity of all these prob-
lems may be less than the complexity of the original problem.

Working backward For some problems the number of alternatives to be searched is
fewer if we begin at the goal state and, running the transformations in reverse as it
were, search for the initial state. This situation might be the case if there is only one
goal state but a multitude of initial states. Working backward is a time-honored proce-
dure in mathematics and logic. Of course it is of no use for problems in which the
transformations are not reversible, or when the definition of goal state is in terms to
which the transformations cannot apply, as with chess. One would be hard put to play
chess by working backward from a definition of checkmate, looking for the initial
board configuration.

3.2.2.2 Heuristic generation  Generate and test If there is a procedure that can gen-
erate candidate solution, goal states in our present terminology, it may be possible to
solve problems by the sequential enumeration and checking of potential solutions.
This method is frequently called generate and test. Note that in this paradigm it is not
the states of the problem space that are generated. Indeed there need not be a problem
space of the sort we have been discussing. Here we need only a space of solutions that
can be generated for consideration. This paradigm is thus fundamentally different
from searching the space of problem states (state-space search).

Analogs of the heuristic search methods described above apply to heuristic genera-
tion. Statistical information concerning the distribution of solutions (perhaps by cate-
gories defined in a "secondary solution description language") may be used to guide
generation, If some measure of goodness is computable from a proposed solution, then
a hill-climbing procedure could be used to determine ways of modifying one proposal
in appropriate ways. Similarly, if an abstracted description of, the set of solutions can
be constructed, it may be possible to search first for the'correct solution class, and
then search within that class.

These methods do not exhaust the possibilities, but they provide enough structure
for our discussion.

3.2.3 Multiple Sources of Knowledge
Much more problem-solving power can be achieved if there is more than one source of
information that can be used. For this reason purely syntactic problem solvers are in-
herently less powerful than those that employ semantic information as well. The secret


ARTIFICIAL INTELLIGENCE 35

is not that semantic information is more important, but that two sources of guidance
are better than one.

Jigsaw puzzles are an appropriate image to make this procedure clear. The prob-
lem of finding the one arrangement of all the pieces that yields the desired picture may
be a very difficult and large combinatorial task. If the puzzle were done with the
pieces face down, analogous to having only the "syntactic" information of piece con-
tours, the true difficulty of the problem would become apparent. If all the pieces were
of the same shape, squares or hexagons, the problem could only be solved from the
"semantic" information of colors and pictured objects and would also be very difficult.
Jigsaw puzzles are tractable because both these sources of information are available
and can be played off against one another.

In terms of the paradigm of state-space search, different sources of information
correspond to different problem-state languages. Several of the search heuristics
defmed above rely on these secondary languages. Hill climbing needs a language in
which to define its gradient of "warmth," and statistically guided search is based on a
rather general but blurry-visioned search for descriptors that have some correlational
information. Abstraction planning is another way of bringing to bear different views of
the problem space.

On a more general level, apart from any of these methods, is the representation
problem. A problem has in general many possible representations. It may be possible
to choose two or more (rather than just one) in such a way that progress in one state-
space search can be transferred to another. Thus those transitions that are difficult in
one representation may be bypassed by using a second and vice versa.
In the context of heuristic generation, multiple sources of knowledge have the ef-
fect of limiting generation to the intersection of the solution sets delimited by each
source.

3.3 DENDRAL

DENDRAL is not a single program but a set of programs. Some of these programs may
be used alone to perform single subtasks of importance to the problem of chemical
structure elucidation. Some may be linked in various ways by different executive pro-
grams to form coherent systems for doing larger tasks. To organize the description of
this collection of intertwined programs we first note that they comprise basically two
systems. The first, called Heuristic DENDRAL, is a system that incorporates specific
knowledge of chemistry and mass spectrometry, accepts a mass spectrum and other ex-
perimental data from an unknown compound as input, and produces an ordered set of
chemical structure descriptions hypothesized to explain the data. The second system,
called Meta-DENDRAL, accepts known mass spectrum/structure pairs as input and at-
tempts to infer the specific knowledge of mass spectrometry that can be used by
Heuristic DENDRAL to explain new spectra. Heuristic DENDRAL is a performance
system and Meta-DENDRAL is a learning system.

The following chapters describe these two systems. It must be kept in mind that
each has evolved over many years; in fact each is being continually revised. The de-


36 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

scriptions here are somewhat idealized expositions of the programs as they exist at this
writing. Earlier versions, described in other publications, were used to produce many
of the results summarized later. No single version has been systematically applied to all
the specific structure elucidation problems investigated by the DENDRAL project.

Naturally, neither Heuristic DENDRAL nor Meta-DENDRAL was developed by
following a detailed blueprint established in advance. The design process inevitably is
one of trial and error and revision. The descriptions that follow organize these pro-
grams around conceptual paradigms that themselves are products of the development
process. Early systems, and earlier publications, were conceived less clearly and de-
scribed in somewhat different terminology, although the current vision, in retrospect,
encompasses these earlier designs.

Two important features of the DENDRAL system characterize it and set it apart
from most other AI systems. The first is the basic organization of the problem-solving
method, which we have called the plan-generate-test paradigm. The second is the fact
that it incorporates and gains its heuristic power from considerable task-specific knowl-
edge overlaid on a general syntactic method; we call DENDRAL a knowledge-based
system for this reason.

3.3.1 The Plan-Generate-Test Organization of DENDRAL

The basic method of both Heuristic DENDRAL and Meta-DENDRAL is an important
extension of the generate-and-test paradigm. The heart of this paradigm is a generator.
This is a program that enumerates for a particular problem its potential solutions, which
are expressed as chemical graphs in the case of DENDRAL. It is often desirable,
though not essential to the paradigm, for the generator to be exhaustive and nonredun-
dant, that is, that it guarantee that every possible solution will be enumerated exactly
once. The Heuristic DENDRAL generator has these properties. The Meta-DENDRAL
generator does not, since the set of all possible solutions is not well defined.

When there are a large number of candidate solutions, success will be rare unless
we can limit generation to the most likely candidates. DENDRAL's way of limiting
generation is with a planning program that can suggest constraints on generation. This
component distinguishes plan-generate-test from generate and test. Constraints may
take the form of ruling out large sets of candidate solutions or suggesting exhaustive
search over limited classes of solutions, or both.

The DENDRAL planner is a hypothesis-formation program that employs task-
specific knowledge to find constraints for the generator. It is important that the plan-
ner be extremely flexible in the sense of permitting the ready addition of new knowl-
edge. Ideally, the knowledge will be highly modular so that it is possible to add new
knowledge without reevaluating the old. A key feature of the plan-generate-test para-
digm is the interface between planner and generator: the output of the planner must
be in a form appropriate to the language of the generator.

In DENDRAL, having narrowed the search space by planning, the generator pro-
ceeds to produce all and only those solutions consistent with the plan. Typically this
set of solutions, though much smaller than the entire space, will be undesirably large.
Further selection is performed by the third and final stage, the tester. This is a pro-


ARTIFICIAL INTELLIGENCE 37

gram that examines each proposed solution and rejects those that fail to meet certain
criteria. The tester incorporates a theory of mass spectrometry that predicts what frag-
mentations a proposed chemical structure will undergo in a mass spectrometer and
constructs a mass spectrum accordingly. This predicted spectrum may then be com-
pared to the one produced in the laboratory. The DENDRAL tester programs are
usually referred to as PREDICTOR programs because of their special form.

Both a planner and a tester are programs for constraining the set of likely solutions.
It might be thought that it is much more economical to apply constraints first, in the
planning stage, rather than last, in the testing stage. In some measure this is true, and
every effort is made to preconstrain the generator. However, preconstraint is not al-
ways possible nor desirable, as we shall see in detail later.

The feature that gives the plan-generate-test paradigm its cohesiveness is the uni-
form representation used by the three components. In the case of DENDRAL this rep-
resentation is chemical graphs. The planner devises hypotheses that reject and/or pro-
pose certain classes of chemical graphs, the generator generates chemical graphs, and
the tester represents fragmentation processes in terms of chemical graphs. This common
representation is the glue holding DENDRAL together.

Uniform representation plus the plan-generate-test paradigm are the keys that
permit multiple sources of knowledge to be brought to bear within the generate-and-
test method. The ways in which generation is constrained may be of fundamentally
different types. In fact in the case of DENDRAL, the knowledge from which con-
straints derive may be from any source as long as it can be translated into appropriate
constraints on graph generation. DENDRAL's power derives in large part from this
ability.

DENDRAL is a particular instantiation, or rather several particular instant&ions,
of the plan-generate-test paradigm. Numerous variations are possible. The paradigm is
still applicable and potentially powerful even in the absence of a nonredundant or a
nonexhaustive generator. If the space of solutions is not large, either the planner or
tester may be omitted. Without either the planner or tester the generator alone may
still provide useful information by providing a measure of the size of the set of pos-
sible solutions to a problem, or a relative measure of the difficulty of two problems.
Further, the generator may be used in conjunction with a human problem solver if the
human is able to define the constraints. This is the case with CONCEN, the CONstramed
GENerator program, described in Chapter 4. Many variations on this theme are
possible.

3.3.2 Knowledge Engineering

We have noted that specific knowledge is used by DENDRAL to constrain the genera-
tion of solutions and to test proposed solutions. The plan-generate-test paradigm does
not require this approach, and certainly other paradigms reject it. As we noted earlier
in this chapter, many of the early AI projects, as well as other approaches to a theory
of intelligence, have sought general problem-solving methods by following the model
of other sciences that have achieved their power from the discovery of general prin-
ciples. Clear examples from AI are the attempts to apply resolution, a uniform proof


38 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

procedure for predicate calculus, to the development of general question-answering
and problem-solving systems [e.g., Green (1969)] . In these efforts, questions or prob-
lems are translated into proposed theorems in the predicate calculus and a resolution
theorem prover attempts to prove these theorems; the proof is then the basis for an
answer or solution. The General Problem Solver (GPS) is an attempt to discover gen-
eral methods that will solve a large class of problems with************************** 381.260000 8.892067+1 381.280000 8.724986+16637 3  1 1087
 381.380000 8.030393+1 381.460000 7.497779+1 381.500000 7.279290+16637 3  1 1088
 381.640000 6.551799+1 381.680000 6.376051+1 381.800000 5.876703+16637 3  1 1089
 381.860000 5.664227+1 382.000000 5.191909+1 382.040000 5.077476+16637 3  1 1090
 382.187500 4.672453+1 382.200000 4.639223+1 382.362500 4.282027+16637 3  1 1091
 382.500000 3.992204+1 382.625000 3.777759+1 382.800000 3.491524+16637 3  1 1092
 382.887500 3.372501+1 383.100000 3.095777+1 383.150000 3.040984+16637 3  1 1093
 383.412500 2.764657+1 383.425000 2.751957+1 383.750000 2.476164+16637 3  1 1094
 383.800000 2.435337+1 384.125000 2.217921+1 384.300000 2.105154+16637 3  1 1095
 384.500000 1.999704+1 384.800000 1.847001+1 384.875000 1.814934+16637 3  1 1096
 385.250000 1.659825+1 385.300000 1.639715+1 385.662500 1.518019+16637 3  1 1097
 385.975000 1.416261+1 386.150000 1.368222+1 386.637500 1.238560+16637 3  1 1098
 386.650000 1.235324+1 387.125000 1.130736+1 387.550000 1.040225+16637 3  1 1099
 387.775000 9.992477+0 388.100000 9.419425+0 388.726000 8.351762+06637 3  1 1100
 388.900000 8.067784+0 389.195500 7.620253+0 389.665000 6.944737+06637 3  1 1101
 390.134500 6.316398+0 390.447500 5.933433+0 390.772000 5.577768+06637 3  1 1102
 390.940000 5.424337+0 391.108000 5.252619+0 391.360000 5.052972+06637 3  1 1103
 391.612000 4.924814+0 391.864000 4.901150+0 392.047750 4.980731+06637 3  1 1104
 392.197375 5.132576+0 392.200000 5.137179+0 392.347000 5.416551+06637 3  1 1105
 392.389000 5.541487+0 392.483500 5.840836+0 392.496625 5.885445+06637 3  1 1106
 392.578000 6.268986+0 392.596375 6.360994+0 392.641000 6.654278+06637 3  1 1107
 392.688250 6.978762+0 392.696125 7.035519+0 392.735500 7.398537+06637 3  1 1108
 392.767000 7.700337+0 392.773563 7.765579+0 392.798500 8.080633+06637 3  1 1109
 392.830000 8.492343+0 392.856250 8.849340+0 392.861500 8.938054+06637 3  1 1110
 392.893000 9.490643+0 392.911375 9.824734+0 392.914000 9.882113+06637 3  1 1111
 392.945500 1.059466+1 392.966500 1.108937+1 392.969125 1.116474+16637 3  1 1112
 392.998000 1.202449+1 393.025563 1.288424+1 393.028188 1.298268+16637 3  1 1113
 393.055750 1.406186+1 393.071500 1.470567+1 393.079375 1.508625+16637 3  1 1114
 393.103000 1.627149+1 393.120063 1.717020+1 393.134500 1.806569+16637 3  1 1115
 393.158125 1.959964+1 393.164688 2.004578+1 393.184375 2.159221+16637 3  1 1116
 393.204325 2.324079+1 393.215875 2.432561+1 393.238975 2.660707+16637 3  1 1117
 393.243438 2.710348+1 393.271000 3.031296+1 393.273625 3.063598+16637 3  1 1118
 393.304075 3.482515+1 393.308275 3.543786+1 393.337150 4.016309+16637 3  1 1119
 393.346600 4.180232+1 393.371800 4.674526+1 393.388600 5.024353+16637 3  1 1120
 393.409600 5.519176+1 393.430600 6.044257+1 393.447400 6.516849+16637 3  1 1121
 393.472600 7.269275+1 393.489400 7.829737+1 393.514600 8.723189+16637 3  1 1122
 393.533500 9.465939+1 393.556600 1.042851+2 393.577600 1.139019+26637 3  1 1123
 393.598600 1.240561+2 393.621700 1.364742+2 393.661600 1.589944+26637 3  1 1124
 393.665800 1.616374+2 393.724600 2.005022+2 393.783400 2.448915+26637 3  1 1125
 393.787600 2.482107+2 393.871600 3.195779+2 393.905200 3.488256+26637 3  1 1126
 394.031200 4.586198+2 394.039600 4.656204+2 394.115200 5.204908+26637 3  1 1127
 394.136200 5.344495+2 394.182400 5.581818+2 394.211800 5.711012+26637 3  1 1128
 394.249600 5.819046+2 394.274800 5.867476+2 394.300000 5.889258+26637 3  1 1129
 394.327300 5.879526+2 394.375600 5.811610+2 394.405000 5.722227+26637 3  1 1130
 394.442800 5.573612+2 394.468000 5.441220+2 394.512100 5.177254+26637 3  1 1131
 394.543600 4.955317+2 394.594000 4.567268+2 394.652800 4.078980+26637 3  1 1132
 394.791400 2.891839+2 394.795600 2.858279+2 394.871200 2.273961+26637 3  1 1133
 394.883800 2.185103+2 394.938400 1.818520+2 394.942600 1.792855+26637 3  1 1134
 394.988800 1.523961+2 394.993000 1.501699+2 395.039200 1.271075+26637 3  1 1135
 395.056000 1.195549+2 395.089600 1.053781+2 395.098000 1.021666+26637 3  1 1136
 395.125825 9.210160+1 395.140000 8.741797+1 395.164675 7.973126+16637 3  1 1137
 395.182000 7.484147+1 395.203525 6.913189+1 395.224000 6.423292+16637 3  1 1138
 395.242375 6.011197+1 395.266000 5.535075+1 395.281225 5.248078+16637 3  1 1139
 395.308000 4.795930+1 395.320075 4.606982+1 395.358925 4.064160+16637 3  1 1140
 395.360500 4.044383+1 395.397775 3.618460+1 395.413000 3.462511+16637 3  1 1141
 395.436625 3.241819+1 395.465500 3.006475+1 395.494900 2.787716+16637 3  1 1142
 395.518000 2.641345+1 395.553175 2.437941+1 395.570500 2.351919+16637 3  1 1143
 395.611450 2.166207+1 395.623000 2.119814+1 395.650300 2.021123+16637 3  1 1144
 395.701750 1.858842+1 395.728000 1.784906+1 395.774125 1.677062+16637 3  1 1145
 395.820250 1.579762+1 395.843313 1.539153+1 395.912500 1.429023+16637 3  1 1146
 396.004750 1.323028+1 396.050875 1.276403+1 396.097000 1.240214+16637 3  1 1147
 396.159109 1.198532+1 396.186438 1.184877+1 396.275875 1.149147+16637 3  1 1148
 396.283328 1.146846+1 396.355375 1.136668+1 396.407547 1.133234+16637 3  1 1149
 396.415000 1.134001+1 396.474625 1.144155+1 396.524313 1.155877+16637 3  1 1150
 396.531766 1.158089+1 396.569031 1.176582+1 396.613750 1.201552+16637 3  1 1151
 396.638594 1.216713+1 396.673375 1.239667+1 396.675859 1.241911+16637 3  1 1152
 396.713125 1.277972+1 396.757844 1.324713+1 396.795110 1.366858+16637 3  1 1153
 396.802563 1.376002+1 396.839829 1.432649+1 396.881566 1.500841+16637 3  1 1154
 396.920322 1.568816+1 396.927775 1.582791+1 396.953613 1.640703+16637 3  1 1155
 396.995350 1.740219+1 397.037088 1.847334+1 397.041063 1.858422+16637 3  1 1156
 397.082800 1.995012+1 397.130500 2.164605+1 397.154350 2.257712+16637 3  1 1157
 397.178200 2.364060+1 397.217950 2.556615+1 397.229875 2.619394+16637 3  1 1158
 397.257700 2.782775+1 397.297450 3.036130+1 397.305400 3.091589+16637 3  1 1159
 397.337200 3.340162+1 397.372975 3.644299+1 397.384900 3.754899+16637 3  1 1160
 397.408750 4.000183+1 397.444525 4.400946+1 397.480300 4.881586+16637 3  1 1161
 397.504150 5.232897+1 397.516075 5.426116+1 397.551850 6.060742+16637 3  1 1162
 397.563775 6.293978+1 397.587625 6.805645+1 397.623400 7.649998+16637 3  1 1163
 397.659175 8.671399+1 397.683025 9.422903+1 397.694950 9.835174+16637 3  1 1164
 397.730725 1.119526+2 397.742650 1.169617+2 397.766500 1.278896+26637 3  1 1165
 397.802275 1.459205+2 397.838050 1.674865+2 397.861900 1.830216+26637 3  1 1166
 397.909600 2.198551+2 397.921525 2.302270+2 397.957300 2.635626+26637 3  1 1167
 397.977175 2.842645+2 398.005000 3.150735+2 398.030838 3.468025+26637 3  1 1168
 398.052700 3.751627+2 398.084500 4.205290+2 398.100400 4.445357+26637 3  1 1169
 398.148100 5.229710+2 398.156050 5.373757+2 398.219650 6.584224+26637 3  1 1170
 398.227600 6.750222+2 398.291200 8.133257+2 398.323000 8.882806+26637 3  1 1171
 398.434300 1.154189+3 398.525725 1.371070+3 398.561500 1.449930+36637 3  1 1172
 398.633050 1.588537+3 398.644975 1.609121+3 398.704600 1.692770+36637 3  1 1173
 398.708575 1.697503+3 398.776150 1.752639+3 398.780125 1.755277+36637 3  1 1174
 398.800000 1.760063+3 398.845713 1.764460+3 398.865588 1.759135+36637 3  1 1175
 398.895400 1.745082+3 398.931175 1.714384+3 398.974900 1.668285+36637 3  1 1176
 399.010675 1.616526+3 399.046450 1.558204+3 399.118000 1.421385+36637 3  1 1177
 399.340600 9.268007+2 399.384325 8.340192+2 399.436000 7.332704+26637 3  1 1178
 399.471775 6.670348+2 399.499600 6.202792+2 399.537363 5.600092+26637 3  1 1179
 399.563200 5.228033+2 399.602950 4.684362+2 399.610900 4.587654+26637 3  1 1180
 399.658600 4.035206+2 399.668538 3.925431+2 399.706300 3.559123+26637 3  1 1181
 399.730150 3.339243+2 399.754000 3.146351+2 399.789775 2.872171+26637 3  1 1182
 399.801700 2.792163+2 399.849400 2.489621+2 399.897100 2.240152+26637 3  1 1183
 399.909025 2.180922+2 399.944800 2.026744+2 399.968650 1.929933+26637 3  1 1184
 400.008400 1.792670+2 400.048150 1.664409+2 400.072000 1.600025+26637 3  1 1185
 400.127650 1.459452+2 400.135600 1.442451+2 400.199200 1.314859+26637 3  1 1186
 400.207150 1.299712+2 400.262800 1.212620+2 400.326400 1.118995+26637 3  1 1187
 400.358200 1.081165+2 400.451613 9.774929+1 400.453600 9.756662+16637 3  1 1188
 400.545025 8.966511+1 400.576825 8.704172+1 400.636450 8.300117+16637 3  1 1189
 400.743775 7.611001+1 400.773588 7.453520+1 400.910725 6.771209+16637 3  1 1190
 401.047863 6.246933+1 401.161150 5.832233+1 401.185000 5.762602+16637 3  1 1191
 401.324125 5.373700+1 401.411575 5.139453+1 401.532813 4.874455+16637 3  1 1192
 401.662000 4.605379+1 401.741500 4.469223+1 401.950188 4.127383+16637 3  1 1193
 401.960125 4.111658+1 402.158875 3.853200+1 402.258250 3.728413+16637 3  1 1194
 402.397375 3.585381+1 402.655750 3.330039+1 402.695500 3.299302+16637 3  1 1195
 402.993625 3.078462+1 403.252000 2.893255+1 403.291750 2.871487+16637 3  1 1196
 403.490500 2.765729+1 403.888000 2.559907+1 404.365000 2.372647+16637 3  1 1197
 404.524000 2.312134+1 404.842000 2.218390+1 405.319000 2.081925+16637 3  1 1198
 405.478000 2.037461+1 405.796000 1.970708+1 406.432000 1.840712+16637 3  1 1199
 406.591000 1.808928+1 407.028250 1.739456+1 407.386000 1.683764+16637 3  1 1200
 407.624500 1.654331+1 408.419500 1.558427+1 408.976000 1.492605+16637 3  1 1201
 409.214500 1.471702+1 410.049250 1.400048+1 410.923750 1.326169+16637 3  1 1202
 411.122500 1.309597+1 411.798250 1.266306+1 413.110000 1.183667+16637 3  1 1203
 413.269000 1.173811+1 414.421750 1.117333+1 415.733500 1.054185+16637 3  1 1204
 416.886103 9.995078+0 417.472000 9.721748+0 418.061577 9.459662+06637 3  1 1205
 419.237052 8.947490+0 420.118657 8.572388+0 421.000263 8.207716+06637 3  1 1206
 421.084000 8.174177+0 421.588000 7.929036+0 422.260000 7.612270+06637 3  1 1207
 422.764000 7.385619+0 422.932000 7.288074+0 423.436000 7.008915+06637 3  1 1208
 423.940000 6.745540+0 424.164000 6.637608+0 424.402000 6.483653+06637 3  1 1209
 424.780000 6.257272+0 425.004000 6.136163+0 425.158000 6.022862+06637 3  1 1210
 425.536000 5.774564+0 425.844000 5.605949+0 425.914000 5.551880+06637 3  1 1211
 426.166000 5.388554+0 426.390000 5.275337+0 426.446000 5.234075+06637 3  1 1212
 426.677000 5.106021+0 426.908000 5.029418+0 426.936000 5.028572+06637 3  1 1213
 427.139000 4.978591+0 427.300000 5.006267+0 427.370000 5.008844+06637 3  1 1214
 427.573000 5.128664+0 427.720000 5.306355+0 427.867000 5.588047+06637 3  1 1215
 427.888000 5.648465+0 428.014000 6.032606+0 428.042000 6.155876+06637 3  1 1216
 428.147000 6.647728+0 428.161000 6.717926+0 428.217000 7.087555+06637 3  1 1217
 428.259000 7.379446+0 428.273000 7.504515+0 428.315000 7.894914+06637 3  1 1218
 428.336000 8.096110+0 428.374500 8.478229+0 428.378000 8.523032+06637 3  1 1219
 428.420000 9.084038+0 428.456750 9.598845+0 428.474250 9.857184+06637 3  1 1220
 428.493500 1.020263+1 428.518000 1.066080+1 428.540750 1.110632+16637 3  1 1221
 428.553000 1.139297+1 428.579250 1.203534+1 428.603750 1.266056+16637 3  1 1222
 428.616000 1.298980+1 428.635250 1.358710+1 428.658000 1.433290+16637 3  1 1223
 428.665000 1.459955+1 428.693000 1.572118+1 428.719250 1.682968+16637 3  1 1224
 428.728000 1.721983+1 428.743750 1.804180+1 428.770000 1.948343+16637 3  1 1225
 428.781200 2.013644+1 428.798000 2.126161+1 428.821800 2.294445+16637 3  1 1226
 428.834400 2.389137+1 428.851200 2.534098+1 428.880600 2.804521+16637 3  1 1227
 428.887600 2.873802+1 428.912800 3.159004+1 428.940800 3.500468+16637 3  1 1228
 428.946400 3.578808+1 428.980000 4.084289+1 428.994000 4.310628+16637 3  1 1229
 429.008000 4.568295+1 429.036000 5.116358+1 429.047200 5.350371+16637 3  1 1230
 429.064000 5.742115+1 429.089200 6.367112+1 429.092000 6.443607+16637 3  1 1231
 429.125600 7.423232+1 429.131200 7.599121+1 429.159200 8.559416+16637 3  1 1232
 429.173200 9.074976+1 429.192800 9.860745+1 429.215200 1.082175+26637 3  1 1233
 429.226400 1.135024+2 429.260000 1.303963+2 429.271200 1.364046+26637 3  1 1234
 429.293600 1.496377+2 429.327200 1.710226+2 429.344000 1.827023+26637 3  1 1235
 429.383200 2.122651+2 429.394400 2.213938+2 429.439200 2.606838+26637 3  1 1236
 429.444800 2.660007+2 429.495200 3.170092+2 429.520400 3.442691+26637 3  1 1237
 429.562400 3.926894+2 429.596000 4.337282+2 429.629600 4.764057+26637 3  1 1238
 429.764000 6.540559+2 429.842400 7.535943+2 429.856400 7.701514+26637 3  1 1239
 429.920800 8.390770+2 429.932000 8.495777+2 429.999200 9.026219+26637 3  1 1240
 430.007600 9.078826+2 430.066400 9.353972+2 430.100000 9.406309+26637 3  1 1241
 430.149700 9.413892+2 430.175600 9.359898+2 430.234400 9.132739+26637 3  1 1242
 430.245600 9.066526+2 430.318400 8.525521+2 430.321200 8.499764+26637 3  1 1243
 430.413600 7.532384+2 430.424800 7.407329+2 430.632000 4.852023+26637 3  1 1244
 430.671200 4.397714+2 430.724400 3.817959+2 430.772000 3.335521+26637 3  1 1245
 430.786000 3.204427+2 430.833600 2.787528+2 430.836400 2.764779+26637 3  1 1246
 430.895200 2.321587+2 430.954000 1.950093+2 430.956800 1.933685+26637 3  1 1247
 430.993200 1.741327+2 431.018400 1.616509+2 431.032400 1.554319+26637 3  1 1248
 431.071600 1.391914+2 431.080000 1.359351+2 431.110800 1.253437+26637 3  1 1249
 431.141600 1.155900+2 431.164000 1.093117+2 431.203200 9.933192+16637 3  1 1250
 431.214400 9.681127+1 431.264800 8.649918+1 431.315200 7.825097+16637 3  1 1251
 431.332000 7.572454+1 431.365600 7.133141+1 431.399200 6.729244+16637 3  1 1252
 431.416000 6.557194+1 431.466400 6.082981+1 431.500000 5.791876+16637 3  1 1253
 431.533600 5.550222+1 431.600800 5.109700+1 431.668000 4.773792+16637 3  1 1254
 431.735200 4.463311+1 431.752000 4.398944+1 431.836000 4.102557+16637 3  1 1255
 431.869600 3.991364+1 431.920000 3.854768+1 432.046000 3.538002+16637 3  1 1256
 432.071200 3.478888+1 432.172000 3.287804+1 432.272800 3.108834+16637 3  1 1257
 432.298000 3.071470+1 432.466000 2.839366+1 432.480000 2.821254+16637 3  1 1258
 432.655000 2.635230+1 432.760000 2.530548+1 432.844000 2.464465+16637 3  1 1259
 433.033000 2.324799+1 433.180000 2.221387+1 433.222000 2.197563+16637 3  1 1260
 433.439000 2.080689+1 433.460000 2.069918+1 433.712000 1.965020+16637 3  1 1261
 433.964000 1.865382+1 433.985000 1.859091+1 434.258000 1.781481+16637 3  1 1262
 434.440000 1.731529+1 434.720000 1.657223+1 434.804000 1.640572+16637 3  1 1263
 435.224000 1.561438+1 435.476000 1.515852+1 435.644000 1.493279+16637 3  1 1264
 436.064000 1.439127+1 436.484000 1.386665+1 436.596000 1.373062+16637 3  1 1265
 437.044000 1.333034+1 437.520000 1.291807+1 437.716000 1.275274+16637 3  1 1266
 438.234000 1.243484+1 438.948000 1.201035+1 439.564000 1.165267+16637 3  1 1267
 439.662000 1.161143+1 440.376000 1.131823+1 441.272000 1.095790+16637 3  1 1268
 441.412000 1.090254+1 442.112000 1.069900+1 443.372000 1.033978+16637 3  1 1269
 444.103440 1.013488+1 444.632000 1.003136+1 445.892000 9.788789+06637 3  1 1270
 447.152000 9.549352+0 448.481759 9.299435+0 448.626300 9.280513+06637 3  1 1271
 449.680599 9.143700+0 451.789198 8.872903+0 453.897797 8.604647+06637 3  1 1272
 454.319517 8.551364+0 456.006397 8.398997+0 458.114996 8.209988+06637 3  1 1273
 460.223595 8.021981+0 462.091211 7.856317+0 464.440793 7.692940+06637 3  1 1274
 468.778483 7.393669+0 469.862905 7.319239+0 473.116173 7.128335+06637 3  1 1275
 477.453862 6.875052+0 481.791552 6.622962+0 486.038136 6.377493+06637 3  1 1276
 488.869192 6.214622+0 493.115776 5.972053+0 495.946832 5.811967+06637 3  1 1277
 497.902360 5.702551+0 498.070124 5.689988+0 500.193416 5.532553+06637 3  1 1278
 501.608944 5.428723+0 502.900787 5.335431+0 503.732236 5.255806+06637 3  1 1279
 505.280000 5.110240+0 506.540000 4.994113+0 507.080000 4.945572+06637 3  1 1280
 507.800000 4.852157+0 509.060000 4.692845+0 509.900000 4.589766+06637 3  1 1281
 510.440000 4.525649+0 510.740000 4.475442+0 511.610000 4.334722+06637 3  1 1282
 512.120000 4.255636+0 512.285000 4.221042+0 512.960000 4.084772+06637 3  1 1283
 513.635000 3.955432+0 513.800000 3.926090+0 514.310000 3.798406+06637 3  1 1284
 514.910000 3.659218+0 515.060000 3.627495+0 515.360000 3.538613+06637 3  1 1285
 515.810000 3.415757+0 516.080000 3.350341+0 516.260000 3.288629+06637 3  1 1286
 516.710000 3.153024+0 516.980000 3.087180+0 517.160000 3.024699+06637 3  1 1287
 517.550000 2.918605+0 517.580000 2.912952+0 517.842500 2.837310+06637 3  1 1288
 518.135000 2.781189+0 518.180000 2.778377+0 518.427500 2.740204+06637 3  1 1289
 518.630000 2.745169+0 518.720000 2.742260+0 518.922500 2.777449+06637 3  1 1290
 519.125000 2.858469+0 519.327500 3.000172+0 519.380000 3.058285+06637 3  1 1291
 519.530000 3.236136+0 519.560000 3.285378+0 519.665000 3.468352+06637 3  1 1292
 519.672500 3.485755+0 519.747500 3.667334+0 519.822500 3.857116+06637 3  1 1293
 519.843125 3.911814+0 519.878750 4.033499+0 519.935000 4.232927+06637 3  1 1294
 519.972500 4.370715+0 520.010000 4.546352+0 520.055000 4.764035+06637 3  1 1295
 520.100000 4.990570+0 520.101875 5.000447+0 520.145000 5.280952+06637 3  1 1296
 520.178750 5.508595+0 520.214375 5.757692+0 520.231250 5.880283+06637 3  1 1297
 520.245313 6.002588+0 520.283750 6.349550+0 520.317500 6.667670+06637 3  1 1298
 520.355000 7.102781+0 520.388750 7.512780+0 520.415000 7.849648+06637 3  1 1299
 520.430000 8.076910+0 520.460000 8.554528+0 520.497500 9.184196+06637 3  1 1300
 520.535000 9.969433+0 520.574375 1.085022+1 520.580000 1.098608+16637 3  1 1301
 520.613750 1.192970+1 520.649000 1.299407+1 520.655000 1.320379+16637 3  1 1302
 520.685000 1.432380+1 520.715000 1.551505+1 520.718000 1.564246+16637 3  1 1303
 520.745000 1.696280+1 520.778000 1.868808+1 520.787000 1.919777+16637 3  1 1304
 520.814000 2.092647+1 520.838750 2.264404+1 520.850000 2.350814+16637 3  1 1305
 520.883000 2.625265+1 520.886000 2.653013+1 520.916000 2.950901+16637 3  1 1306
 520.937000 3.176029+1 520.952000 3.355647+1 520.988000 3.822655+16637 3  1 1307
 520.991000 3.865044+1 521.024000 4.382005+1 521.045000 4.738963+16637 3  1 1308
 521.060000 5.021769+1 521.096000 5.755356+1 521.099000 5.821674+16637 3  1 1309
 521.132000 6.624009+1 521.153000 7.175441+1 521.168000 7.607989+16637 3  1 1310
 521.192000 8.342965+1 521.207000 8.837924+1 521.240000 1.002421+26637 3  1 1311
 521.261000 1.085259+2 521.288000 1.200943+2 521.318000 1.340348+26637 3  1 1312
 521.330000 1.400812+2 521.372000 1.627779+2 521.378000 1.663118+26637 3  1 1313
 521.435000 2.023095+2 521.438000 2.043856+2 521.498000 2.484959+26637 3  1 1314
 521.540000 2.835366+2 521.582000 3.209307+2 521.624000 3.604947+26637 3  1 1315
 521.690000 4.270783+2 521.732000 4.702547+2 521.870000 6.142647+26637 3  1 1316
 521.936000 6.789798+2 521.966000 7.052411+2 522.026000 7.521697+26637 3  1 1317
 522.047000 7.658601+2 522.110000 7.997137+2 522.128000 8.067465+26637 3  1 1318
 522.182000 8.211213+2 522.200000 8.234462+2 522.242000 8.234176+26637 3  1 1319
 522.281000 8.172351+2 522.332000 8.027164+2 522.356000 7.918753+26637 3  1 1320
 522.413000 7.599321+2 522.437000 7.428877+2 522.524000 6.730407+26637 3  1 1321
 522.536000 6.620037+2 522.674000 5.272005+2 522.770000 4.318211+26637 3  1 1322
 522.806000 3.976847+2 522.869000 3.412646+2 522.902000 3.134299+26637 3  1 1323
 522.935000 2.878656+2 522.992000 2.465601+2 523.010000 2.346268+26637 3  1 1324
 523.052000 2.088475+2 523.073000 1.969895+2 523.112000 1.766248+26637 3  1 1325
 523.136000 1.652077+2 523.172000 1.494718+2 523.199000 1.388136+26637 3  1 1326
 523.232000 1.267333+2 523.241000 1.237756+2 523.283000 1.108270+26637 3  1 1327
 523.292000 1.082412+2 523.340000 9.599785+1 523.352000 9.317791+16637 3  1 1328
 523.394000 8.453509+1 523.422500 7.913160+1 523.448000 7.494595+16637 3  1 1329
 523.493000 6.815654+1 523.502000 6.697757+1 523.556000 6.048397+16637 3  1 1330
 523.563500 5.964671+1 523.610000 5.516632+1 523.634000 5.301848+16637 3  1 1331
 523.664000 5.075161+1 523.736000 4.575637+1 523.739750 4.551611+16637 3  1 1332
 523.808000 4.193516+1 523.845500 4.011332+1 523.880000 3.873620+16637 3  1 1333
 523.970000 3.542740+1 523.986500 3.486215+1 524.060000 3.280650+16637 3  1 1334
 524.127500 3.103975+1 524.150000 3.055837+1 524.285000 2.788414+16637 3  1 1335
 524.339000 2.688689+1 524.420000 2.568361+1 524.555000 2.380601+16637 3  1 1336
 524.735000 2.187173+1 524.780000 2.141889+1 524.937500 2.012539+16637 3  1 1337
 525.080000 1.902782+1 525.140000 1.865038+1 525.342500 1.745103+16637 3  1 1338
 525.380000 1.723916+1 525.545000 1.646498+1 525.680000 1.586126+16637 3  1 1339
 525.777500 1.550906+1 526.070000 1.450996+1 526.190000 1.411924+16637 3  1 1340
 526.362500 1.367928+1 526.655000 1.296737+1 526.700000 1.286179+16637 3  1 1341
 526.947500 1.241430+1 527.240000 1.190514+1 527.465000 1.152547+16637 3  1 1342
 527.540000 1.143025+1 527.990000 1.088200+1 528.320000 1.049513+16637 3  1 1343
 528.440000 1.039096+1 528.890000 1.001553+1 529.340000 9.651510+06637 3  1 1344
 529.520000 9.509650+0 529.865000 9.320826+0 530.540000 8.964310+06637 3  1 1345
 531.215000 8.618183+0 531.320000 8.565517+0 531.890000 8.374681+06637 3  1 1346
 532.340000 8.227293+0 533.240000 7.938507+0 533.720000 7.787641+06637 3  1 1347
 534.080000 7.709176+0 534.920000 7.530007+0 536.180000 7.266481+06637 3  1 1348
 536.186064 7.265236+0 537.440000 7.083031+0 538.700000 6.903139+06637 3  1 1349
 539.960000 6.725605+0 539.984256 6.722224+0 541.404668 6.582117+06637 3  1 1350
 542.849335 6.441349+0 544.775558 6.255659+0 545.048511 6.229570+06637 3  1 1351
 546.701782 6.115800+0 549.591117 5.919215+0 552.480452 5.724713+06637 3  1 1352
 555.369787 5.531870+0 557.715452 5.376640+0 560.061117 5.222706+06637 3  1 1353
 561.624894 5.121131+0 563.188670 5.020720+0 564.752447 4.922004+06637 3  1 1354
 565.010075 4.906102+0 565.925279 4.829145+0 567.098112 4.732484+06637 3  1 1355
 568.118000 4.651067+0 568.464692 4.624406+0 568.832000 4.581764+06637 3  1 1356
 569.546000 4.501324+0 570.260000 4.424397+0 570.736000 4.375818+06637 3  1 1357
 570.872000 4.362800+0 571.212000 4.310042+0 571.688000 4.240282+06637 3  1 1358
 572.164000 4.176196+0 572.232000 4.168017+0 572.521000 4.110597+06637 3  1 1359
 572.878000 4.045737+0 573.235000 3.989288+0 573.252000 3.987053+06637 3  1 1360
 573.473000 3.935268+0 573.745000 3.879944+0 573.932000 3.849434+06637 3  1 1361
 573.974500 3.836587+0 574.204000 3.778610+0 574.433500 3.736139+06637 3  1 1362
 574.561000 3.724622+0 574.663000 3.696432+0 574.816000 3.670915+06637 3  1 1363
 574.969000 3.663854+0 574.994500 3.666878+0 575.122000 3.657368+06637 3  1 1364
 575.275000 3.682065+0 575.283500 3.685863+0 575.377000 3.709822+06637 3  1 1365
 575.479000 3.770235+0 575.555500 3.847608+0 575.632000 3.964353+06637 3  1 1366
 575.700000 4.114490+0 575.768000 4.326018+0 575.810500 4.503843+06637 3  1 1367
 575.819000 4.542796+0 575.870000 4.838644+0 575.895500 5.026575+06637 3  1 1368
 575.921000 5.224765+0 575.938000 5.391102+0 575.972000 5.741556+06637 3  1 1369
 576.001750 6.124517+0 576.023000 6.417239+0 576.065500 7.140533+06637 3  1 1370
 576.074000 7.294065+0 576.108000 8.046258+0 576.125000 8.443031+06637 3  1 1371
 576.159000 9.407457+0 576.176000 9.914246+0 576.197250 1.066002+16637 3  1 1372
 576.214250 1.128231+1 576.235500 1.217276+1 576.252500 1.291545+16637 3  1 1373
 576.273750 1.394938+1 576.278000 1.416503+1 576.312000 1.611974+16637 3  1 1374
 576.329000 1.713806+1 576.350250 1.862804+1 576.380000 2.079591+16637 3  1 1375
 576.388500 2.151461+1 576.426750 2.486768+1 576.431000 2.525498+16637 3  1 1376
 576.465000 2.879855+1 576.482000 3.063532+1 576.503250 3.323606+16637 3  1 1377
 576.533000 3.702115+1 576.553400 3.992917+1 576.584000 4.448481+16637 3  1 1378
 576.609500 4.868664+1 576.635000 5.307030+1 576.665600 5.893765+16637 3  1 1379
 576.711500 6.809178+1 576.726800 7.148045+1 576.788000 8.551815+16637 3  1 1380
 576.866200 1.057150+2 576.905300 1.161571+2 577.005600 1.434859+26637 3  1 1381
 577.066800 1.601595+2 577.168800 1.850102+2 577.172200 1.857902+26637 3  1 1382
 577.250400 2.004445+2 577.270800 2.032253+2 577.338800 2.112254+26637 3  1 1383
 577.359200 2.125638+2 577.400000 2.144145+2 577.437400 2.141850+26637 3  1 1384
 577.481600 2.131858+2 577.485000 2.129044+2 577.563200 2.051494+26637 3  1 1385
 577.576800 2.035379+2 577.644800 1.918289+2 577.672000 1.866680+26637 3  1 1386
 577.740000 1.709715+2 577.808000 1.543936+2 577.835200 1.474822+26637 3  1 1387
 577.998400 1.051376+2 578.069800 8.812718+1 578.080000 8.589928+16637 3  1 1388
 578.141200 7.301172+1 578.161600 6.910661+1 578.194750 6.301173+16637 3  1 1389
 578.244900 5.463148+1 578.248300 5.409118+1 578.309500 4.543360+16637 3  1 1390
 578.328200 4.308771+1 578.360500 3.929099+1 578.411500 3.397355+16637 3  1 1391
 578.462500 2.962309+1 578.494800 2.720493+1 578.513500 2.591616+16637 3  1 1392
 578.551750 2.358474+1 578.578100 2.213548+1 578.590000 2.153776+16637 3  1 1393
 578.628250 1.981582+1 578.661400 1.847337+1 578.666500 1.828562+16637 3  1 1394
 578.711125 1.682945+1 578.744700 1.585280+1 578.749375 1.573221+16637 3  1 1395
 578.787625 1.485067+1 578.845000 1.368988+1 578.870500 1.324205+16637 3  1 1396
 578.902375 1.276582+1 578.959750 1.202492+1 578.998000 1.158947+16637 3  1 1397
 579.017125 1.140589+1 579.074500 1.092112+1 579.151000 1.034971+16637 3  1 1398
 579.168000 1.023630+1 579.227500 9.918227+0 579.304000 9.551962+06637 3  1 1399
 579.393250 9.162644+0 579.423000 9.042626+0 579.482500 8.850060+06637 3  1 1400
 579.601500 8.497221+0 579.669500 8.310818+0 579.720500 8.200446+06637 3  1 1401
 579.899000 7.849272+0 580.077500 7.527962+0 580.154000 7.399335+06637 3  1 1402
 580.256000 7.273673+0 580.426000 7.078796+0 580.681000 6.806034+06637 3  1 1403
 580.800000 6.686720+0 580.936000 6.586685+0 581.191000 6.411418+06637 3  1 1404
 581.446000 6.245260+0 581.548000 6.181828+0 581.760500 6.088509+06637 3  1 1405
 582.049500 5.968453+0 582.483000 5.797368+0 582.916500 5.634196+06637 3  1 1406
 582.940500 5.625487+0 583.350000 5.524047+0 583.783500 5.421231+06637 3  1 1407
 584.222750 5.320903+0 584.664875 5.223414+0 585.107000 5.129360+06637 3  1 1408
 585.514750 5.045919+0 585.922500 4.966287+0 586.330250 4.891727+06637 3  1 1409
 586.636063 4.840499+0 586.883625 4.803216+0 587.102063 4.774640+06637 3  1 1410
 587.204000 4.763944+0 587.320500 4.738110+0 587.538938 4.697818+06637 3  1 1411
 587.684563 4.677494+0 587.830188 4.664811+0 587.946688 4.662622+06637 3  1 1412
 587.975813 4.664980+0 588.077750 4.649683+0 588.165125 4.648508+06637 3  1 1413
 588.252500 4.662362+0 588.318031 4.687288+0 588.383563 4.730182+06637 3  1 1414
 588.449094 4.798234+0 588.492781 4.862374+0 588.536469 4.945878+06637 3  1 1415
 588.543750 4.963797+0 588.580156 5.049289+0 588.631125 5.206825+06637 3  1 1416
 588.674813 5.381985+0 588.718500 5.602542+0 588.762188 5.877655+06637 3  1 1417
 588.805875 6.217695+0 588.849563 6.634182+0 588.893250 7.139658+06637 3  1 1418
 588.907813 7.342263+0 588.936938 7.758392+0 588.980625 8.498713+06637 3  1 1419
 589.024313 9.393963+0 589.068000 1.043241+1 589.126250 1.206761+16637 3  1 1420
 589.129163 1.215228+1 589.190325 1.425999+1 589.228188 1.577742+16637 3  1 1421
 589.251488 1.673760+1 589.312650 1.959824+1 589.330125 2.051911+16637 3  1 1422
 589.394200 2.398102+1 589.432063 2.626832+1 589.534000 3.256722+16637 3  1 1423
 589.650500 4.004817+1 589.691275 4.235569+1 589.767000 4.668086+16637 3  1 1424
 589.845638 5.017952+1 589.935925 5.281375+1 589.938838 5.289351+166**************************out resorting to specific
procedures.

The DENDRAL approach is a sharp contrast to these efforts. It was developed
from the belief that since human experts have large quantities of detailed task-specific

Table 3-l Organization of the DENDRAL programs

System

Components

Input

output

Heuristic DENDRAL
    Planning (Chap. 5):
        MOLION
      Planning Rule Generator
        PLANNER

Generating (Chap. 4):
Acyclic generator

  CONGEN   J
Testing (Chap. 6):
PREDICTOR

MSPRUNE

Meta-DENDRAL (Chap. 7)
    Planning:
        INTSUM

Generating:
  RULEGEN

Testing:
  RULEMOD

Mass spectrum

Planning rules

Molecular ion

Constraints:

superatoms
GOODLIST
BADLIST

Constraints

Candidate
molecular
structures

Candidate
molecular
structures
Mass spec
rules

Most plausible
structures

Structures consistent
with spectrum

Set of known     Set of all
structures       possible
and their       fragmentations
mass spectra     (ALLBRKS)

Set of
fragmentations

Candidate mass
spec rules

Candidate mass
spec rules

Most plausible
mass spec rules


ARTIFICIAL INTELLIGENCE 39

knowledge, machines might profitably embody such information. While at some level
of abstraction all problem solving and thought must have certain common features, we
note that champion chess players are not invariably expert chemists or accomplished
composers.

  This observation does not mean that DENDRAL is of no interest beyond mass
spectrometry. Generality, on this view, is to be sought at a higher level of abstraction,
perhaps at the level of general procedures for knowledge acquisition. This theme will
be explored more fully in the discussion of Meta-DENDRAL.
  In large part, then, DENDRAL is a piece of "knowledge engineering," that is, the
careful fashioning of many forms of knowledge into a complex system that functions
* smoothly.

3.4 OUTLINE OF DENDRAL PROGRAMS

Table 3-1 introduces the names of some of the component programs and data struc-
tures of the DENDRAL system and outlines their interrelationships.

The programs are written primarily in the list-processing language LISP [McCarthy
(1960)] in the INTERLISP [Teitehnan (1975)] implementation. Some routines are
written in SAIL [VanLehn (1973)] and BCPL. At present the programs run on the
Digital Equipment Corporation KI-10 computer at the SUMEX-AIM installation at
Stanford University, Palo Alto, California. The BCPL programs have been exported to
many other sites as well.


CHAPTER
FOUR

THE DENDRAL GENERATOR

The induction-by-enumeration model of scientific discovery was abandoned be-
cause of the seeming impossibility of enumerating all possible hypotheses. DENDRAL
puts new life in the old model by proposing an enumerator of molecular structure hy-
potheses that is not only complete but nonredundant as well. This hypothesis genera-
tor can be guided by task-specific constraints in order to avoid exhaustive search of the
hypothesis space. It is then no longer necessarily complete, but those hypotheses not
generated are precisely characterized.

4.1 INTRODUCTION

The heart of the plan-generate-test paradigm is the generator. The seminal insight for
DENDRAL was the original algorithm for exhaustively and nonredundantly generating
acyclic structures as reported in Lederberg (1964b) and Lederberg (1965a). This algo-
rithm, embodied in computer code ,r was the basis of the first DENDRAL system. When
the limitation to acyclic structures was overcome [Brown? Hjelmeland, and Masinter
(1974) Brown and Masinter (1974)] , DENDRAL increased its scope dramatically.
In this chapter we present an informal description of the cyclic generator, which

includes the acylic generator as a component. The complete algorithm is complex. The
correctness of the algorithm has been rigorously proved [Brown, Hjelmeland, and
Masinter (1974)] , but no procedure is known for proving that a program is a correct
embodiment of a complex algorithm. However, the generator program has passed the
important test of enumerating the correct number of structures for many cases where

`William C. White initially implemented Lederberg's algorithm in 1965 and Georgia Sutherland
improved and expanded the scope of the program over the next several years.

40


THE DENDRAL GENERATOR 41

the number of structural isomers was computed independently, and has been exten-
sively checked against hand-calculated examples. We do not seriously doubt the pro-
gram's correctness.

The chapter concludes with a description of a self-contained system called CON-
GEN that embodies the cyclic structure generator. Aside from its importance as a
powerful system in its own right, CONGEN illustrates the basic concepts of CONstrained
GENeration that underly the entire DENDRAL effort and the plan-generate-test
paradigm.

4.2 OVERVIEW

The problem of enumerating all ring-jkee connectivity isomers from a set of atoms
whose valences are known was solved with the construction of the original DENDRAL
acyclic structure generator. The cyclic generator reduces the more general problem of
enumerating all connectivity isomers to the special case of acyclic generation by treat-
ing ring structures as large atoms, called ring superatoms. A ring superatom is a chem-
ical graph containing one or more connected rings and having free valences, that is, a
number of unattached links are available for bonding to other atoms or ring super-
atoms. All atoms in a ring superatom are members of one or more rings. That is, there
are no isthmuses-appendages that may be separated from the structure by cutting
only one bond. Because in general a ring superatom is asymmetrical, its free valences,
unlike those of an atom, may be distinguished from one another. To do so, with each
ring superatom is associated a set of permutations on the nodes that specifies the sym-
metry of the structure.

  Associated with any ring superatom is another graph, called a vertex graph, that
has the same number of rings, connected in the same way, as the ring superatom. A
vertex graph is an abstracted structure, and a number of ring superatoms correspond
to the same vertex graph. Vertex graphs thus define equivalence classes of ring super-
atoms. A vertex graph together with a set of atoms (and their associated valences)
underlies, and can be used to generate, all possible structurally equivalent ring super-
atoms for that set of atoms. Thus a set of vertex graphs together with atom/valence
sets can generate sets of ring superatoms that may be combined with still other atoms
by a tree generator to yield a set of connectivity isomers.

Atoms that are contained in more than one ring (i.e., those atoms at which rings
are connected) are called vertex atoms. A single ring has no vertex atoms. Two rings
sharing exactly one vertex atom are said to be Spiro-fused (a chemistry term). More
commonly, two rings share two vertex atoms, usually adjacent. The rings are said to be
edge-fused, or, more commonly, fused. In defining ring~superatom classes we ignore
not only the atom names but also all nonvertex atoms. Thus a two-ring superatom con-
nected with two vertex atoms is of the same vertex-graph form no matter whether the
vertex atoms are adjacent or not, as illustrated in Figure 4-1.

When we consider only connectivity of ring superatoms vis a vis the vertex nodes
we obtain vertex graphs. All nodes of these graphs have degree of at least 3; in fact the
vertex graphs associated with most known chemical structures (except the limiting


42 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

         Figure 4-1 Some of the two-ring superatoms that
            reduce to a common 2-trivalent-node vertex
o Denotes vertex atom  graph.

case of a single ring) have only nodes of degree 3. Spiro-fused ring structures have a
node of degree 4, corresponding to the four links that fuse on a single vertex atom.

A CATALOG has been developed for most vertex graphs of chemical interest. The
CATALOG as of this writing contains several thousand vertex graphs including all
trivalent vertex graphs up to 18 nodes, plus some quadrivalent varieties. Higher-order
graphs are handled by "tricks" that reduce them to trivalent and quadrivalent graphs.
For example, a six-valent node may be considered to be a connection of two quadriva-
lent nodes:

\ /      \ 1
-*- =   -*-*-
/\      / \

Some examples of vertex graphs and associated chemical structures are given in
Figure 4-2.

Given an empirical formula, the enumeration of all isomers is a three-step process:

1. Ring generation

a. Form the initial partition: Partition the atoms of the formula in all possible
ways into sets, called ring superatompots, which will form ring superatoms, and
a set, called the remainingpot, which will not be part of any ring superatom.
b. Identib vertex graphs: For each partition, determine the (unique) vertex graph
for each of the ring superatompots.

c. Generate equivalent ring superatoms: Use each veitex graph to generate all ring
  superatoms in the equivalence class defmed by that vertex graph.
2. Tree generation

,

  For each combination of ring superatoms and atoms from the remainingpot pro-
  duced in step 1, use the acyclic generator to generate all possible tree structures.
  That is, treat ring superatoms as nodes in tree structures and generate all trees.
3. Expanding ring superatoms

a. Imbedding: Expand each ring superatom node to its full structure in terms of
  atoms.

b. Pruning: Throw out structures that would not be eliminated before imbedding.


Vertex graph       Trivalent    Quadrivalent
Regular trivalent                     Example
             nodes       nodes         sti-uctures

Single ring

aI
(Hosohedron)
87

0 (six 2' nodes)
a3

Ia
(Tetrahedron)

0

CD
(Prism)

0
0
@
(Nonplanar graph)

0




0




0




0







0








0







0





0





0









I



1




1

Graphs with nodes of valence > 3

Go

0

2

4

Fii 4-2 Some vertex graphs and associated chemical structures. (Source: Computer Representa-
tion and Manipulation of Chemical Information, edited by W. T. Wipke, S. Heller, R. Feldmann
and E. Hyde. Copyright I974, John Wiley & Sons, Inc. Reproduced by permission. After Smith,
Masinter, and Sridharan [ 19 741.)

43


44 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

4.3 RING GENERATION

4.3.1 Form the Initial Partition

The empirical formula is first converted to the abbreviated formula by computing de-
gree of unsaturation, using Equation 1, page 12. The number of u's in the abbreviated
formula determines how many ring superatoms are possible, since each ring superatom
must have at least one unsaturation.' If there are three unsaturations available, they
may form either one 3-ring superatom, or one 2-ring superatom plus a single ring, or
three single rings. There is no known closed formula giving the number of partitions of
a given number of U's, but their enumeration is straightforward.3 For each partition
of the unsaturations there are a number of ways to divide the multivalent atoms among
each of the ring superatompots and the remainingpot. All univalent atoms (including
the unmentioned H's) are assigned to the remainingpot, since they can never be in-
cluded in rings.

Consider the example of CreHraN. The degree of unsaturation is 2, so the abbre-
viated formula is CreNUs . This means that two-ring superatoms are the most that need
be considered. Remembering that it does not make sense for a ring superatompot to
contain fewer than two atoms or less than one unsaturation, we have the following set
of partitions.

The process next proceeds through several steps that will be illustrated for
CreHrsN, in Figure 4-3.

4.3.2 Identify Vertex Graphs

Construct the valence list. Let ai denote the number of available atoms with valence i.
The vector (as, a3, , . . , a,) is called the valence list for a ring superatompot containing
atoms with n - 1 numerically distinct valences. For the ring superatompot containing
CsNUs the valence list is (0, 1,9), because there are no atoms of valence 2, one of
valence 3 (nitrogen), and nine atoms of valence 4 (carbon).

Compute the number of free valences. This computation is made by solving Equation
1, page 12, for free valence:

F=S-2K+2-2U           0%. 2)

where S = sum of valences of multivalent atoms
   K = number of multivalent atoms
  U = degree of unsaturation (of a superatompot)

For the example, CgNUz , there are 17 free valences.

*The DENDRAL generator treats double bonds as rings and triple bonds as two-ring struc-
tures. See page 12.

3The number of partitions of n indistinguishable objects for n = 5, 10, and 20 is 7, 42, and
627, respectively. The number of partitions is asymptotic to [4n(3)`/*] -' exp [n(2n/3)`/*].


THE DENDRAL GENERATOR 45

Table 4-1 Possible partitions of CloNU2

Rim      Ring
superatompot superatompot
#I        #2       Remainingpot

CNU2

ClOU2
c9u2
cSu2
c7u2
c6u2
csu2
c4u2
c3u2
c2u2

CsNU
C7NU
CeNU
C5NU
C4NU
C3NU
C2NU
CNU

C7NU
CeNU
CSNU
C4NU
C3NU
C2NU
CNU

c6m
CSN
C4NU

C
c2
c3
c4
C5
c6
c7
c8
c9

N
CN
C2N
C3N
C4N
GN
C6N
C7N
CSN

c2u
c3u
c4u
GU
c6u
c7u
c8u
c9u

c2u        C
c3u        C
c4u        C
csu        C
c6u        C
c7u        C
cS"        C

c2u       c2
c3u      c2
c4u      c2

Ring      Ring
superatompot superatompot
#l        #2       Remainingpot

C3NU
C2NU
CNU

csw
C4NU
C3NU
C2NU
CNU

C4NU
C3NU
C2NU
CNU

C3NU
C2NU
CNU

C2NU
CNU

CNU

c8u
c7u
c6u
csu

c7u
c6u
csu

c6u
c5u
c4u

csu
c4u

c4u
c3u
c3u

c2u

csu      c2
c6u      c2
c7u      c2
c2u      c3
c3fJ      c3
c4u      c3
csu      c3
c6u      c3
czu      c4
c3u       c4
c4u      c4
csu      c4

c2u      c5
c3u      c5
c4u      c5
c2u      c6
c3u      c6

c2u      c7

c2u        N
c3u        N
c4u        N
c5u        N

c2u        CN
c3u        CN
c4u        CN

c2u      C2N
c3u      C2N
c4u      C2N
c2u      C3N
c3u      C3N

c2u      C4N
c3u .     C4N

c2u      C5N

c2u      C6N

Partition the free valences. The total number of free valences is divided among the
atoms, none being assigned more than its valence less 2. In general this assignment can
be done in more than one way, and each leads to a different class of possible struc-
tures. In our example we have 17 free valences to be assigned among one trivalent
atom and nine quadrivalent atoms. If none is assigned to the trivalent, the 17 must


Empirical
formula

Superatom
partition

VdeWX
list

Free
valence

Partition
free
valence

Degree
list

C,oH,vN, = CIONI",

C,oN,"z
1 1               1

(0,1,10)    @,1,9)       (`Al 3)       K40,10)     wJ,~)/(0,l,5)
I 1

A >f     1     1     1
  -q--+N-N* Is%..% y1
(?)      TU      c'o)
(2,2,2,2,2,2,2,2,0) (2,2,2,2,2,2,2,1,1)   cL2,2,2,2,2,2,2,1)
  1     1 1
  (9,&l)        @,W        Km

Vertex graphs
from catalog  8

Ring -

Sulleratoms

Remaining
Pot

Partition
secondary    J      \

nodes     @,l)--X5,4)    - -,(4,0,4),(4,1,3),(4,2,2),- - -
among edges  1 J  J /  1 I I

Ciliated
skeletons

  1     1
I ,A,p:;
/y         I'C'I'C'I

`C    ,   ,.  N' `C' `C.
       / .'
1:c;F;c:C cx  ' ,
     1,c:F;c:F
  1     1
  -CH,       -CH,
/I `\           \
                  \
       \   I  \
       a           *
      -__

  --,(4,0,4),(4,1,3),---
II/' J I `\Y
-,c`o,---,a>--.

u  1    12 1

1;c: `c:l
+
`C  `;" 7,
1;c:Y;c::: , ;:c;N'c:c,
        :I .c.
           c. .c.  /\
       1,C.I ,c.

1     1
-CH,       -CH,

Figure 4-3 Structure generation for CloHlgN. (Source: Computer Representation and Manipula-
tion of Chemical Information, edited by W. T. Wipke, S. Heller, R. Feldmann and E. Hyde. Copy-
right 1974, John Wiley & Sons, Inc. Reproduced by permission. After Smith, Masinter, and
Sridharan [ I9 741.)

46


THE DENDRAL GENERATOR 47

divide (2,2,2,2,2,2,2,2,1) among the nine quadrivalents. If one is assigned to the tri-
valent, there are two possible ways of assigning the remaining 16 among the 9 quadriva-
lents: (2,2,2,2,2,2,2,2,0) and (2,2,2,2,2,2,2,1,1).

Compute the degree list. The degree of an atom is simply its valence less the free va-
lences assigned to it; for atoms in a ring superatom it is how many of its valences are
used in forming the ring structure, since all such atoms by definition are members of
one or more rings. Traditionally, atoms are said to be primary, secondary, tertiary, and
quaternary for degree 1, 2, 3, and 4. Thus the carbon atom in CH3- is primary, the
carbon atom in -CH*- is secondary, and so forth. Let di be the number of atoms of
degree i. The degree list is computed for a free-valence partition in the obvious way.
Trivalent atoms with one free valence have degree 2, as do quadrivalent atoms with
two free valences; trivalent atoms with no free valences and quadrivalent atoms with
one free valence have degree 3, and so forth. Since atoms of degree 1 cannot be part of
a ring superatom, the degree list (d, , d3, . . . , d,) begins with the number of atoms of
degree 2.

Determine what ring superatom organizations are possible. A degree list uniquely de-
termines for its ring superatom the number of rings and their connectivity. In fact this
structural information may be computed from the degree list by arithmetic operations.
Once the degree list for a particular partition of a ring superatompot has been deter-
mined, it is "looked up" in the CATALOG.

The manipulations of the degree list that comprise the look-up are simple arithme-
tic operations that, interpreted in the graph-model semantics, amount to deleting re-
cursively all secondary atoms one at a time until (1) no nodes remain (this is the special
case of a single ring), or (2) only one node remains, with one or more reflexive links
(these cases are called "daisies" and result from Spiro-fusions and double bonds), or (3)
two or more nodes remain, in which case the CATALOG is consulted for entries with
this number of nodes.

4.3.3 Generate Equivalent Ring Superatoms

The remaining steps in the generation of ring superatoms from a given ring superatom-
pot build on the selected vertex graph using the information contained in the associated
free-valence partition and the degree list derived from it. The procedures involve, first,
labeling the edges of the vertex graph with the number of atoms each will contain; sec-
ond, labeling all nodes (the vertex nodes together with the just-generated nonvertex
nodes) with degrees; and third, labeling each node with its particular atom type. Each
step can, in general, be carried out in more than one way and all combinations must be
considered.

Generate cyclic skeletons. The number of edges in the vertex graph is counted and the
number of atoms of degree 2 is partitioned among these in all possible distinct ways,
eliminating duplications due to the symmetry of the vertex graph. In the case of the
hosohedron vertex graph (see Figure 4-2) associated with partition B in Figure 4-3, the


48 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

three edges are equivalent because of the symmetry of the graph. The eight nodes of
degree 2 may be assigned to the three edges in only 10 distinct ways: (8,0,0), (7,0,1),
(6,0,2), (5,0,3), (4,0,4), (61 J), (5,1,2), (4,1,3), (4,2,2), (3,2,3). Each leads to a
distinct cyclic skeleton with one node per atom. Note that after each labeling
step, some of the symmetry of the unlabeled graph may be destroyed.

Assign degrees to nodes. The free valence partition is consulted to determine how
many secondary nodes must have 0, 1, 2, etc., free valences; then how many tertiary
nodes must have 0, 1,2, etc., free valences; and so forth. Again there is in general more
than one way to label the nodes subject to this constraint, while eliminating those that
are equivalent by symmetry. This step yields ciliated skeletons.

Assign atoms to nodes. The final step is to assign the available atoms to the nodes that
have been generated. All assignments consistent with the actual valences and node
labelings must be made, again discounting structures that are equivalent by symmetry.

It is interesting to note that each of these three labeling steps is formally the same
and in fact is carried out by the same labeling algorithm. Formally the problem is to
associate a set of nz labels, not necessarily distinct (in the three cases: secondary nodes,
degrees, and atom names), with a set of n objects, not necessarily distinct (in the three
cases: edges of a vertex graph, nodes of a cyclic skeleton, and nodes of a ciliated skele-
ton), to yield a set of labeled objects distinct up to a given set of symmetry transfor-
mations. We will not describe this algorithm in detail; it is published in Brown, Hjelme-
land, and Masinter (1974).

4.4 TREE GENERATION-THE ACYCLIC GENERATOR

The ring superatoms generated by the above-described algorithm are next combined in
all chemically possible ways with the atoms in the remainingpot. If we ignore the in-
ternal structure of the ring superatoms, the structures so created will be trees. The
algorithm that accomplishes this structural creation is essentially the same as the orig-
inal acyclic DENDRAL algorithm which enumerates all possible isomers for aliphatic
structures. That algorithm will now be described, and the modification needed to in-
corporate it into the general cyclic structure generator will be described later.

4.4.1 DENDRAL Notation

It is convenient to have a linear notation for representing tree structures, both because
for some purposes tree-structure diagrams are unwieldy, and because a linear notation
frequently makes enumeration and formal manipulation more uniform and systematic.
The DENDRAL notation is a linear notation for aliphatic chemical structures.4 Other
chemical nomenclatures have been devised for similar purposes, but the DENDRAL
notation is more systematic and perspicuous.

4A linear notation was devised for cyclic structures, but we were unable to map it into a gener-
ating algorithm in the same way as for acyclic structures.


THE DENDRAL GENERATOR 49

The DENDRAL notation is based on a method for finding a unique ordering, i.e.,
a unique path through the nodes and branches of any given acyclic structure diagram.
This method is also the basis for enumerating all aliphatic connectivity isomers of a
given empirical formula because the notational algorithm can be easily turned into a
generating algorithm, as discussed here. The method could be extended to an enumera-
tion algorithm for all acyclic structures by proceeding through all (countably infinite)
empirical formulas in the obvious dictionary order.

It is apparent that we must have a way of identifying a unique and characteristic
starting point for traversing the tree. Otherwise, the same tree would have several pos-
sible encodings, and it could become a monumental task to determine from two codes
the relation between the trees they represent. In particular, it would be difficult or im-
possible to know if two codes represented the same tree. Such a situation would make
an exhaustive, nonredundant enumeration algorithm inefficient or impossible.

Fortunately, for the case of trees, there is always a unique starting point, the
centroid. This was proved by the mathematician Jordan in 1869 [see reference 14 of
Buchanan, Duffield, and Robertson (1971)]. There are three cases to consider: (Al)
For trees with an odd number of nodes, the centroid is that unique node (Atom) from
which each branch carries less than half the total number of nodes. (A2) For trees with
an even number of nodes, the centroid is that node (Atom) from which each branch
carries less than half the total number of nodes, if such a node exists; otherwise, (B)
the centroid is an edge (Bond) that joins nodes of equal node count.

The construction of the unique, unambiguous DENDRAL notation for any given
tree is now straightforward; we need only establish conventions for deciding which
route to take when several are available. These conventions are called the DENDRAL
Canons of Order. Once these have been adopted, it remains only to convert the thus-
defined canonical traversal of a tree into a linear notation.

The most familiar and direct method for uniquely encoding tree structures in lin-
ear format is the use of parentheses in the usual way: each terminal node is enclosed in
parentheses, and subnodes of a single parent are separated (say by commas) and en-
closed in parentheses. The procedure is iterated until the top node is reached (note
that `terminal node', `top', `subnodes', and `parent' were not uniquely defmed until a
topmost node was specified). For complex trees a more compact form is Polish prefix
notation; for chemical graphs we may use . and : as the @nary) operators correspond-
ing to single and double bonds.' Propane would be represented as (CH,((CH,)(CH,)))
in parenthetic notation or as CH2 . . CHaCHa in DENDRAL-like notation.6 Here we
have collapsed all the hydrogens onto their associated carbon nodes to simplify the no-
tation. Since the number of hydrogens is readily determined for each carbon (4 minus
the number of other links), we can and do omit mention of hydrogens. The DENDRAL
notation for propane then becomes C . . CC.

`For enumeration of aliphatic compounds bonds may be single, double, or triple. In the con-
text of the cyclic generator all bonds are the same type since doubly and triply bonded atoms are
treated as ring superatoms.

6The parallel between this representation of chemical structures and the LISP language's repre-
sentation of branching trees (lists) was one reason why LISP was selected initially for the imple-
mentation of DENDRAL.


50 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

4.4.2 Enumeration of Hydrocarbons

We begin with the special case of the hydrocarbons (all atoms are carbon or hydrogen)
for which the canons of order reduce to a small set. As usual, hydrogen atoms are ig-
nored until the very end. Enumeration begins by choosing a possible centroid, then
partitioning the number of carbon atoms in the formula in all possible ways between
the atoms connected by the centroid (if it is a bond) or among the bonds issuing from
the centroid (if it is an atom). Our first canons of order fur the order in which cen-
troids are considered. Canon 1: consider bond centroids before atom centroids; Canon
2: consider lower-degree atoms before higher-degree atoms in generating atom cen-
troids. (Recall that a first-degree atom is an atom with one nonhydrogen bond, a
second-degree atom has two nonhydrogen bonds, and so forth.) Clearly a first-degree
node can never be a centroid, and a second-degree node cannot be a centroid if the
structure has an even-node count.

In the consideration of a bond as a centroid, there is only one division of the
nodes: half and half. This division is also true for a centroid that is a second-degree
node. For third- and fourth-degree nodes there are in general several ways of partition-

Table 4-2 DENDRAL enumeration of the pen@ radicals

Number    Graph

DENDRAL formula

8

-c-c-c-c-c

-c-c-c-c
  4

-c-c-c-c
A

c
-"-V"

  i:

-c-c-c-c
A

-c-c-c
4;

-c-c-c
I
l
-6,-,
A

.c.c.c.c.c

.c.c.c..cc




.c.c..cc.c





.c.c...ccc




.c..cc.c.c




.c..cc..cc




.c..c.cc.c









.c...ccc.c


THE DENDRAL GENERATOR 51

ing the remaining nodes in such a way that each component of the partition contains
less than half the total. A partition is a set of integers; choose as a canonical notation
an ordering of these integers (a vector) into a nondecreasing sequence. The vectors have
a natural ordering: (ai) < (IQ), i = 1 to n if and only if for some k < n + 1, ak < bk and
aj = bj for 1 <i < k. Canon 3: consider the partitions in ascending sequence. This
means that radicals of lower-node count will precede those of higher-node count in the
canonical DENDRAL notation for a particular structure, and that structures with lower-
node counts will be enumerated sooner by the acyclic generator.

Given a centroid and a partition, we must consider for each component of the
partition all possible radicals that may be constructed from that set of atoms. These
must be enumerated in a systematic order.

In enumerating the radicals for a given set of atoms, the starting point is uniquely
determined; it is the site of the free valence. This is called the apical node. Canon 4:
consider all possible degrees of the apical node in ascending order. Then consider all
partitions of the remaining atoms among the branches from the apical node, remem-
bering that there is no "balance" constraint now since the apical node is not a cen-
troid. Canon 5: These partitions are ordered as before (Canon 3).

For each component of a partition, apply the procedure,just described,recursively.
This algorithm yields, for the case of five carbons (pentyl radicals), the enumeration in
Table 4-2.

Now we will illustrate the enumeration of a class of hydrocarbons, the hexanes.
The entire algorithm yields the enumeration depicted in Figure 4-4. The node count is
even (6), so we consider the bond centroid possibility first. This yields the single parti-
tion (3,3). The enumeration of the propyl radicals by the above algorithm yields only
two possibilities: .C.C.C and .C..CC in that order. Pairwise enumeration of the propyl
radicals gives (.C.C.C and .C.C.C), then (.C.C.C and .C..CC), then (.C..CC and .C..CC).

Node count

Centroids

Partitions

Tree graphs

Isomers

< 3C(Pr)


   3C(Pr)

/
C

  `2C(Et)

\ 2C(Et)

Figure 4-4 Dendral enumeration of the hexanes, with centroids marked by arrows. (Source: Mass
Spectrometry: Techniques and Applications, edited by G. W. A. Milne, Copyright 1971, John
Wiley & Sons, Inc. Reproduced by permission. After Buchanan, Duffield, and Robertson [ 19711.)


52 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Table 4-3 Tbe number of isomers of some simple radicals
and saturated hydrocarbons

Number of carbons     Number of isomers

Radicals

Methyl       1                  1
Ethyl       2                  1
ROPYl       3                   2
Butyl        4                   4
Pentyl       5                   8

Alkanes

Methane      1                   1
Ethane       2                   1
Propane      3                    1
Butane       4                  2
Pentane      5                  3
Hexane      6                   5
Heptane      7                  9
Octane       8                  18
Nonane      9                  35
Deane      10                  15
Isocane      20              366319

Thus we have three isomers with a bond centroid. There can be no first-degree atom
centroids for any structure, and no second-degree atom centroids in this (even-node
count) structure. Choosing a third-degree atom centroid allows only one partition of
the remaining five atoms (remember that no component of the partition can be more
than half the total), yielding only one isomer. This is also the case for the last enumer-
ated isomer resulting from a fourth-degree atom centroid.

Table 4-3 is provided for those readers who wish to test their understanding of the
algorithm by trying some other examples. (Ten atoms challenge almost everyone's
ingenuity .)

4.4.3 Enumerating Other Acyclic Structures     ,

For compounds containing heteroatoms (nonhydrogen, noncarbon atom) we need
another canon for choosing order. Canon 6: order atoms (arbitrarily) by increasing
atomic number: C, N, 0, P, S for these five common atoms. (The order of these most
common atoms is easily memorized, since it is also alphabetical.) Whenever one must
sort a set of atoms, it is done on atomic number.

  The final decision concerns unsaturation: what to do when structures contain
double and triple bonds. Canon 7: consider single bonds first, then double bonds, then
triple bonds.


THE DENDRAL GENERATOR 53

4.5 THE CYCLIC GENERATOR

For a given set of ring superatoms (one exemplar for each ring superatompot generated
by the cyclic structure generator) and the atoms of the remainingpot, we can apply a
modified version of the acyclic generator to enumerate all possible single structures.
The modifications to the generator are necessary because the free valences of a ring
superatom, unlike those of an atom, are distinguishable; this modification is readily
handled by supplying the symmetry transformations of each ring superatom to the
acyclic generator, which can then reject duplications. A final addition to our canons of
order is also needed because it is necessary to have a rule for ordering superatoms.

We now have a complete set of canons of order that uniquely determines the
order of enumeration of all structures for compounds of C, H, N, 0, P, and S:

1. Canon 1: Consider bond centroids before atom centroids.
2. Canon 2 : Consider lower-degree atom centroids before candidates of higher degree.
3. Canon 3: Consider partitions of atoms in their natural order.
4. Canon 4: In generating radicals, consider possible degrees of the apical node in
ascending order.

5. Canon 5: In generating radicals, consider partitions of atoms in their naturalorder.
6. Canon 6: Consider atoms in the order C, N, 0, P, S.
7. Canon 7: Consider single bonds before double bonds before triple bonds.
8. Canon 8: Consider smaller ring superatoms before larger, and for those of equal
number of atoms list their constituent atoms in order of atomic number and order
the ring superatoms alphabetically on this naming rule.

Together, the rules for partitioning atoms into superatompots, plus the rules for
enumerating ring structures for a given superatompot, plus the acyclic canons of order
yield a complete, exhaustive, nonredundant cyclic structure generator.

4.6 CONSTRAINING THE GENERATOR: CONGEN

The cyclic generator is embodied in the full DENDRAL plan-generate-test system. In
subsequent chapters the planner and tester will be described. There it will be seen how
a complete structure elucidation engine can be realized. However, the cyclic generator
alone is a very powerful program. In the hands of chemists it can prove a useful ad-
junct to their own planning and testing heuristics, especially when they can specify
constraints on the structures in terms of chemical graphs. Such a program has been im-
plemented. It is called the CONstrained GENerator, or CONGEN.

We will now describe CONGEN because it demonstrates in clear fashion the con-
cept of heuristic search in the space of possible chemical structures. It is, incidentally,
a well-documented and user-oriented program with a user's manual' and online help

`Available at cost from The DENDRAL Project, Computer Science Department, Stanford
University, Stanford, California 94305.


54 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

facilities. A serious effort has been made to "export" it to the scientific community.
Thus it is of interest in its own right.

  For problems of serious concern to the chemist, the number of connectivity iso-
mers for a given empirical formula is so large as to be unmanageable (see Section 8.2).
Of course one normally knows much more about a compound than its empirical for-
mula. What is known comes from many sources, a mass spectrum often being an im-
portant one. The data can often be interpreted in a form that rules out certain sub-
structures and strongly suggests the presence of others. By instructing the generator to
generate only structures containing the required substructures and not containing for-
bidden substructures, the number of generated isomers may be dramatically reduced.

CONGEN permits the user to constrain the enumeration by specifying several
types of constraints.8 These are:

1. SUBSTRUCTURE constraints: These are substructures that must be present with
specific cardinality. The specific number (including none) of occurrences may be
specified, or a range for the minimum and maximum number of occurrences may
be given. (Superatoms specified by the chemist with a definite number of occur-
rences may be used from the start in place of their constituent atoms.)
2. RING constraints: The user may specify sizes of rings that must be present. The
number of occurrences (including none) or a range for the number of occurrences
of a given ring size may be specified.

3. PROTON constraints: The user may specify the number of hydrogen atoms that
must be associated with a given structure, without being specific as to where they
are bonded.

4. ISOPRENE constraints: The user may specify a range for the number of isoprene
units that must be part of the generated structures. An isoprene unit is a Y-shaped
grouping of five carbon atoms.

The last mentioned constraint is included because many naturally occurring com-
pounds contain known numbers of isoprene units. The SUBSTRUCTURE constraint
mechanism is sufficiently general to encompass ISOPRENE constraints, but because
they are an important and ubiquitous special case, they are treated separately. The
strategy is sufficiently flexible to permit further extensions along these lines, and time
will no doubt see further special cases handled.

The first step in using CONGEN is to defme superatoms. We have encountered the
concept of ring superatoms above. A superatom may be either a ring superatom or an
acyclic structure containing more than one atom. That is, it is any connected graph
that is treated as a unit, acting in the role of an atom in the construction of larger
structures.

The specification of superatoms is done with DEFINE commands. These permit
the construction of computer representations of rings and chains of atoms of specified
type and the assignment of free valences. Certain atoms may be TAGged to specify

8At present there is no way to specify constraints on the three-dimensional configuration of
structures, although this problem is a focus of current work. See Section 4.6.2.


THE DENDRAL GENERATOR 55

PROTON constraints. Ranges of hydrogen attachment may also be specified for each
atom.

A set of constraints of the above listed types may now be specified. This set of
constraints applies to the first step of generation, which treats the specified super-
atoms as units distinguished only by their free valences. This is the GENERATE step,
which produces all possible structures of atoms and superatoms following the algorithm
of the cyclic generator but rejecting all structures violating defined constraints.

The final step, called IMBED, expands ("explodes") the superatoms one type at a
time so that the resulting structures are representations of chemical structures in terms
of atoms and bonds only. During imbedding, structures are also constrained according
to the user's specifications, since the expansion of a superatom could give rise to viola-
tions of constraints that were not violated by intermediate structures. For example, an
excluded substructure that consists of portions from each of two permitted substruc-
tures might emerge as these substructures are expanded when they are connected in
one way, but not when they are connected in other ways. The set of constraints may
differ for each IMBED step.

The program is interactive, permitting chemists to revise their list of structures
and constraints at any stage. Thus if the generation produces an inordinate number of
possibilities, they may add further constraint information until they are able to win-
now the set down to manageable size. The final enumeration ideally would be a single
structure, though in practice this is not often the case. However, if the number of
structures is sufficiently small to permit examination of each member, the chemist's
stock of judgment and intuition that remains uncodified may, at times, be sufficient to
make a good guess as to the correct structure.

4.6.1 An Example of CONGEN Use
The following is a record of a session with CONGEN. The example is very simple and
of no chemical interest but serves to illustrate the program's syntax and behavior.
  The chemical information available is as follows:

Cl. The empirical formula is C r3 H r4 0.
C2. The compound contains a keto group in a five-membered ring.
C3. There are three protons (H's) alpha to the carbonyl group.
C4. There are two vinyl groups (-C=C-) and (C4B) four vinyl protons.
C5. There is no conjugation (alternation of double and single bonds).
C6. There are no diallylic protons (hydrogens at the middle carbon of a diallylic
   structure: -C=C-C-C=C-), (C6B) nor protons alpha to both a vinyl and
  the keto group.

C7. There are only two quaternary carbons, one in the keto group and one in one of
  the vinyl groups.

Cg . There are no additional multiple bonds.
C9. It is assumed there are no three- or four-membered rings.
ClO. There are no methyl groups.


56 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

The following typescript of a dialogue with CONGEN shows how the complete set
of topological isomers satisfying these constraints can be obtained. Fitting the con-
straints to the CONGEN syntax sometimes requires some roundabout procedures. The
program is undergoing constant revision, in part to make these communications more
succinct and natural to the chemist. Our example illustrates the system as of this
writing.

  Comments written in lowercase and enclosed in brackets have been inserted into
the transcript to point out the purpose of each section with respect to the above con-
straints. The CONGEN syntax should be decipherable with the following brief guide.
CONGEN prompts the user with #. The main subprograms that may be called
when this prompt is given are DEFINE, GENERATE, and IMBED. Each of these sub-
programs issues a > prompt to which the user replies with subcommands. User-typed
responses are in bold type.

  Substructures are defined with the DEFINE commands. Some of the substruc-
tures so defmed will be used to specify superatoms that are to occur in the final graphs,
but others will be disallowed. The DEFINE commands

and

RING n

CHAIN n

define a ring and a chain, respectively, of n carbon atoms and assign to each atom an
identification number. To defme superatoms with other atom types, RING and
CHAIN are followed by the ATNAME command, which changes atom types. For
example,

                  ATNAME3N50

would make atom 3 a nitrogen and atom 5 an oxygen; the argument list can have as
many number-name pairs as desired. More complex superatoms are defmed by modify-
ing rings and chains with the

                   LINK a b m

command, which connects atom a to atom b with a chain of m carbons. This is also
how multiple bonds may be specified;

                   LINK 1 1 1       1

doubly bonds a carbon to atom 1.

                   ATOMFV a v

is used to define the (exact) number of free valences for specified atoms; the argument
list is an arbitrarily long list of atom-number/free-valence-count pairs.

HRANGE a n m

specifies that the number of hydrogens bonded to atom a must be between n and m,
inclusive.


THE DENDRAL GENERATOR 57

More complex structures may be defined by naming superatoms within super-
atoms, using ATNAME to replace atom names in the new superatom with names of
previously defined superatoms.

DEFINE has commands for diagramming superatoms, showing atoms by number
(DRAW NUMBERED) or by type (DRAW ATNAMED), or displaying them in tabular
form (SHOW). These features are illustrated in the example.

GENERATE is the command that produces all intermediate structures meeting
the defined constraints, with the superatoms not imbedded ("exploded"), but treated
as single atoms. After GENERATE is called, it gives the user the opportunity to define
the CONSTRAINTS. After generating, more structures may be defined to give new
constraints for the IMBED steps. IMBEDding is done one superatom at a time, allow-
ing yet more flexibility in application of constraints. After GENERATE and IMBED,
the user may DRAWSOME of the structures.

Sample CONGEN Dialogue
[Comments are bracketed and refer to problem definition statements Cl to ClO,
above .]

WELCOME TO CONGEN, VERSION VI.
#DEFINE MOLFORM C 12 H 14 0
MOLECULAR FORMULA DEFINED

#DEFINE SUBSTRUCTURE Z

[Z is the structure required by C2 and
c3.1

(NEW SUBSTRUCTURE)
>RING 5               [C2 : form rive-membered ring. J
.LINK 1 1 1             [C2: add keto group.]
>ATNAME 6 0
>HRANGE211312412522

[C3: atom 5 will have 2 H's, which will
be alpha to the carbonyl; atom 2 will
have the third H alpha to C=O.]

>DRAW NUMBERED

SUBSTRUCTURE Z (I-IRANGES NOT INDICATED)
NON-C ATOMS: 6->0

    /
6=1-S-4
\ I
  2-3
  I \


58 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

XHOW

SUBSTRUCTURE Z

ATOM# TYPE NEIGHBORS    HRANGE
  1     C      6  6 5  2
  2     C      3  1FV
  3     C      4  2FV      l-2
  4     C      5  3FV      l-2
  5     C      1  4
  6     0      1  1

>DONE
Z DEFINED

#DEFINE SUBSTRUCIIJRE V
(NEW SUBSTRUCTURE)
>RING 2
>DRAW ATNAMED

w is the vinyl group.]

SUBSTRUCTURE V:

c=c

>DONE
V DEFINED

[Comment: Next the disallowed structures are defmed.]

#DEFINE SUBSTRUCTURE W

[CS: W is a double vinyl, which would
violate conjugation prohibition.]

(NEW SUBSTRUCTURE)
>CHAIN 2

>ATNAME 1 V 2 V
>DRAW ATNAMED

SUBSTRUCTURE W:

v-v

>DONE
W DEFINED

#DEFINE SUBSTRUCTURE VCHV

[C6: VCHV is a diallyl with 1 or 2 H's,
which is prohibited.]


THE DENDRAL GENERATOR 59

(NEW SUBSTRUCTURE)
XHAlN 3

>ATNAME 1 V 3 V
>HRANGE 2 12
>DRAW ATNAMED

SUBSTRUCTURE VCHV: (I-IRANGES NOT INDICATED)

v-c-v

>DONE
VCHV DEFINED

#DEFINE SUBSTRUCTURE CHO
(NEW SUBSTRUCTURE)
>CHAlN 1
>HRANGE 10 0
>DONE
CHO DEFINED

[C7: CHO is a quaternary carbon.]

#DEFINE SUBSTRUCTURE CH3
(NEW SUBSTRUCTURE)
>CHAIN 1
>HRANGE 13 3
>DONE
CH3 DEFINED

[ClO: CH3 is a methyl group.]

#DEFINE SUBSTRUCTURE VI-I

[C4B: "tagged" vinyls needed to specify
PROTON constraint later .]

(NEW SUBSTRUCTURE)
XHAIN 1
>ATNAME 1 V
>TAG 1
>SHOW

SUBSTRUCTURE VH:

ATOM# TYPE NEIGHBORS
1* v

TAGGED ATOMS ARE INDICATED BY A *

>DONE
VH DEFINED


60 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

##GENERATE
SUPERATOM : Z

RANGE OF 0CCURRENCES:AT LEAST 1
SUPERATOM: V

RANGE OF 0CCURRBNCES:AT LEAST 2
SUPERATOM:

`COLLAPSED' FORMULA IS C 3 Z 1 V 2 H 9
CONSTRAINT:LOOP Z NONE      [This constraint prevents Z from bonding
                  with itself.]

CONSTRAINT: SUBSTRUCTURE CH3 NONE
                  FJOI

CONSTRAINT: SUBSTRUCTURE CHO NONE
                  [C71
CONSTRAINT: SUBSTRUCTURE W NONE -
                  PI

CONSTRAINT: SUBSTRUCTURE VCHV NONE
                  [C61

CONSTRAINT:RlNG 3 NONE
CONSTRAINT:RING 4 NONE
CONSTRAINT:RING 2 EXACTLY 3

[C91
EC91
[There are already 3 double bonds (car-
bony1 plus two vinyls). This constraint
makes certain there are no more and no
triple bonds.]

CONSTRAINT:PROTON VH EXACTLY 4
                  K4Bl
CONSTRAINT:

[Comment: Each time CONGEN generates a structure it prints ".".I

[Comment: Now first-level intermediate structures have been generated.]

18 STRUCTURES WERE GENERATED

[Comment: The following is one of the 18 structures; asrequired, it contains one Z
and two V's that will be imbedded later. Most of the constraints have been employed
already, but a few remain for the imbedding steps.]

#DRAW ATNAMED 1

#l:

c-c-v
I I I
v-c-z


THE DENDRAL GENERATOR 61

#DEFINE SUBSTRUCTURE VCHCO

[C6B: VCHCO defines protons alpha to
both V and C=O to be prohibited.]

(NEW SUBSTRUCTURE)
>cHAIN 4
>JOIN 3 4
>ATNAME 4 0
>ATNAME 1 V
>DRAW ATNAMED

SUBSTRUCTURE VCHCO:

v-c-c=0

>HRANGE 2 1 2
>DONE
VCHCO DEFINED

#IMBED

[Comment: Z will now be imbedded fast. More superatoms could be imbedded now
also .]

SUPERATOM : Z
NUMBER TO BE IMBEDDED:l
SUPERATOM:
THE `EXPANDED' FORMULA IS 0 1 C 8 V 2 H 14
CONSTRAINT: SUBSTRUCTURE VCHCO NONE
                  w31
CONSTRAINT:RlNG 3 NONE      [C91
CONSTRAINT: RING 4 NONE      [C91
CONSTRAINT:

[Comment: As CONGEN begins to consider each structure it prints "#", and for each
new structure produced it prints ".".I

#..#..#..#.# . . . . # . . . . ##..####w## . . . . # .*.. #..##..
29 STRUCTURES WERE OBTAINED
#DRAW ATNAMED 1

[Comment: The following is a sample structure in which Z has been imbedded. Note
that the V's are not yet imbedded.]


62 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

#l:

0
=
ic\ iv\
C   c---c c
\I \I
c-c \ ic
    \ /
     V

[Comment: The V's will now be imbedded.]

SUPERATOM : V

NUMBER TO BE IMBEDDED:2
SUPERATOM:

THE `EXPANDED' FORMULA IS 0 1 C 12 H 14
CONSTRAINT: SUBSTRUCTURE CHO EXACTLY 2

                  [C'?: we must end up with exactly two
                  quaternary carbons.]
CONSTRAINT: RING 3 NONE      [C91
CONSTRAINT:RING 4 NONE      [C91
CONSTRAINT:
#.#.#.#..#..#..#..#..#..#..#..#.#.#.#..#.#..
#.#..#.#..#..#...#..#..#.#.#.#..
47 STRUCTURES WERE OBTAINED

#DRAW ATNAMED (4 6)

[Comment: The following is a selection of final structures.]

#4:

  c--c
/I =\
cc c\
II IC
II I I
c-c--c--c-c=c
=

0


THE DENDRAL GENERATOR 63

#5:

0          C
=
c-c   C=
I I\
I I c---c'
ccl I
  \II I
  c-c c
       = I
      C

#6:

         C
c--c-c=
  /   I \
o==c    I cc
  \   I/ =I
   \ c +
   \/ I=
     C    I c
     \   I/
      c---c

#DRAW ATNAMED 30 31

#30:

     C
    / =
   I c
c--c /I
I \Cl
I   x I
c---c-c-c--c--ccc
=

0


64 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

#31:

    C
   / \
  / \
c cEz=c
/I/ I
cc    I
\\ I
c-c---c--c--(+c
=

0

#EXIT
DO YOU WANT TO SAVE YOUR SESSION ON FILE?:YES
FILE NAME : CONGEN. EXAMPLE
SAVED ON CONGEN.EXAMPLE
EXIT

4.6.2 Stereoisomer Generation

After the connectivity isomers have been generated, it is possible to elaborate some of
the three-dimensional properties of those structures or examine the list in various ways.
CONGEN has deliberately been kept unencumbered by these options. Additional pro-
grams have been written to allow users to look at the different relative orientations of
groups in space (STEREO), rank or remove structures with respect to arbitrary assign-
ments of scores to features (EXAMINE), and determine the plausibility of structures
by looking at known reaction products and the likelihood that each structure would
produce those products (REACT). These and other programs are currently under de-
velopment and so will be mentioned only briefly.

4.6.3 STEREO

Much of organic chemistry involves the positioning of atoms in space. CONGEN is
only a first step toward providing fmal answers to many kinds of problems. For ex-
ample, the biological activity of drugs is known to be closely tied to their three-
dimensional "fitting" into receptor molecules ln the body.

Within the large problem of modeling the positions of atoms in space, it is impor-
tant to specify the possible orientations of parts of a molecule around one or more ap-
propriately substituted trivalent and tetravalent atoms, called stereocenters. The
STEREO program' looks at one structure from CONGEN at a time and defines the
complete set of alternative orientations of parts around all stereocenters, thus produc-
ing for each topological structure in the CONGEN list a set of stereoisomers. For ex-

`The STEREO program was designed and implemented by Dr. James Nourse, who also devel-
oped its theoretical foundations in graph theory and group theory [Nourse (1978b) and Nourse
(1979a)].


THE DENDRAL GENERATOR 6.5

ample, the central carbon in the structure below is a stereocenter in which the four
substituents (Sl to S4) are positioned on the vertices of an imaginary tetrahedron en-
closing the central carbon. The four substituents (Sl to S4) can be positioned either
above or below the plane of the paper:

Sl s3
\/
A
s2 s4

Different stereoisomers result from the following positionings:

Above the plane      Below the plane

Sl, s4          s2, s3
s2, s3          Sl, S4

When there are n stereocenters, there are at most 2" distinct stereoisomers. Two
important features of the generator parallel features of CONGEN: (1) it produces only
the subset of the 2" potential stereoisomers that are distinct and (2) it can be con-
strained to avoid (prospectively) classes of stereoisomers that are less plausible, for one
reason or another.

4.6.4 EXAMINE

Even though a chemist has defined required and forbidden substructures as part of the
specification to CONGEN, it is useful to provide additional interactive capabilities for
examining the list of CONGEN structures under different hypotheses. The EXAMINE
program" allows the user to define additional structural features and find subsets of
structures from the CONGEN list that satisfy Boolean combinations of features.

  It is useful to be able to ask how many structures in a CONGEN list contain iso-
prene units, spiro forms, ring fusions, and complex functional groups without having
to inspect a drawing of each one. Beyond this function, the program allows the chem-
ist to mark the structures found, draw them, save them, remove them, rank them, or
replace the original CONGEN list with the list of structures found.

An example is shown below." The program's requests and messages are printed in
capitals; the user's typing is in bold type and is lowercase.

INPUT FILE: azocine-saved .32st; 1 [OLD VERSION]
READING <GRAY>AZOCINE-SAVED .32ST; 1
THIS IS A FILE WRITTEN BY CONGEN

loEXAMINE was implemented by Dr. Neil Gray.
"From pp. 3-4 of STRUCC manual, by N. A. B. Gray, Stanford University, August 1978.


66 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

(32 STRUCTURES)

xmn

DO YOU REQUIRE SIMPLY TO PRUNE YOUR STRUCTURE LIST?: n
DO YOU WANT TO RANK YOUR STRUCTURES? n
DO YOU WANT TO USE A LIBRARY? y
FILE NAME: <smith>examine . library;1 [OLD VERSION]
READING <SMITH>EXAMINE . LIBRARY; 1
DO YOU WANT ALL SUBSTRUCTURES IN THE FILE? y

(FILE READ OK)

SUBSTRUCTURE C=C . . -PRESENT IN 32 STRUCTURES.
SUBSTRUCTURE MONOSUBSC=C . . . PRESENT IN 19 STRUCTURES.

SUBSTRUC.TURE ALKYNE . . .PRESENT IN 4 STRUCTURES.
SUBSTRUCTURE ALLENE . . . PRESENT IN 0 STRUCTURES.

SUBSTRUCTURE NITRILE . . . PRESENT IN 0 STRUCTURES.

ENTER COMMANDS FOR SELECTING SUBSETS OF STRUCTURES WITH

      PARTICULAR FEATURES.
32 STRUCTURES
-> select
> alkyne
4 STRUCTURES WITH ALKYNE
-> remove
28 STRUCTURES WITH (NOT ALKYNE)
-> done

DO YOU WANT TO CHECK FOR OTHER FEATURES?: n
DO YOU WANT TO FILE ANY OF YOUR SELECTION FEATURES?: n
WOULD YOU LIKE TO KEEP THE SUBSTRUCTUIhS READ FROM THE
FILE? n

4.6.5 REACT

Important structural information about an unknown compound comes from knowing
what chemical reactions produced the compound or what products are formed in re-
actions with it. The REACT program [varkony et al. (1978a) and Varkony et al.
(1978b)] simulates chemical reactions to use knowledge of reactions in structure de-
termination problems. The chemist interactively defines chemical reactions for the


THE DENDRAL GENERATOR 67

program to use. These reactions are carried out by the program on each of the candi-
date structures in the CONGEN list to show the chemist what products one would be
likely to observe from each of the possible candidates. If some products are known,
then the CONGEN list can be pruned man&y to delete candidates that do not lead
to those products.

  Another use of REACT is to delineate the structures that could arise from known
precursors through a complex chain of reactions. The likely products, then, constitute
the most plausible subset of the CONGEN list of candidates for a specific problem.
For example, REACT has been applied to known sterol structures to help determine
which of the CONGEN possibilities would be likely to be formed in nature through
known biosynthetic reactions and chains of known reactions. It is difficult to follow
complex chains manually in order to explore the possibilities. REACT is able to follow
the reaction pathways from the known marine and plant sterols (combinations of
seven naturally occuring sterol skeletons with over 30 known alkyl side chains on the
C-17 position), using nine different reactions and sequences of them. As with the other
programs, REACT is used with chemical constraints on the production of the tree of
possible pathways and products.

In the case of the sterols, the total number of sterols (of many empirical formulas)
that can be produced from the naturally occurring skeletons and side chains (within
biosynthetic constraints) is 1778 [varkony et al. (1978a)] . Spectroscopic data allow
one to look at only the subset of correct molecular weight, e.g., only 264 sterol prod-
ucts have empirical formula Cs9Ha 0. Additional constraints inferred from spectro-
scopic data are used by CONGEN during generation. Thus only a small number of
CONGEN structures will (typically) remain after one has considered biosynthetic reac-
tions in addition to mass spectral fragmentation patterns and structural constraints in-
ferred from other data.


CHAPTER
FIVE

HEURISTIC DENDRAL PLANNING

Planning before generation is a powerful addition to the generate-and-test method,
and is the major design contribution of the DENDRAL system. In the model of scien-
tific discovery embodied by DENDRAL, planning focuses the search on relevant cksses
of hypotheses and away porn irrelevant classes.

5.1 INTRODUCTION

Constraints to keep the generator from producing all possible structures are necessary
for all but the simplest problems. We have seen how certain types of constraints can be
stated in a manner appropriate for the cyclic generator. In CONGEN these constraints
are at present formulated by the user. An early version of the DENDRAL system used
a set of planning rules for aliphatic compounds elicited from an expert mass spectro-
metrist. Each rule specified features of the spectrum that are associated with a particu-
lar structure. The planning phase then examined the spectrum for the specific evidence
and if it was present the associated structure was added as a GOODLIST constraint.
The rules are found in Buchanan, Sutherland, and Feigenbaum (1969). An extension
of this planning method, in which rules are automatically generated by the Planning
Rule Generator, is described in Buchs et al. (1970a).

The current DENDRAL PLANNER program further automates some aspects of
constraint formulation. It embodies a paradigm of mass spectrometry theory that the
users instantiate to produce a particular theory for the particular class of compounds
with which they are working. This theory is not a sweeping generalization but a col-
lection of specific hypotheses about the likely loci of breaks that will occur when a
compound in the class is placed in the mass spectrometer.
Input to the planning phase is: (1) the basic skeleton of the compound class, i.e.,
the structure common to all members of the class, (2) definitions of the various breaks

68


HEURISTIC DENDRAL PLANNING 69

that might occur, and (3) a mass spectrum (either low or high resolution). The pro-
gram determines (usually) the molecular ion (using the MOLION program, described
below) even if the spectrum does not contain a peak corresponding to it, and formu-
lates constraints that specify which sites on the skeleton are likely, and which unlikely,
locations for the nonskeletal groups of atoms. The substructures that are attached to
the skeleton are called substituents, since they substitute for the hydrogens that would
otherwise be there.

5.2 THE EARLY PLANNER AND THE PLANNING
RULE GENERATOR

The first class of compounds to which DENDRAL was applied was the amino acids. In
predicting the behavior of these compounds in the mass spectrometer, it was assumed
that every bond that could break, would break, and they would do so one at a time.
This assumption is the zero-order theov of mass spectrometry, so-called because it
takes into account no site-specific information. This theory proved insufficient for
other classes of compounds, although it worked for the amino acids.

More sophisticated versions of planning were used with the acyclic generator ap-
plied to the aliphatic ketones. Planning information for these compounds was obtained
by careful questioning of mass spectrometrists about ketones in the mass spectrom-
eter, that is, about the kinds of fragmentation processes that were most likely to oc-
cur. This knowledge had never been completely codified, however, and thus the effort
to specify the information for DENDRAL was a valuable exercise. It proved successful
and provided the first version of the system in the full plan-generate-test form where
planning was based on planning rules that encompassed more than the trivial zero-
order theory. These rules took the form:

Set of mfe peaks --> a subgraph

where "-- Y' is read "implies that the molecular structure graph contains."
The successful application to ketones was followed by a similar program for alco-

hols, with new planning rules for that class of compounds derived in similar fashion.
Work was next done for saturated ethers and then saturated amines. At this point simi-
larities were seen among the planning strategies for these classes of compounds. It be-
came possible to develop a general scheme that would generate planning rules for any
saturated acyclic monojkctional (SAM) compounds, that is, any class with empirical
formula of the form C,H a,, + vx, where x denotes a heteroatom of valence u. The gen-
eralized planning program, based on the Planning Rule Generator, was successfully ap-
plied to the saturated acyclic ethers, alcohols, thioethers, thiols, and amines.

The generalized planning program works from a low-resolution mass spectrum
and, optionally, a proton NMR spectrum. These are the only inputs necessary; the pro-
gram is able to determine the empirical formula with a MOLION-like procedure, and
thus can determine the class of the compound if it is one of the SAM classes.
The strategy of the Plannlng Rule Generator is to describe the subgraphs corre-
sponding to all possible configurations of carbons around the heteroatom, and then,


70 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

assuming only alpha-cleavage fragmentation processes, predict fragmentation products
and the combinations of spectral peaks associated with each subgraph. The resulting
rules are then used in the same way as manually written rules to determine constraints
on generation. This combination, alpha cleavage plus systematic generation of such
structures in which alpha cleavage was relevant, proved a successful generalization of
the intuitive rules of the human spectrometrists.

As an example, consider the saturated acyclic amines. The heteroatom in this case
is N (with a valence of 3) hence there can be one, two, or three carbons adjacent to the
heteroatom. Each adjacent carbon can be in one of four forms: it can be of degree 1
(hence part of a methyl radical CHs), it can be of degree 2 (-CHa-), of degree 3, or
of degree 4. Systematic generation of all relevant subgraphs containing the heteroatom
and adjacent carbons (some trivial cases, for example, CHe-NH2, were omitted)
yields 31 forms for this class of compounds. Next, each of these 31 cases can undergo
an alpha-cleavage fragmentation process in seven ways: one, two, or three alpha cleav-
ages at a time, in all combinations. Each possible process yields a fragment containing
the heteroatom, plus one, two, or three fragments containing the remaining atoms of
the empirical formula in question. Those fragments that predict peaks actually present
in the given mass spectrum then become required (GOODLIST) structures for the gen-
eration phase.

These GOODLIST items produced by the planning rules proved able to reduce the
set of possible isomers substantially. More remarkable was the additional reduction
possible when proton NMR data were also supplied. These data determine the exact
number of methyl radicals present in the molecule. This information sometimes was
sufficient, in conjunction with the GOODLIST items from the mass spectrometry rules,
to constrain the generator to the production of very few candidates. For example, the
number of isomers of NJV-dlmethyl-l -octadecyl amine is 14,7 15,8 13; the number of
inferred isomers using the Planning Rule Generator plans and the mass spectrum of
that compound is 1,284,792; the number of inferred isomers using both MS and pro-
ton NMR planning rules is one!'

Additional examples are given in Section 8.3.

5.3 MOLION

The fast step in planning is to determine the molecular ion. This determination is ac-
complished by a heuristic program called MOLION [Dromey et al. (1975)], which is
also usable as a separate, stand-alone routine. The program works with either a low-
resolution or high-resolution spectrum to compute a ranked set of masses (from low-
resolution input) or compositions (from high-resolution input) that are candidate mo-
lecular ions. It is not always successful, but for 265 compounds covering 10 different
classes it has included the correct candidate among its top five choices in 97 percent of
the cases; in 89 percent of the cases the correct candidate was among the top three

`The reason for such dramatic reduction in this case is that the NMR spectrum was inter-
preted as showing evidence for exactly two methyl radicals, and only a straight chain satisfies this
constraint.


HEURISTIC DENDRAL PLANNING 71

choices. The program is limited to compounds of carbon, hydrogen, oxygen, and ni-
trogen, and depends on a relatively clean and complete spectrum.

If a peak for the molecular ion is present in the spectrum, it will be at highest
mass or just below (the peak at highest mass could be the molecular ion with higher
mass isotopes of some of its atoms). However, in roughly 20 percent of all spectra
there will be no peak in the spectrum corresponding to the molecular ion; in this case
the mass of the molecular ion is greater than that of the largest peak present. If we can
ignore the possibility of impurities, the peak of next greatest mass after the molecular
ion is from a fust fragment of the molecule; the difference between it and the molecu-
lar ion mass is called a primq loss. Other peaks may also be from first fragments of
the molecular ion; or they may be from fragments of fragments, called secondary frag-
ments In the latter case, the mass loss suffered by the fragment to produce a second-
ary fragment is called a secondary loss. All interpeak differences are secondary losses
except when one of the peaks is the molecular ion peak or when the peaks differ by
amounts that could be interpreted as isotopic differences or as transfers of one or
more hydrogens. In addition, any low-mass peaks could be due to a secondary frag-
ment. Thus the smaller masses are also presumed by the program to be equal in mass
to secondary losses.

MOLION is based on the MOLION postulate: There exists at least one secondary
loss in any spectrum that will match a primary loss whether or not the molecular ion is
present in the spectrum. That is, we assume that some composition that breaks from
the parent molecule as a primary unit will also break from some fragment as well (see
Figure S-1). MOLION determines all possible secondary losses and adds them to the
masses of the larger fragments (those in the upper haLf of the spectrum) to generate a
set of molecular ion candidates. If the MOLION postulate is correct, this set will in-
clude the true molecular ion. The final step is to rule out the unlikely candidates and
order the remaining ones according to likelihood.

MOLION is organized in a plan-generate-test fashion. The planning stage deter-
mines the masses or compositions that are candidate secondary losses. The generate
stage combines these in all ways with the larger masses or compositions from the spec-
trum. The test phase eliminates some of the generated molecular ion candidates and
orders the remaining ones by likelihood.

5.3.1 MOLION Planning Phase

This is the most complex part of MOLION. The fust step is to simplify the spectrum
by converting it to a list of "clusters," sets of peaks separated by less than 3 amu. The
three most intense peaks in a cluster are kept and the others are discarded. Then any
peak within a cluster that is less than one-third of the largest peak in the cluster is also
discarded. This procedure is used to eliminate noise (low-intensity peaks). Simply dis-
carding peaks below a threshold that is the same for the entire spectrum would elimi-
nate some low-intensity but highly informative peaks frequently found at the high-
mass end of the spectrum.

The program contains a list of bad losses. A bad loss is a mass that can be ruled
out on chemical grounds. These normally would include masses 4 to 11, which are too


72 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Primary fr:

Secondary fragment FBf
\

Secondary
loss B' t

M'

Figure 5-l The molion postulate. There exists a primary loss A and a secondary loss B' such that
A = B', hence M+ = FA + B' (whether or not M+ appears in the spectrum).

small to be from atoms found in organic compounds, 12 and 13, which could only be
from C and CH, ions that almost never appear, and other higher masses that cannot be
formed from elemental masses or that correspond only to compositions that almost
never occur. The complete list is

Badlosses.  (4 5 6 7 8 9 10 11 12 13 20 21 22 23 24 25 34 37 38 48 49
  50 51 53 65 66 76 79 80 81)

  Also maintained is a list of bad compositions that serves the same function as the
bad losses when a high-resolution spectrum is available. The definitions of bad compo-
sitions are given in the form of restrictions on the values that may be assumed by the
subscripts x, y, z, and n in the formula C,H,,O,N,. The restrictions are

Bad compositions:
  XC0  or y<O or z<O or n<O
  x>O and y=O and z=O and n=O
x=0 and y>2 and z=O and n=O
  x=0 and y=O and z>O and n=O
  x=0 and y=O and z=O and n>O
x=0 and n=O and [z>y  or y>2z]
x#O and y>(2x+3)
x#O and z>(xtl)
  x#O and y#O and x>ytl

The program makes first use of the bad losses or bad compositions to determine if
there is a molecular ion candidate in the spectrum. The highest-mass peak is compared
to its lower neighbors to see if any of the differences correspond to bad losses or bad


HEURISTIC DENDRAL PLANNING 73

compositions. A peak that shows no bad losses is a candidate molecular ion. It and
other candidates are subjected to further tests later.

The spectrum is then examined to determine the dominant series, if one exists.
This is the longest series of peaks that differ by multiples of 14 or CH2. The series will
consist either of odd masses or even masses. A dominant odd-mass series implies that
the compound contains an even number of nitrogens, perhaps zero, and the mass of
the molecular ion must be even. Conversely, a dominant even-mass series means that
the compound contains an odd number of nitrogens, and the mass of the molecular
ion must be odd. Occasionally there will be even and odd series of equal dominance; in
this case no decision is made about nitrogen parity. If the nitrogen parity of `the molec-
ular ion mass is determined by this procedure, and the largest mass peak in the spec-
trum is of opposite parity, we may conclude that no molecular ion peak exists in the
spectrum (see Section 2 J .4).

Next, secondary-loss candidates are produced by computing mass differences be-
tween all pairs of peaks. Again bad losses and bad compositions are discarded. Other
candidates are discarded if they are greater than half the largest mass in the spectrum
or otherwise "too large" (an arbitrary limit may be imposed; the default is 115 amu).
The remaining set is augmented with all the masses in the lower half of the spectrum,
which are presumed to be secondary losses. Finally, for each even-mass secondary-loss
candidate, the mass of 1 amu less is added to the set of secondary losses because hy-
drogen transfer is likely to have yielded the (generally stable) even mass whereas the
next lower mass was the one actually produced initially.

Each secondary-loss candidate carries a weighting to indicate the strength of the
evidence supporting its candidacy. This weighting is simply the sum of all the lntensi-
ties of peaks from which the candidate "arose." For a candidate arising from an inter-
peak difference, the weighting is the sum of the intensities of the two peaks; if the
same candidate arose from several inter-peak differences, all the intensities are summed.
Candidates from peaks in the lower half of the spectrum have weighting equal to their
intensity. Odd masses arising from even masses one greater adopt their parent's weight-
ing. Those candidates that arise in several ways have the combined weighting from all
SOUUXS.

The resulting set may then be used as the set of secondary losses, or it may be
further reduced by an additional heuristic. This heuristic searches the set of secondary-
loss candidates for series that differ by multiples of 14 amu or by one or more CHa
compositions; only the lower members of each series are chosen as secondary-loss
candidates.

The set of secondary losses and the nitrogen parity, if known, are passed to the
generating phase.

5.3.2 MOLION Generating Phase
The generating phase is straightforward. Each member of the secondary-loss set is
added to each peak in the upper half of the spectrum. Any results having incorrect
nitrogen parity are immediately rejected. Any results that are less than the largest peak
in the spectrum are also rejected. The sum of the secondary-loss weighting and the


74 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

upper spectrum peak intensity yields a weighting for each molecular ion candidate. If a
candidate arises from more than one combination, its weighting is the sum of its
sources' weightings.

5.3.3 MOLION Testing Phase

The basic idea behind the testing phase is to predict for each molecular ion candidate
those losses that the candidate must suffer in order to produce the observed spectrum.
To the extent the required losses are improbable, the candidate is improbable. The mo-
lecular ion candidates are divided by the testing phase into three categories: rejects,
unlikelies, and probables.

Differences between each candidate and the prominent peaks in the spectrum are
computed. Candidates that must suffer bad losses or bad compositions to produce ob-
served peaks are rejects.

Two additional mass lists are kept. The poor primmy-loss list contains masses that
are unlikely to be from first fragments of the molecule. The poor secona'my-loss list
(a subset of the poor primary-loss list) contains masses that are unlikely to be either
primary or secondary losses. This list is like the bad loss list except that its entries are
not chemically impossible, merely unlikely. The lists are

Poorprimmy losses.  (3 14 19 26 27 39 40 54 62 64 67 68 70 82 83 84
  86 88 89 90 91 92 93 94 95 96 98 99 103 104 105 106 107 108
  109 110)
Poor secondary losses.  (3 14 39 64 67 82 84 86 94 95 96 98 103 107 108
  109 110)

Candidates that must suffer poor primary lcsses to produce the spectral peak of
greatest mass or that must suffer poor secon/lmy losses to produce other observed
peaks are categorized as unlikelies.

The remaining candidates are categorized as probables. The probable candidates
are then ranked by their weightings, normalized to 100. The output is the top mem-
bers of this list (the number of members to include in the output is user-selected).

5.3.4 An Example of MOLION Performance
We will trace through this procedure for the compound dimethylmalonic acid n-butyl
ester whose reduced low-resolution spectrum is

Mass

Intensity

41        44
57        48
59        23
70        15
73        12


HEURISTIC DENDRAL PLANNING 75

Mass     Intensity


88       100
115        46
133        14
143        18
144        16
171        95
189        26

5.3.4.1 Planning The dominant series in this spectrum is 59, 73, 115, 143, 171, an
odd-mass series. I-his means the molecular ion has even mass, so it is not present in the
spectrum.

We next tabulate all interpeak differences for this spectrum and indicate those
that are rejected by virtue of being bad losses or being larger than the default cutoff of
115.

Differences between each peak and lower peaks

Peak

Lower peaks

     171   144   143   133   115    88    73    70    59    57    41
41
57                                                     16
59                                                  2    18
70                                          11*    13*    29
73                                        3     14    16    32
88                                15    18    29    31     47
115                             27    42    45    56    58    74
133                        18    45    60    63    74    76*    92
143                  lO*   28    55    70    73    84    86    102
144               1    ll*   29    56    71     14    85    87    103
171          27    28    38*   56    83    98   101    112    114    130!
189    18    45    46    56    74   101   116!   119!   130!   132!   148!

*Indicates bad loss.
!Indicates "too large."

  To the set of all distinct numbers in this table is added those that are one less than
any even member. Then the bad losses and redundancies are removed. The union of
the resulting set with the set of masses from the lower half of the spectrum, (41 57
59 70 73 88), produces the set of secondary-loss candidates: (1 2 3 14 15 16 17
18 27 28 29 31 32 37 41 42 45 46 47 55 56 57 58 59 60 63 69 70 71 73 74 75
83 84 85 86 87 88 91 92 97 98 101 102 103 111 112 113 114). This set has
48 members.
If we were to use only the first few members of each difference-14 series, we

would select from this set of series:


76 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Loss series with differences that are multiples of 14

28     42     56     IO     84     98     112
15     29     57     71     85
58     86     114
18     32     46    60     74     88    102
27     41     55     83
31     45     59    73     87     101
47     103

5.3.4.2 Generating In this example we will use the full set of candidates. Each candi-
date secondary loss is added to eachupper halfpeak: (115,133,143,144,171,189).
There are 48 times 6 or 288 such sums, not all distinct. The generator rejects sums less
than 189 (the largest peak) and all odd sums, because of the required even nitrogen
parity. This reduces the list of molecular ion candidates to 46.

5.3.4.3 Testing From each molecular ion candidate we subtract the largest mass rep-
resented in the spectrum, 189, to see what that candidate's primary loss would be. The
poor primary-loss list is used to reject bad candidates. Then the next two largest
masses represented in the spectrum, 17 1 and 144, are subtracted from the remaining
candidates and any differences that are found in the poor secondary-loss list result in
further casualties. These computations are summarized in the following table, which
also includes the weighting associated with each candidate.

Candidate M+      Less 189      Less 171      Less 144     Weighting

  190           1         19          46           392
  192           3**        21*         48           49
  196           7*         25*         52*           29
  198           9*         27          54           1154
  200           11*         29          56           857
  202          13*         31          58           556
  204           15          33          60          318
  206           17         35          62           725
  208          19**        37          64***         171
  212          23*         41          68           254
  214          25*         43          70            73
  216           27**        45          72          1504
  218          29          47         74           845
  220          31         49          76*          368
  224           35         53*         80           58
  226           37          55         82***         947
  228          39**        57          g#$***         431
  230          41         59         86***         488
  232          43         61          88           100
  234          45         63         90           626
  236           47         65*         92           888
  240          51*         69          96***         152
  242          53*         71         98+**        135
  244          55          73         100          1175
  246           57         75         102          469


HEURISTIC DENDRAL PLANNING 77

Candidate M+      Less 189      Less 171      Less 144     Weighting


   248          59          77         104           49
   252          63         81        lo%***         29
   254          65*         83        110***         359
   256          67**        85         112           366
   258          69          87         114           352
   260           71         89         116            28
   262          73         91         118           333
   264           75         93         120            62
   268          79*         97         124           107
   272          83**        101         128           534
   274           85        103***       130           165
   276          87         105         132           164
   280          91**       109***       136            58
   282          93**        111         138           118
   284          95**       113         140           143
   286          97         115         142           107
   290          101         119         146           298
   292         103**       121         148           60
   300          111         129         156           118
   302          113         131         158          143

*Denotes bad loss.
**Poor primary loss.
***Poor secondary loss.

Of the 18 acceptable candidates, 244 has the largest weighting and is in fact
known to be the mass of the molecular ion of this compound.

5.3.5 Optional Heuristics in MOLION

If the program as just described fails to narrow the list of candidates sufficiently, there
are additional options.
1. Candidates may be rejected if there is no metastable ion support, that is if they
show no true daughter ion peaks.

2. A spectrum obtained using a low ionization voltage normally will show a strong
relative peak at the molecular ion because other fragmentations are less likely.
This will be the case even though a spectrum obtained at normal voltages does not
show this peak because the greater intensities of other peaks place it in the noise
level. Candidates that show no peak at low ionization voltage may be rejected.
3. If there is a pair of candidates, differing by one or two H's, the lower may be
automatically rejected.

4. If there is a pair of candidates, the higher of which is less intense and can be ac-
counted for by variations in abundance of natural isotopes, that higher one may
be automatically rejected.

5. The user may insist that the molecular ion is present in the spectrum if that is gen-
erally true for compounds of the class in question. (This is true of the estrogens,
for example .)


78 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

5.4 EMPIRICAL FORMULA

If MOLION has selected a molecular ion candidate from high-resolution data, then the
composition, that is the empirical formula, is known. If only a low-resolution spec-
trum was available, further work must be done to determine the empirical formula
from the mass of the molecular ion. At present DENDRAL does not use the pro-
gram that was written to perform this determination; the empirical formula is deter-
mined by other means (often high-resolution mass spectrometry) and supplied to the
PLANNER by the user. The reason is that the program can never produce a unique an-
swer when both nitrogen and oxygen are possible, since -NH? and =O both have
nominal mass contributions of 16 amu.

5.5 GENERALIZED BREAK ANALYSIS

For many analytical problems, it is known what class of compounds is under investiga-
tion, particularly when the source of the material is known and the empirical formula
of the molecular ion has been determined. If chemists have experience with this class,
they may be able to predict the fragmentations, or breaks, that are most likely to have
occurred. This class-specific information can be used to produce constraints that will
reduce the DENDRAL generator's output.

Breaks are defmed by specifying (1) the bonds that break, (2) the charge loca-
tion, (3) any accompanying hydrogen transfers, and (4) any accompanying losses of
small molecules such as water. Breaks are represented schematically with wavy lines
as illustrated in Figure 5-2.

From the empirical formula and the definition of the class skeleton, the program
can readily determine the numbers and types of atoms and unsaturations that are not
part of the skeleton and which thus are available to form the substituent structures
that distinguish the particular compound under investigation. This capability is shown
in a simplified example in Figure 5-3. It remains to determine the exact composition
of each substituent and its location on the skeleton. To do this determination, the
mass spectrum is consulted for evidence that can be associated with each of the hy-
pothesized breaks. In general, all these breaks may have occurred, but the fragments
resulting from a particular break will have compositions that differ depending on how
the substituent atoms are divided among the fragments. The program determines for
each break all the ways the substituent atoms may be divided and the evidence in the
spectrum associated with each division. This process of course does not determine the

'

I

2 m 6

5  Figure 5-2 Schematic representation of a fragmentation. This fragmentation
  involves breaking bonds between atoms 1 and 6 and between atoms 4 and 5.
  The arrow indicates (positive) charge placement on the larger fragment. No hy-
  drogen transfers or neutral molecule losses are indicated in this example.


HEURISTIC DENDRAL PLANNING 79

     I         8

          9
2                  7
w
3                  6    C
          S

4
    B

       (a)                          (b)

Fiie 5-3 Simplified example of reasoning by the DENDRAL planner. (a) The mass spectrum
contains a peak corresponding to the mass-to-charge ratio of fragment C withour an OH substit-
uent and a peak corresponding to the mass-to-charge ratio of fragment B with an OH substituent.
(b) Thus the DENDRAL planner is able to infer that the OH substituent is probably in the part of
fragment B that is distinct from fragment C, i.e., at node 1, 2, or 9.

exact location or composition of a substituent. However, combining the information
from all the breaks further narrows the possible arrangements.

The DENDRAL PLANNER has been successfully applied to the estrogens, and
this application will serve as an illustration of its potential. The user first defines the
characteristic skeleton of the class using the structure-editing commands of CONGEN.
As illustrated in the example at the end of the last chapter, these commands permit
the definition of rings and chains of carbon atoms; these may be modified by renaming
some atoms (to other atom types), by increasing the bond order between atoms (with
JOIN a b), by growing chains from given atoms (BRANCH a n creates a chain of n
atoms from atom a), and by setting the free valences of atoms. The structure being
formed may be drawn (on the terminal) with either letter names for atoms (ADRAW)
or numbers for each atomic position (NDRAW). The following is a record of a session
in which the estrogen skeleton is constructed (and named EST). User-typed commands
follow the system prompt symbols "#" and "Y', or are replies to questions. They are
in bold type. Other typing was done by the program.

WELCOME TO THE DENDRAL PLANNER.
TYPE ? AT ANY TIME (REALLY!) FOR HELP IN INTERPRETING WHAT
THE PROGRAM WANTS.
USE <CNTRL>-E (PRESS THE CNTRL AND E KEYS SIMULTANEOUSLY)
TO GET TO COMMAND MODE. THIS USUALLY CANCEI,S THE EFFECT
OF THE PREVIOUS COMMAND.
CLASS NAME : EST

GET CLASS PARAMETERS FROM A FILE (Y/N) ? N
READ A NEW MASS SPECTRUM (Y/N) ? N

START PLANNING (Y/N)? N
WANT HELP (Y/N)? N
# EDIT STRUC
(NEW STRUCTURE)
XHAIN 10


80 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

>JOIN 1 2 3 4 5 10 5 10 10 1

[Comment: The partially built structure is drawn to see where to add the next piece.]

>NDRAW

EST
6 4
/\ /=
7 5 3
I      I
8 1; 2
\/ \=
9 1
>BRANCH 9 7

[Comment: Again, the partial structure is drawn before adding the final specifications.]

>NDRAW

EST
3-2
4=   =
\ I1
5=10
/ \
6    9-1-1-1-1-1-1-17
\ / 123456
7-8
>JOIN 14 8 17 13
>BRANCH 13 1
>NDRAW

EST
  A /"=
     7 5 3
    I    =   I
y\ ,8\ :O\ z2
16 14 9 1
I I I
17---I3 11
  / \/
18 12
>DONE


HEURISTIC DENDRAL PLANNING 81

SKELETAL COMPOSITION: ((I-I . 24) (C . 18))

Next we enter our "theory" of the mass spectrometry of estrogens. This entry
takes the form of specifying possible breaks (done by listing the names of bonds, i.e.,
node pairs, that are broken), by indicating which fragment will bear the charge (done
by naming any atom in the ion), and indicating how many hydrogen atoms might mi-
grate upon fragmentation (each potential hydrogen transfer is indicated by a signed
number denoting the number of possible transfers to the ion; there may be more than
one possibility).

Note that the form of the planning rules has changed from the early version of the
planning program. Instead of requiring sets of diagnostic peaks associated with every
possible configuration of relevant subgraphs, the program now accepts rules of the form:
subgraph ==> break, Interpreted as "when the graph contains the given subgraph, infer
that the particular break will occur." These rules are more natural to the chemist and
constitute the codification of fragmentation knowledge commonly used in texts. With
this change, the Planning Rule Generator was subsumed in the planning procedure
itself.

For the estrogen example we have the break definitions in Table 5-1, pictured in
Figure 5-4.

This information is given to the PLANNER in the following dialogue. The pro-
gram's one-word requests for information terminate with ":" and the user's replies fol-
low immediately in bold type. The user has typed "?' at certain places to elicit ex-
planations from the program to make the dialogue self-explanatory.

Table 5-l Estrogen breaks

Name     Break definition

Transfer hydrogens

Charge on:

B       (14.15)(13.17)        t-1901            14
C       (9.11)(14.13)(15.16)     C-1,0)             9
D      (9.11)(14.13)(16.17)     C-2, -1)            9
E       (11.12)(8.14)        C-1,0)             11
F       (9.11)(8.14)         (-1,O)             9

Figure 5-4 The estrogen skeleton with
break definitions.


82 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

# BREAKS
LABEL: B
BOND: ?

ENTER THE NUMBERS OF THE ATOMS BETWEEN WHICH THE BOND IS
BROKEN.
FOR EXAMPLE,
BOND: 3 7
IF THE BREAK IS BETWEEN ATOM 3 AND ATOM 7. YOU MAY ENTER
ONE PAIR OF NUMBERS PER LINE.
THE FIRST ATOM MENTIONED (IN THIS CASE 3) SHOULD BELONG TO
THE CHARGED FRAGMENT.
SIMPLY USE CARRIAGE RETURN WHEN YOU ARE FINISHED ENTERING
BONDS FOR THIS BREAK.
BOND: 14 15
BOND: 13 17
BOND:
HTRANS: ?

ENTER A LIST OF NUMBERS WHICH CORRESPONDS TO THE NUMBER
OF HYDROGENS TRANSFERRED INTO OR OUT OF THE CHARGED
FRAGMENT. (NEGATIVE IF HYDROGENS MIGRATE OUT.) FOR EXAM-
PLE -
HTRANS: 1 0 -1
INDICATES THAT ONE HYDROGEN IS TRANSFERRED OUT, OR ONE IS
TRANSFERRED INTO THE CHARGED FRAGMENT, OR NONE MOVE AT
ALL.
HTRANS: -1 0
LABEL: C
BOND: 9 11
BOND: 14 13
BOND: 15 16
BOND:
HTRANS: -1 0
LABEL: D
BOND: 9 11
BOND: 14 13
BOND: 16 17
BOND:
HTRANS: -2 -1
LABEL: E
BOND: 11 12
BOND: 8 14
BOND:
HTRANS: -1 0


HEURISTIC DENDRAL PLANNING 83

LABEL: F
BOND: 9 11
BOND: 8 14
BOND:
HTRANS: -1 0
LABEL:

[Comment: The user now asks to see the value of BREAKS as a check.]

# BREAKS?

  , . . . . . . . . . . . . . . . . . . . .
LABEL: B

BONDS: ((14 . 15) (13 . 17))
HTRANS: (-1 0)

  . . . . . . . . . . . . . . . . . . . . .
LABEL: C

BONDS: ((9 . 11) (14 . 13) (15 . 16))
HTRANS: (-1 0)

  . . . . . . . . . . . . . . . . . . . . .
LABEL: D

BONDS: ((9 . 11) (14 . 13) (16 . 17))
HTRANS: (-2 -1)

LABEL: E

BONDS: ((11 . 12) (8 . 14))
HTRANS: (-1 0)

  . . . . . . . . . . . . . . . . . . . . .
LABEL: F

BONDS: ((9 . 11) (8 . 14))
HTRANS: (-1 0)

# SAVE
FILE NAME: PLANNER.EST
PLANNER.EST;l HAS BEEN SAVED.
# DONE
BYE

5.5.1 Producing Constraints
The first step is to predict for each break what possible ions could result. In general,
ions possible for a given break have compositions consisting of at least the skeletal
fragment (less any net losses of hydrogen) and at most the skeletal fragment plus all
substituents (plus any possible net gains of hydrogen). Computing possible ions for
each defmed break is thus straightforward. In our example, consider estrogen break B


84 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

and a compound with empirical formula C ls Hz4 O2 . Break B will leave an ion contain-
ing 15 carbons and 18 hydrogens. Or it may contain 15 carbons and 17 hydrogens,
since the break definition permits one migration of H away from the ion. The substit-
uent atoms are two oxygens. Either, both, or neither of these could be on the ion; in
each of these three cases 17 or 18 hydrogens could remain. Hence six possible ions
could result from break B. They are organized into three ion series, where ions are in
the same series if they differ in composition only by possible hydrogen transfers:

C1sH1~02, ClSH1702

The next step is to find evidence in the spectrum for each of the possible ions and
sum the evidence within each ion series. The user has other optional constraints which
may be applied. For example, the intensities of the corresponding peaks may be re-
quired to exceed a threshold; the threshold may be set differently for each break if
the chemist believes that certain breaks always give prominent peaks.

After this analysis we have for each break an ion series that has greatest empirical
support. The next step is to consider each possible combination' of these series with a
Chinese menu algorithm: one from break B, one from break C, and so forth. Some of
these combinations may be impossible, and others may restrict the substituents to a
single locus or a range of them.

For example, a spectrum actually produced from estradiol, the isomer of C 18 H24 O2
in which the oxygens are at nodes 3 and 17, should contain strongest evidence for the
single-oxygen series for each of the five break definitions. Accordingly, PLANNER can
determine the following. Exactly one oxygen is on one of the nodes 1 to 10 (from
break F evidence); nodes 11, 14,15, and 16 do not have an oxygen (else break D or E
would have yielded double-oxygen series evidence); nodes 12,13, and 18 do not have
an oxygen (else break B would have yielded double-oxygen series evidence). Thus the
second oxygen must be at node 17, These constraints will substantially reduce the
number of isomers of C r8 H24 O2 that the generator would otherwise produce.

The constraints thus determined are suitable for use by the GOODLIST and BAD-
LIST mechanisms of the generator. Additional information may also be supplied with
GOODLIST and BADLIST. For example, naturally occurring estrogens typically have
an oxygen at a particular site on the skeleton (node 3); if the compound is known to
occur naturally, this structural feature may be added to GOODLIST. In addition, the
program makes a thorough analysis of any proposed structures and rules out all those
that would violate valence constraints.

If no possible structures remain, that is, if the constraints rule out all possibilities,
the PLANNER relaxes its criteria on the empirical evidence and tries again3

2This combinatorial generator under constraints bears surface similarities to CONGEN but is
less general.

3This capability, too, is under the control of the user, giving a significant degree of control over
the feedback criteria. For example, the user may wish breaks C and D to be relaxed first since they
are less reliable than the other breaks.


HEURISTIC DENDRAL PLANNING 85

5.6 CONCLUSION

The DENDRAL PLANNER can be useful as a stand-alone program, for it may reduce
the number of possibilities to the point where there is no need to generate them by
computer. More generally, however, the constraints produced by PLANNER, along
with any others that the user wishes to apply for whatever reason (and from whatever
source), are passed to the generator.

It is clear from this description that PLANNER will be of assistance only when we
are explaining a mass spectrum from a class of compounds for which we have some
prior experience that permits the definition of reasonable mass spectrometric breaks.
This is frequently not the case. Other types of planning-constraint selection-may
then be needed. Often the only solution is to specify them "by hand" directly to
CONGEN.

The PLANNER, and its component MOLION, are good illustrations of the design
of the DENDRAL system and the general philosophy of design that characterizes the
project. No explicit formal theory underlies these programs. Describing them, even in
the idealized fashion we have employed in this chapter, is at best clumsy. However,
their ad hoc character is their strength when combined with program flexibility. Since
so much of any scientist's knowledge is intuitive and judgmental, it cannot be readily
formalized. Programs such as those we have just described nonetheless permit this
knowledge to be employed in useful ways. The processing speed and clerical superior-
ity of the computer in fact amplify, in many cases, the power of the scientist's infor-
mal knowledge. A particular case in point is the PLANNER's analysis of spectra taken
from unseparated mixtures of estrogens, described in Smith et al. (1973a) and in Chap-
ter 8. The record-keeping and cross-checking demands of this task are too great to per-
mit a thorough job by hand.


CHAPTER
SIX

HEURISTIC DENDRAL TESTING

  Verification is the best understood part of the scientific enterprise, but it is
usually discussed outside the context of discovery. In DENDRAL, the verification pro-
cess is an important stage in the discovery process, for by testing the generated hy-
potheses the program can better select the most plausible ones. DENDRAL 3 testing
program contains a predictive theory of mass spectrometry from which testable predic-
tions are made. Some hypotheses can be discarded if their predicted data are incon-
sistent with observation; the rest are ranked in order of plausibility.

6.1 INTRODUCTION

If planning were perfect and generating were exhaustive, no spurious solution candi-
dates would be produced and no solutions would be missed. DENDRAL planning,
however, is not perfect and so a testing phase is applied to each candidate.

There are two reasons why planning cannot be perfect even in principle. First
there may be tests that can only be applied to fully specified solution candidates or
to sets of them. Second there may be tests that are too costly to apply in the planning
phase but are not too expensive to apply to the smaller set of solution candidates.
Both these factors operate with DENDRAL.

The constraints that DENDRAL planning produces are conditions that exclude or
specify classes of structures defined by the presence of certain substructure features
or global properties. A molecular structure that meets all the constraints may none-
theless have properties by which it can be recognized as a spurious solution. Further-
more there are ways in which candidates can be ranked, and rankings necessarily
involve comparisons among sets of candidates and can thus not be formulated as
a priori constaints on generation.

Some of the tests that can be used to reject proposed structures require data

86


HEURISTIC DENDRAL TESTING 87

from metastable defocusing experiments (see Section 2.5.2). These data are expensive
to collect. Therefore the experiments are done only for those cases that pass the plan-
generate phases of DENDRAL.

The program that tests the generator's output might have been called the TESTER
because of the way it is used, but it has been called the PREDICTOR because of what
it does. This program is driven by a set of rules, called productions, that define a
theory of the behavior of compounds in a mass spectrometer. The productions state
that structures of a given form will fragment in certain ways. They are thus like the
rules used in PLANNER, except that the format is more general. Given a set of pro-
ductions, PREDICTOR applies them to a proposed structure graph to predict what
ions will be produced; the productions are applied recursively to all ion graphs they
produce. The result is a predicted mass spectrum that can be compared to the actual
data from which DENDRAL began. Structures that produce spectra in close agreement
with the data are ranked highly. PREDICTOR also predicts metastable peaks, and
further laboratory work may be able to distinguish among the best final candidates.

6.2 PREDICTOR PRODUCTION SYSTEM

PREDICTOR is based on a production system control structure [Newell (1972)]. A
production is a rule that defines a situation and an action to be taken when that
situation exists. The control structure is a regimen for the application of productions
and for recording and processing the results of the application.

The situation-part of a PREDICTOR production describes a chemical graph. The
action-part of the production consists of a set of operations that alter the graph to
produce other graphs. The action-part may contain a complete production as a com-
ponent, so that some operations are performed conditionally. The operations that
PREDICTOR permits are any INTERLISP functions (Section 3.4); in fact they define
fragmentations, hydrogen transfers, and means for computing relative abundances of
the products of the fragmentation processes.

The PREDICTOR control structure applies the production rules to a set of ions.
First a molecular ion is constructed and placed as the only item on an ion list. The set
of productions is scanned, and each one that is applicable is applied to produce one or
more new ions that are then added to the end of the ion list. When all applicable pro-
ductions have been applied, the current ion is put into the spectrum list and the next
ion on the ion list is selected. When all ions on the ion list have finally been processed
(or the maximum permitted depth of recursion has been reached), the procedure is
complete. The spectrum list then corresponds to a mass spectrum, since each entry is
an ion that has a mass or composition, and each has associated with it a number that
denotes its abundance. Note that some ions may have several entries on the spectrum
list if they arose from more than one fragmentation process. The abundances are
accumulated and normalized to produce the mass spectrum prediction. For each peak
other than the molecular ion a metastable peak (M*PEAK) is computed. [Recall that
if d is the mass of the (daughter) peak and p is the mass of the (parent) molecular ion,
then the corresponding metastable peak is at mass d2/p. See Section 2.5.2.1


88 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

6.3 GRAPH STRUCTURE AND PRODUCTION REPRESENTATION

While it is not necessary to know the details of the INTERLISP data structures used
by the program to understand its logic, it will be convenient to introduce some of
these details because they enable descriptions to be given in linear form that is both
more compact and more convenient to reproduce than graphs.

6.3.1 Representation of Chemical Graphs
Each node of a chemical graph is given a number and a name. These are redundant and
both exist only for reasons having to do with INTERLISP conventions, but we include
both in our examples so that they correspond to program listings. The node is de-
scribed by indicating the type of atom, its connectivity to other nodes, the number
of unsaturations (double bonds) from that node (these are called "dots"), and the
number of hydrogens attached to the node. Connections are indicated by a list of node
names enclosed in parentheses. The entire node description is enclosed in parentheses.
Finally the list of nodes defining a structure is enclosed in parentheses along with the
name of the structure.'

To illustrate, consider &HsOH. We arbitrarily use the number of a node as its name.

NODE DIAGRAMS

ATOM    ATOM
NAME    TYPE
-------- ---------
1       C
2       0
3       C
4       C
5       C
6       c
7       C

6 =7
/    \
5      1  - 2
=     =

4- 3

NODE
NUMBER
--------
1
2
3
4
5
6
7

  H H
  c=c
/    \
HC      C - OH
  = c - c=
  H H

NEIGHBORS    DOTS    NUMBER OF
                 I-IYDROGENS
-------------------_-----------
(2  3 7)       1      0
(1)          0       1
(1 4)      ;l       1
(3 5)         1       1
(4 6)        1       1
(5 7)        1       1
(1 6)        1       1

`The original representation of a chemical graph was as a LISP list with sublists indicating
branching. A second notation was as a list of LISP atoms [for example, (Cl, C2, C3)], each with its
own property list indicating the properties of NEIGHBORS, NUMBER OF HYDROGENS, DOTS,
etc. The representation described here is faster and more compact because it uses fvted positions ln
lists instead of explicit names and values.


HEURISTIC DENDRAL TESTING 89

The complete notation is (spacing on the page is irrelevant and is chosen for reada-
bility):

(PHENOL
    (1  c  1 (2 3 7)  1 0)
    (2 0 2 (1) 0 1)
    (3 c  3 (1 4) 1 1)
     (4 c 4 (3 5) 1 1)
    (5 C 5 (4 6) 1 1)
    (6 C  6 (5 7) 1 1)
    (7 C  7 (1 6) 1 1)
1

The same notation is used to describe classes of structures in which some of the
information is not completely specified. In particular, substructures are defined in
such a way that their connections to larger structures are not uniquely defined. The
symbol X when used in a connectivity list denotes exactly one connection to a node
outside the subgraph. The symbol "--" means "don't care." When used in the position
of a node, "--" denotes zero or more connections outside the substructure; when
used instead of an integer as a dot or hydrogen-count parameter, it indicates any in-
teger value, including zero. When actual numbers are not needed by INTERLISP, X
may also appear as a node number, as is the case with substructures. Thus the ketone
substructure is

(KETONE

    (1 c X(2 XX) 10)       x-c-x
    (2 0 x (1) 1 0)               =
>                             0

The alcohol substructure is

(ALCOHOL
    (1 c x (2 x --) --)       X-C-OH
    (2 0 x (1) 0 1)
1

6.3.2 Representation of Productions

Each production consists of a situation-part and an action-part. The situation-part is a
predicate, which is either true or false of the structure under consideration. For ex-
ample, the predicate (WHERE X) evaluates to true if X is a substructure of the active
ion, that is, the one to which the production is being applied. The special argument-
free predicates NIL and DEFAULT may be used as the situation-part. NIL always
evaluates to false; this predicate is used to take a production out of action temporarily
without actually deleting it from the production set. DEFAULT evaluates to true if
and only if all previously tried productions have proved inapplicable.


90 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Other situation-part predicates are specific to chemistry. DB(N,M) is true if there
is a double bond between nodes numbered N and M. ISIT is true if substructure S is
contained in the active ion. MISSING(N,M) is true if nodes N and M are not con-
nected. ON(S, N) is true if substructure S is contained in the active ion, with node N
substituted for any unspecified atoms in substructure S. ISIT, ON, and WHERE, when
true, produce as side effects an indication of the location of the match. This informa-
tion is available for use by functions in the action-part of the production.

The action-part of a production is more complex. It may have more than one
component. Each component may itself be a production. A component also may be
the name of a function that will be executed, selecting its parameters from the current
context. Finally, a component may be a list of two or three functions specific to mass
spectrometry. The break function produces new ions from the active ion and adds
them to the ion list. The intensity function determines an intensity for each newly
formed ion. It may be a number indicating the relative abundance of the parent ion to
be assigned to the daughter ion. The transfer function produces additional ions accord-
ing to rules of hydrogen transfer but does not add these to the ion list. (The transfer
function is optional and may be absent.) Each function-list component has a label that
is used in the output to indicate the source of each spectral peak, The label is the first
symbol in the function list.

To summarize, a PRODUCTION is (SITUATION-PART ACTION-PART). A
SITUATION-PART is one of the following three forms:

I. (ANY LISP PREDICATE, for example, ISIT, WHERE, DB, ON)
2. (NIL)
3. (DEFAULT)

  An ACTION-PART is a list of ACTION-PART COMPONENTS. An ACTION-
PART COMPONENT is one of the following three forms:

1. (LABEL BREAK-FUNCTION INTENSITY-FUNCTION TRANSFER-FUNCTION
(optional))

2. ANY LISP FUNCTION
3. A PRODUCTION

The following production for estrogens is a production rule formulation of the
theory of estrogen fragmentation that was presented in the discussion of PLANNER
(see Section 5.5). The break labels, node numbers, and hydrogen-transfer information
are the same as used in that discussion. The intensity-function of each component of
the production is here the integer 100, which simply means that any generated ion
will be assigned 100 percent of the intensity of the ion from which it derives. The
estrogen production has five function-list components, each function list associated
with a particular break definition; the break name is used as the label of its function
list. The functions BREAKBND and HTRANS are a break function and a transfer
function, respectively, to break a bond, or a set of bonds, and to transfer hydrogens.

'


HEURISTIC DENDRAL TESTING 91

((WHERE ESTROGEN)

(B (BREAKBND((14 . 15) (13 . 17)) 100 (HTRANS -1 0))
(D (BREAKBND((9 . 11) (14 . 13) (16 . 17)))  100 (HTRANS -2 -1))
(C (BREAKBND((9 . 11) (14 . 13) (15 . 16)))  100 (HTRANS -1 0))
(E (BREAKBND((11 . 12) (8 . 14)))  100 (HTRANS - 1 0))
(F (BREAKBND((9 . 11) (8 . 14)))  100 (HTRANS -1 0))
1

A syntactically more complex production is one that defines McLafferty re-
arrangement, defined in an earlier chapter (Section 2.5.3). The structures that undergo
this rearrangement contain the substructure named GRAFMC, shown below (compare
Figure 2-13).

(GRAFMC
     (1 c x (2 4 --) 1)
     (2 -- x (1 --) 1)
     (4 -- x (1 5 --))
     (5 -- X (4 6 --))
     (6 C X (5 --))
1

The production is labeled MCLAFFERTY. It corresponds to an MS process that
occurs in many cases and has thus been defined and named so that it may be refer-
enced in defining class-specific productions. A number of such cases are gathered
together below under the heading SUB-PRODUCTIONS. These processes are used in
the subsequent definitions of the PREDICTOR productions; The situation-part of the
MCLAFFERTY production is (WHERE GRAFMC). The action-part of MCLAF-
FERTY uses six functions. Two of them, LASTION and LASTINT, simply return the
previous ion and its intensity, respectively. Three of them, MRRFGT, MRRFGT2, and
MRRFGT3, produce the required hydrogen migrations before performing breaks that
produce new ions. The final function GAMMACLEAVAGES, produces (possibly)
several ions by producing all gamma cleavages (see Section 2.4.1).
  The other subgraphs referenced in the MCLAFFERTY production are defined
below. The integers used as intensity-functions are interpreted as before: the intensity
of the generated ion is the indicated percentage of the intensity of the current ion. The
MCLAFFERTY production is

(MCLAFFERTY
  ((WHERE GRAFMC) ((WHERE GRAFMCMETHYL)
            (MCLAFFCH3 MRRFGT3 100)
           (MCLAFFERTY MRRFGT 200))
     ((WHERE GRAFDBLMCALPHA)
        (DBLMCLAFF MRRFGT3 100)
        (DBLMCLAFF MRRFGT2 100)
        (MCLAFFERTY MRRFGT 200))


92 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

(DEFAULT

        (MCLAFFERTY MRRFGT 200))
     ((WHERE GRAFMCS)
       (MCLAFFERTY+l LASTION (LASTINT 10) (HTRANS 1))
       (GAMMA GAMMACLEAVAGES (LASTINT 100)) )
1)

The following productions comprise a partial theory of mass spectrometry as
embodied in one version of the PREDICTOR. The functions they employ are defined
subsequently. The chemical graphs they reference are shown in Table 6-1. Adding new
productions is simple as long as no new functions are introduced.

(* PRODUCTIONS
------------------------
SITUATION-PART     1  ACTION-PART

((WHERE KETONE) MCLAFFERTY
     (MAJORALPHA MAJORALPHACLEAVAGE MAJORAIPHAINT)
     (MINORALPHA MINORALPHACLEAVAGES MINORALPHAINT)
       COELIM

1
((WHERE ALDEHYDE) MCLAFFERTY:!

     (MAJORALPHA MAJORALPHACLEAVAGE MAJORALPHAINT)
)
((WHERE ALCOHOL) H20ELIM
     (MAJORALPHA MAJORALPHACLEAVAGE MAJORALPHAINT)
     (MINORALPHA MINORALPHACLEAVAGES MINORALPHAINT)
     (* DELETEPARENT 0)
1
((WHERE THIOL) H20ELIM
     (MAJORALPHA MAJORALPHACLEAVAGE MAJORALPHAINT)
     (MINORALPHA MINORALPHACLEAVAGES MINORALPHAINT)
     (* DELETEPARENT 0)
)
((WHERE ETHER) (MAJORALPHA MAJORALPHACLEAVAGE
            MAJORALPHAINT)
     (MINORALPHA MINORALPHACLEAVAGES MINORALPHAINT)
     ((WHERE GRAFCH3ALPHA) (ALPHA-H REMOVEHl
        (LASTINT 100)))
     ((GREATERP LEVEL 0)
        ((WHERE GRAFETHl) (REARR AMINERR 200)) )

[(WHERE THIOETHER) (MAJORALPHA MAJORALPHACLEAVAGE
              MAJORALPHAINT)


HEURISTIC DENDRAL TESTING 93

(MINORALPHA MINORALPHACLEAVAGES MINORALPHAINT)
((WHERE GRAFCH3ALPHA) (ALPHA-H REMOVEHl
   (LASTINT 100)))
((GREATERP LEVEL 0)

((WHERE GRAFETHl) (REARR AMINERR 200)) )

1
((WHERE AMINE) (MAJORALPHA MAJORALPHACLEAVAGE

      MAJORALPHAINT)
(MINORALPHA MINORALPHACLEAVAGE~ MINORALPHAINT)
((WHERE GRAFCH3ALJ'HA) (ALPHA-H REMOVEHI
   (LASTINT 100)))
((GREATERP LEVEL 0)
   ((WHERE GRAFETHl) (REARR AMINERR 200)) )

&HERE OXIME) (MAJORALPHA MAJORALPHACLEAVAGE

MAJORALPHAINT)

     (GAMMA GAMMACLEAVAGES 200)
       MCLAFFERTY
       H20ELIM
       COELIM
&HERE ESTROGEN)

   (B (BREAKBND((14 . 15) (13 . 17)) 100 (HTRANS -1 0))
   (D (BREAKBND((9 . 11) (14 . 13) (16 . 17)))  100 (HTRANS -2 -1))
   (C (BREAKBND((9 . 11) (14 . 13) (15 . 16)))  100 (HTRANS -1 0))
   (E (BREAKBND((11 . 12) (8 . 14)))  lOO(HTRANS -1 0))
   (F (BREAKBND((9 . 11) (8 . 14)))  100 (HTRANS -1 0))
(* )SUBPR~D~CTI~NS
__-_--------------------
(CH4ELIM         1

  ((WHERE GRAFCH41*3) (CH4ELIM1*3 ELIM 40))
  ((WHERE GRAFCH4 1*4) (CH4ELIM 1*4 ELIM 50))
~C~ELIM

  ((WHERE GRAFCO) (COELIM LOSEl*2 50))         ;
&20ELIM

  ((WHERE GRAFHZOI *2) (H20ELIM1*2 ELIM 25))
((WHERE GRAFH201*3) (H20ELIM1*3 ELIM 80))
  ((WHERE GRAFH20 1*4) (H20ELIM1*4 ELIM 100))
;H2SELIM

((WHERE GRAFH2S1*3) (H2SELIM1*3) ELIM 8))
((WHERE GRAFH2S1*4) (H2SELIM1*4 ELIM 10))


94 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

:H ALOGENELIM

  ((WHERE GRAFHALl"3) (HALOGENELIMl*3 ELIM 40))
  ((WHERE GRAFHALl*4) (HALOGENELIM1*4 ELIM 50))
>
(NH3ELIM

  ((WHERE GRAFNH31*3) (NH3ELIM1*3 ELIM 40))
  ((WHERE GRAFNH31*4) (NH3ELIMI *4 ELIM 50))
1
(MCLAFFERTY

  ((WHERE GRAFMC ((WHERE GRAFMCMETHYL)
            (MCLAFFCH3 MRRFGT3 100)
           (MCLAFFERTY MRRFGT 200))
        ((WHERE GRAFDBLMCALPHA)
           (DBLMCLAFF MRRFGTS 100)
           (DBLMCLAFF MRRFGT2 100)
           (MCLAFFERTY MRRFGT 200))
         (DEFAULT
           (MCLAFFERTY MRRFGT 200))
        ((WHERE GRAFMCS)
           (MCLAFFERTY+l LASTION (LASTINT 10)
              (HTRANS 1))
           (GAMMA GAMMACLEAVAGES (LASTINT 100)) )
1)
--------------------------------------------------------------------

The functions used by these productions have the following effects. Their defini-
tions, of course, are in INTERLISP.'

BREAK FUNCTIONS

AMINERR

1. Find the bonds alpha to node 2.
2. Break one major bond from step 1,
3. Break one major bond adjacent to node 2.
4. Place a hydrogen at node 2.
5. Return a list containing the ion containing node 2.

BRK (BONDSET)

1. Break each of the bonds in bondset.
2. Return a list containing the ion containing the first node of the first bond in
bondset.

2This is an example of procedural imbedding of knowledge, as it is now called in the artificial
intelligence literature.


Table 6-1 Structure graphs referred to by the example productions

(*STRUCTURE GRAPHS
             1

(KETONE
     (1 c x (2 x X) 1 0)
      (2 0 x (1) 1 0)
1

(ALDEHYDE
     (1 c x (2 X) 1 1)
      (2 0 x (1) 1 0)
1

(ALCOHOL
     (1 c x (2 --) --)
      (2 0 x (1) 0 1)
1
(THIOL

     (1 c x (2 --) --)
     (2 s x (1) 0 1)
1
(ETHER
      (2 0 x (X X) 0 0)
)

(THIOETHER
     (2 s x (X X) 0 0)
1
(AMINE

      (2 N X (X --))
1
(OXIME

     (1 c x (2 --) 1)
     (2 N X (1 3) 1 0)
      (3 0 x (2 X) 0 0)
1
(ESTROGEN

   (1 c x (2 10 --) 1)
   (2 c x (1 3 --) 1)
   (3 c x (2 4 --) 1)
   (4 c x (3 5 --) 1)
   (5 C X (4 6 10) 1 0)
  (6 C X (5 7 --) --)
   (7 C X (6 8 --) --)
   (8 C X (7 9 14 --) --)
   (9 C X (8 10 11 --) --)
   (IO c x (1 5 9) 1 0)
  (11 c x (9 12 --) --)
   (12 c x (11 13 --) --)
   (13 C X (12 14 17 18) 0 0)
   (14 C X (8 13 15 --) --)
  (15 C X (14 16 --) --)
   (16 C X (15 17 --) --)
  (17 C X (13 16 --) --)
   (18 C X (13 --) --)
1

(GRAFMC
     (1 c x (2 4 --) 1)
     (2 -- x (1 --) 1)
      (4 -- x (1 5 --))
     (5 -- X (4 6 --))
     (6 C X (5 --))
1

(GRAFMCMETHYL
     (1 c x (2 3 4) 1 0)
     (2 -- x (1 --) 1)
     (4 -- x (1 5 --))
     (5 -- X (4 6 --))
     (6 C X (5 7 --))
     (7 -- X (6 8 --))
     (8 -- X (7 --))
     (3 -- x (1 9 --))
     (9 -- x (3 10 --))
     (10 c x (9) 0 3)
1

(GRAFDBLMCALPHA
     (1 c x (2 3 4) 1)
     (2 -- x (1 --) 1)
     (4 -- x (1 5 --))
     (5 -- X (4 6 --))
      (6 C X (5 --))
     (3 -- x (1 9 --))
     (9 c x (3 7 10) 0 0)
     (7 C X (9 8 --))
     (8 C X (7 --))
     (10 c x (9 --))
1

(GRAFETHl
      (1 c x (2 --))
     (2 (0 N S) X (1 3 --))
      (3 c x (2 4 --))
      (4 c x (3 --))
1
(GRAFCH3ALPHA
      (1 c x (2) 0 3)
      (2 (N 0) X (1 --I)
)

(GRAFHAL1*3
  (2 (FL CL BR I) X (1) 0 0)
   (1 c x (2 3 --))
   (3 c x (1 --))
1
(GRAFHAL1*4
  (2 (FL CL BR I) X (1) 0 0)
   (1 c x (2 4 --))
   (4 c x (1 3 --))
   (3 c x (4 --))
1

95


96 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Table 6-1 (Continued)

(GRAFHZOI *2
   (2 0 x (1) 0 1)
   (1 c x (2 3 --))
   (3 c x (1 --))

(GRAFH201*3
   (2 0 x (1) 0 1)
   (1 c x (2 4 --))
   (4 c x (1 3 --))
   (3 c x (4 --))
1

(GRAFH201*4
   (2 0 x (1) 0 1)
  (1 c x (2 4 --))
   (4 c x (1 5 --))
   (5 c x (3 4 -7))
   (3 c x (5 --))

(GRAFH2S1*3
   (2 s x (1) 0 1)
   (1 c x (2 3 --))
   (3 c x (1 --))

(GRAFHZS1*4
   (2 s x (1) 0 1)
   (1 c x (2 4 --))
   (4 c x (1 3 --))
   (3 c x (4 --))

(GRAFNH31*3
   (2 N X (1) 0 2)
   (1 c x (2 3 --))
   (3 c x (1 --))

(GRAFNH31*4
   (2 N X (1) 0 2)
   (1 c x (2 4 --)I
  (4 c x (1 3 --))
  (3 c x (4 --))

(GRAFCH41*3
  (2 c x (1) 0 3)
  (1 c x (2 3 --))
  (3 c x (1 --))

(GRAFCH4 1*4
   (2 c x (1) 0 3)
   (1 c x (2 4 --))
  (4 c x (1 3 --))
  (3 c x (4 --))

(GRAFMCS

(1 c x (2 4 --) 1)
(2 (0 N C) X (1 --) 1)
(4 (C N 0) X (1 5 --I)
(5) (C N 0) X (5 6 --I)
(6 C X (5 7 --1)
(7 C X (6 8 --)I
(8 C X (7 --))

(GRAFCO
  (1 c x (2 3) 2 0)
   (2 0 (1) 1 0)
   (3 c x (1 --))
1

COELIM

1. Break the bond between nodes 2 and 3.
2. Return a list containing the ion containing node 3.

COMPL

Place the complement of the previous ion directly into the mass spectrum. Return no
ions.

DELETEPARENT

Reduce the intensity of the parent ion to 0. Return no ions.


HEURISTIC DENDRAL TESTING 97

ELIM

1. Remove a hydrogen from node 3.
2. Break the bond between nodes 1 and 2.
3. Return a list containing the ion containing node 1,

GAMMACLEAVAGES

1. Find all bonds gamma to node 2.
2. Break each bond in turn.
3. For each bond broken, create an ion containing node 2.
4. Return the list of ions created.

LASTION

Return a list containing the previous ion.

LOSE1 *2

1. Break the bond between nodes 1 and 3.
2. Return a list containing the ion containing node 3.

MAJORALPHACLEAVAGE

1. Find all major bonds alpha to node 2.
2. Break each bond in turn; and for each bond broken, create an ion containing
node 2.

3. Return the list of ions created.

MINORALPHACLEAVAGES

1. Find all bonds alpha to node 2 that are not major bonds.
2. Break each bond in turn; and for each bond broken, create an ion containing
node 2.

3. Return the list of ions created.

MRRFGT

1. Migrate a hydrogen atom from node 6 to node 2.
2. Break the bond between nodes 4 and 5.
3. Return a list containing the ion containing node 4.

MRRFGT2

1. Migrate a hydrogen atom from node 8 to node 2.
2. Break the bond between nodes 3 and 9.
3. Return a list containing the ion containing node 3.


98 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

MRRFGT3

1. Migrate a hydrogen atom from node 10 to node 2.
2. Break the bond between nodes 3 and 9.
3. Return a list containing the ion containing node 3.

MRRX (ATl, AT2, AT3)

1. Migrate a hydrogen atom from node AT1 to node 2.
2. Break the bond between nodes AT2 and AT3.
3. Return a list containing the ion containing node AT2.

PERFORMBREAK (BND); a function

args: BND; a bond (dotted pair of active-node descriptors).
Value: the ion created by breaking the bond and keeping the fragment attached to the
  first node,
Comment: this function is not intended for use as a theory-statement primitive.

REMOVEHI

1, Eliminate a hydrogen atom from node 1.
2. Return a list containing the ion containing node 1.

INTENSITY FUNCTIONS

LASTINT (N)

((intensity of previous ion) X N)/ 100

MAJORALPHAINT

(intensity of the parent ion) X KCMAJ

MINORALPHAINT

Ml <- (carbon count of the ion being computed)
M2 <- (carbon count of the parent ion) - Ml - 1
Tl <- (intensity of the previous ion) X Ml
if M2 = 0 then Tl/KCMAJ

     else Tl/(KCMAJ X M2)
__________-----_________________________------------------

6.3.3 An Example

To illustrate the output of PREDICTOR we take the now-familiar example of an
estrogen, estradiol, and have the program predict its low-resolution spectrum and


HEURISTIC DENDRAL TESTING 99

metastable peaks. The production for estrogens, given above, was used in this run.
Recall that the intensity computations used simply copied the current intensity to
each ion generated. Thus the spectrum produced has peaks of equal height. This result
is not inherent in the program, which can use arbitrarily complex computations, but it
simplifies this example.

The input to the program is the structure defining estradiol (the chemical graph
is as depicted in Figure 5-4, with OH groups added to nodes 3 and 17):

ESTRADIOL

((ESTRADIOL) (CHEMICAL
(Cl c 1 (Cl0 C2) 1 1)
(C2 c 2 (C3 Cl) 1 1)
(C3 c 3 (019 c4 C2) 1 0)
(C4 c 4 (C5 C3) 1 1)
(C5 C 5 (Cl0 C6 C4) 1 0)
(C6 C 6 (C7 C5) 0 2)
(C7 C 7 (C8 C6) 0 2)
(C8 C 8 (Cl4 C9 C7) 0 1)
(C9 c 9 (Cl1 Cl0 C8) 0 1)
(Cl0 c 10 (C5 Cl C9) 1 0)
(Cl1 c 11 (Cl2 C9) 0 2)
(Cl2 c 12 (Cl3 Cll) 0 2)
(Cl3 C 13 (Cl7 Cl8 Cl4 C12) 0 0)
(Cl4 C 14 (C8 Cl5 C13) 0 1)
(Cl5 C 15 (Cl6 C14) 0 2)
(Cl6 C 16 (Cl7 C15) 0 2)
(Cl7 C 17 (020 Cl3 C16) 1 0)
(Cl8 C 18 (C13) 0 3)
(019 0 19 (C3) 0 1)
(020 0 20 (C17) 0 1)))
STOP

The output of the program is as follows, annotated where appropriate.

PREDICTOR CONSTRAINTS for ESTRADIOL
__________-----------~---~------~---~~~-------------------
  (PARAMETER NAME)         VALUE ;
___________----------~--------------
  (HIPEAKNORMFLAG)       T [Note: T(rue) means the highest peak
                     will be assigned intensity 100 and
                         the others will be normalized to this
                      level; false means the intensities will
                     be made to sum to 100.1

show only masses in the spectrum? Y/N.
The usual response is: N
(ONLYMASSES)         NIL [Note: only masses means no inten-
                   sities.]

maximum number of steps in a fragmentation process.


100 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

  The usual response is: 2
   (MAXIONLEVEL)           2
  spectrum resolution? HIGH/LOW.
   (RESOLUTION)            LOW
----------------------------------------------------------
END.

REVIEW OF MASS SPECTRUM PREDICTION for ESTRADIOL
____----___---___--------~---~~~----~-----~~-----~~~--~---
       BREAK CHARGE COMPOSITION MASS METASTABLE PEAK
---_-----_--_---__----~------------------------~~-~--~~~~-
ION# 0  Mt     10      Cl 882302     271
ION# 1   B      10      C15H180     214   M*PEAK 169
ION# 1   B      10      Cl 5H170     213   M*PEAK 167
ION# 2  D      10      C13H140     186   M'PEAK 128
ION# 2  D      10      C13H130     185   M*PEAK 126
ION# 3  C      10      C12H130     173   M*PEAK 110
ION# 3  C      10      C12H120      172   M*PEAK 109
ION# 4   E      10      Cl lH120     160   M*PEAK 94
ION# 4  E      10      CllHllO     159   M*PEAK 93
ION# 5   F      10      ClOHlOO     146   M*PEAK 79
ION# 5  F      10      ClOH90      145   M*PEAK 78
___-_---__----------____________________~~-~~~---~~~~~-~--
END.

6.4 RANKING THE CANDIDATE EXPLANATIONS

Different models, or "theories," of mass spectrometry can be used to predict the
fragmentations of a molecular skeleton. The type of fragmentation theory to be used
depends largely on the context of the structure determination problem. When one
initially studies a new class of compounds, or when one attempts to discriminate
among different candidate structures obtained from some unusual CONGEN prob-
lem, it is usually appropriate to use some universal form of fragmentation theory that
expresses very general chemical principles. Although a general theory will be applicable
and will not be biased in its predictions, it may well prove to have poor discriminatory
power. Fine discrimination between related structures generally requires more refined
fragmentation theories wherein one assigns different plausibilities to alternative frag-
mentation processes. When processing isomers from some well-characterized class, the
appropriate fragmentation theory may well involve the detailed specification of sub-
structures, their bond cleavage processes, and the accompanying specific transfers of
hydrogen atoms or other molecular fragments.

In the following subsections we show how even the most general "half-order"
fragmentation theory can serve to discriminate among isomers of moderately com-
plex structures such as monoketoandrostanes. (The skeleton of this class is illustrated
in Figure 7-2.) Refinements of the simplest half-order theory involve first the use of
estimates of relative plausibilities of fragmentation processes of differing degrees of
complexity and, subsequently, the association of relative plausibility values with some


HEURISTIC DENDRAL TESTING 101

classes of bond cleavage. The use of detailed class-specific fragmentation processes is
considered in relation to the processing of the spectra of macrolide antibiotics.

6.4.1 The Half-Order Theory of Molecular Fragmentation

The simplest model of molecular fragmentation is the ALLBREAKS, or zero-order,
"theory" that predicts ions arising from all bond cleavages and combinations of cleav-
ages and transfers of atoms between fragments. Such a model is too general for almost
every problem in computer analysis of mass spectra. (However, the zero-order theory
was the method of spectrum prediction in the first application of Heuristic DENDRAL
to amino acids.) DENDRAL's "half-order theory" of mass spectrometry is a con-
strained version of the ALLBREAKS model of molecular fragmentation: of all the
possible fragmentations, some are not tried because they are implausible, if not pat-
ently absurd. The half-order theory is a very loose model; it does not describe the
detailed aspects of fragmentations, such as specific relationships between atom trans-
fers and cleavage of certain groups of bonds, and it makes no attempt to express
anything about the mechanisms by which fragmentations actually take place.

The constraints that can be expressed in the half-order theory of molecular frag-
mentation include limitations on the number of bonds that may be broken and the
number of allowed hydrogen transfers into or out of the charged fragment. Each
predicted ion is formed by a "process" involving (1) one or more cleavage "steps,"
(2) possible H-transfers, and (3) possible neutral losses. Each "step" cleaves a mole-
cule and may be a break of one acyclic bond, two bonds within a ring, or a group
of three bonds in an edge-fused-ring system. A complete process could, for example,
involve fused-ring cleavage, simple ring cleavage, and acyclic bond cleavage steps;
such a process would involve a total of six bond breaks. Typical constraints used with
the half-order theory would be:

1. Prohibit cleavage of aromatic or isolated double or triple bonds.
2. AIlow one or two step processes.
3. Allow at most two bonds to be cleaved in a given step.
4. Permit a maximum of three bonds to be cleaved in a process.
5. Prohibit the cleavage of two (nonhydrogen) bonds from the same carbon atom
(for this cleavage would formally leave a fragment that is normally energetically
unfavorable).

6. Restrict transfers between fragments to at most two hydrogen atoms.

A simple use of the half-order theory for testing is implemented in the MSPRUNE
function. MSPRUNE helps a chemist reject CONGEN structures by determining the
difficulty of rationalizing any specific ion in the spectrum from each of the possible
structures. Even in this very limited form, the half-order theory can be of value in
helping to identify candidate structures compatible with spectral data. For example, a
simple ring cleavage and hydrogen transfer are a simpler explanation than cleavage of a
fused-ring system. MSPRUNE uses such differences to eliminate candidate structures
[Smith and Carhart (1978)].


102 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Table 6-2 Ranking of monoketoandrostanes based on the half-order theory

Structure
(keto position)

Ranking

Structures with      Better-ranked
equal score         structures

1             1        2,3,4
3             1         1,294
4             1         1,293
6              1
7             2                         6
11              2                         12
12             1
15              1         17,16
16              1         17,15
17              2        15,16          1,2,3,4

  Note: Fragmentation constraints: one-step processes, a maximum of two bonds cleaved,
transfer of at most two hydrogens into or out of the charged fragment.

Generally, we have found it to be more effective to employ the data in the entire
observed mass spectrum and rank candidate structures according to how well they
serve to explain the spectral data. This ranking is accomplished through the MSRANK
function, which allows the user to define the constraints of the half-order theory and
to specify the form of the scoring function. The score assigned to a candidate structure
is determined from the importance accorded to those of the observed ions that can be
generated by the allowed fragmentations of that candidate. As ions at higher mass and
intensity values are generally of greater structural significance, the importance ac-
corded to each observed ion in the spectrum is determined by some function of its
m/e and its relative intensity (in most cases, the product of m/e and intensity has been
used).

The results shown in Table 6-2 typify the performance of this simple approach to
discriminating between structures. The structures analyzed were monoketoandrostanes,
all with the same steroid skeleton but varying in the position of the keto substituent.
The simple half-order-theory approach was used, and the 11 possible isomers were
ranked against each of the 10 available high-resolution mass spectra. The half-order
theory generally separates structures into two groups, those that match the spectra
about equally well and those that can definitely be eliminated. With these structures,
the correct candidate was generally ranked first after its predicted and recorded
spectra had been compared, but it was not possible to discriminate among isomers
with the keto group on nodes 1 to 4 or among those with the keto group on nodes 15
to 17.

6.4.2 Half-Order Theory with Process and Bond-Break Plausibilities

Differences among candidate structures are not always simply explained by the major
fragmentation processes. In such cases, we can use the MSRANK program with a more
refined version of the half-order theory in which relative plausibility values, in the
range 0 to 1, are associated with processes according to differing numbers of steps,


HEURISTIC DENDRAL TESTING 103

differing numbers of bond cleavages, and different types of neutral transfers between
fragments. The principle behind this reasoning is that if two structures both provide
explanations for an observed ion, then the structure with the simpler explanation is
more likely. The plausibility of a predicted ion is given as the product of the break
plausibilities of the bonds and H-transfers or neutral losses involved, modified by any
additional factors such as the reduced plausibility of a process requiring adjacent
breaks or multiple steps. If an observed ion can be rationalized in terms of two differ-
ent fragmentations of the same structures, then the process with the higher plausibility
is used. The score assigned to a structure is the sum, over all observed ions, of the
importance of the ion (m/e times intensity) multiplied by the plausibility of the pro-
cess producing it. With these plausibility weighting factors, the half-order theory
can discriminate quite well between related structures. Typically, around half or even
two-thirds of a set of candidate isomers can be rejected on the results of mass spectral
ranking.

6.4.3 The Use of Class-Specific Fragmentation Rules in MSRANK

The half-order theory typically falls to discriminate within a large group of equally
well-ranked structures even when relative plausibilities of different fragmentations are
defined. This failure is partly due to the fact that the candidates will have very similar
structures. However, the overgenerality of the theory also contributes to this degen-
eracy of scores. The half-order theory does not allow specific hydrogen transfers or
neutral losses to be associated with specific break processes.

In structures with several charge-localization/fragmentation-directing substituents,
interactions between competing fragmentation processes must be expected. It is hard
to predict a priori the result of such interactions on the appearance of the mass spec-
trum, and general half-order theories can be of limited value. However, if the candidate
structures are from a previously studied class, then rules defining their fragmentation
behavior can supplement, or replace, the half-order theory to explain observed ions
and rank structures. Generally, class-specific fragmentation rules produce a fmer dis-
crimination among candidates.

The rules given to the program must specify substructures, bond breaks, and spe-
cific transfers. Such rules have been derived manually, by chemists working with
DENDRAL, for a number of compound classes including the macrolide antibiotics.
Some of the standard macrolides are shown in Figure 6-1. Conventional analysis (and
results from the INTSUM program, described later in Chapter 7) showed that the
major fragmentations of the macrolide skeleton could be described in terms of certain
McLafferty rearrangements, cleavages alpha to carbonyl groups, and other processes
illustrated in Figure 6-2. To test the discriminatory power of the fragmentation rules
that had been derived, isomers of the standard macrolactones were generated using
CONGEN. In each case the standard macrolactone skeleton was retained, the isomers
varying only in the position of hydroxy, keto, and alkyl substituents and in the posi-
tion of the double bond in the macrolactone ring. The generated isomers were ranked
using the experimental mass spectrum of the standard compound. If just the half-
order theory, without any plausibility weightings was used, the spectrum-ranking func-


6
3-dehydro-methynolide

              OH

HO

9
Eihydro-methynolide

10
Dihydro-neomethynolide

Figure 6-1 Some standard macrolides. (Source: Biochemical Applications of Mass Spectrometry
(supplement), edited by G. R. Waller. Copyright 1979, John Wiley & Sons, Inc. Reproduced by
permission. After Gray et al, [ I9 791.)

CA2"           CA4

MI-H              M?-H

Ml+H

M2+H

McLafferty rearrangements

A2

CA6

M3-H

M3+H

HB2

Figure 6-2 Rules used in predicting the mass spectra for macrolide structures. (Source: Biochemi-
cal Applications of Mass Spectrometry (supplement), edited by G. R. Wailer. Copyright 1979,
John Wiley & Sons, Inc. Reproduced by permission. After Gray et al. [I9791 .)

104


HEURISTIC DENDRAL TESTING 105

Table 6-3 Comparison of performance of MSranking functions
when using half-order theory and class-specific rules

Structure

Total #
of isomers

   Number of isomers with equally
good explanations of recorded spectrum

Half-order theory     Class-specific rules

6          60          5              2
I          105         28               1
8          105          4              2
9          105         21               5
10         105         10              5

  Note: The structures are the macrolide antibiotics shown in Fig. 6-l. Sets of CONGEN-
generated isomers were ranked using the recorded high-resolution mass spectrum of the standard
structures.

tions could always eliminate at least 75 percent of the isomers. However, the correct
structure was never uniquely identified.

The rules that had been derived for these skeletons involved all pairwise combina-
tions of the singlebreak processes shown in Figure 6-2. Specific hydrogen transfers
were associated with each rule. As shown in Table 6-3, use of the rules in the spectrum-
generating process resulted in greatly reduced ambiguity. With rules, methynolide
could apparently be identified with certainty, and, typically fewer than 1 isomer in 20
was found to be compatible with the spectral data.

6.5 SUMMARY OF HEURISTIC DENDRAL

The Heuristic DENDRAL system consists of planning, generating, and testing phases.
Each may be used alone, or the phases may be used together. The programs themselves
embody theories of chemical structure and mass spectrometry. Particular hypotheses
for particular classes of compounds are formulated by the user and saved. The knowl-
edge thus formulated gives the program its power.

1. Planning

a. Planning may use special heuristic rules relating sets of mass spectrum peaks
with subgraphs of specific compound classes, as was done in early versions for
aliphatic compounds.

b. A Planning Rule Generator may be used to systematically consider all possible
fragmentation processes of specified type. It writes the planning rules relating
peaks to subgraphs.

c. The DENDRAL PLANNER may be used to produce automatically constraints
from user-supplied definitions of break patterns for a known class of com-
pounds. It subsumes the Planning Rule Generator.


106 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

d, MOLION may be used alone or as part of PLANNER to infer the molecular ion
  from a mass spectrum.
  e. Manually inferred constraints may be supplied to CONGEN.
2. Generating

CONGEN is a generator of a complete and nonredundant list of isomers for a given
empirical formula, including structures containing rings. It subsumes the original
acyclic generator for aliphatic compounds. Its current power comes from user-
supplied constraints, although constraints produced by PLANNER may also aid in
narrowing the output of the generating phase.
3. Testing

a The PREDICTOR is a production-system-oriented program that applies frag-
mentation rules to a given structure to produce a mass spectrum.
b. The predicted spectrum may then be compared to data to determine the plausi-
bility of each candidate structure as a source of the data.


   CHAPTER
SEVEN

META-DENDRAL

Meta-DENDRAL is a separate program that discovers new rules of mass spectrom-
etry and `3C NMR spectrometry for use by the planning and testing programs of
Heuristic DENDRAL. It is more of an induction program than Heuristic DENDRAL in
the truditional sense of proposing general rules that explain a number of observed in-
stances. Nevertheless, the plan-generate-test paradigm is used by Meta-DENDRAL as
well. The key idea is to search a space of possible rules using both the empirical data
and a strong model of the domain to guide the search.

7.1 INTRODUCTION

We have seen that Heuristic DENDRAL employs user-supplied knowledge to guide its
search through a space of possible connectivity isomers to produce a list of isomers
that are likely explanations of the given mass spectrum (or other data). The compila-
tion and translation of the heuristic knowledge into the codification appropriate to
Heuristic DENDRAL requires anywhere from a few weeks to a few months of the time
of a chemist who is familiar not only with the subject class of compounds and its
behavior in the mass spectrometer, but with DENDRAL as well.

One significant way in which the system can be generalized is to automate this
knowledge acquisition phase. It may be hoped that such a generalization will do more
than facilitate the application of DENDRAL to new compounds. A careful study of
the processes of induction may lead to new insights about the theory of mass spec-
trometry, i.e., how molecular structure determines the behavior of molecules under
electron bombardment. It may also lead to a deeper understanding of the means by
which scientists acquire and use specialized knowledge. With these objectives in mind,
a substantial effort has been devoted to the development of a knowledge acquisition
system called Meta-DENDRAL.

107


108 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

It is useful to distinguish several approaches that might be taken toward the real-
ization of a system for automatic knowledge acquisition. Five schemes are outlined in
Figure 7-1.

In the first, which we have called custom crafting, the route from knowledge
source to program is traversed in two stages. The information source is interpreted by
a scientist, and a programmer, studying the scientist's report of his activity, codifies
the information (the scientist's knowledge) in a manner suitable for machine simu-
lation. This method is the one used in the construction of early versions of Heuristic
DENDRAL [see in particular Buchanan, Sutherland, and Feigenbaum (1970)]. As
Heuristic DENDRAL evolved further, knowledge acquisition was effected by the
second scheme in which a single interlocutor (e.g., Raymond Carhart) was knowl-
edgeable in both chemistry and the Heuristic DENDRAL system. Much of AI research
has used this approach, usually because AI researchers were programmers and tended
to choose a subject matter in which they were expert also. For example, chess, natural
language, logic, and mathematics have been subjects of much investigation largely
for this reason. A more sophisticated, or at least more automatic, approach is what
we have called the dialogue approach. This approach requires a program that is suf-
ficiently competent to assume some of the work done by the "programmer" in the
previous cases, thereby enabling it to work with scientists who do not have intimate
familiarity with the program, or with programming. Here we envision a program that
listens to scientists' descriptions of their methods and asks them pertinent questions.
The TEIRESIAS program constructed by Davis (1976) is an example of this type of
program.

In the last two approaches diagrammed, the human scientist and/or programmer
have been eliminated, and the program is able to examine the information source
directly. We have distinguished two major classes of information sources, text and
data.' An automatic text analyzer would, ideally, be able to "pick up" a textbook,
read and interpret it, and augment its own knowledge base. To our knowledge no
existing system even approaches such an ability, though the concept has often been
considered. The final approach, in which the program directly examines data and in-
duces generalizations about regularities, is the approach taken by the Meta-DENDRAL
research. Note that "data" does not refer to raw observations of the world via human-

`A similar distinction can be made in the different sources used by scientists in the custom-
crafting model, which requires different kinds of reasoning by the Scientist.

Custom crafting:    source - scientist - programmer - program

Much of AI:      source - scientist/programmer - program

Dialog:          Source           * scientist         + program


Text reader:      (text) SO"rce                        * program

Meta-DENRAL:    (data) source

Figure 7-1 Approaches to automatic knowledge acquisition.

* program


META-DENDRAL 109

like sense organs, but rather to already structured (and quantified) measurements, in
particular, mass spectra.

What Meta-DENDRAL induces is a set of productions (situation-action rules) that
constitute a partial theory of fragmentation for a class of compounds. These produc-
tions are the same sorts of rules as those used by Heuristic DENDRAL in planning and
testing. The productions are induced in a three-stage procedure that is a species of the
plan-generate-test paradigm.

The stages of Meta-DENDRAL's knowledge acquisition are:

1. The INTSUM (INTerpretation and SUMmary) program examines a collection of
spectra from several members of a class of compounds and seeks to account for
the important peaks in terms of MS processes. A process specifies (a) bond cleav-
ages, (b) the charged fragment, (c) a resultant composition of the charged frag-
ment, and (d) a set of associated migrations (transfers) of hydrogen atoms and
electrically neutral fragments.

2. RULEGENerator represents these processes in terms of productions describing the
general environments in which the processes apply.
3. RULEMODifier refines this set of productions by generalization, selection, merg
ing, and specialization.

7.2 INTSUM-DATA INTERPRETATION AND SUMMARY

This program requires that the user supply a skeleton structure common to the mem-
bers of the class. The skeleton may be a single atom, e.g., the nitrogen atom common
to the aliphatic amines, or a large ring structure, such as the steroid nucleus that has
been used as an example in previous chapters. The skeleton is defined and coded in the
now-familiar manner.

The user may next define part of the semantic model of mass spectrometry that
guides the whole system, by specifying kinds of fragmentation processes to be con-
sidered. This definition is done by specifying constraints on the types of processesin a
so-called half-order theory of mass spectrometry. If no constraints are specified, i.e.,
the zero-order theory of mass spectrometry is used, all possible MS processes (com-
binations of bond fragmentations and neutral transfers) are considered. Usually, how-
ever, the user will wish to shorten the search by limiting the process types in a number
of ways. The types of constraints are the following options:

1. Cleave (or not) more than one bond to a single atom prohibited.
2. Cleave (or not) aromatic ring bonds.
3. Cleave (or not) double and triple bonds.
4. Retain a minimum number of carbon atoms in a fragment.
5. Accompany cleavage with a range of allowed hydrogen transfers (numbers and

directions).

6. Cleave a maximum number of bonds in a single process.


110 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Fiie 7-2 Androstane skeleton.

7. Allow a maximum number of steps in a process. (Two steps would allow frag-
mentation of fragments, etc.)

8. If multiple step processes have been allowed, cleave a maximum total number of
bonds.

9. If multiple rings have been allowed to break, cleave a maximum number of rings.
10. Permit neutral fragments other than hydrogen to transfer.

This model defines, implicitly, a set of permitted MS processes for the given
skeleton. A report summarizing this basic information is printed. Each process is given
a name, called a process label, and is identified by a list of bonds (that cleave), an
indicator of which fragment is charged, and a fragment composition (giving the com-
position of the charged fragment). At this point only the skeleton has been considered,
and the neutral transfer information has not yet been used.

One class of compounds to which Meta-DENDRAL has been applied is the mono-
ketoandrostanes, another subclass of steroids. The skeleton of this class is depicted in
Figure 7-2. There are 11 possible monoketoandrostanes corresponding to the 11 pos-
sible carbon atoms in the rings to which an oxygen atom can be double bonded (recall
that a keto group is C=O): nodes 1,2,3,4,6,7, 11, 12, 15, 16, and 17. The analysis
here described was based on spectra from 10 of these, plus spectra from two stereo-
isomers and from androstane (whose structure is just the skeleton), making 13 mole-
cules and spectra in all. A portion of the output file produced by INTSUM as the first
step of its analysis follows. The parameter values listed define the model that the user
supplied for this run.

FRAGMENTATION PROCESS CONSTRAINTS for LNDROSTANE
----------------------------------------------------------
# (PARAMETER NAME)          VALUE
-----___---_-_---_-_--------------------------------------
1.  forbid cleavage of more than one bond to the same atom?
   the usual response is: Y

(ADJBONDFILTERFLAG) T

2.  forbid cleavage of aromatic ring bonds? Y/N.
  the usual response is: Y
   (AROMATICFILTERFLAG) T


META-DENDRAL 111

____--_-_-_---_----_--------------------------------------
# (PARAMETER NAME)         VALUE
---_-_----_--------_--~----------~~~------~----~----~~~-~~
3.  forbid cleavage of double and triple bonds? Y/N.
   the usual response is: Y
    (BONDFILTERLIST)      (DOUBLE TRIPLE)

4.  minimum number of carbons in a fragment?
   the usual response is: 0
   (MINCARBONFILTER)       2

5.  allowed hydrogen transfers?
   the usual response is: 0
   (HTRANSFERS)        (-2 -1 0 1 2)

6.  maximum number of bonds allowed to cleave in a single step process?
   the usual response is: 4
   (MAXBREAKORDER)       2

7.  maximum number of steps in a fragmentation process?
   the usual response is: 2

(MAXPROCESSLEVEL)      1

8.  maximum number of bonds allowed to cleave in a multiple step process?
   the usual response is: 6
   (MAXBONDBREAKS)       6

9.  maximum number of rings allowed to fragment in a multiple step process?
    the usual response is: 3
   (MAXRINGBREAKS)        3

10. allowed neutral transfers (other than H)?
    (TRANSFERS)            NIL
_______--____-__---_--------------------------------------
END.

SKELETON DRAWING for ANDROSTANE
--------------------------------------------.--------------

2- 1 11-12
/ \ / \I
3  19-1-9 18-3-17
\ /o \ / I
4-5 8-14 I
  \ / \I
    6-7 15 16

ALL ATOMS ARE CARBON.


112 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

_-_--_--___----_________________________~~-~~~~~~~~~~~~~~-
LIST OF PROCESSES DEFINED for ANDROSTANE
-_--__---__--_______-~~~~--~~-------~-~---~---------~-~-~-
37 PROCESS LABELS DEFINED
(THE DEFAULT SET OF H-TRANSFER VALUES IS) (-2 -1 0 1 2)

PROCESS      FRAGMENT
LABEL        SELECTOR

FRAGMENT
COMPOSITION

LIST OF
BONDS

BRKO               19      C19H32
_____________--__--_--------------------------------------
BRKlL               10      C18H29        (10 19)
BRK2L              13      C 18829        (13 18)
_____________--__-_-____________________------------------
BRK3L               1       C17H28        (1 2) (3 4)
_________________-__--------------------------------------
BRK3H              2       C2H4         (1 2) (3 4)
------------_---------------------------------------------
BRK4L              1       C 16826        (1 2) (4 5)
----------------------------------------------------------
BRK4H              2       C3H6         (1 2) (4 5)
-__--_-----_-_--__---~------------~--~~-~~-~~~~~~~~~~~~~~~
BRKSL               1       C2H4         (1 10) (2 3)
----------------------------------------------------------
BRKSH              10      Cl 7828        (1 10) (2 3)
-_---_------__--_-----------------------------------------
BRK6L               1       C3H6         (1 10) (3 4)
------__---_---------~--~-~~--~---~~~~~-~~-~~~~~~~~~~~~~~-
BRK6H              10      C16H26        (1 10) (3 4)
----------------------------------------------------------
BRK7L               1       C4H8         (1 10) (4 5)
-_-------_--__--_-------~--~~----~~--~~-~~--~~~~~~~~~~~~~~
BRK7H              10      C15H24        (1 101 (4 5)
-_------_--__----_-_____________________------------------
BRK8L              2       C17H28        (2 3) (4 5)
_-_--_----_--_------____________________~~-~~~~~~~~~~~~~~~
BRK8H              3       C2H4         (2 3) (4 5)
-------------------**************************37 3  1 1425
 590.000000 5.360898+1 590.069900 5.337410+1 590.081550 5.331215+16637 3  1 1426
 590.151450 5.179687+1 590.163100 5.152049+1 590.244650 4.844107+16637 3  1 1427
 590.267950 4.729888+1 590.340763 4.356719+1 590.378625 4.135812+16637 3  1 1428
 590.489300 3.470934+1 590.570850 2.970371+1 590.675700 2.384758+16637 3  1 1429
 590.745600 2.042929+1 590.815500 1.745306+1 590.866469 1.556523+16637 3  1 1430
 590.917438 1.390719+1 590.932000 1.349508+1 590.968406 1.250594+16637 3  1 1431
 591.019375 1.131843+1 591.070344 1.030733+1 591.108570 9.651643+06637 3  1 1432
 591.146797 9.073693+0 591.150438 9.025199+0 591.185023 8.601474+06637 3  1 1433
 591.223250 8.193497+0 591.259656 7.853834+0 591.296063 7.555485+06637 3  1 1434
 591.332469 7.292762+0 591.368875 7.060548+0 591.423484 6.792571+06637 3  1 1435
 591.478094 6.570135+0 591.514500 6.445206+0 591.532703 6.391047+06637 3  1 1436
 591.587313 6.255302+0 591.641922 6.139828+0 591.696531 6.039677+06637 3  1 1437
 591.769344 5.923652+0 591.836695 5.829196+0 591.922250 5.722064+06637 3  1 1438
 591.929531 5.715071+0 592.022367 5.637002+0 592.115203 5.566520+06637 3  1 1439
 592.238984 5.480766+0 592.330000 5.423574+0 592.424656 5.380833+06637 3  1 1440
 592.610328 5.306629+0 592.796000 5.238998+0 593.014438 5.165366+06637 3  1 1441
 593.232875 5.096349+0 593.495000 5.018100+0 593.524125 5.012501+06637 3  1 1442
 593.815375 4.960621+0 594.121188 4.909260+0 594.601750 4.832958+06637 3  1 1443
 595.082313 4.760271+0 595.359000 4.719807+0 595.562875 4.699816+06637 3  1 1444
 596.203625 4.639494+0 597.094404 4.558674+0 597.664808 4.508146+06637 3  1 1445
 598.805615 4.408923+0 599.087000 4.384915+0 600.516826 4.292546+06637 3  1 1446
 602.228038 4.184022+0 604.509653 4.040827+0 605.650460 3.969712+06637 3  1 1447
 608.839845 3.772429+0 612.029230 3.576969+0 614.421269 3.432014+06637 3  1 1448
 616.015961 3.336696+0 617.211981 3.266370+0 618.408000 3.197877+06637 3  1 1449
 619.452000 3.116670+0 620.148000 3.064922+0 620.670000 3.028210+06637 3  1 1450
 621.192000 2.994332+0 621.540000 2.959264+0 621.888000 2.927026+06637 3  1 1451
 622.236000 2.898979+0 622.497000 2.882025+0 622.700000 2.872611+06637 3  1 1452
 622.729000 2.868923+0 622.946500 2.846580+0 623.164000 2.831858+06637 3  1 1453
 623.309000 2.828311+0 623.454000 2.832343+0 623.483000 2.835129+06637 3  1 1454
 623.562750 2.833516+0 623.671500 2.841175+0 623.744000 2.854470+06637 3  1 1455
 623.816500 2.877394+0 623.889000 2.914034+0 623.943375 2.949461+06637 3  1 1456
 623.997750 2.999394+0 624.052125 3.068364+0 624.106500 3.162200+06637 3  1 1457
 624.160875 3.288284+0 624.215250 3.455811+0 624.251500 3.595978+06637 3  1 1458
 624.287750 3.763376+0 624.336688 4.040271+0 624.374750 4.302986+06637 3  1 1459
 624.412813 4.613867+0 624.450875 4.979550+0 624.454500 5.021334+06637 3  1 1460
 624.501625 5.578200+0 624.527000 5.941621+0 624.552375 6.312932+06637 3  1 1461
 624.603125 7.200019+0 624.635750 7.873780+0 624.653875 8.257120+06637 3  1 1462
 624.704625 9.506085+0 624.727100 1.014876+1 624.763350 1.120644+16637 3  1 1463
 624.809750 1.277999+1 624.830050 1.348204+1 624.892400 1.594926+16637 3  1 1464
 624.896750 1.612466+1 624.975050 1.971946+1 624.996800 2.073502+16637 3  1 1465
 625.057700 2.389517+1 625.165000 2.955265+1 625.252000 3.420812+16637 3  1 1466
 625.368000 3.961184+1 625.463700 4.292952+1 625.510100 4.392580+16637 3  1 1467
 625.543450 4.460038+1 625.600000 4.509340+1 625.640600 4.492200+16637 3  1 1468
 625.692800 4.462344+1 625.739200 4.363740+1 625.791400 4.244448+16637 3  1 1469
 625.855200 4.015422+1 625.890000 3.885036+1 625.959600 3.556986+16637 3  1 1470
 626.029200 3.220518+1 626.064000 3.042935+1 626.171300 2.484293+16637 3  1 1471
 626.262650 2.043328+1 626.323550 1.777255+1 626.397500 1.489881+16637 3  1 1472
 626.462750 1.270556+1 626.528000 1.082879+1 626.542500 1.046726+16637 3  1 1473
 626.571500 9.765970+0 626.615000 8.837674+0 626.658500 8.023194+06637 3  1 1474
 626.687500 7.549017+0 626.702000 7.320583+0 626.738250 6.820468+06637 3  1 1475
 626.774500 6.378162+0 626.810750 5.987554+0 626.832500 5.780704+06637 3  1 1476
 626.847000 5.651148+0 626.883250 5.367624+0 626.919500 5.119380+06637 3  1 1477
 626.955750 4.901759+0 627.010125 4.623650+0 627.050000 4.454292+06637 3  1 1478
 627.064500 4.399493+0 627.118875 4.230926+0 627.173250 4.090985+06637 3  1 1479
 627.227625 3.973048+0 627.282000 3.871926+0 627.332750 3.790149+06637 3  1 1480
 627.343625 3.775760+0 627.405250 3.706312+0 627.497688 3.618092+06637 3  1 1481
 627.590125 3.542877+0 627.713375 3.455515+0 627.804000 3.398313+06637 3  1 1482
 627.836625 3.382979+0 628.021500 3.307439+0 628.206375 3.240828+06637 3  1 1483
 628.413000 3.173391+0 628.558000 3.129239+0 628.674000 3.096143+06637 3  1 1484
 628.848000 3.060081+0 629.138000 3.005224+0 629.428000 2.953944+06637 3  1 1485
 629.834000 2.886366+0 629.863000 2.882700+0 630.298000 2.831317+06637 3  1 1486
 630.878000 2.766394+0 631.748000 2.673695+0 632.444000 2.602368+06637 3  1 1487
 632.835500 2.568465+0 633.923000 2.477019+0 634.648000 2.417036+06637 3  1 1488
 636.880900 2.235157+0 639.858100 1.997178+0 642.091000 1.821488+06637 3  1 1489
 643.463600 1.715639+0 645.068200 1.578743+0 646.556800 1.455250+06637 3  1 1490
 647.920000 1.346321+0 648.942400 1.256588+0 649.624000 1.201934+06637 3  1 1491
 649.964800 1.178126+0 650.135200 1.163097+0 650.476000 1.137471+06637 3  1 1492
 650.788400 1.119171+0 650.930400 1.114376+0 651.072400 1.105981+06637 3  1 1493
 651.285400 1.100700+0 651.427400 1.102892+0 651.498400 1.107766+06637 3  1 1494
 651.569400 1.109930+0 651.675900 1.121271+0 651.782400 1.144219+06637 3  1 1495
 651.853400 1.169583+0 651.924400 1.207000+0 651.995400 1.261564+06637 3  1 1496
 652.048650 1.317932+0 652.101900 1.391837+0 652.155150 1.488184+06637 3  1 1497
 652.208400 1.612978+0 652.261650 1.773435+0 652.314900 1.978053+06637 3  1 1498
 652.350400 2.149074+0 652.364600 2.219293+0 652.407200 2.474057+06637 3  1 1499
 652.449800 2.775908+0 652.492400 3.131207+0 652.520800 3.405818+06637 3  1 1500
 652.577600 4.042690+0 652.598900 4.329939+0 652.634400 4.816682+06637 3  1 1501
 652.691200 5.737674+0 652.705400 6.005970+0 652.748000 6.821239+06637 3  1 1502
 652.776400 7.443569+0 652.804800 8.072421+0 652.847400 9.144894+06637 3  1 1503
 652.872960 9.794780+0 652.918400 1.109035+1 652.941120 1.174413+16637 3  1 1504
 652.992240 1.339441+1 653.077440 1.617191+1 653.103000 1.703085+16637 3  1 1505
 653.259200 2.233199+1 653.367120 2.544585+1 653.459420 2.740351+16637 3  1 1506
 653.463680 2.749184+1 653.560240 2.857472+1 653.585800 2.867025+16637 3  1 1507
 653.600000 2.871523+1 653.679520 2.836057+1 653.696560 2.827502+16637 3  1 1508
 653.770400 2.713685+1 653.798800 2.668157+1 653.881160 2.464908+16637 3  1 1509
 653.901040 2.414744+1 653.974880 2.181327+1 654.054400 1.925988+16637 3  1 1510
 654.145280 1.624409+1 654.221960 1.368126+1 654.298640 1.136398+16637 3  1 1511
 654.375320 9.297543+0 654.412240 8.420709+0 654.432830 7.936118+06637 3  1 1512
 654.487500 6.799544+0 654.540750 5.830206+0 654.545720 5.751773+06637 3  1 1513
 654.594000 5.002180+0 654.647250 4.294676+0 654.679200 3.934786+06637 3  1 1514
 654.700500 3.700269+0 654.753750 3.209172+0 654.807000 2.800601+06637 3  1 1515
 654.821200 2.710386+0 654.860250 2.470550+0 654.913500 2.202342+06637 3  1 1516
 654.963200 1.997299+0 654.966750 1.983284+0 655.020000 1.812497+06637 3  1 1517
 655.066150 1.690335+0 655.112300 1.587620+0 655.176200 1.471833+06637 3  1 1518
 655.181525 1.462921+0 655.250750 1.372861+0 655.319975 1.301259+06637 3  1 1519
 655.389200 1.242771+0 655.481500 1.178774+0 655.488600 1.174812+06637 3  1 1520
 655.619950 1.112147+0 655.758400 1.059142+0 655.967575 9.924942-16637 3  1 1521
 655.971400 9.914460-1 656.176750 9.437609-1 656.455650 8.875583-16637 3  1 1522
 656.609700 8.605162-1 656.874000 8.202058-1 657.403500 7.506315-16637 3  1 1523
 657.502500 7.391828-1 657.712000 7.170902-1 658.594200 6.310042-16637 3  1 1524
 658.654750 6.257996-1 659.597500 5.527007-1 659.649875 5.489934-16637 3  1 1525
 660.435500 5.002711-1 660.854500 4.772741-1 660.959250 4.722675-16637 3  1 1526
 661.483000 4.506506-1 662.006750 4.327974-1 662.111500 4.299699-16637 3  1 1527
 662.399563 4.244154-1 662.740000 4.200512-1 662.949500 4.184865-16637 3  1 1528
 663.159000 4.178422-1 663.368500 4.181772-1 663.394688 4.183327-16637 3  1 1529
 663.525625 4.203321-1 663.682750 4.233484-1 663.833328 4.268475-16637 3  1 1530
 663.924984 4.292816-1 664.016641 4.319544-1 664.108297 4.348730-16637 3  1 1531
 664.193406 4.378097-1 664.271969 4.407197-1 664.350531 4.438258-16637 3  1 1532
 664.438914 4.475611-1 664.448734 4.479922-1 664.527297 4.515588-16637 3  1 1533
 664.573125 4.537717-1 664.615680 4.562875-1 664.704063 4.617908-16637 3  1 1534
 664.792445 4.675804-1 664.880828 4.736650-1 664.979031 4.807824-16637 3  1 1535
 665.096875 4.898360-1 665.214719 4.994707-1 665.306375 5.073812-16637 3  1 1536
 665.411125 5.168849-1 665.568250 5.321056-1 665.594438 5.348540-16637 3  1 1537
 665.738469 5.518289-1 665.869406 5.682877-1 666.065813 5.947521-16637 3  1 1538
 666.196750 6.136441-1 666.380063 6.418747-1 666.563375 6.723088-16637 3  1 1539
 666.746688 7.081019-1 666.930000 7.464103-1 667.139500 7.935003-16637 3  1 1540
 667.349000 8.443996-1 667.506125 8.864979-1 667.663250 9.321493-16637 3  1 1541
 667.898938 1.007446+0 668.160813 1.098733+0 668.422688 1.198904+06637 3  1 1542
 668.501250 1.231920+0 668.684563 1.314166+0 668.972625 1.456186+06637 3  1 1543
 669.286875 1.628371+0 669.601125 1.831962+0 669.915375 2.059207+06637 3  1 1544
 670.072500 2.187115+0 670.255813 2.345069+0 670.622438 2.703269+06637 3  1 1545
 670.858125 2.967121+0 670.989063 3.120767+0 671.355688 3.613862+06637 3  1 1546
 671.381875 3.654530+0 671.722313 4.202846+0 671.905625 4.544721+06637 3  1 1547
 672.088938 4.900444+0 672.429375 5.667914+0 672.455563 5.729597+06637 3  1 1548
 672.822188 6.736546+0 672.953125 7.160717+0 673.188813 7.951921+06637 3  1 1549
 673.345938 8.563964+0 673.463781 9.038655+0 673.738750 1.030291+16637 3  1 1550
 674.013719 1.180634+1 674.131563 1.255186+1 674.288688 1.357982+16637 3  1 1551
 674.472000 1.493862+1 674.477238 1.498331+1 674.765300 1.751557+16637 3  1 1552
 674.799344 1.787396+1 675.058600 2.068907+1 675.121450 2.149436+16637 3  1 1553
 675.278575 2.357770+1 675.443556 2.611758+1 675.498550 2.699809+16637 3  1 1554
 675.645200 2.966655+1 675.765663 3.221852+1 675.896600 3.509961+16637 3  1 1555
 676.053725 3.921173+1 676.085150 4.006385+1 676.273700 4.605139+16637 3  1 1556
 676.462250 5.337671+1 676.493675 5.484392+1 676.650800 6.241987+16637 3  1 1557
 676.713650 6.604444+1 676.807925 7.164286+1 676.860300 7.534795+16637 3  1 1558
 676.965050 8.294873+1 677.006950 8.662108+1 677.122175 9.699333+16637 3  1 1559
 677.153600 1.004659+2 677.279300 1.147441+2 677.295013 1.168868+26637 3  1 1560
 677.384050 1.293907+2 677.436425 1.379905+2 677.488800 1.468812+26637 3  1 1561
 677.577838 1.647614+2 677.598788 1.690971+2 677.672113 1.872771+26637 3  1 1562
 677.708775 1.965984+2 677.766388 2.143028+2 677.818763 2.308079+26637 3  1 1563
 677.860663 2.468780+2 677.928750 2.736083+2 677.944463 2.811474+26637 3  1 1564
 678.038738 3.275204+2 678.054450 3.368704+2 678.138250 3.881403+26637 3  1 1565
 678.164438 4.071628+2 678.232525 4.579903+2 678.274425 4.946649+26637 3  1 1566
 678.326800 5.417252+2 678.384413 6.017406+2 678.421075 6.408625+26637 3  1 1567
 678.494400 7.302595+2 678.515350 7.564131+2 678.620100 9.039661+26637 3  1 1568
 678.635813 9.286984+2 678.745800 1.104895+3 678.777225 1.159143+36637 3  1 1569
 679.060050 1.650951+3 679.081000 1.686667+3 679.201463 1.865200+36637 3  1 1570
 679.206700 1.872701+3 679.311450 1.990596+3 679.437150 2.072788+36637 3  1 1571
 679.500000 2.086493+3 679.604750 2.064945+3 679.615225 2.062144+36637 3  1 1572
 679.709500 1.993814+3 679.730450 1.977287+3 679.845675 1.841800+36637 3  1 1573
 679.866625 1.811258+3 679.960900 1.668651+3 680.086600 1.457691+36637 3  1 1574
 680.306575 1.086838+3 680.338000 1.034584+3 680.411325 9.263109+26637 3  1 1575
 680.463700 8.501634+2 680.516075 7.838117+2 680.589400 6.927203+26637 3  1 1576
 680.620825 6.590236+2 680.683675 5.930359+2 680.709863 5.691622+26637 3  1 1577
 680.777950 5.085351+2 680.819850 4.767430+2 680.882700 4.303468+26637 3  1 1578
 680.929838 4.006852+2 680.966500 3.782452+2 681.039825 3.394373+26637 3  1 1579
 681.050300 3.340390+2 681.149813 2.912815+2 681.176000 2.803181+26637 3  1 1580
 681.259800 2.520530+2 681.301700 2.382882+2 681.375025 2.187149+26637 3  1 1581
 681.427400 2.050966+2 681.490250 1.918655+2 681.574050 1.746694+26637 3  1 1582
 681.605475 1.693781+2 681.699750 1.538910+2 681.720700 1.509841+26637 3  1 1583
 681.825450 1.368529+2 681.893538 1.292848+2 682.014000 1.163038+26637 3  1 1584
 682.066375 1.117508+2 682.202550 1.002666+2 682.265400 9.590950+16637 3  1 1585
 682.391100 8.743136+1 682.433000 8.511365+1 682.600600 7.605953+16637 3  1 1586
 682.621550 7.495332+1 682.831050 6.586519+1 682.852000 6.509732+16637 3  1 1587
 683.040550 5.839147+1 683.103400 5.654951+1 683.354800 4.938160+16637 3  1 1588
 683.663813 4.246803+1 683.669050 4.235352+1 683.946638 3.737836+16637 3  1 1589
 683.983300 3.673459+1 684.229463 3.314937+1 684.318500 3.188276+16637 3  1 1590
 684.653700 2.793405+1 684.695600 2.745296+1 685.072700 2.385340+16637 3  1 1591
 685.077938 2.381106+1 685.449800 2.088539+1 685.502175 2.054070+16637 3  1 1592
 685.785000 1.871841+1 685.952600 1.765882+1 686.308750 1.576937+16637 3  1 1593
 686.361125 1.549784+1 686.832500 1.340620+1 687.303875 1.165170+16637 3  1 1594
 687.356250 1.148242+1 687.775250 1.016338+1 688.141875 9.172788+06637 3  1 1595
 688.403750 8.484791+0 688.927500 7.309345+0 688.980875 7.192563+06637 3  1 1596
 689.506625 6.188103+0 689.713125 5.838290+0 690.032375 5.312142+06637 3  1 1597
 690.520875 4.596521+0 690.558125 4.543250+0 691.066750 3.905957+06637 3  1 1598
 691.189625 3.756622+0 691.742563 3.173065+0 692.080469 2.854284+06637 3  1 1599
 692.111188 2.826838+0 692.541250 2.483564+0 692.909875 2.225533+06637 3  1 1600
 693.094188 2.110901+0 693.155625 2.076147+0 693.432094 1.938723+06637 3  1 1601
 693.662484 1.840222+0 693.892875 1.757146+0 694.000391 1.725264+06637 3  1 1602
 694.077188 1.707002+0 694.200063 1.683955+0 694.322938 1.666091+06637 3  1 1603
 694.422774 1.655555+0 694.537969 1.648023+0 694.614766 1.645860+06637 3  1 1604
 694.691563 1.646492+0 694.718442 1.648384+0 694.799079 1.657166+06637 3  1 1605
 694.879715 1.668774+0 694.958432 1.682930+0 695.036188 1.699750+06637 3  1 1606
 695.062107 1.706002+0 695.113945 1.719496+0 695.169623 1.735492+06637 3  1 1607
 695.225301 1.753086+0 695.280978 1.772321+0 695.305938 1.781888+06637 3  1 1608
 695.363535 1.808484+0 695.444172 1.849451+0 695.524809 1.894265+06637 3  1 1609
 695.613126 1.947956+0 695.705282 2.009363+0 695.797438 2.076542+06637 3  1 1610
 695.912633 2.169094+0 695.951031 2.203319+0 696.027828 2.280109+06637 3  1 1611
 696.104625 2.362862+0 696.227500 2.505822+0 696.350375 2.662634+06637 3  1 1612
 696.473250 2.834380+0 696.596125 3.022254+0 696.749719 3.301812+06637 3  1 1613
 696.903313 3.611547+0 697.056906 3.954758+0 697.084553 4.023237+06637 3  1 1614
 697.210500 4.354594+0 697.382525 4.856663+0 697.554550 5.417675+06637 3  1 1615
 697.572981 5.484953+0 697.726575 6.076335+0 697.898600 6.814927+06637 3  1 1616
 698.021475 7.409699+0 698.095200 7.783916+0 698.291800 8.915502+06637 3  1 1617
 698.390100 9.560163+0 698.488400 1.023294+1 698.685000 1.176580+16637 3  1 1618
 698.758725 1.242163+1 698.869313 1.344823+1 699.053625 1.539319+16637 3  1 1619
 699.127350 1.628325+1 699.237938 1.767788+1 699.422250 2.034012+16637 3  1 1620
 699.495975 2.156924+1 699.606563 2.348081+1 699.741725 2.615818+16637 3  1 1621
 699.766300 2.666218+1 699.962900 3.132674+1 700.012050 3.271134+16637 3  1 1622
 700.159500 3.699494+1 700.233225 3.949763+1 700.306950 4.207840+16637 3  1 1623
 700.454400 4.801190+1 700.601850 5.510930+1 700.675575 5.925434+16637 3  1 1624
 700.749300 6.354409+1 700.896750 7.363327+1 701.044200 8.604896+16637 3  1 1625
 701.099494 9.165105+1 701.191650 1.012834+2 701.265375 1.105753+26637 3  1 1626
 701.326813 1.185646+2 701.431256 1.349070+2 701.455831 1.388614+26637 3  1 1627
 701.541844 1.556203+2 701.584850 1.641976+2 701.652431 1.807025+26637 3  1 1628
 701.713869 1.960625+2 701.763019 2.106998+2 701.799881 2.219456+26637 3  1 1629
 701.873606 2.479342+2 701.885894 2.523883+2 701.990338 2.969139+26637 3  1 1630
 702.002625 3.031314+2 702.082494 3.445418+2 702.113213 3.632198+26637 3  1 1631
 702.174650 4.014384+2 702.223800 4.371573+2 702.266806 4.691211+26637 3  1 1632
 702.334388 5.274329+2 702.358963 5.490955+2 702.444975 6.375490+26637 3  1 1633
 702.469550 6.633547+2 702.567850 7.825205+2 702.573994 7.911445+26637 3  1 1634
 702.715300 9.931544+2 702.739875 1.033605+3 702.899613 1.300153+36637 3  1 1635
 703.182225 1.790447+3 703.212944 1.842484+3 703.348106 2.026201+36637 3  1 1636
 703.378825 2.066452+3 703.452550 2.132882+3 703.489413 2.163977+36637 3  1 1637
 703.600000 2.204751+3 703.633791 2.214884+3 703.650686 2.214547+36637 3  1 1638
 703.735163 2.195880+3 703.870325 2.102132+3 704.005488 1.944457+36637 3  1 1639
 704.140650 1.742353+3 704.251238 1.561825+3 704.472413 1.200364+36637 3  1 1640
 704.583000 1.036900+3 704.619863 9.884767+2 704.730450 8.457180+26637 3  1 1641
 704.841038 7.249473+2 704.951625 6.227198+2 705.062213 5.373291+26637 3  1 1642
 705.172800 4.665719+2 705.271100 4.150429+2 705.295675 4.023814+26637 3  1 1643
 705.369400 3.709550+2 705.418550 3.503678+2 705.467700 3.332452+26637 3  1 1644
 705.541425 3.081019+2 705.615150 2.870422+2 705.664300 2.733330+26637 3  1 1645
 705.762600 2.510597+2 705.848613 2.319983+2 705.910050 2.212076+26637 3  1 1646
 706.032925 2.000507+2 706.155800 1.826924+2 706.180375 1.797614+26637 3  1 1647
 706.327825 1.625088+2 706.352400 1.596855+2 706.549000 1.411501+26637 3  1 1648
 706.745600 1.260088+2 706.770175 1.244635+2 706.991350 1.108592+26637 3  1 1649
 707.040500 1.078911+2 707.261675 9.725634+1 707.335400 9.377604+16637 3  1 1650
 707.507425 8.717284+1 707.630300 8.253349+1 707.753175 7.866661+16637 3  1 1651
 707.900625 7.411278+1 708.121800 6.841590+1 708.244675 6.531412+16637 3  1 1652
 708.490425 6.017235+1 708.588725 5.815178+1 708.859050 5.364580+16637 3  1 1653
 709.104800 4.962021+1 709.282969 4.729816+1 709.620875 4.296652+16637 3  1 1654
 709.639306 4.277402+1 710.136950 3.766622+1 710.173813 3.735536+16637 3  1 1655
 710.708319 3.293350+1 710.726750 3.278319+1 711.242825 2.939016+16637 3  1 1656
 711.464000 2.795550+1 711.777331 2.631390+1 712.201250 2.412037+16637 3  1 1657
 712.262688 2.385707+1 712.877063 2.125741+1 712.938500 2.100096+16637 3  1 1658
 713.798625 1.804567+1 713.921500 1.762970+1 714.720188 1.540487+16637 3  1 1659
 714.904500 1.489837+1 715.641750 1.318577+1 715.887500 1.262215+16637 3  1 1660
 716.563313 1.128166+1 716.870500 1.068037+1 717.607750 9.408217+06637 3  1 1661
 717.853500 8.989411+0 718.345000 8.249358+0 719.082250 7.154832+06637 3  1 1662
 719.358719 6.790021+0 720.188125 5.716316+0 720.372438 5.500305+06637 3  1 1663
 721.294000 4.445594+0 721.386156 4.349712+0 722.031250 3.703010+06637 3  1 1664
 722.399875 3.368808+0 722.768500 3.050494+0 723.075688 2.816138+06637 3  1 1665
 723.382875 2.596383+0 723.751500 2.366258+0 724.120125 2.192763+06637 3  1 1666
 724.388125 2.089920+0 724.433125 2.076164+0 724.605813 2.038707+06637 3  1 1667
 724.750938 2.016879+0 724.910875 2.002861+0 724.944344 2.002144+06637 3  1 1668
 725.041938 2.009596+0 725.129313 2.021023+0 725.231250 2.039560+06637 3  1 1669
 725.318625 2.060237+0 725.333188 2.064475+0 725.406000 2.095389+06637 3  1 1670
 725.493375 2.137585+0 725.551625 2.168735+0 725.580750 2.185262+06637 3  1 1671
 725.639000 2.220298+0 725.716364 2.271124+0 725.784625 2.320631+06637 3  1 1672
 725.795547 2.330407+0 725.874731 2.407161+0 725.944813 2.480362+06637 3  1 1673
 726.010344 2.553606+0 726.075875 2.631805+0 726.152328 2.744151+06637 3  1 1674
 726.228781 2.864311+0 726.316156 3.012077+0 726.352563 3.078293+06637 3  1 1675
 726.388969 3.154049+0 726.461781 3.314804+0 726.571000 3.575153+06637 3  1 1676
 726.629250 3.726404+0 726.658375 3.811903+0 726.745750 4.087134+06637 3  1 1677
 726.833125 4.383536+0 726.847688 4.436954+0 726.920500 4.736320+06637 3  1 1678
 727.037000 5.259066+0 727.066125 5.404802+0 727.153500 5.892058+06637 3  1 1679
 727.229953 6.360726+0 727.240875 6.435875+0 727.328250 7.087922+06637 3  1 1680
 727.393781 7.623811+0 727.415625 7.822868+0 727.503000 8.697513+06637 3  1 1681
 727.590375 9.765075+0 727.602025 9.925051+0 727.677750 1.107412+16637 3  1 1682
 727.701050 1.147488+1 727.765125 1.271133+1 727.800075 1.348186+16637 3  1 1683
 727.852500 1.477425+1 727.874344 1.537710+1 727.907838 1.640461+16637 3  1 1684
 727.948613 1.777333+1 727.963175 1.832191+1 728.018513 2.060127+16637 3  1 1685
 728.022881 2.079983+1 728.073850 2.339326+1 728.097150 2.469873+16637 3  1 1686
 728.129188 2.672074+1 728.171419 2.964631+1 728.184525 3.065092+16637 3  1 1687
 728.220931 3.370772+1 728.239863 3.543146+1 728.270444 3.847845+16637 3  1 1688
 728.295200 4.115817+1 728.324325 4.464333+1 728.365100 4.996380+16637 3  1 1689
 728.382575 5.250419+1 728.435000 6.080379+1 728.440825 6.182601+16637 3  1 1690
 728.499075 7.290349+1 728.504900 7.410639+1 728.557325 8.594145+16637 3  1 1691
 728.574800 9.019702+1 728.615575 1.009772+2 728.644700 1.092264+26637 3  1 1692
 728.673825 1.180819+2 728.708775 1.295575+2 728.761200 1.479466+26637 3  1 1693
 728.790325 1.590658+2 728.866050 1.900940+2 728.912650 2.105065+26637 3  1 1694
 728.970900 2.372722+2 729.203900 3.476969+2 729.227200 3.579113+26637 3  1 1695
 729.308750 3.907445+2 729.332050 3.990408+2 729.396125 4.189325+26637 3  1 1696
 729.413600 4.232817+2 729.500975 4.401089+2 729.506800 4.408714+26637 3  1 1697
 729.565050 4.444655+2 729.600000 4.445238+2 729.658250 4.403269+26637 3  1 1698
 729.696113 4.349370+2 729.757275 4.222514+2 729.774750 4.175667+26637 3  1 1699
 729.850475 3.926946+2 729.885425 3.795585+2 729.949500 3.526861+26637 3  1 1700
 729.961150 3.474204+2 730.135900 2.632611+2 730.229100 2.180292+26637 3  1 1701
 730.252400 2.072739+2 730.339775 1.688701+2 730.368900 1.569066+26637 3  1 1702
 730.421325 1.368935+2 730.454007 1.252064+2 730.481961 1.159916+26637 3  1 1703
 730.539114 9.834692+1 730.541545 9.766126+1 730.601128 8.206543+16637 3  1 1704
 730.614868 7.870538+1 730.647390 7.143564+1 730.671914 6.632296+16637 3  1 1705
 730.700193 6.090048+1 730.728961 5.580929+1 730.752996 5.192185+16637 3  1 1706
 730.786007 4.702271+1 730.805799 4.435465+1 730.843054 3.973730+16637 3  1 1707
 730.849175 3.905168+1 730.900100 3.382787+1 730.942538 3.024074+16637 3  1 1708
 730.951025 2.957926+1 730.984975 2.726249+1 731.027413 2.461212+16637 3  1 1709
 731.069850 2.257700+1 731.103800 2.109814+1 731.112288 2.079052+16637 3  1 1710
 731.154725 1.941408+1 731.180188 1.867197+1 731.197163 1.827198+16637 3  1 1711
 731.239600 1.739250+1 731.256575 1.709150+1 731.303256 1.646477+16637 3  1 1712
 731.337206 1.610969+1 731.366913 1.590058+1 731.409350 1.568903+16637 3  1 1713
 731.426325 1.563900+1 731.494225 1.563785+1 731.545150 1.575216+16637 3  1 1714
 731.579100 1.590540+1 731.663975 1.645271+1 731.668219 1.648660+16637 3  1 1715
 731.757338 1.735399+1 731.782800 1.765003+1 731.876163 1.885652+16637 3  1 1716
 731.952550 2.000645+1 731.994988 2.070295+1 732.122300 2.308493+16637 3  1 1717
 732.207175 2.489954+1 732.258100 2.605424+1 732.393900 2.955304+16637 3  1 1718
 732.461800 3.154243+1 732.529700 3.361485+1 732.682475 3.894680+16637 3  1 1719
 732.716425 4.033017+1 732.852225 4.604612+1 732.971050 5.194249+16637 3  1 1720
 733.021975 5.455096+1 733.191725 6.483876+1 733.217188 6.668316+16637 3  1 1721
 733.361475 7.741517+1 733.446350 8.482426+1 733.488788 8.863458+16637 3  1 1722
 733.616100 1.018044+2 733.675513 1.089395+2 733.743413 1.172790+26637 3  1 1723
 733.828288 1.294386+2 733.870725 1.356382+2 733.981063 1.545470+26637 3  1 1724
 733.998038 1.575168+2 734.125350 1.837983+2 734.133838 1.858850+26637 3  1 1725
 734.252663 2.156411+2 734.286613 2.258241+2 734.379975 2.544109+26637 3  1 1726
 734.456363 2.825531+2 734.507288 3.017068+2 734.596406 3.421628+26637 3  1 1727
 734.634600 3.598364+2 734.736450 4.156779+2 734.838300 4.818120+26637 3  1 1728
 734.876494 5.106001+2 734.940150 5.593804+2 735.016538 6.269445+26637 3  1 1729
 735.042000 6.498536+2 735.177800 7.928469+2 735.296625 9.406286+26637 3  1 1730
 735.313600 9.651528+2 735.474863 1.200720+3 735.517300 1.271016+36637 3  1 1731
 735.653100 1.497130+3 735.924700 1.965640+3 735.950163 2.008810+36637 3  1 1732
 736.128400 2.267054+3 736.298150 2.434500+3 736.400000 2.483070+36637 3  1 1733
 736.425463 2.494293+3 736.491241 2.501238+3 736.540044 2.487138+36637 3  1 1734
 736.654625 2.449536+3 736.680088 2.429177+3 736.794669 2.333372+36637 3  1 1735
 736.866813 2.248708+3 736.934713 2.167115+3 737.376063 1.514892+36637 3  1 1736
 737.469425 1.378200+3 737.528838 1.300741+3 737.639175 1.158599+36637 3  1 1737
 737.681613 1.111621+3 737.808925 9.725618+2 737.953213 8.411921+26637 3  1 1738
 737.961700 8.347790+2 738.114475 7.213390+2 738.131450 7.089183+26637 3  1 1739
 738.267250 6.289844+2 738.309688 6.043721+2 738.420025 5.528475+26637 3  1 1740
 738.487925 5.216014+2 738.572800 4.899315+2 738.666163 4.555652+26637 3  1 1741
 738.708600 4.427657+2 738.844400 4.024239+2 738.912300 3.859121+26637 3  1 1742
 739.048100 3.534450+2 739.116000 3.401560+2 739.251800 3.139853+26637 3  1 1743
 739.319700 3.035677+2 739.523400 2.727700+2 739.557350 2.676983+26637 3  1 1744
 739.761050 2.440830+2 739.862900 2.324150+2 739.964750 2.231230+26637 3  1 1745
 740.168450 2.047788+2 740.270300 1.973187+2 740.474000 1.826123+26637 3  1 1746
 740.575850 1.766465+2 740.847450 1.609468+2 740.881400 1.593585+26637 3  1 1747
 741.186950 1.452408+2 741.220900 1.436886+2 741.560400 1.314732+26637 3  1 1748
 741.781075 1.236249+2 741.967800 1.185082+2 742.341250 1.083952+26637 3  1 1749
 742.375200 1.076418+2 742.714700 1.001905+2 742.782600 9.898276+16637 3  1 1750
 743.190000 9.181187+1 743.461600 8.707192+1 743.656813 8.445551+16637 3  1 1751
 744.242450 7.668670+1 744.276400 7.624029+1 744.828088 7.059306+16637 3  1 1752
 745.091200 6.792243+1 745.413725 6.529811+1 745.906000 6.132942+16637 3  1 1753
 746.194575 5.951049+1 746.882063 5.521894+1 747.128200 5.369428+16637 3  1 1754
 747.773250 5.063460+1 748.350400 4.792017+1 748.664438 4.679237+16637 3  1 1755
 749.555625 4.361831+1 749.980000 4.211501+1 750.149750 4.165947+16637 3  1 1756
 751.338000 3.849180+1 751.677500 3.759307+1 752.611125 3.566679+16637 3  1 1757
 753.375000 3.410145+1 753.884250 3.330348+1 755.157375 3.132176+16637 3  1 1758
 755.921250 3.013874+1 756.430500 2.954114+1 758.128000 2.756100+16637 3  1 1759
 758.297750 2.736406+1 760.165000 2.569133+1 761.353250 2.463265+16637 3  1 1760
 762.202000 2.404646+1 764.239000 2.264703+1 764.408750 2.253086+16637 3  1 1761
 766.276000 2.155746+1 768.992000 2.014792+1 771.538250 1.916752+16637 3  1 1762
 774.084500 1.819062+1 777.479500 1.718945+1 779.177000 1.669061+16637 3  1 1763
 780.874500 1.631576+1 784.609000**************************---------------------------------------
BRK9L               5       C17H28        (5 6) (7 8)
--------------------L___________________------------------
BRK9H              6       C2H4         (5 6) (7 8)
--_------_--__--------------------------------------------
BRKlOL              5       C7H12        (5 6) (9 10)
-_--__-_________-__-____________________------------------
BRKlOH            6       C12H20 :     (5 6) (9 10)
-----_--_--_---_--__--------------------------------------
BRKI 1L             6       C8H14      (67) (910) '
--__-----_---_--_---____________________~~~~~~~~~~~~~~-~~-
BRKI 1H             7       Cl lH18        (6 7) (9 10)
---------_---------_____________________------------------
BRK12L             7       C9H16        (7 8) (9 10)
~-___--_-----_------____________________~~~-~~~~~~~~~~~~~-
BRK12H             8       ClOH16        (7 8) (9 10)
-_-----__----__-----____________________~~~~~~~~~~~~~~~~~-
BRK13L             8       Cl 1H18        (8 14) (9 11)
---------------_---_____________________------------------


META-DENDRAL 113

PROCESS      FRAGMENT      FRAGMENT       LIST OF
LABEL        SELECTOR      COMPOSITION      BONDS
_____--_-------__--_~~--~---~~~~~~~-~~-~~-~~~~~~~~~~-~~---

BRK13H             14      C8H14        (8 14) (9 11)
---------------_------------------------------------------
BRK14L             8       C12H20        (8 14) (11 12)
--___-_---__---_________________________~~~~~~~~~~~~~~~--~
BRK14H             14      C7H12        (8 14) (11 12)
-------_---_---_---_--------------------------------------
BRKISL             8       CI3H22        (8 14) (12 13)
______-__--_-___________________________------------------
BRKlSH             14      C6HlO        (8 14) (12 13)
-___--__--____-___-_--------------------------------------
BRK16L             9       C17H28       (9 11) (12 13)
_____-__---_---___-_____________________~~~~-~~~~~~~~~~~-~
BRKl6H              11      C2H4         (9 11) (12 13)
--__-__-_-_----__-_-~--~--~--~~-~~--~---~--~~---------~---
BRK17L             13      C16H26        (13 17) (14 15)
-_____-__--_--__________________________------------------
BRKl7H             17      C3H6         (13 17) (14 15)
_________-__-_-___-_____________________------------------
BRK18L             13      C 17H28        (13 17) (15 16)
--__--_---____~___-_~~~~-~-~-~-~~-~~~~----~-~~~----------~
BRKl8H             17      C2H4         (13 17) (15 16)
-____-_---_-----_---------------------------------- -------
BRK19L             14      C17H28        (14 15) (16 17)
_________--__-____-_--------------------------------------
BRK19H             15      C2H4         (14 15) (16 17)
--_--__--_--_____--_-----~-~-~--~-----~~~--~~-~~--~-~~~~~~
END.

Following the construction of the list of basic skeletal MS processes, INTSUM is
ready to examine spectra. Each spectrum is examined in turn, and significant peak
groups are determined by the same local weighting scheme used by MOLION (Section
5.3) in order that important high mass peaks will not be ignored because of their low
abundances. At this point, fragmentations in the substituents of each molecule are also
defined and added to the list of basic processes to be considered for that molecule.
For each of the significant peak groups, an exhaustive search of the list of processes
is made to locate all processes that yield a charged fragment of the appropriate
composition.

A summary of findings is printed for each spectrum, Each peak for which an ex-
planation was found has an abundance that may be expressed:as a percentage of the
total ion current. The sum of these intensity percentages is an index of how much of
the important data has been accounted for by the listed processes. The following is an
example of the results for a spectrum for just one monoketoandrostane. Process names
refer to labels listed in the previous table. Transfers when proposed are indicated by
concatenating a colon to the process label, followed by the direction and number of
hydrogens that migrate. (Minus indicates loss, or transfer out of the charged fragment;
plus indicates gain, or transfer into the charged fragment.) Other atoms or neutral frag-
ments such as Hz0 may also be specified.


114 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

MASS SPECTRUM for S:ANDROSTAN-3-ONE-MAPAl

---~--__------_-__-_-~--~~-~----------~~~-~~~~--~~-~-~--~~
(SKELETON IS) ANDROSTANE
(SUBSTITUENTS ARE) ((SUBSTO= 3))
(MOLECULE NUMBER) 4

(TOTAL ION CURRENT IS) 1162
3 (PEAKS BELOW MINIMUM MASS OR INTENSITY)
85 (PEAKS REMOVED BY CLUSTERING)  [See Section 5.3.1.1
(HAVING A COMBINED INTENSITY OF) 21 .l
--_--_--__---__-_-__--------------------------------------
END.

[Note that the keto group is at node 3, i.e., the oxygen atom (node 20) is doubly
bonded to the carbon atom at node 3, as represented by the dots at 3 and 20.1

  12-11    1-2
  I/   \ / \2
17-3-18 9-1-19 3.-O.
I \ / o\ /
1 14-8    5-4
I/ \ /
16-15   7-6

NON-CARBON ATOMS ARE: (0 20)

PEAK EXPLANATIONS for S:ANDROSTAN-3-ONE-MA1204
__________------_------------~--~---~~~~-~~-~~~~~-----~---
MOLECULE S:ANDROSTAN-3-ONE-MAPAI204

     (DATA POINTS)       (PROPOSED EXPLANATION)
   FRAGMENT       INTENSITY
MASS COMPOSITION (% TOT ION)     PROCESS NAMES
-----_------------_-____________________--~-~~-~~-~~--~--~

274   C 19H300         6.05     BRKO
259   C18H270         1.58     BRKIL BRK2L

[@I+ - 15) can be a loss of either methyl group. Thus there are two possible explana-
tions.]

232   C 168240          .55     BRKl7L
231   C16H230         1.49     BRKl7L: -H
219   C16H27           .46     BRK4L: +H  BRK6H: +H
217   C16H25           .59     BRK4L: -H  BRK6H: -H
216   C 16H24           .25     BRK4L:-2H  BRK6H:-2H
203   C15H23          5.14     BRK7H: -H
202   C15H22          8.51     BRK7H:-2H


META-DENDRAL 115

177   C12H170
163   C12H19
163   Cl lH150
162   C12H18
149   Cl lH17
148   Cl lH16
135   ClOH15
124   C8H120
123   C8HllO
109   C8H13
108   C8H12
95    C7Hll
81    C6H9
41    C3H5

.20     BRK14L: -H
.46     BRKl OH: - H
.53     BRKl3L:-H
.34     BRKlOH:-2H
1.38     BRKl lH:-H
.64     BRKl lH:-2H
1.49     BRKl2H: -H
.84     BRKl IL
.56     BRKl IL:-H
1.78     BRK13H:-H
1.28     BRKl3H: - 2H
5.06     BRK14H:-H
3.64     BRKlSH:-H
3.54     BRK17H:-H

(TOTAL INTENSITY OF ALL DATA POINTS SHOWN IS) 46.3
__________-___--_--_--------------------------------------
(THOSE DATA POINTS NOT HAVING ANY EXPLANATION)
_____--___-_----_-_-~~--~-~~~~--~-~--~~-~-----~--~--------
25 (DATA POINTS WITH INTENSITY ABOVE) 0
(HAVING A COMBINED INTENSITY OF) 32.5
-__-__--_--_------_----~--------~-~~-~--------------------
$ULTS SAVED FOR) ANDROSTANE

Note that roughly one-third of the total ion current remains unexplained under
this model, which was specified by the chemist. At this point the chemist may wish
to change the model and run INTSUM again if there are significant peaks in the spec-
trum that must be explained. The half-order theory may also be augmented with
specific processes (however complex) that the chemist chooses to include in the model.
The final output from INTSUM is an INTSUM table of infomation about each
break giving break name, the names of the molecules for which there is positive Eli-
dence (predicted peaks that are found in spectra) for this break, and the average inten-
sity of the ion current of positive evidence for each of the molecules. The INTSUM
table for androstanes is shown in Table 7-1.

The INTSUM table of results is itself an informative and useful codification of a
set of mass spectra. Because the model of mass spectrometry can be defined to capture
the chemist's expectations, INTSUM can quickly point out the unexpected peaks. In
addition, plausible alternative explanations are often surprising in themselves, since
chemists do not usually exhaust the combinations of allowable fragmentations and
transfers.

7.3 RULEGENeration

As defined by INTSUM, each process is specific to particular bonds, the break loci.
For example, BRK3L cleaves the carbon-carbon bonds between nodes (1 2) and (3 4)


Table 7-1 Part of the INTSUM table for monoketoandrostanes

REPORT OF ALL PROCESSES HAVING EVIDENCE for ANDROSTANE

31 SEPARATE PROCESS LABELS

FULL            (MOLS SHOWING THIS PROCESS)
PROCESS           OCCURRENCE MOL INTEN PARTIAL
LABEL               RATIO ID   SITY REDUNDANCIES

BRKO             13/13     1
                           2
                          5
                          9
                          6
                        13
                          3
                        10
                         8
                        12
                          4
                          7
                         11

BRKlL
((10 19))

BRK'IL:+H
((1 10) 4 5))

13/13 7
       6
       9
       10
       13
       2
       5
       4
       8
       12
       3
       11
        1

l/13     3    3.46

MOLS NOT SHOWING
THESE PROCESSES 1  2 4
               5  6 7
              8  9
               10  11
              12  13

11.5
11.3
9.94
9.17
8.75
8.19
7.82
7.69
7.05
6.08
6.05
5.78
5.27
8.05

9.03  BRKZL
7.87  BRKZL
5.14  BRKZL
4.23  BRKZL
3.93  BRKZL
3.02  BRKZL
1.91  BRKZL
1.58  BRKZL
1.56  BRKZL
1.47  BRK2L
1.34  BRKZL
.67  BRKZL
SO  BRKZL
3.25  (AVERAGE INTENSITY)

(AVERAGE INTENSITY)

BRK7L:-H
((1 10) (4 5))       9113      6    4.49
                         8    4.48
                          1    4.46

116


Table 7-1 (Continued)

REPORT OF ALL PROCESSES HAVING EVIDENCE for ANDROSTANE

31 SEPARATE PROCESS LABELS

FULL          (MOLS SHOWING THIS PROCESS)
PROCESS          OCCURRENCE MOL INTEN PARTIAL
LABEL               RATIO ID   SITY REDUNDANCIES

I 4.41
5 4.33
2 4.17
9 3.51
3 3.34
12 3.07
   4.03 (AVERAGE INTENSITY)
MOLS NOT SHOWING
THESE PROCESSES 4 10
              11 13

BRKl'IH:+H
((17 13) (15 14))     10113    10 .92 BRK4H:+H
                      8 .88 BRK4H:+H BRK6L:+H
                       11 .67
                        13 .67 BRK6L:+H
                        4 .67
                       3 .66 BRK4H:+H BRK6L:+H
                      1 56 BRK4H:+H BRK6L:+H
                      6 55 BRK4H:+H BRK6L:+H
                      12 54 BRK4H:+H BRK6L:+H
                      7 53 BRK4H:+H BRKCL:+H
                        .67 (AVERAGE INTENSITY)
                        MOLS NOT SHOWING
                        THESE PROCESSES 2 5 9

BRK17H
((17 13) (15 14))     l/l3      10    .98 BRK4H
                       MOLS NOT SHOWING
                      THESE PROCESSES 1 2 3
                                      4 5 6
                                      I 8 9
                                      11 12
                                      13

BRK17H:-H
((17 13) (15 14))     10113 3
                          7
                         6
                          8
                          10
                         13
                          4
                          11

6.01
4.78
4.66
4.56
4.14
3.94
3.54
3.12

BRK4H:-H BRK6L:-H
BRK4H:-H BRK6L:-H
BRK4H:-H BRK6L:-H
BRMH:-H BRK6L:-H
BRK4H:-H
BRKCL:-H

117


118 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Table 7-1 (Continued)

REPORT OF ALL PROCESSES HAVING EVIDENCE for ANDROSTANE

31 SEPARATE PROCESS LABELS

FULL           (MOLS SHOWING THIS PROCESS)
PROCESS          OCCURRENCE MOL INTEN PARTIAL
LABEL              RATIO ID   SITY REDUNDANCIES

12   3.09 BRMH:-H BRK6L:-H
9     .55
   3.84 (AVERAGE INTENSITY)
MOLS NOT SHOWING

THESE PROCESSES 1 2 5

  Notes:
1. BRKO is the molecular ion.

2. BRKlL is loss of methyl. This is totally redundant with loss of methyl from another site in
process BRKZL.

3. BRK7L is a "unique" explanation of the data points in the spectra of molecules where it oc-
curs at all. That is, there are no other processes that explain these data points.
4. BRKl7H (with gain or loss of one H) is rarely a unique explanation. In many spectra, the peak
that can be explained by BRK17H:+H, BRK17H, or BRK17H:-H can also be explained by
either of two other processes.

of the androstane skeleton. The task of RULEGEN is to generalize these descriptions
so that a smaller set of more general subgraph descriptions accounts for a significant
portion of the MS data. The goal is to achieve the appropriate amount of generaliza-
tion without overgeneralizing, i.e., to find rules describing fragmentations in terms of
subgraphs that are general enough to explain many data points at once and specific
enough to avoid false predictions. At the opposite extreme from the specific process
definitions produced by INTSUM is the single most general rule stating that "all bonds
break and all allowed transfers occur." This zero-order-theory rule accounts for all
possible breaks but obviously predicts many peaks that do not appear. The plausible
rules lie somewhere between this single, overly general rule and the INTSUM-generated
processes.

The RULEGEN program systematically and selectively searches the space of pos-
sible rules,2 with strong guidance from the data as well asfrom the semantic model of
mass spectrometry. For purposes of the search, a candidate rule is represented as a
pair of constructs called a break environment (or B/E) and a template, which are
explained below. A template represents an operation that, when applied to a B/E,
transforms it into a general rule. A template thus defines a whole class of rules (be-
cause it is an abstract description of many rules, as will be seen).

20ne organization of the program and requisite representation of the search space are de-
scribed here. Another representation and organization are discussed ln Mitchell (1978), in which
the key idea is to keep a set of admissible versions of each rule and update the most specific and
most general boundaries of this set on examination of each new training instance. It is still the sub-
ject of current research.


META-DENDRAL 119

The search of the rule space is implemented by selectively generating more and
more refined templates and applying them to B/E's that are determined directly by the
INTSUM output. (This method is much more efficient than searching the rule space by
applying all possible templates to all possible B/Es.) By the way the space of tem-
plates is generated, some rules will not be considered during generation. The search is
coarse during RULEGEN, following the heuristic that rules that are close approxima-
tions to final rules can be found quicker and refined later.
A breuk environment (B/E) is a pair of associated elements: (1) A set of bonds in
a molecule that may break, cleaving the molecule into two parts, and (2) a descrip-
tion of the molecule in question that is complete within the limits of the available
vocabulary.3

The program first forms the base B/E set, i.e., the set of all break environments
resulting from INTSUM's analysis of the data. The maximum possible cardinality of
this set is the product of the number of processes and the number of molecules. In
general it will be smaller since not all processes will occur in all molecules. In our ex-
ample, the base B/E set contains at most 468 members (36 processes X 13 molecules).4
Associated with each B/E is the set of data points INTSUM has listed as poten-
tially explained by the break that the B/E defines. The B/E's associated with positive
evidence are the only ones that RULEGEN sees. RULEGEN's goal is to identify
significant common features of break environments so that general rules may be com-
posed to describe several specific B/E's. We expect to have far fewer explanatory rules
than B/E's in every case.

As mentioned above, the program also needs the templates or rule abstractions for
guidance in its search for rules. A template is a one-dimensional specification of sig-
nificant attributes of a B/E whose values are to remain fured in generalizing the B/E
into a rule. For example, a template may specify that atom type is a significant deter-
miner for fragmentation at a particular location.
In denoting templates, we will use "*" to denote a cleaving bond and "-" to de-
note a noncleaving bond, and we will adopt the convention that the charged fragment
is on the left of a cleaving bond. If no particular features are specified for a node, it
will be denoted by X. Otherwise, a node will be denoted by a sequence of from one to
three letters separated by commas. The letter T indicates that the afom type of that
node is significant. The letter N denotes that the number of (nonhydrogen) neighbors
of that node is significant. The letter D denotes that the number of dots (double
bonds) is significant for that node. For example, the template ;
            CT11   T,N - T,N * T
when applied to B/E
                         C
                     I
         W-1)   c-o-c-o*c-c

3As indicated in earlier publications, we previously considered only B/E's of limited sizes, but
this restriction has now been removed.
4See INTSUM's list of processes in Table 7-1. BRKO is not included because it breaks no
bonds.


120 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

generalizes it into the following rule:

X

(RI)  >C - 0 * C

X

That is, the atom type of BE-l has been fKed at three positions, and the number
of neighbors has been fured at the outermost position on the left. The size of the tem-
plate also determines the size of the subgraph in the rule. In Rl all other features have
been abstracted away in the generalization.

Templates are used to guide the exploration of the rule space within constraints
of the positive evidence associated with B/E's Only candidate rules for which there is
some positive evidence are ever generated, because templates are only applied to the
base B/E set. This limitation is a significant advantage over simple generate-and-test
schemes in which rules are generated under the model and tested to see whether or not
there is evidence supporting them.

In order to capture the notion of a candidate rule explaining more than one data
point, we need to determine when two or more B/E's are equivalent under a template,
or match with respect to a template. Two B/E's match with respect to a template if,
within the size of the template there is a one-to-one correspondence between their
atomic nodes such that (1) corresponding nodes have corresponding neighbors and (2)
corresponding nodes have the same value for the features (T,N, or D) specified by the
template for their positions. For example, both of the hypothetical B/E's below match
under template (II):

C

I

(BE-l)      c-o-c-o*c-c

      C         C
              I
W-2)  A-c-c-c-o*c-o-c

Applying (Tl) to either or both (BE-l) or (BE-2) will result in rule (RI) above.

Thus, rules are explored by applying templates to B/E sets in order to determine
the plausible rules that explain many data points. The most general template X*X is
first applied to the base B/E set providing general rules that say, in effect, (1) every
individual bond breaks (if the molecule is thereby cut into two fragments), (2) every
pair of bonds breaks together (if the molecule is thereby cut), and so on. The next
step is to refine this parent template systematically and determine which of the B/E's
in the base B/E set are equivalent under each of the refinements.
A set of refined daughter templates is generated from a single parent template
by adding specifications to the current template in accordance with the following rule:
Add exactly one of the attribute names T, N, or D to any current position or to a
new position adjacent to a current outermost position with N specified, provided that
the attribute name is not already specified at that position.


META-DENDRAL 121

Figure 7-3 Template refinement with rulegen.

For example, X*X yields these 12 daughters: T*X, N*X, D*X, T-N*X, N-N*X,
D-N*X, X*T, X*N, X*D, X*N-T, X*N-D, X*N-N. (See Figure 7-3.)
A template may partition a set of B/E's into more than one equivalence class if
members of the set do not match with respect to the template. For compounds con-
taining several carbons and one oxygen (such as monoketoandrostanes) the subgraph
template T*T could partition a set of B/E's into at most 15 equivalence classes, if we
limit consideration to single and double breaks. For one-break B/E's three nonequiva-
lent environments are possible: C*C, C*O, and O*C (with 0*0 ruled out because
there is just one 0). For double break B/E's there are 12 nonequivalent environments
containing at most one oxygen:'

           c*c     c*c     c*c     c*c
                 I       I     1 4
            c*c     c*c     c*c     c*c
                ----------------------------
            c*c     c*c     c*c     c*c
                I       I     I I
           c*o     c*o     c*o     c*o
                ------...------------------~~~
            c*c     c*c     c*c     c*c
                 I        I     I I
           o*c     o*c     o*c     o*c

SNote that the size and connectivity of the subgraph is fixed by the template, as well as atom
type.


122 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

For more complex templates the possibilities escalate rapidly, even when there are
strong structural constraints, as for ketoandrostanes. A particular B/E set may be sub-
divided into fewer than this maximum number of subsets depending on the actual
structures, and in particular may not be subdivided at all.

As mentioned, each B/E set has an associated set of evidence, namely those peaks
in the spectra that INTSUM could explain by the break (or process) in the B/E. It is
summarized for RULEGEN as (1) the number of molecules associated with the set,
(2) the average number of peaks per molecule, and (3) the maximum number of peaks
per molecule.6 These values will be used to compare B/E sets to direct the search
toward plausible rules.

Beginning with the base B/E set and the most general template, X*X, the program
partitions the base B/E set. Here the only relevant bases for partitioning are number
of breaks and connection patterns of atoms within the template radius. The equiva-
lence classes so produced are the first entries on a list of classes to be examined.
Having selected a class for examination, every possible refinement of the present
template is made to produce the next level of the template tree. At the first step this
refinement will be T*X, D*X, N*X, etc. (as above). Each of these daughter templates
may partition the selected B/E class, producing more specific candidate rules. The pro-
gram considers each rule in turn and discards any duplicates. It also discards any rules
that are not "improvements" over the parent rule according to the following deflni-
tion. A rule is an improvement over its parent if three conditions hold:

1. The daughter rule predicts fewer ions per molecule than its parent (i.e., the
daughter is more specific).

2. The daughter rule predicts fragmentations for at least half of all the molecules
(i.e., it is sufficiently general).

3. The daughter rule predicts fragmentations for as many molecules as its parent,
unless the parent rule was "too general" in the following sense: the parent pre-
dicts more than 2 ions in some single molecule or, on the average, it predicts more
than 1.5 ions per molecule.

The remaining rules (B/E classes and templates) are added to the list of those to
be explored further. When a rule chosen for examination (1) contains only one B/E, or
(2) has only one peak or peak group per molecule in its evidence set, or (3) has an
associated template that cannot be refined further, or (4) on refinement yields no new
rules that are improvements [in the sense of conditions (l), (2), and (3) above], then
it is considered a plausible rule and is saved for output.
Since each member of the B/E class has the same values of the attributes T, N, and
D at each node for which its template specifies these features, the template instan-
tiated with these values becomes the situation-part of the rule. The action-part is the
B/E's definition of the break (plus transfers of hydrogen or neutral molecules) that
accounts for the observed peaks in the positive evidence groups.
RULEGEN produced 12 rules for the monoketoandrostanes. The templates for

61n cases where a process includes transfers of atoms, a group of peaks can be associated with
any single application of the process. In these cases, the program counts the average and maximum
number of peak groups per molecule.


META-DENDRAL 123

Table 7-2 RULEGEN templates for monoketoandrostanes

Positive evidence

                                          Maximum
         Number of     Number of    Average      number of
Template     molecules     peaks       intensity     peaks

x*x        13          13          3.2         1
D-N*X      12           16          2.2         2
N-N*D      12          16          3.8         2
N*D        11          15          1.7         2
X*N        12          15          1.6         2
N*N-D      13          16          4.1         2
D*N        12           15          1.6         2
N*X        11          11          5.0         1
X*N-N      11          11          4.1         1
D-N*X      12          14          2.6         2
X*N-N      11          14          3.6        2
N*N        11          11          5.4         1

these rules are given in Table 7-2, along with the summary of the positive evidence for
each rule. The rules themselves are not given since examples are shown at the end of
the next section.

7.4 RULEMODification

The final phase of Meta-DENDRAL refines RULEGEN's set of rules to increase its
generality and economy. This process is performed by RULEMOD, the testing phase
of the plan-generate-test paradigm. Many of the refinements done here could have in
principle been incorporated into the generating phase, but because of the combina-
torial expansion, they are instead done only after a set of viable candidate rules has
been generated. RULEMOD will typically turn out a set of 8 to 12 rules covering
substantially the same data as an original set of 25 to 100 rules, but with fewer incor-
rect predictions.

Each rule generated by RULEGEN has been developed in isolation. RULEMOD
attempts to improve and simplify the set of productions by eliminating redundant
explanations. It also considers negative evidence, using it to further specialize over-
general rules.' There are five steps to this procedure:

1. Select the most important rules.
2. Of those rules selected, merge similar rules.
3. Specidize rules of the resulting set to eliminate unconfirmed predictions.
4. Generalize these rules to increase their predictive range.
5. Select the most important rules from the modified set.

`Because of the cost of computing negative evidence for each candidate rule, this further pro-
cess is not done in RULEGEN. In principle it could be.


124 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

7.4.1 Selection

Each rule is evaluated by computing a score according to the following equation:

Score=IX (P+lJ- 2N)

where P= positive evidence: the number of times there is any evidence for the rule.
    (If any or all transfers associated with a rule produce peaks that are found in
    the spectrum, P is incremented by 1.)

N= negative evidence: the number of times a rule applies to a molecule whose
spectrum contains no evidence for that fragmentation.
U= unique evidence: the number of times there is any unique evidence for a
rule in the range of transfers. (Unique evidence is found if there are peaks
accounted for by this rule and no others.)

I= (average) intensity of positive evidence: the ratio of intensities of peaks
counted as positive evidence to P.

  The rule with the best score is selected and the evidence supporting it is removed
from further consideration so that it does not improve the score of other rules. The
operational heuristic here is that no data points need two explanations, or, in other
words, a rule should not gain merit by duplicating the explanations of other rules. The
remaining rules are then reevaluated to select another rule. The process repeats until
all scores fall below a threshold or until all remaining evidence is accounted for by one
of the selected rules.

7.4.2 Merging

The selection procedure removes any rules that are totally redundant, but it is still
possible that two (or more) rules explain many of the same peaks. If such rules are
found, the merging procedure attempts to replace them with fewer, more general
rules that account for the same data without introducing any new negative evidence
(predicted peaks that are not found in the data). The modified rules are merged by
searching for a common environment description that includes all the conditions
found in the to-be-merged rules.

7.4.3 Specialization

The selected and merged set of rules is next modified to eliminate predicted evidence
that does not occur in the data. This modification is done by making situation-parts
more specific by adding one feature at a time. Any such refinement is kept if it deletes
some unconfirmed predictions without loss of any positive evidence. This process is
part of the refined search of the rule space that complements RULEGEN's course
search.

7.4.4 Generalizing

One neighborhood-defining feature at a time is now removed from the situation-parts.
If no new unconfirmed predictions are introduced by a deletion, the deletion is made


META-DENDRAL 125

permanent. This procedure may also add new predictions for which there is support
in the data. This procedure is another important part of the relined search of rules in
the local space of a rule found by RULEGEN, introduced to make rules more general.

7.4.5 Final Selection

The final step is a repeat of the initial selection step to remove new redundancies that
have appeared in the process of merging, specializing, and generalizing.
A portion of the final set of rules for the monoketoandrostanes is given in Figure
8-4.

7.5 SUMMARY

Meta-DENDRAL is a learning program in the sense that it induces a set of general
productions (describing the behavior of a class of compounds in the mass spectrom-
eter) from specific instances. The program organization is a form of the plan-generate-
test paradigm. As with Heuristic DENDRAL, there is a generator that must be con-
strained by planning and, for reasons of computational efficiency, is permitted to
generate a set of ,first approximations that are then refined in the testing phase.

The initial set of specific instances delimits the class of hypotheses to be con-
sidered. Commonalities among the specifics are sought and used to generate a set of
candidate-solution components (individual rules). Much computation is saved by
limiting search to finding rough approximations rather than well-honed (and com-
putationally expensive) final products, and by evaluating each component (produc-
tion) rule in isolation. Only after the selection of a set of solution components that is
very, very small in comparison to the potential space of possibilities are interactions
among the components considered and detailed refinements of the solution made.

  If we reexamine the motivations mentioned in the introduction to this chapter,
we find the following observations are in order. First, Meta-DENDRAL certainly has
succeeded in facilitating the application of DENDRAL to new compounds. The
setup time for a new class of compounds is nominal, a few days in comparison to the
weeks or months required by Heuristic DENDRAL. Second, new insights about the
behavior of the molecules investigated (e.g., mono-, di-, and tri-ketoandrostanes) have
indeed emerged; these details will not be reported here because they are technical
and primarily of interest to chemists [see Buchanan et al, (1976) and also Chapter 8
of this book]. Third, our personal intuitions about the means by which scientists
acquire and use specialized knowledge have certainly been deepened and enriched.
But while the general organizational principles of Meta-DENDRAL have been demon-
strated to work, it would be an exaggeration to claim that more than a scratch has
been made on the surface of the complex problem of induction. It is, however, an
interesting scratch that we feel merits deepening. We will have more to say on this
issue in the final chapter.


CHAPTER
EIGHT

RESULTS

The results obtained by using DENDRAL are of primary interest to chemistry; the
the design principles underlying the program are of primary interest to Artificial Intel-
ligence. As an aid for systematic exploration of chemical structures, DENDRAL is
unique. It has been applied to enough chemical problems to demonstrate its power and
utility. In addition, the lessons learned from developing the system can be applied to
the construction of other complex problem-solving systems.

8.1 INTRODUCTION

In this chapter we gather many of the results obtained to date using various versions
and components of the DENDRAL system. Our purpose is to give readers some idea of
the range and power of this system so that they may assess the results and potential of
this research. The importance to chemistry of the particular results tabulated herein
can best be assessed by those readers who are suitably knowledgeable about the appro-
priate aspects of organic chemistry and mass spectrometry. i-Iowever, it should be pos-
sible, from an unhurried examination of this material, to gain an appreciation for the
abilities of the DENDRAL system, present and future.

As has been emphasized, no one program is called DENDRAL. It should already
be clear that DENDRAL is not a special purpose system for solving just those prob-
lems to be described shortly. Heuristic DENDRAL is a framework for helping chemists
with structure elucidation problems in various ways. Some of the knowledge embodied
in the system, such as the stability knowledge codified in the a priori GOODLIST and
the a priori BADLIST, is general. This is also the case for the basic mass spectrometry
theory that is embodied in the PLANNER and PREDICTOR programs. The class-

126


RESULTS 127

specific and problem-specific chemical knowledge used by Heuristic DENDRAL is
supplied by the chemist-user; the programs, however, are intelligent enough to under-
stand such specifications and make use of them.

In addition to being an MS problem-solving engine of various configurations, the
programs can be used in a more general vein as aids to chemists with structure elucida-
tion problems. CONGEN, for example, is a symbolic graph manipulator for the chem-
ist analogous to algebraic and analytic symbolic manipulators for the mathematician,
such as REDUCE [Heam (1971)] and MACSYMA [Martin and Fateman (1971)] . This
chapter illustrates some of the applications in which the DENDRAL programs have
aided chemists.

Finally, design lessons that have been learned from this work are discussed. These
results are contributions to the art of heuristic programming and as such should be
of greatest interest to the computer scientist.

8.2 THE SCOPE OF STRUCTURAL ISOMERISM

The concept of structural isomerism is basic in organic chemistry. The complexity of
the combinatorics involved is such, however, that the variety and identity of isomers as
a function of molecule size and other factors is still not fully understood. Rouvray
(1974) summarizes various mathematical approaches to the question of numbers of
isomers. Many lessons remain to be learned about the nature of the space of structural
isomers and the effects on chemical variety of factors such as valence, ring structure,
and heterogeneity of atomic types, among others.

The unconstrained DENDRAL generator provides means not only for determining
empirically the number of isomers for a given empirical formula, but for identifying
the structure of each. CONGEN provides in addition a means to determine the number
of isomers with specific characteristics. For large problems these experiments are im-
practical. However, the cyclic and acyclic generators have been used to obtain some
indication of the size of the spaces involved. The numbers turn out to be enormous,
in fact often larger by an order of magnitude than was estimated by professional
chemists.

The important trends are well illustrated in Figures 8-1 and 8-2, which are derived
from CONGEN unconstrained runs. Figure 8-1 illustrates that the number of isomers
increases approximately exponentially with number of carbon atoms, the rate of in-
crease being larger with more rings and double bonds. Figure 8-2 plots the number of
isomers as a function of unsaturations (i.e., number of rings plus double bonds) for
compounds with a fixed total number of nonhydrogen atoms divided in various ways
among carbon, nitrogen, and oxygen. The role of carbon in increasing the variety of
compounds is well illustrated here. The smooth relation between number of isomers
and degree of unsaturation is also interesting. Perhaps most striking is the extrapola-
tion of the curves of Figure 8-1 to compounds containing larger numbers of carbon
atoms, such as commonly concern chemists. The size of the space of possible struc-
tures quickly exceeds the practical limits for exhaustive search. This limitation is true
for acyclic isomers alone also, as shown in Lederberg et al. (1969b).


Number of carbon atoms, x

Cl     1     2     3     4     5     6     I

U E unsaturation

Figure 8-l Semilog plot of number
of isomers versus number of carbon
atoms. (Source: Journal of Chemi-
cal Information and Computer Sci-
ences, Copyright 1975, American
Chemical Society. Reproduced by
permission. After Smith [ 1975b] .)

Figure 8-2 Number of isomers ver-
sus degree of unsaturation. (Source:
Journal of Chemical Information
and Computer Sciences, Copyright
1975, American Chemical Society.
Reproduced by permission. After
Smith [1975b] .)


RESULTS 129

In addition to indicating the size of the problem space for structure elucidation,
results have been generated to indicate the pruning power of additional chemical
knowledge given to the DENDRAL programs. Table 8-l lists the numbers of isomers
for each of the 15 functional groups relevant to the empirical formula (CsH1602).
The total number of isomers of this composition is in the thousands, so knowing
which functional groups are present and/or absent will constrain the search immensely.
BADLIST pruning constrains these numbers still more; the usual a priori BADLIST for

Table 8-l Number of aliphatic isomers of CsH1602 selected by functional group

No.    Functional group name

No. of isomers of
Gd1602

Contained subgraph

9






10





11





12





13


14

15

Acid

Ester
Keto ether and aldehyde ether
Hydroxy ketone and
hydroxyaldehyde
Diether (excluding enol ether)
Hydroxy ether


Enol and ether
Hydroxy enol ether

39            -COOH

105            -coo-

329            SCOCC and -CO-

458

183

183

305

497

+-COH and SCCO-
(XOC~)*
3COC-C and +COH
        I
+COCc and >C=COH
+-COH and >C=COCc

Unconjugated acetal             102

   OC<
  /
+-cc
"OC<

Conjugated a&al

Acyloin enol ether

48            sa3c=COCf
           I I

gem-Diol

                 OH
            /
262            +-cc
      ' `OH

Diol (excluding gem-diol and enol)

  I
-Y)*

Unconjugated peroxide           197            scOocf
Unconjugated hydroperoxide        306            XZOOH

  Source: Lederberg et al. (1969b). Reprinted with permission from the Journal of the Ameri-
can Chemical Society, copyright by the American Chemical Society.


130 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

acyclic structures is as follows (with "=" denoting triple bonds):'

(X2-O-H     H-O-C-O-H
@C-N-H     H-O-C-N-H
C=C-O-H     H-C-N=0
(X2-N-H     H-0-C=N

N=N-N       H-N-C-N-H
N=N-0      I
N=N-H       H

o-o        O=C-O-H
o-o-o      I
O-N-O       0
N-N-N      I
N-N-O
N-O-N      O=C-O-H
N-O-O      I
         0
         I

8.3 ACYCLIC HEURISTIC DENDRAL

Of the enormous number of classes of chemical compounds that might be grist for the
DENDRAL mill, only a handful have passed through it. It may be of interest to know
on what basis the selections were made.

The first class of compounds attacked was the amino acids. This class was basi-
cally a target of opportunity, for spectra had been collected from them for another
purpose: the feasibility of a robot detector of life was being studied in connection
with a preliminary design for a Mars probe. (The final design, as realized in the 1976
Viking mission, took a different approach to the life detection problem.) It might ap-
pear that the amino acids would prove to be a difficult class of compounds for the in-
fant DENDRAL system because of their variety and the number of heteroatoms con-
tained. Such proved not to be the case, because the absence of long, unbranched hy-
drocarbon chains in amino acids made them particularly appropriate for the primitive
(zero-order) theory of mass spectrometry with which DENDRAL began. (The zero-
order theory of mass spectrometry states that each bond will break, one at a time, so
that all possible fragments will appear in the spectrum.) That this theory closely ap-
proximated the behavior of the amino acids was a happy state of affairs resulting in an
early success, encouraging further work.

lit should be noted that while the a priori BADLIST for acyclic structures contains about 20
(forbidden) subgraphs, the chemistry of cyclic structures does not seem to permit strong a priori
statements about unstable structures.


RESULTS 13 1

Professor Carl Djerassi, an organic chemist on the Stanford University faculty, was
intrigued by the program's success with the amino acids but skeptical of its methods
because its zero-order theory of mass spectrometry was so shallow. He proposed ali-
phatic ketones as an appropriate next test case, on the grounds that this class was in
fact simple in structure and no appreciable challenge to a human mass spectrometrist,
but would require significant extensions to DENDRAL's simplistic theory. This proved
to be the case. Some of Djerassi's knowledge of ketones was captured in a revised ver-
sion of DENDRAL, and ketones became the first in a series of classes of increasing
complexity examined by the early versions of DENDRAL. Carl Djerassi became a
highly valued colleague on the DENDRAL Project.

The sequence of classes examined in this early work proceeded in what is a fairly
logical series of increasing complexity through various saturated, acyclic monofunc-
tionals. After the ketones, the ethers and alcohols were chosen as the next most com-
plex oxygen-bearing compounds. The oxygen of valence 2 constrains the possible
structures more than a valence-3 atom, so the next most complex class to be selected
was the aliphatic amines, which are acyclic nitrogen-containing compounds. Sulfur-
containing compounds (thiols and thioethers) were examined to demonstrate the gen-
erality of the planning program.

Tables 8-2,8-3, and 8-4 present results with amino acids, ketones, and amines, re-
spectively. Results for ethers and alcohols, thioethers and thiols, are similar and are
tabulated in Buchanan and Lederberg (1972). The reduction in the number of struc-
tures with planning is striking, particularly for the more complex compounds. Note

Table 8-2 Amino acid results without planning

Name of
"`unknown"
amino acid

Chemical
formula

Number of      Number of
possible       plausible
structurest      structures$

Number of
structures
generated p

Rank order
of correct
candidate7

Glycine     CzHsNOz      38           12        8      lst, 7 sxcluded
Alanine     WbN02     216          50        3        1st
Serine     W+-/N'A     324          40       IO      lst, 9 excluded
Threonine   W-W03     1758         238        2        1st
Leucine    C6H13N02   10000 (approx.)   3275      288      Tied for Zd,
                                                271 excluded

tThe total number of possible structures is the number of topologically possible (and distinc-
tive) molecular structures generated by the algorithm within valence considerations alone.
$The number of plausible structures is the number of molecular structures in the total space
that also meet the a priori conditions of chemical stability on BADLIST. The a priori rules have
greater effect with increased numbers of noncarbon, nonhydrogen atoms.
DThe number of structures generated is the number of molecular structures actually generated
by the program as candidate explanations of the experimental data. Pruning has been achieved by
using the zero-order theory during structure generation.
(The rank order of the correct structure is the evaluation program's assignment of rank to the
actual molecular structure used as a test "`unknown." The number of structures excluded in the
validation process is also indicated.

  Source: Buchanan and Lederberg (1972). Reprinted by permission from Znformetion Process-
ing `71, copyright by Elsevier-North Holland Publishing Co.


132 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Table 8-3 Ketone results with planning and testing

Name of
"unknown"
ketone

Chemical
formula

Number of   Number of
plausible     structures
structure@   generatedS

Rank order
of correct
candidates

2-Butanone
3-Pentanone
3-Hexanone
2-Methyl-hexan-3-one
3-Heptanone
3-Octanone
4-Octanone
2,4-Dimethyl-hexan-3-one
6-Methyl-heptan-3-one
3-Nonanone
2-Methyl-octan-3-one
4-Nonanone

C4H80      11
CsH100      33
CsH120      91
C7H140     254
C7H140     254
w3160     698
CBHl60     698
Gd160     698
C8H160     698
C9H1130    1936
C9Hxio    1936
C9H1ao    1936

1
1

4
4

1st
1st
1st
1st
Tied for 1st
1st
lst, 1 excluded
Tied for lst, 1 excluded
1st
1st
1st
1st

tThe number of plausible structures is the number of molecular structures in the total space
that also meet the a priori conditions of chemical stability on BADLIST. The a priori rules have no
effect with formulas containing a single noncarbon, nonhydrogen atom. Thus, this column also rep-
resents the total number of possible structures.

*The number of structures generated is the number of molecular structures actually generated
by the program as candidate explanations of the experimental data. Pruning has been achieved by
using the planning information from the planning program.

_The rank order of the correct structure is the evaluation program's assignment of rank to the

actual molecular structure used as a test "unknown." The number of structures excluded in the
process is also indicated.

  Source: Buchanan and Lederberg (1972). Reprinted by permission from Information Pro-
cessing `71, copyright by Elsevier-North Holland Publishing Co.

the further marked reduction when NMR data were manually used to determine the
number of methyl radicals present in the compound. These results are indicative of the
beneficial effects derived from the combination of multiple sources of information. It
is particularly noteworthy that in some cases a single candidate is isolated from an ini-
tially very large set of possibilities. In these cases, the reduction is a consequence of
knowing exactly the number of methyl groups in the compound, an observation that
can be made from NMR but rarely from MS data alone. The planning and testing pro-
grams used to generate some of these results are the Preliminary Inference Maker and
the PREDICTOR described above (Chapters 5 and 6). Additional PREDICTOR results
are described below in Section 8.7.

After the generalization of the special heuristics for these classes was completed
[and reported in Feigenbaum, Buchanan, and Lederberg (1971)], the project reached
a turning point. The problems it had solved were all from small, acyclic molecules with
a single functional group, and the data were all low-resolution mass spectra. It ap-
peared that DENDRAL was capable of harder problems if provided with the additional
information of high-resolution spectra.

At this stage the general cyclic generator had not been developed, so the means


RESULTS 133

Table 8-4 Amine results with planning but without testing

Name of
"unknown"
amine

           Number of                              Number of
           structures                               structures
   Number of  generated$    Name of              Number of   generated$
Size  plausible ~    "unknown"         Size plausible
C!"   structurert  MS NMR amine            C"   structurest MS   NMR

n-propy1
iso-propyl
n-butyl
iso-butyl
Sec.butyl
Tert-butyl
Di-ethvl
Nmethyl-n-propyl
Ethyl-n-propyl
N-methyl-di-ethyl
*-pi3ltYl
iwpentyl
2-penty1
3-pentyl
3-methyl-2.butyl
N-methyl-n-butyl
Nmethyl-seebutyl
Nmethyl-iso-butyl
n-hexyl
Tri-ethyl
2-hexyl
Di-n-propyl
Di-iso-propyl
N-methyl-n-pentyl
N-methyl&o-pentyl
Ethyl-n-butyl
N,N-dimethyl-n-butyl
nheptyl
Ethyl-n-pentyl
n-butyl-iso-propyl
4-methyl-2.hexyl

c3 4
    4
c4 8
    8
    8
    8
    8
    8
cs 17
   17
   17
   17
   17
   17

17
17
17

   17
C6 39
   39
   39
   39
   39
   39
   39
   39
   39
c7 89
   89
   89
   89

1 1      N-methyl-di-iso-propyl    Cl       89
2 1      n-octy1           C8      211
2 1      Ethyl-n-hexyl               211
2 1      I-methylheptyl              211
4 2      2-ethylhexyl               211
3 1      I, I-dimethylhexyl             211
3 1      Di-n-butyl                 211
4 1      Di-sec-butyl                211
5 1      Diiso-butvl                211
4 1      DCethyl-n-butyl              211
4 1      3.octyl                  211
4 2      It-"O"Yl           c9      507
2 1     N-methyl-di-n-butyl            507
5 1     Tri-npropyl                so7
4 1      Di-n-pentyl         Cl0     1238
4 1     Di-iso-pentyl               1238
3 1      N,N-dimethyl-2-ethylhexyl        1238
4 1      n-undecyl          Cl1     3057
8 1      n-dodecyl          Cl2     7639
2 1      n-tetradecyl         Cl4    48865
8 1      Di-n-heptyl               48865
8 1      N,N-dimethyl-n-dodecyl        48865
8 1     Tri-n-pentyl         Cl5    124906
8 1      Bis-2-ethylhexyl       Cl6   321988
8 2      N,N-dimethyl-n-tetradecyl       321988
6 1     Di-ethyl-n-dodecyl           321988
10 1      n-heptadecyl         Cl7   830219
17 1      N-methyl-bis-2-ethylhexyl       830219
16 1      n-octadecyl         Cl8   2156010
11 1      N-methyl-n-actyl-n-nonyl       2156010
16 4      N,N-dimethyl-n-octadecyl C20  14715813

15 3
39 1
24 1
34 1
39 9
32 4
24 1
33 8
17 5

   17 3
   26 2
   89 1
   13 1
   2 1
   83 1
  109 16
  156 9
  507 I
1238 1
10115 1
  646 1
4952 1
   40 1
2340 24
3895 1
2476 1
124906 1
2340 24
48865 1
15978 1
1284792 1

tThe number of plausible structures is the number of molecular structures in the total space that also meet the a priori conditions
of chemical stability on BADLIST. The a priori rules have no effect with formulas containing a single noncarbon, nonhydrogen atom.
Thus, this column also represents the total number ofpossible structures.
$The number of structures generated is the number of molecular structures actually generated by the program as candidate ex-
planations of the experimental data. Pruning has been achieved by using the planning information from the planning program.
MS = Number of structures when only mass spectrometry is used in planning.
NMR = Number of structures when NMR data are used in planning to infer the number of methyl radicals.
Source: Buchanan and Lederberg (1972). Reprinted by permission from Information Processing `71, copyright by Elsevier-
North Holland Publishing Co.

for a general attack on more complex cyclic molecules was not at hand.2 As a result, a
class of cyclic molecules of interest to Djerassi, the estrogenic steroids, was studied us-
ing special purpose heuristics and working from high-resolutioq spectra available from
Djerassi's laboratory. An extension of the Planning Rule Generator (Section 5.2) led to
the first successes on cyclic compounds. With the development of the cyclic generator,
this class of compounds, plus other steroids already under study for other reasons,
were the natural first choices to which the new procedures could be applied and
generalized.

`A specialized generator of single-ringed structures had been written (circa 1970) as an exten-
sion of the acyclic generator. Although it was used for some studies [Sheikh et al. (1970)], the
general utility of DENDRAL still awaited a generator of arbitrarily complex structures (now called
CONGEN).


134 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

8.4 CONGEN RESULTS

Of all the DENDRAL programs, CONGEN is clearly the most generally useful and has
been applied to current research problems by chemists around the world. To a large
extent, CONGEN has moved from a research program to a service program. This is not
to say that all the research problems have been dropped or solved, but that the current
level of development already provides a valuable service and a production version of
CONGEN is reliable enough to provide that service.

The range of problems to which CONGEN is applicable is great. To date perhaps
a few dozen applications have in fact been made. Each of these is a relatively special-
ized problem whose importance is only cl************************** 1.549420+1 788.258625 1.469376+16637 3  1 1764
 788.683000 1.462374+1 792.757000 1.395400+1 796.831000 1.328672+16637 3  1 1765
 798.868000 1.295412+1 799.631875 1.282991+1 802.278000 1.241420+16637 3  1 1766
 804.324000 1.209496+1 805.688000 1.188369+1 807.052000 1.167445+16637 3  1 1767
 808.075000 1.151952+1 808.179250 1.150400+1 809.098000 1.131290+16637 3  1 1768
 809.780000 1.117336+1 810.480000 1.103304+1 811.005000 1.093060+16637 3  1 1769
 811.040000 1.092400+1 811.530000 1.076885+1 812.055000 1.060758+16637 3  1 1770
 812.405000 1.050400+1 812.755000 1.040486+1 813.105000 1.031190+16637 3  1 1771
 813.140000 1.030335+1 813.367500 1.019060+1 813.630000 1.006714+16637 3  1 1772
 813.892500 9.952828+0 814.111250 9.867312+0 814.190000 9.840765+06637 3  1 1773
 814.308125 9.760451+0 814.505000 9.640795+0 814.636250 9.572120+06637 3  1 1774
 814.767500 9.516072+0 814.898750 9.419846+0 814.997188 9.365295+06637 3  1 1775
 815.073750 9.337962+0 815.161250 9.329631+0 815.222500 9.344407+06637 3  1 1776
 815.226875 9.344205+0 815.292500 9.367015+0 815.358125 9.424194+06637 3  1 1777
 815.423750 9.527031+0 815.489375 9.690252+0 815.533125 9.841752+06637 3  1 1778
 815.576875 1.003517+1 815.620625 1.027834+1 815.625000 1.030853+16637 3  1 1779
 815.664375 1.061319+1 815.708125 1.102059+1 815.760625 1.161649+16637 3  1 1780
 815.800000 1.215943+1 815.806563 1.226109+1 815.852500 1.309404+16637 3  1 1781
 815.898438 1.406575+1 815.931250 1.487197+1 815.944375 1.522223+16637 3  1 1782
 816.005625 1.713348+1 816.018750 1.761955+1 816.066875 1.951738+16637 3  1 1783
 816.106250 2.132669+1 816.128125 2.239330+1 816.180625 2.532648+16637 3  1 1784
 816.189375 2.584586+1 816.258500 3.050558+1 816.272500 3.157929+16637 3  1 1785
 816.335500 3.669045+1 816.364375 3.930888+1 816.412500 4.390574+16637 3  1 1786
 816.456250 4.854055+1 816.528000 5.649219+1 816.548125 5.888430+16637 3  1 1787
 816.640000 7.021530+1 816.808000 9.167576+1 816.822000 9.346562+16637 3  1 1788
 816.955000 1.082879+2 817.025000 1.144406+2 817.056500 1.169799+26637 3  1 1789
 817.144000 1.218908+2 817.151000 1.221403+2 817.200000 1.234120+26637 3  1 1790
 817.277000 1.238363+2 817.284000 1.237941+2 817.382000 1.207116+26637 3  1 1791
 817.403000 1.195511+2 817.480000 1.144788+2 817.508000 1.120519+26637 3  1 1792
 817.620000 1.013187+2 817.634000 9.982262+1 817.760000 8.544467+16637 3  1 1793
 817.889500 7.018395+1 817.999750 5.829121+1 818.073250 5.111486+16637 3  1 1794
 818.127500 4.627915+1 818.136250 4.553946+1 818.215000 3.959029+16637 3  1 1795
 818.267500 3.604947+1 818.293750 3.443966+1 818.320000 3.294707+16637 3  1 1796
 818.372500 3.026079+1 818.425000 2.784768+1 818.477500 2.587275+16637 3  1 1797
 818.530000 2.411531+1 818.556250 2.333690+1 818.589063 2.246303+16637 3  1 1798
 818.648125 2.109328+1 818.687500 2.029287+1 818.707188 1.994361+16637 3  1 1799
 818.766250 1.903468+1 818.825313 1.823820+1 818.862500 1.779343+16637 3  1 1800
 818.884375 1.757681+1 818.943438 1.706332+1 819.002500 1.660595+16637 3  1 1801
 819.061563 1.619235+1 819.063750 1.617830+1 819.120625 1.590015+16637 3  1 1802
 819.190625 1.559140+1 819.282500 1.522651+1 819.374375 1.489365+16637 3  1 1803
 819.405000 1.479002+1 819.466250 1.464289+1 819.588750 1.437190+16637 3  1 1804
 819.711250 1.411909+1 819.860000 1.383040+1 819.895000 1.378244+16637 3  1 1805
 820.078750 1.354901+1 820.315000 1.326696+1 820.560000 1.298969+16637 3  1 1806
 820.577500 1.297652+1 820.840000 1.279080+1 821.102500 1.261345+16637 3  1 1807
 821.365000 1.244223+1 821.688750 1.223726+1 821.785000 1.217806+16637 3  1 1808
 822.135000 1.203680+1 822.581250 1.186313+1 823.027500 1.169392+16637 3  1 1809
 823.360000 1.157056+1 823.622500 1.150552+1 824.184358 1.136993+16637 3  1 1810
 824.977430 1.118259+1 825.770503 1.099853+1 826.563576 1.081681+16637 3  1 1811
 827.560000 1.059098+1 827.621006 1.057841+1 828.390861 1.042129+16637 3  1 1812
 829.449500 1.020708+1 830.675750 9.961343+0 831.902000 9.718359+06637 3  1 1813
 833.128250 9.478799+0 833.945750 9.321532+0 834.191000 9.275118+06637 3  1 1814
 834.763250 9.123051+0 835.608000 8.902214+0 836.262000 8.734644+06637 3  1 1815
 836.589000 8.652856+0 836.916000 8.537884+0 837.570000 8.313307+06637 3  1 1816
 838.224000 8.096234+0 838.333000 8.061738+0 838.796250 7.854981+06637 3  1 1817
 839.205000 7.679555+0 839.423000 7.590213+0 839.613750 7.479808+06637 3  1 1818
 840.022500 7.253855+0 840.431250 7.042554+0 840.458500 7.029572+06637 3  1 1819
 840.703750 6.857009+0 841.017125 6.651303+0 841.194250 6.546008+06637 3  1 1820
 841.282813 6.472132+0 841.548500 6.271019+0 841.684750 6.182360+06637 3  1 1821
 841.814188 6.061636+0 841.991313 5.917758+0 842.168438 5.796769+06637 3  1 1822
 842.202500 5.780027+0 842.379625 5.642990+0 842.475000 5.595408+06637 3  1 1823
 842.563563 5.531325+0 842.686188 5.479739+0 842.808813 5.469906+06637 3  1 1824
 842.931438 5.518768+0 843.023406 5.609934+0 843.101750 5.743835+06637 3  1 1825
 843.115375 5.774908+0 843.207344 6.076856+0 843.224375 6.153103+06637 3  1 1826
 843.275469 6.422108+0 843.306125 6.627538+0 843.350406 6.964430+06637 3  1 1827
 843.367438 7.127824+0 843.425344 7.747735+0 843.428750 7.791845+06637 3  1 1828
 843.481547 8.555216+0 843.490063 8.698921+0 843.530938 9.454934+06637 3  1 1829
 843.537750 9.591847+0 843.571813 1.037695+1 843.593953 1.092953+16637 3  1 1830
 843.612688 1.146410+1 843.650156 1.261780+1 843.653563 1.273734+16637 3  1 1831
 843.690350 1.412023+1 843.706359 1.477399+1 843.739400 1.629208+16637 3  1 1832
 843.762563 1.745713+1 843.788450 1.891487+1 843.818766 2.077744+16637 3  1 1833
 843.837500 2.206027+1 843.875650 2.490048+1 843.886550 2.580089+16637 3  1 1834
 843.932875 2.994627+1 843.935600 3.021537+1 843.984650 3.544324+16637 3  1 1835
 843.990100 3.607207+1 844.033700 4.155328+1 844.047325 4.340311+16637 3  1 1836
 844.085475 4.901443+1 844.104550 5.204825+1 844.142700 5.859091+16637 3  1 1837
 844.164500 6.261583+1 844.195838 6.884073+1 844.229900 7.606517+16637 3  1 1838
 844.248975 8.045458+1 844.317100 9.722159+1 844.322550 9.867598+16637 3  1 1839
 844.404300 1.220562+2 844.480600 1.469073+2 844.526925 1.630137+26637 3  1 1840
 844.611400 1.934873+2 844.764000 2.506912+2 844.873000 2.891975+26637 3  1 1841
 844.905700 2.998342+2 844.998350 3.262711+2 845.014700 3.302577+26637 3  1 1842
 845.101900 3.477598+2 845.200000 3.578490+2 845.210900 3.584348+26637 3  1 1843
 845.287200 3.584654+2 845.300825 3.578640+2 845.374400 3.509170+26637 3  1 1844
 845.396200 3.479002+2 845.483400 3.312859+2 845.510650 3.250540+26637 3  1 1845
 845.597850 3.006877+2 845.657800 2.824413+2 845.930300 1.900331+26637 3  1 1846
 846.028400 1.587142+2 846.044750 1.538434+2 846.121050 1.326082+26637 3  1 1847
 846.159200 1.226058+2 846.187813 1.157101+2 846.245038 1.027262+26637 3  1 1848
 846.246400 1.024345+2 846.302263 9.146659+1 846.333600 8.569127+16637 3  1 1849
 846.359488 8.136583+1 846.416713 7.244455+1 846.420800 7.184904+16637 3  1 1850
 846.473938 6.494019+1 846.508000 6.082228+1 846.531163 5.833894+16637 3  1 1851
 846.588388 5.266364+1 846.595200 5.203250+1 846.637438 4.860495+16637 3  1 1852
 846.682400 4.521838+1 846.698750 4.415839+1 846.760063 4.051971+16637 3  1 1853
 846.794125 3.865267+1 846.821375 3.736303+1 846.862250 3.557999+16637 3  1 1854
 846.882688 3.481689+1 846.944000 3.271141+1 846.998500 3.097095+16637 3  1 1855
 847.005313 3.079394+1 847.066625 2.931854+1 847.134750 2.779727+16637 3  1 1856
 847.148375 2.755528+1 847.230125 2.622528+1 847.332313 2.468559+16637 3  1 1857
 847.339125 2.458832+1 847.393625 2.398527+1 847.516250 2.270594+16637 3  1 1858
 847.543500 2.243812+1 847.638875 2.169991+1 847.761500 2.080210+16637 3  1 1859
 847.816000 2.042280+1 847.945438 1.971891+1 848.129375 1.877432+16637 3  1 1860
 848.143000 1.870745+1 848.347375 1.791078+1 848.470000 1.745322+16637 3  1 1861
 848.538125 1.725921+1 848.728875 1.673798+1 849.015000 1.598671+16637 3  1 1862
 849.124000 1.571075+1 849.301125 1.539220+1 849.587250 1.489706+16637 3  1 1863
 849.914250 1.434870+1 849.941500 1.430428+1 850.323000 1.384801+16637 3  1 1864
 850.731750 1.337454+1 850.759000 1.334372+1 851.140500 1.302493+16637 3  1 1865
 851.685500 1.258209+1 852.067000 1.227919+1 852.189625 1.221007+16637 3  1 1866
 852.884500 1.182889+1 853.579375 1.145647+1 854.274250 1.109048+16637 3  1 1867
 854.356000 1.104793+1 854.737500 1.088927+1 855.664000 1.050961+16637 3  1 1868
 856.192000 1.029625+1 857.182000 9.901716+0 857.924500 9.610544+06637 3  1 1869
 858.667000 9.323950+0 859.409500 9.042788+0 859.756000 8.914815+06637 3  1 1870
 860.152000 8.726195+0 860.812000 8.419687+0 861.307000 8.196257+06637 3  1 1871
 861.472000 8.124216+0 861.802000 7.927794+0 862.297000 7.642841+06637 3  1 1872
 862.792000 7.371063+0 863.254000 7.034692+0 863.600500 6.796807+06637 3  1 1873
 863.782000 6.680992+0 863.947000 6.534763+0 864.293500 6.250505+06637 3  1 1874
 864.475000 6.115004+0 864.524500 6.065069+0 864.805000 5.806861+06637 3  1 1875
 865.019500 5.635522+0 865.052500 5.601103+0 865.300000 5.381880+06637 3  1 1876
 865.382500 5.323349+0 865.465000 5.246388+0 865.630000 5.123399+06637 3  1 1877
 865.778500 5.049278+0 865.795000 5.039371+0 865.960000 4.995443+06637 3  1 1878
 866.108500 5.021888+0 866.257000 5.139325+0 866.261125 5.145619+06637 3  1 1879
 866.356000 5.326768+0 866.368375 5.360752+0 866.455000 5.642972+06637 3  1 1880
 866.471500 5.715935+0 866.545750 6.098309+0 866.554000 6.148558+06637 3  1 1881
 866.620000 6.642519+0 866.628250 6.713232+0 866.669500 7.132718+06637 3  1 1882
 866.702500 7.506090+0 866.719000 7.727835+0 866.768500 8.464387+06637 3  1 1883
 866.779225 8.643274+0 866.818000 9.403755+0 866.855125 1.020302+16637 3  1 1884
 866.860900 1.033862+1 866.892250 1.117557+1 866.915350 1.184476+16637 3  1 1885
 866.929375 1.229560+1 866.966500 1.358669+1 866.969800 1.371146+16637 3  1 1886
 867.003625 1.511840+1 867.024250 1.605684+1 867.049000 1.729376+16637 3  1 1887
 867.078700 1.890437+1 867.082000 1.910066+1 867.131500 2.230100+16637 3  1 1888
 867.133150 2.241777+1 867.167800 2.508131+1 867.187600 2.672511+16637 3  1 1889
 867.207400 2.850548+1 867.240400 3.170432+1 867.245350 3.222228+16637 3  1 1890
 867.293200 3.768022+1 867.299800 3.849761+1 867.352600 4.568945+16637 3  1 1891
 867.359200 4.667155+1 867.397150 5.278089+1 867.425200 5.766654+16637 3  1 1892
 867.445000 6.138187+1 867.491200 7.077462+1 867.497800 7.221474+16637 3  1 1893
 867.557200 8.629879+1 867.560500 8.715788+1 867.626500 1.053947+26637 3  1 1894
 867.629800 1.063972+2 867.702400 1.297058+2 867.709000 1.320281+26637 3  1 1895
 867.788200 1.614484+2 867.808000 1.694570+2 867.887200 2.031081+26637 3  1 1896
 867.940000 2.272606+2 868.019200 2.641551+2 868.190800 3.464047+26637 3  1 1897
 868.256800 3.762026+2 868.309600 3.977126+2 868.395400 4.290491+26637 3  1 1898
 868.428400 4.387217+2 868.520800 4.606129+2 868.547200 4.645120+26637 3  1 1899
 868.600000 4.698985+2 868.642900 4.724961+2 868.687450 4.722616+26637 3  1 1900
 868.699000 4.714946+2 868.784800 4.616478+2 868.798000 4.595214+26637 3  1 1901
 868.903600 4.339713+2 868.910200 4.320801+2 869.048800 3.824248+26637 3  1 1902
 869.062000 3.769903+2 869.335900 2.587881+2 869.444800 2.138813+26637 3  1 1903
 869.464600 2.061248+2 869.537200 1.800677+2 869.573500 1.678083+26637 3  1 1904
 869.629600 1.506204+2 869.682400 1.354315+2 869.698900 1.312208+26637 3  1 1905
 869.768200 1.145991+2 869.791300 1.093800+2 869.834200 1.009913+26637 3  1 1906
 869.893600 9.007252+1 869.900200 8.892490+1 869.953000 8.092923+16637 3  1 1907
 869.972800 7.810465+1 870.012400 7.309558+1 870.052000 6.838903+16637 3  1 1908
 870.071800 6.632044+1 870.131200 6.050425+1 870.190600 5.587722+16637 3  1 1909
 870.250000 5.152733+1 870.309400 4.818921+1 870.368800 4.504078+16637 3  1 1910
 870.448000 4.172059+1 870.522250 3.930783+1 870.596500 3.703686+16637 3  1 1911
 870.606400 3.675054+1 870.695500 3.472509+1 870.764800 3.324568+16637 3  1 1912
 870.794500 3.274832+1 870.893500 3.118822+1 870.992500 2.969913+16637 3  1 1913
 871.002400 2.955654+1 871.141000 2.801353+1 871.240000 2.696842+16637 3  1 1914
 871.314250 2.635288+1 871.462750 2.518132+1 871.570000 2.436984+16637 3  1 1915
 871.685500 2.371667+1 871.908250 2.251853+1 872.065000 2.170614+16637 3  1 1916
 872.131000 2.145178+1 872.353750 2.062542+1 872.560000 1.988545+16637 3  1 1917
 872.642500 1.965976+1 872.964250 1.881376+1 873.154000 1.833014+16637 3  1 1918
 873.286000 1.806961+1 873.607750 1.745357+1 873.748000 1.719127+16637 3  1 1919
 873.929500 1.694271+1 874.309000 1.643695+1 874.804000 1.579414+16637 3  1 1920
 874.936000 1.562644+1 875.299000 1.530791+1 875.794000 1.488368+16637 3  1 1921
 876.124000 1.460520+1 876.256000 1.449540+1 876.784000 1.417366+16637 3  1 1922
 877.345000 1.383829+1 877.576000 1.370242+1 878.186500 1.344477+16637 3  1 1923
 879.028000 1.309674+1 879.869500 1.275412+1 880.190500 1.262510+16637 3  1 1924
 880.711000 1.246323+1 881.574121 1.219892+1 882.480482 1.192590+16637 3  1 1925
 883.096687 1.174345+1 883.712891 1.156451+1 884.175044 1.143348+16637 3  1 1926
 884.637198 1.130634+1 884.945300 1.122463+1 885.071200 1.119267+16637 3  1 1927
 885.260050 1.111578+1 885.574800 1.099273+1 885.810863 1.090517+16637 3  1 1928
 886.046925 1.082341+1 886.271184 1.075349+1 886.330200 1.073793+16637 3  1 1929
 886.471838 1.065256+1 886.605606 1.057966+1 886.739375 1.051635+16637 3  1 1930
 886.839702 1.047839+1 886.940028 1.045285+1 887.006913 1.044572+16637 3  1 1931
 887.073797 1.044959+1 887.085600 1.045286+1 887.140681 1.044673+16637 3  1 1932
 887.207566 1.045886+1 887.274450 1.049699+1 887.333466 1.055884+16637 3  1 1933
 887.392481 1.065462+1 887.451497 1.079313+1 887.510513 1.098491+16637 3  1 1934
 887.569528 1.124243+1 887.628544 1.158007+1 887.687559 1.201413+16637 3  1 1935
 887.730838 1.241634+1 887.746575 1.257440+1 887.805591 1.330084+16637 3  1 1936
 887.864606 1.418102+1 887.888213 1.460509+1 887.927556 1.536010+16637 3  1 1937
 887.998375 1.698370+1 888.036145 1.801309+1 888.069194 1.897430+16637 3  1 1938
 888.140013 2.135949+1 888.174635 2.266098+1 888.187225 2.316422+16637 3  1 1939
 888.281650 2.737063+1 888.313125 2.894922+1 888.380796 3.252979+16637 3  1 1940
 888.451615 3.660307+1 888.583810 4.455667+1 888.722300 5.320987+16637 3  1 1941
 888.848200 5.991708+1 888.956789 6.434500+1 889.037050 6.644857+16637 3  1 1942
 889.062230 6.701513+1 889.100000 6.746232+1 889.200720 6.760030+16637 3  1 1943
 889.210163 6.747280+1 889.307735 6.567520+1 889.376980 6.350289+16637 3  1 1944
 889.414750 6.218704+1 889.433635 6.132893+1 889.565830 5.490637+16637 3  1 1945
 889.603600 5.291054+1 889.819204 4.069557+1 889.823925 4.045281+16637 3  1 1946
 889.918350 3.548467+1 890.012775 3.104573+1 890.083594 2.809564+16637 3  1 1947
 890.154413 2.547641+1 890.201625 2.394343+1 890.225231 2.322257+16637 3  1 1948
 890.296050 2.135751+1 890.349164 2.013636+1 890.402278 1.905193+16637 3  1 1949
 890.437688 1.841039+1 890.455392 1.812292+1 890.508506 1.736804+16637 3  1 1950
 890.561620 1.670668+1 890.614734 1.612564+1 890.667848 1.561277+16637 3  1 1951
 890.673750 1.556215+1 890.720963 1.522731+1 890.774077 1.489824+16637 3  1 1952
 890.827191 1.460841+1 890.890141 1.430594+1 890.945222 1.407041+16637 3  1 1953
 890.980631 1.393280+1 891.000303 1.387692+1 891.055384 1.373751+16637 3  1 1954
 891.138006 1.355278+1 891.220628 1.338945+1 891.303250 1.324113+16637 3  1 1955
 891.413413 1.305931+1 891.492100 1.293819+1 891.523575 1.290806+16637 3  1 1956
 891.688819 1.276446+1 891.822588 1.265659+1 891.979963 1.253614+16637 3  1 1957
 892.216025 1.236457+1 892.436350 1.221148+1 892.452088 1.220545+16637 3  1 1958
 892.688150 1.212036+1 893.002900 1.201266+1 893.270438 1.192483+16637 3  1 1959
 893.671744 1.179755+1 894.073050 1.167404+1 894.474356 1.155315+16637 3  1 1960
 894.639600 1.150415+1 894.875663 1.146707+1 895.444738 1.138000+16637 3  1 1961
 896.047813 1.128983+1 896.952426 1.115723+1 897.857039 1.102673+16637 3  1 1962
 898.416600 1.094685+1 898.761652 1.091870+1 899.967803 1.082167+16637 3  1 1963
 901.211831 1.072267+1 903.077873 1.057556+1 904.943915 1.042949+16637 3  1 1964
 907.049220 1.026550+1 907.431971 1.024521+1 909.920027 1.011409+16637 3  1 1965
 912.408082 9.983517+0 914.896138 9.853237+0 915.681840 9.812207+06637 3  1 1966
 919.872250 9.652270+0 924.927203 9.460054+0 929.982155 9.268322+06637 3  1 1967
 935.037108 9.076966+0 940.092060 8.885978+0 945.828495 8.669784+06637 3  1 1968
 950.130821 8.508110+0 952.999039 8.400622+0 955.867256 8.293598+06637 3  1 1969
 958.018419 8.213764+0 959.176638 8.171106+0 960.169583 8.116500+06637 3  1 1970
 961.603691 8.038107+0 963.037800 7.960456+0 963.957000 7.911277+06637 3  1 1971
 964.876200 7.862849+0 965.565600 7.827272+0 966.255000 7.792684+06637 3  1 1972
 966.714600 7.744890+0 967.174200 7.698071+0 967.633800 7.652682+06637 3  1 1973
 967.978500 7.620024+0 968.323200 7.589137+0 968.553000 7.569956+06637 3  1 1974
 968.840250 7.548299+0 969.012600 7.537270+0 969.055688 7.527447+06637 3  1 1975
 969.271125 7.481590+0 969.414750 7.453817+0 969.558375 7.429654+06637 3  1 1976
 969.666094 7.415252+0 969.752269 7.407245+0 969.827672 7.403928+06637 3  1 1977
 969.903075 7.405410+0 969.978478 7.413505+0 970.053881 7.430694+06637 3  1 1978
 970.104150 7.448810+0 970.154419 7.473668+0 970.161600 7.478394+06637 3  1 1979
 970.204688 7.498350+0 970.254956 7.531601+0 970.305225 7.576856+06637 3  1 1980
 970.355494 7.636465+0 970.405763 7.713104+0 970.456031 7.809778+06637 3  1 1981
 970.506300 7.929813+0 970.554773 8.071075+0 970.603247 8.240898+06637 3  1 1982
 970.651720 8.442916+0 970.700194 8.680852+0 970.764825 9.060381+06637 3  1 1983
 970.829456 9.518765+0 970.879725 9.942392+0 970.894088 1.006911+16637 3  1 1984
 970.958719 1.073140+1 971.023350 1.148912+1 971.106653 1.265460+16637 3  1 1985
 971.189955 1.396952+1 971.238788 1.482984+1 971.314909 1.624370+16637 3  1 1986
 971.459970 1.909469+1 971.563380 2.122923+1 971.695515 2.362957+16637 3  1 1987
 971.701260 2.373604+1 971.827650 2.552486+1 971.936805 2.649038+16637 3  1 1988
 972.000000 2.677201+1 972.086175 2.680596+1 972.091920 2.680215+16637 3  1 1989
 972.189585 2.627232+1 972.287250 2.532076+1 972.321720 2.484968+16637 3  1 1990
 972.425130 2.329594+1 972.551520 2.106779+1 972.746850 1.739392+16637 3  1 1991
 972.821535 1.610867+1 972.833025 1.590532+1 972.919200 1.452462+16637 3  1 1992
 973.005375 1.330803+1 973.070006 1.250727+1 973.127456 1.187463+16637 3  1 1993
 973.199269 1.118358+1 973.253128 1.073308+1 973.306988 1.033568+16637 3  1 1994
 973.360847 9.986449+0 973.378800 9.884395+0 973.414706 9.698931+06637 3  1 1995
 973.468566 9.458741+0 973.522425 9.251675+0 973.576284 9.073137+06637 3  1 1996
 973.630144 8.918899+0 973.681310 8.791401+0 973.727091 8.690604+06637 3  1 1997
 973.788131 8.572437+0 973.849172 8.469390+0 973.910213 8.378322+06637 3  1 1998
 973.971253 8.321223+0 974.032294 8.271463+0 974.093334 8.227396+06637 3  1 1999
 974.184895 8.169223+0 974.276456 8.117810+0 974.398538 8.056161+06637 3  1 2000
 974.520619 7.999579+0 974.642700 7.946232+0 974.858138 7.895958+06637 3  1 2001
 975.073575 7.849651+0 975.360825 7.791763+0 975.648075 7.736792+06637 3  1 2002
 975.964050 7.678604+0 976.481100 7.586813+0 976.998150 7.497864+06637 3  1 2003
 977.267653 7.452321+0 977.745000 7.373030+0 977.947725 7.339793+06637 3  1 2004
 978.724950 7.215262+0 979.502175 7.093596+0 980.279400 6.975153+06637 3  1 2005
 980.822400 6.894867+0 980.867700 6.884229+0 981.456000 6.749020+06637 3  1 2006
 982.044300 6.617650+0 982.632600 6.491476+0 983.024800 6.411274+06637 3  1 2007
 983.417000 6.283281+0 983.784688 6.168242+0 984.152375 6.059521+06637 3  1 2008
 984.201400 6.046154+0 984.520063 5.905297+0 984.887750 5.754434+06637 3  1 2009
 985.132875 5.662655+0 985.181900 5.646181+0 985.378000 5.533705+06637 3  1 2010
 985.598613 5.417639+0 985.819225 5.314652+0 985.917275 5.276676+06637 3  1 2011
 986.039838 5.195247+0 986.260450 5.073002+0 986.407525 5.010202+06637 3  1 2012
 986.554600 4.924503+0 986.720059 4.863188+0 986.830366 4.852109+06637 3  1 2013
 986.897775 4.866652+0 986.940672 4.875526+0 987.050978 4.948640+06637 3  1 2014
 987.133708 5.050512+0 987.191925 5.161813+0 987.216438 5.223976+06637 3  1 2015
 987.299167 5.510307+0 987.339000 5.698206+0 987.375769 5.894853+06637 3  1 2016
 987.381897 5.931701+0 987.455434 6.490316+0 987.461563 6.547103+06637 3  1 2017
 987.510588 7.059312+0 987.535100 7.358601+0 987.565741 7.779661+06637 3  1 2018
 987.608638 8.459726+0 987.620894 8.674385+0 987.657663 9.410737+06637 3  1 2019
 987.676047 9.809205+0 987.706688 1.056412+1 987.731200 1.121614+16637 3  1 2020
 987.755713 1.195305+1 987.786353 1.294502+1 987.804738 1.361387+16637 3  1 2021
 987.841506 1.505069+1 987.853763 1.558585+1 987.896659 1.759232+16637 3  1 2022
 987.902788 1.791077+1 987.951813 2.065151+1 987.961618 2.125643+16637 3  1 2023
 988.006966 2.426280+1 988.013094 2.471231+1 988.064570 2.873735+16637 3  1 2024
 988.073149 2.945408+1 988.116046 3.341537+1 988.144848 3.624329+16637 3  1 2025
 988.167523 3.869334+1 988.216548 4.433702+1 988.231255 4.618201+16637 3  1 2026
 988.288247 5.378763+1 988.290085 5.405205+1 988.358720 6.452285+16637 3  1 2027
 988.359946 6.472151+1 988.427355 7.638853+1 988.446965 7.999482+16637 3  1 2028
 988.520503 9.442304+1 988.567077 1.041128+2 988.628358 1.173930+26637 3  1 2029
 988.868580 1.718118+2 988.986240 1.963083+2 989.005850 2.000189+26637 3  1 2030
 989.123510 2.186597+2 989.143120 2.212479+2 989.246073 2.309252+26637 3  1 2031
 989.260780 2.318543+2 989.300000 2.333154+2 989.363733 2.342186+26637 3  1 2032
 989.398050 2.338905+2 989.417660 2.329985+2 989.525515 2.255637+26637 3  1 2033
 989.535320 2.245650+2 989.643175 2.102583+2 989.667688 2.063755+26637 3  1 2034
 989.795153 1.830474+2 989.819665 1.781543+2 990.064790 1.270607+26637 3  1 2035
 990.167743 1.067999+2 990.202060 1.004669+2 990.260890 9.025488+16637 3  1 2036
 990.319720 8.079777+1 990.349135 7.640921+1 990.437380 6.437200+16637 3  1 2037
 990.496210 5.766870+1 990.555040 5.142203+1 990.613870 4.626948+16637 3  1 2038
 990.672700 4.150275+1 990.727853 3.784017+1 990.764622 3.557889+16637 3  1 2039
 990.783006 3.456945+1 990.838159 3.177914+1 990.856544 3.091804+16637 3  1 2040
 990.893313 2.942452+1 990.948466 2.736247+1 990.979106 2.630130+16637 3  1 2041
 991.003619 2.558538+1 991.058772 2.410295+1 991.101669 2.303360+16637 3  1 2042
 991.113925 2.277597+1 991.169078 2.170612+1 991.224231 2.071026+16637 3  1 2043
 991.288577 1.983395+1 991.371306 1.880177+1 991.408075 1.837869+16637 3  1 2044
 991.454036 1.797377+1 991.536766 1.730396+1 991.647072 1.647665+16637 3  1 2045
 991.653200 1.643362+1 991.757378 1.588658+1 991.867684 1.534376+16637 3  1 2046
 991.947350 1.497407+1 992.033144 1.466395+1 992.143450 1.428714+16637 3  1 2047
 992.241500 1.396577+1 992.302781 1.381462+1 992.462113 1.344124+16637 3  1 2048
 992.701109 1.290780+1 992.829800 1.263300+1 992.940106 1.246818+16637 3  1 2049
 993.179103 1.212770+1 993.418100 1.179956+1 993.565175 1.160349+16637 3  1 2050
 993.663225 1.150916+1 994.030913 1.116928+1 994.300550 1.092895+16637 3  1 2051
 994.398600 1.086639+1 994.766288 1.064059+1 995.133975 1.042132+16637 3  1 2052
 995.477150 1.022162+1 995.562944 1.018942+1 996.114475 9.989614+06637 3  1 2053
 996.666006 9.795625+0 997.217538 9.605823+0 997.536200 9.497710+06637 3  1 2054
 997.585225 9.487497+0 998.320600 9.337586+0 999.006950 9.200667+06637 3  1 2055
 999.693300 9.065863+0 1000.28160 8.951947+0 1000.72283 8.900256+06637 3  1 2056
 1001.75235 8.782132+0 1002.78188 8.665738+0 1003.81140 8.550607+06637 3  1 2057
 1004.90914 8.428934+0 1005.12986 8.404652+0 1006.55576 8.311182+06637 3  1 2058
 1008.20238 8.204449+0 1009.84899 8.098580+0 1011.49561 7.993336+06637 3  1 2059
 1013.69110 7.853733+0 1015.64418 7.730177+0 1016.98433 7.660637+06637 3  1 2060
 1020.27757 7.490619+0 1021.37531 7.434109+0 1025.45258 7.224856+06637 3  1 2061
 1029.52986 7.016495+0 1033.60713 6.809094+0 1036.32531 6.671591+06637 3  1 2062
 1036.59714 6.657930+0 1039.04350 6.489847+0 1041.08213 6.350691+06637 3  1 2063
 1042.44122 6.258522+0 1043.69217 6.174454+0 1044.81478 6.099935+06637 3  1 2064
 1044.83498 6.097859+0 1045.97779 5.981852+0 1046.83489 5.896418+06637 3  1 2065
 1047.40630 5.840648+0 1047.94913 5.788996+0 1048.46338 5.741824+06637 3  1 2066
 1048.53900 5.735269+0 1048.97763 5.666862+0 1049.36331 5.609316+06637 3  1 2067
 1049.74900 5.555226+0 1050.05150 5.516475+0 1050.23300 5.495752+06637 3  1 2068
 1050.27838 5.485094+0 1050.50525 5.435807+0 1050.65650 5.406171+06637 3  1 2069
 1050.80775 5.380378+0 1050.95900 5.360479+0 1051.07244 5.351651+06637 3  1 2070
 1051.08000 5.351616+0 1051.18588 5.331696+0 1051.27095 5.323880+06637 3  1 2071
 1051.35603 5.326318+0 1051.41275 5.335675+0 1051.46947 5.353089+06637 3  1 2072
 1051.52619 5.380595+0 1051.58291 5.420679+0 1051.63963 5.476349+06637 3  1 2073
 1051.69634 5.551199+0 1051.75306 5.649455+0 1051.80978 5.776049+06637 3  1 2074
 1051.86650 5.936621+0 1051.91755 6.115424+0 1051.96859 6.331997+06637 3  1 2075
 1052.01964 6.591833+0 1052.07069 6.900757+0 1052.10850 7.170445+06637 3  1 2076
 1052.12173 7.269207+0 1052.17278 7.711453+0 1052.18413 7.827396+06637 3  1 2077
 1052.24084 8.426933+0 1052.30891 9.279199+0 1052.33538 9.666637+06637 3  1 2078
 1052.37697 1.030290+1 1052.45638 1.170991+1 1052.47755 1.214532+16637 3  1 2079
 1052.54713 1.363436+1 1052.61065 1.517906+1 1052.63788 1.586712+16637 3  1 2080
 1052.74375 1.886579+1 1052.77400 1.975240+1 1052.87685 2.296247+16637 3  1 2081
 1053.05835 2.880998+1 1053.06440 2.898178+1 1053.18540 3.246694+16637 3  1 2082
 1053.31850 3.545549+1 1053.42438 3.700709+1 1053.43497 3.709102+16637 3  1 2083
 1053.50000 3.752024+1 1053.58470 3.750185+1 1053.60285 3.746887+16637 3  1 2084
 1053.71175 3.643132+1 1053.74805 3.583711+1 1053.82065 3.453569+16637 3  1 2085
 1053.85998 3.359950+1 1053.97190 3.075731+1 1054.05660 2.833942+16637 3  1 2086
 1054.27440 2.177525+1 1054.32280 2.045920+1 1054.39994 1.833462+16637 3  1 2087
 1054.47934 1.638574+1 1054.55875 1.464376+1 1054.63816 1.311260+16637 3  1 2088
 1054.71756 1.178573+1 1054.74025 1.145846+1 1054.78941 1.079396+16637 3  1 2089
 1054.84613 1.012781+1 1054.90284 9.541824+0 1054.95956 9.027666+06637 3  1 2090
 1055.01628 8.577029+0 1055.04275 8.392599+0 1055.07300 8.205017+06637 3  1 2091
 1055.12972 7.901092+0 1055.18644 7.637910+0 1055.24316 7.409084+06637 3  1 2092
 1055.29988 7.208936+0 1055.31500 7.161900+0 1055.35659 7.053759+06637 3  1 2093
 1055.41142 6.929733+0 1055.44734 6.856728+0 1055.51919 6.726720+06637 3  1 2094
 1055.59103 6.613709+0 1055.66288 6.513480+0 1055.67800 6.494402+06637 3  1 2095
 1055.73472 6.440254+0 1055.84248 6.350200+0 1055.95025 6.270639+06637 3  1 2096
 1056.09394 6.174843+0 1056.16200 6.132946+0 1056.23763 6.100623+06637 3  1 2097
 1056.45316 6.016725+0 1056.68012 5.934940+0 1056.83524 5.881620+06637 3  1 2098
 1057.14547 5.779307+0 1057.37200 5.707556+0 1057.45571 5.689402+06637 3  1 2099
 1057.92832 5.591937+0 1058.41546 5.495548+0 1059.06497 5.370979+06637 3  1 2100
 1059.71449 5.249251+0 1060.06500 5.184583+0 1060.36400 5.133817+06637 3  1 2101
 1061.36150 4.967045+0 1062.85775 4.721012+0 1064.35400 4.478889+06637 3  1 210**************************ear in the context of a larger chemical issue.

Applications of CONGEN are no longer under close supervision by DENDRAL
project members. This fact speaks for the maturity of the program but makes it diffi-
cult to enumerate problems to which it has been applied. As mentioned, it is a very
general program. It works well on "medium size" problems in which it is combining
8 to 10 building block substructures, i.e., any combination of several atoms and super-
atoms. If the chemist has interpreted his data in terms of large superatoms (along with
other constraints) then the program can manage structures with 50 or more atoms.
The setup time fqr a CONGEN run depends on the number of constraints, but ranges
from 2 to 20 minutes. Computation time ranges from a few CPU-seconds to many
CPU-minutes

The final number of structures is strongly dependent on the chemist's ability
to aggregate separate atoms into superatoms and his ability to infer other struc-
tural constraints from the available data. Because of the subtle, and powerful, interac-
tions among constraints, it is difficult to estimate the final number of structures that
will be produced. Nevertheless, a user can interrupt CONGEN at any time to request
an estimate of the number of structures remaining to be generated. Although the esti-
mates are rather crude, they are valuable for indicating to the chemist that the pro-
gram needs more constraints, for example, if 200 structures have been generated and
CONGEN estimates that it is only 5 percent finished.

Some of the problems have been studied for tutorial purposes and for comparison
of the CONGEN approach to results achieved by conventional means. Many problems
of this type have been solved [e.g., Carhart et al. (1975b), Smith (1975a), and Carhart
et al. (1975c)]. Since the answers were known in advance, the ability of CONGEN to
list the correct structure, sometimes with added possibihties, increases our confidence
in the correctness of the program. Several similar examples of various degrees of com-
plexity have also been worked out. See Cheer et al. (1976).

  Much of the collaboration to date has been informal and has been undertaken
with the dual expectation of providing useful service while leading to new CONGEN
research areas. Some examples of problems are listed here togive a sense of the range
of structures for which CONGEN has been of service.

1. Chemical constituents of body fiids (e.g., organic acids, amino acids). Generate
structures within constraints derived from knowledge of chemical isolation pro-
cedures and human metabolic processes to identify compounds in the GC/MS
traces of patients with suspected metabolic disorders of genetic origin.


RESULTS 135

2. Terpenoids. Generate structures within constraints (including four to six large
superatoms) to identify Crs and CzO compounds isolated from natural sources.
These were also tested to see if candidate structures obeyed the isoprene rule that
restricts interconnections of 5-carbon superatoms [Smith and Carhart (1976),
Cheer et al. (1976)].

3. Marine sterols. Determine the sterols (within numerous constraints) that could be
metabolic precursors of known sterols in marine organisms in order to guide iden-
tification of unknowns.

4. Insect secretions. Confirm the structural possibilities in problems involving the
identification of insect hormones and other insect defense secretions.
5. Rearrangement products. Obtain all structural possibilities under available con-
straints to help solve the structures of chemical and photochemical rearrangement
products of unsaturated hydrocarbons (e.g., a tricyclic CllHlz hydrocarbon) and
polycyclic molecules [Varkony, Carhart, and Smith (1976)].
6. Ion structures. CONGEN has also been applied to the problem of generating the
structures of gaseous ions. This application has been done, for example, for the
case of triethylamine, (CH3CH2)sNt-. See Smith, Konopelski, and Djerassi
(1976) for an explanation of the underlying mass-spectrometry fragmentation
mechanisms of this and related compounds.

7. Pharmacologic agents. CONGEN has been used to help solve the structures of sev-
eral compounds displaying pharmacologic activity including some nitrogen hetero-
cycles, pesticide conjugates, and metabolic products of microorganisms.

Another potential use for CONGEN is as a check on the results of analyses done
by other means. Although chemists, unaided by CONGEN, have hypothesized struc-
tures that agree with all sources of information about a compound, it is seldom possi-
ble to be certain that equally plausible candidates have not been overlooked. In several
cases (selected for their complexity) CONGEN has found alternatives to published hy-
potheses. For example, it was found that four structures in addition to the one pre-
sented in a published result met the stated constraints and were in fact chemically
plausible. The routine use of CONGEN in this capacity could ensure a higher degree of
reliability in the published literature.

8.5 PLANNER RESULTS

The next group of results illustrates the use of PLANNER with estrogens, using the
fragmentation analysis and definitions described in Section 5.5. First, results for a
single typical example are given. Figure 8-3 presents the low-resolution spectrum of
16alpha-hydroxyestrone. Table 8-5 shows the results of the break analysis for this
compound, and Table 8-6 presents the results of planning, indicating the structures
supported by the spectral data, and showing that all but one set of possibilities was
eliminated by the PREDICTOR.

Table 8-7 briefly summarizes results obtained for 45 estrogens, using variations of
the same techniques. This figure illustrates the program's feedback loop: constraints
are relaxed with each pass until the program finds at least one structure that is consis-


136 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

tent with the data. That is, the data are reinterpreted under weaker and weaker con-
straints if no consistent interpretation can be found under the stronger constraints.
The procedure can be closely controlled by the user.

Table 8-8 presents some results on the difficult problem of analyzing mixtures of
compounds. PLANNER's results are compared with published results obtained by con-
ventional methods. The determination of the molecular ion in these examples was not
done with MOLION, but with an earlier and less general method. These results are im-
portant because they illustrate the power of combining pieces of evidence for every
fragmentation and every molecular ion in a much more thorough and systematic way
than is possible by hand. They also indicate that some problems involving mixtures of
similar compounds may be solved by the program without requiring the chemist to
separate the individual components of the mixture.

Table 8-9 presents results from MOLION as applied to several compounds and
demonstrates that the correct M+ was among the top four candidates selected by the
program in each case. Table 8-10 summarizes the performance of MOLION with 11
classes of compounds, using low-resolution spectra. When the molecular ion is present
in the spectrum, MOLION always includes it among its top three choices, generally
first. For compounds where the molecular ion is not present in the spectrum, such as
amino acid derivatives and barbiturates, the correct candidate is still generally among
the top five. There are some cases where prediction is not good (such as when M' - 73
is the highest mass); but overall the probability is greater than 0.95 that the molecular
ion will be among the top five predictions, according to the empirical studies summa-
rized here.

It is of interest how much of the chemist-user's time is required for imparting the
necessary knowledge for analysis of a new class of compounds. Roughly, PLANNER

100-j
      b
90-         0


80- :& OH

70- Ii0

60-

B

M'

IO-

60 70 80 90 100110120 130140 1%. )160170180190200210220230240250260270280290
                      Fragment mass

E

Figure 8-3 Low-resolution spectrum of 16alpha-hydroxyestrone. (Source: Journal of the American
Chemical Society, Copyright 1972, American Chemical Society. Reproduced by permission. After
!Smith et al. [ 1972) .>


Table 8-5 PLANNER break analysis for 16alpha-hydroxyestrone

Substituents      Break

Substituents on
charged fragment

Summed relative
abundance, %

03 DOT2        B        01              133
            C        01               60
            D        02               16
                     01                15
                     01 DOT2            5
            E        01               58
                    01 DOT2           40
             F         01                45

  Source: Smith et al. (1972). Reprinted with permission from the JoumaZ of the American
Chemical Society, copyright by the American Chemical Society.

Table 8-6 PLANNER results for 16-alphabydroxyestrone

Number of structures
remaining after testing     Substituents     Placement


1                 01           C-l -c-10
                  01 DOT2      c-17
                   01           C-16

2                  01          C-l-C-10
                  02 DOT2      c-17

3                  01           C-l-C-10
                  02           c-17
                   DOT2        C-16

  Source: Smith et al. (1972). Reprinted with permission from
the Journal of the American Chemical Society, copyright by the
American Chemical Society.

Table 8-7 Summary of results for estrogen standard compounds

Derivatives

No. of
structures

One
correct?

How
obtainedt

Of estrone (3-hydroxy-1,3,5(10)-estratrien-17-one)

1, Estrone
2,2-Hydroxy-
3,2-Methoxy-
4,3-Methoxy-
5, l-Methyl-
6, 1-Methyl-3-methoxy-
7, 1,2-Dimethyl-
8, I-Methyl-6or, 7a-dihydroxy-
9,6-Methyl-

Yes
Yes
Yes
Yes
Yes
Yes
No
No
Yes

Normal
Normal
Normal
Normal
Normal
Pass 2
Normal
Pass 2
Pass 2

137


Table 8-7 Continued

Derivatives

                   No. of       One
                     structures    correct?

Of estrone (3hydroxy-1,3,5(10)-estratrien-17-one)

How
obtained7

10,7-0x0-
11,11-0x0-9p-
12,3-Methoxy-1 la-hydroxy-
13,15o-Hydroxy-
14,16a-Hydroxy-
l&6-Dehydro-
16,7-Dehydro- (equilin)
17, l-Methyl-6-dehydro-
18,6-Methyl-6-dehydro-
19,6-Dehydro-8-dehydro- (equilenin)
2Oa, 9,1 I-Dehydro- (mixture with 20b)
20b, Estrone
21a, 3-Methoxy-9,11-dehydro- (mixture with 21b)
Zlb, 3-Methoxy-
22, I-Methyl-3methoxy-9,11-dehydro-$
23,17-Deoxo-

2
5
1
2
1
1
1
1
1
0
5
1
4
1

1

Of estradiol(1,3,5(10)-estratriene-3,17fldiol)

Yes
Yes
No
Yes
Yes
Yes
Yes
Yes
Yes

Yes
Yes
Yes
Yes

Yes

Pass 2
Pass 3
Pass 2
Pass 3
Normal
Normal
Normal
Normal
Normal
Pass 3
Pass 2
Normal
Normal
Pass 2

Pass 2

24, Estradiol                           1          Yes       Normal
25,2-Hydroxy-                        1          Yes       Normal
26,2-Methoxy-                         1          Yes       Normal
27,3-Methoxy-                         1          Yes       Normal
28, l-Methyl-                          1          Yes       Normal
29,6-0x0-                            1          Yes       Normal
30,l lo-Hydroxy-                        2          Yes       Normal
31,3-Methoxy-1 lo-hydroxy-                  1          No        Normal
32, 3-Methoxy-lSa-hydroxy-                  1          No        Pass 2
33,16-0x0-                           3          Yes       Pass 3
34, lIlaMethyl-                          1          Yes       Normal
35, "17~-Acetyl-"8                       2                  Pass 2
36, I-Methyl-17oacetyl-                    3          Yes       Pass 2
37,3-Methoxy-17o-vinyl-                   1          Yes       Normal
38,17a-Ethinyl-                        1          Yes       Normal
39,3-Methoxy-17o-ethinyl-              1 i     Yes       Normal
40,1-Methyl-6-dehydro-                    1          Yes       Normal
41,1,2-Dimethyl-6-dehydro-                 1          No       Normal
42,9,11-Dehydro-                       3          Yes       Normal
43, Estriol(1,3,5(10)-estratriene-3,16o, 17p-triol)     1          Yes       Normal

thlormal: standard, one-pass processing. Pass 2: recycled with break B classification relaxed.
Pass 3: recycled through entire program to include all evidence for all breaks.
&See text for description.
OCompound is not estradiol 17o-acetate. The program indicates there is an extra unsaturation,
possibly in ring C. The true identity of the sample is not known at this time.
  Source: Smith et al. (1972). Reprinted with permission from the Journal of the American
ChemieaI Society, copyright by the American Chemical Society.

138


A     119     270
        (C1aH2202)

300
G&z&d

286
Gt3H2203)
298
(CI~HZZW
284
(ClSH2003)

                                          H

B     99     288
        (C18H2403)

                                          H

C      76      288
        (Cl8H2403)

                                     0

                                          H

D     58     286
        (C18H2203)

Table 8-8 Comparison of PLANNER and conventional analysis
for mixtures of estrogens

     Amount Molecular
Mixture pg      ions

Estrogen planner

Results

   Conventional analysis

80% estrone

20% 2-methoxyestrone

Not reported

Not reported

Not reported

Estriol plus trace amounts
of others

Estriol plus trace amounts
of others

16/3-hydroxyestrone

25% 16-oxoestradioL17p

5% lk~hydroxyestrone

139


Table 8-8 Continued

                                     Results
    Amount, Molecular
Mixture I.cg     ions      Estrogen planner          Conventional analysis

                                     0

E      34

F      26

OH

286
(C18H2203)

  16@hydroxyestrone

23% 16-oxoestradiol-17p
9% 15~hydroxyestrone

286
(ClgH2602)

OH

284
GdhW

estradiol-17ar

-70%   3-methyl ether
   estradiol-17p
    3-methyl ether

-20% 1 l-
dehydroestradiol-1701
3-methyl ether plus
small amounts of several
unknowns with one
additional double bond

OH

300
GcJ-h0d

Unknown

140


Table 8-8 Continued

    Amount, Molecular
Mixture fig      ions

Estrogen planner

Results

    Conventional analysis

G     24      270
         VhHzz0d

H

300
(ClghOd



286
(ClSH2203)

14     286
    (CwH2602)

284
(Cdh02)

-90% estrone

-10% 2-methoxyestrone

Not reported

-20% 1 l-
dehydroestradiol-170
3-methyl ether plus
several unknowns with
one or two additional
double bonds

  Source: Smith et al. (1973a). Reprinted with permission from the Journal of the American
ChemicalSociety, copyright by the American Chemical Society.

141


142 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Table 8-9 MOLION predictions and rankings for illustrative compounds

Compound        Mol formula

Highest mass Fragment
present    missingt   Mol wt  Ranked at no. $:

Ritalin (2)

Pentobarbital(3)

Mebutamate (4)

Tridecan'l-one

Succinic acid
methyl ester
Caprylic acid
methyl ester
Glutaric acid
methyl ester
Maleic acid
butyl ester
N-TFA o-alanine 0
butyl ester
N-TFA norleucine
butyl ester
N-TF A valine
butyl ester
N-T'FA threonine
butyl ester
N-TFA phenylalanine
butyl ester
n-Undecyl alcohol

4-Methyloctan-4-01

172
(M - 61)

197
(M - 29)

175
(M - 57)

155
(M-43)
116
(M - 30)
129
(M - 29)
129
(M-31)
173
(M - 55)
186
(M - 55)
227
(M - 56)
227
(M-42)
323
(M - 44)
216
(M - 101)
154
(M - 18)
129
(M - 15)

C2H502


C2H5


Cd-b


C3H7

CH20

C2H5


CH30


C4H7


C4H7


C4Hs

C3H6

C3W3


Csb02


H20


CH3

233

226

232

198

146

158

160

228

241

283

269

367

317

172

144

4


2


3


4


2


3


1


2


2


2


2


1


4


1


1

tThese fragment composition losses from the molecular ion are only postulated. Their validity
could only be confirmed by high-resolution studies.
*Note "ranked at number 1" is the program's best choice for a `;nolecular ion candidate.
_TFA refers to the trifluoroacetyl derivative.
  Source: Dromey et al. (1975). Reprinted with permission from the Journal of Organic Chem-
istry, copyright by the American Chemical Society.

rules for a new class of simple compounds can be entered into the program in a few
minutes, although it may take one or two weeks for a chemist familiar with the class
and its MS behavior to decide on an appropriate set of rules. For the more complex
cyclic classes such as the estrogens, the time requirements jump to one or two months,
if program modifications are needed to accommodate new problems.


RESULTS 143

Table 8-10 Summary of MOLION performance

Class           M+ in top 3

           Total number
M+intop5    of compounds

Amines             62          67          68
Alcohols             51           54          57
Ketones             42          44          44
Ethers               33          34          34
Acetals              13           14          14
Amino acid derivatives      9           11          13
Thioethers            11          12          12
Drug compounds         6           8           9
Methyl esters           6           8           8
Butyl esters            4           5           6

  Note: The program failed to generate the correct candidate for one alcohol, tert-butyl
akohoL

  Source: Dromey et al. (1975). Reprinted with permission from the Journal of the American
Chemical Society, copyright by the American Chemical Society.

8.6 META-DENDRAL RESULTS

The Meta-DENDRAL program has been used to study the MS behavior of several
classes of compounds. Before it could be used with confidence on new cases, however,
it was necessary to reproduce previous results on at least two widely differing classes
of molecules. Low-resolution spectra for 11 aliphatic amines and high-resolution
spectra for 10 estrogenic steroids were the two test cases chosen. Setup time for Meta-
DENDRAL, once spectra have been collected, is less than an hour. However, the in-
terpretation of results and refining of system parameters can take some weeks.

Meta-DENDRAL was applied to the low-resolution spectra of 11 aliphatic amines
ranging in size from 4 to 14 carbons. Five rules were produced, explaining 84 percent
of the total ion current. The five rules described processes that had previously been
known to describe the behavior of these compounds in the mass spectrometer. They
were (1) alpha cleavage, (2) beta cleavage with hydrogen transfer, (3,4) two casts of
gamma cleavage with concomitant C-N cleavage, and (5) two-bond cleavage yielding
a nitrogen-containing fragment.

Applied to the high-resolution spectra of 10 estrogenic stqoids, Meta-DENDRAL
produced eight rules that well characterize these compounds, accounting for over 40
percent of the total ion current. Five of these rules were the same as those found in
the literature and used earlier for PLANNER (although Meta-DENDRAL was not in
any way primed with these rules). The three additional rules describe cleavages
through rings B and C of the estrogen skeleton (Figure 5-4, Section 5.5) that are plau-
sible processes.

Meta-DENDRAL has also been successfully applied to three classes of Ice&an&o-
stanes. No fragmentation processes for these compounds taken as a class had previously
been described in the literature. For monoketoandrostanes, eight rules were produced,
accounting for 42 percent of the total ion current (74 percent of the data explained by


144 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

INTSUM). (We have used this case to illustrate the organization of the program; see
Chapter 7.) For diketoandrostanes eight rules were also produced, accounting for 33
percent of the total ion current (77 percent of the data explained by INTSUM). The
data were high-resolution spectra of 9 of the 55 possible diketoandrostanes. Ten rules
were produced from the high-resolution spectra from 8 of the 165 possible triketo-
androstanes; these rules accounted for 60 percent of the total ion current (84 percent
of the data explained by INTSUM).

The rules for these classes of compounds are depicted in Buchanan et al. (1976).
A few are shown in Table 8-11 for illustration.

8.7 DENDRAL PREDICTOR RESULTS

The prediction and ranking programs have been tested successfully on several sets of
known compounds and used to aid in structure elucidation of some unknowns, as
mentioned ln Section 6.4, including monoketoandrostanes, sterols, and macrolide anti-
biotics. If we assume that the correct structure was in the CONGEN list, the ranking
program was expected to pick it out among all plausible isomers by comparing pre-
dicted mass spectral peaks for each isomer with the observed mass spectrum (of the
one correct structure). The predictor itself is a deductive mechanism that provides test-
able results, either by the half-order theory or by more complex, class-specific rules.
The ranking function is a heuristic program that compares predicted and observed
spectra to discriminate the structure whose predictions best match the observed data
from all others.

Several scoring functions have been tried on test sets to determine the sensitivity
of the ranking to the specifics of the scoring. All are variations on the simple idea that
the score for a structure should be increased when predictions are confirmed (in the
observed spectrum) and should be decreased when predictions are disconfirmed. Some
functions give extra weight to predicted high mass peaks on the principle that these
are more significant. Other functions give extra weight to disconfirmed predictions on
the principle that negative evidence is more significant, since spectral peaks arising
from any source can be used to confirm predictions. The net result of our experlmen-
tation with scoring functions is that simple functions do about as well as complex
ones, especially if there are many predictions included in the score. The score is much
more sensitive to the quality of the rules used for making predictions than it is to the
composition of the scoring function. The halt-order theory provides a reasonably effi-
cient filter because it almost never makes numerous erroneous predictions on the cor-
rect structure, and it is specific enough to make predictions for the incorrect structures
that will be disconfirmed. On the other hand, it is general enough that many candi-
dates pass through this filter.

For the results mentioned below, the score for each comparison was computed as
follows.

For a given set of rules, a particular structure-to-spectrum comparison yields a nu-
merical score. This score is a function of
S(R) = significance of a peak correctly predicted by rule R
    = mass of the corresponding ion + M+


Table 8-11 Meta-DENDRAL produced rules for monoketoandrostanes

NUllet         Subgraph$

Other descriptors
and interpretations

     Positive evidence(i          Average
                Negative   intensity
SCXXe_   Any Unique    evidence   %~`I"

M-l
(none, +H, -H)

M-2
(none, +H,
-H, -2 H)

M-3
(none)

M-4
(none, -H, -2 H)

M-S
(+K -HI

M-6
t-W

M-7
(-H, -2 H)

M-8
(+H, -H)

R
R      Atom a is not       145.8    24
       ketosubstituted

R
  R
  H

11       1       4.42

135.3    21 12       3

Loss of methyl       84.5    26 26       0       1.62

70.5    21 0       1

39.5     8 4       0       3.29

  c
d           There must be a       39.7     9
          keto group on atom a

d

Atoms a and d are
not keto-substituted

23.8    13

H  H

  d
P H        Atom d is not        13.1     3
H          keto-substituted

5.01

3.71

0       0       4.4 1







13       7       1.99







0      0       4.35

tlmportant transfers of neutral species are indicated below the name of the rule. Absence of transfers is stated explicitly
as "none."

$Specified nonhydrogen substituents are indicated by R (R t H). Other valence positions may be filed with any atoms
(including H) except when restricted by other descriptors.
$Score calculated as described in Section 7.4.1.
7Positive evidence count (any and unique) and negative evidence count are described in Section 7.4. The number of posi-
tive instances may be greater than the number of molecules because a rule may apply more than once in any molecule.
  Source: Buchanan et al. (1976). Reprinted with permission from the Journal of the American Chemical Society, copy-
right by the American Chemical Society.

145


146 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

and

K(R) = number of peaks in the spectrum that are correctly predicted by applica-
   tion of rule R to the structure, or - 1 if there are no correctly predicted
   peaks.

K(R) will be greater than 1 if the rule predicts lower m/e peaks due to transfers, and
these are indeed found in the spectrum along with the major peak predicted.

The score is the sum of [S(R) X K(R)] over all the rules in the set. The scor-
ing function used in discrimination penalizes a candidate structure if its predicted
spectrum shows significant peaks that are not in the actual data. The other kind of
mismatch-failure to predict peaks that appear in the actual spectrum-does not
penalize a candidate. The reason for this asymmetry is that the rules are selected for
their generality and thus should make correct predictions, but they are not expected
to explain all ions in a spectrum. When a predicted mass spectrum from a candidate
structure is compared with an actual spectrum, then the peaks that arise from non-
general fragmentation processes will not be predicted.

Using the eight estrogen rules and this scoring function, we showed that the pro-
gram can distinguish several of the estrogenic steroids from all other isomers of the
same class.

  For the ketoandrostanes, this scoring function was used to test the discriminatory
power of the respective rules by testing their ability to rank known structures higher
than other possibilities. Rules M-l through M-8 (six of which are shown in Figure 8-4)
have relatively low discriminatory power for the monoketoandrostanes. These rules
can distinguish the 7- and 1 l- keto compounds from among all other possible mono-
ketones, but they ranked the other structures anywhere from second to last when
comparing the spectrum of the correct structure with predicted spectra for all candi-
dates. This low discriminatory power relative to the estrogens is due to a combination
of three factors: (1) the rules seldom mention the carbonyl group explicitly (by itself
this is not necessarily bad), (2) each rule often predicts the same ions in all the mole-
cules, and (3) where different ions are predicted they are not unique to the spectrum
of the correct compound.

It is interesting that the eight diketoandrostane rules have much better discrimina-
tory power than rules M-l through M-8 had for the monoketoandrostanes. We com-
pared the predicted spectra for the 55 possible diketoandrostanes (excluding substitu-
tion on the C-18 and C-19 methyl groups) against the actual spectrum for each of nine
diketones. Three compounds were ranked first (i.e., discriminated correctly). The rest
were ranked 6th, 3rd, 4th, 16th, 8th, and 9th respectively, out of 55 candidates. The
improvement in discriminatory power over the monoketoandrostanes reflects more
frequent (implicit) reference to keto groups in the rules and a larger number of unique
ions predicted by the rules.

The discriminatory power of the 10 triketoandrostane rules is quite high, parallel-
ing the discriminatory power of the diketoandrostane rules. The predicted spectra of
the 165 possible triketoandrostanes were compared to the known spectrum of each of
eight compounds. The ranking of the correct structure was 4,5,3,4,9,20,4, and 12,
respectively.


RESULTS 147

These programs have been used to infer structures for sterols isolated from marine
sources. CONGEN's lists of possibilities (within constraints specified by the chemist)
contain several dozen structures. Banking these with respect to a few known fragmen-
tation rules has been an important aid to the chemists.

8.8 DESIGN PRINCIPLES

In The Sciences of the ArtificiaZ Herbert Simon (1969) distinguishes natural sciences
from "artificial" sciences, which he judiciously calls sciences of the artificial. By the
latter he means sciences of design-the systematization of knowledge that man em-
ploys in constructing artifacts. Although design is more often conceived as an art,
Simon argues that an instructive comparison may be made between design principles
on the one hand, and empirical generalizations about natural phenomena on the other.
He suggests that the art of design could become the science of design. Since it has
frequently been observed that the pursuit of scientific knowledge is itself an art,
Simon's suggestion includes the case of the science of doing science.

  The discoveries of natural science are facts and theories. The discoveries of the
sciences of design are design principles. The exact status of design principles has never
been analyzed, so there is something more compelling, more real, about a fact or em-
pirical law than about a principle of design. Nonetheless design principles are of pre-
eminent importance in human endeavor. Facts are seldom ends in themselves; more
often their importance is in the service of design.

Viewed on the model of natural science, artificial intelligence may be properly
criticized when it does not result in facts about computing, facts about cognition, or
artifacts in the form of successful performance programs. But such results are only
part of what should be expected from a science of design. It is because of the unclear
status of design principles, we feel, that empirical studies of design, such as AI projects,
have been subjected to harsh criticism for failure to produce substantive results. It is
more than this unclear status, of course. Since we lack any systematic way of stating
design principles and their range of application, these principles bear a certain will*`-
the-wisp quality that flits between the obvious and the false. There simply is no com-
pelling way to convey just what the builder has learned; in the absence of a program of
demonstrable power, as is more often than not the case, the suspicion is that nothing
has been learned.

This book is about the discovery, use, and importance of heuristics. No theo-
' rems have been proved, no systematic experiments run, no general empirical laws
recorded, but we have done a substantial amount of experimentation in the design of
heuristic programs. Since a program of demonstrable power has been produced to do
a job that scientists consider significant, interest attaches to the underlying principles
of design; we know, at least, that they do work in a nontrivial case. In this section we
will attempt to convey as clearly as possible, given the presystematic state of the
science of artificial intelligence, some of the lessons that have been gained from this
experience.


148 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

8.8.1 Considerations for Program Design

DENDRAL is an extensive case study of a knowledge-based program within the plan-
generate-test paradigm. The success of DENDRAL illustrates the power of this para-
digm. It also clearly points to a number of details of this methodology that deserve
careful consideration in its application.

  1. The efficiency of the generator is extremely important. Even with effective
planning and testing, the power of the problem solver will often be limited by how
quickly candidate solutions can be enumerated. It is particularly important that con-
straints can be applied effectively.

One interesting improvement in CONGEN involves spending a little extra time at
the beginning of a session to save enormous amounts of time later. There are numerous,
logically equivalent ways of specifying constraints to CONGEN that differ greatly in
efficiency. It is unreasonable to expect a chemist using CONGEN to be familiar
enough with the program itself to know which specifications are more efficient than
others. (It is also unreasonable to ask the chemist to seek advice every time from one
of the local CONGEN experts.) Thus we have begun work on a "smart interpreter" of
constraints. The goal is to have it accept the chemist's statement of the problem and
understand both the chemistry and the computational procedure well enough to trans-
form the given constraints into an equivalent, more efficient set of specifications.

2. The use of depth-first search, which provides a stream of candidates, is gener-
ally better (in an interactive program) than breadth-first search, in which no candidates
emerge for examination until all are generated. To a programmer the two methods are
equivalent. To a chemist waiting for help with a structure problem the difference is
substantial. It is far more pleasing to see some answers quickly, and it is more efficient
in those cases where the first few answers reveal mistakes in the problem specification.
In those cases, the chemist can interrupt the program, change the constraints, and
restart.

3. Planning is in general not simply a nice additional feature but is essential for
the solution of difficult problems. As much knowledge as possible should be brought
to bear at this stage rather than at the testing stage, because this point is where the
search can be cut drastically.

4. Every effort to make the program uniform and flexible will be rewarded. The
user should be provided with as many options as one can think of (with defaults es-
tablished to remove the burden when the flexibility is unneeded). Every decision
strategy and parameter that is hardened into the program Will become a limitation not
open to examination or easy modification and not easily remembered.

5. Interactive user interfacing is not merely a nicety but an essential. For a high-
performance computer program to capture the sustained, widespread attention of
working scientists, it must contain a large number of features that make it easy and
pleasant to use. These features are commonly termed "human engineering aspects" of
a program. In very rare instances, a program will be so useful that it will be widely
adopted even without proper attention to human engineering. More often, programs
that are understandable only to programmers are used, if at all, only by programmers.

The prompts and descriptions printed by the programs have been designed by
chemists to be terse, informative, objective, and courteous. These are not always con-


RESULTS 149

sistent goals, but with careful attention the dialogue can be free of flagrant affronts to
our feelings. Along the same lines, it should be noted that a person's right to privacy
cannot be ignored in scientific programs. An automated laboratory notebook, for ex-
ample, should be confidential if the chemist wishes it to be. In other contexts much
work has been done on this problem. In CONGEN we rely on the standard protection
mechanisms built into the computer system, but we will need more security if we are
to satisfy users in chemical industries. As mentioned above, the system tries to be re-
sponsive to a user's request for help, and users are encouraged to call one of several
local chemists with knowledge of the program in case of problems. The importance of
talking to someone who understands the task is obvious to users of complex programs,
but not always obvious to programmers.

6. An interesting extension of the plan-generate-test paradigm could improve its
power: search and generation (see Section 3.2.2) might be combined into a single
problem solver. In the context of DENDRAL this combination would mean that the
generation of isomers would be guided by a search through a related problem space.
The problem states would most naturally be chemical structure graphs, and the trans-
formations would append, delete, and rearrange constituents. A proposed alteration
would be considered for its effects on the mass spectrum, and a hill-climbing technique,
for example, might drive the search. Successful ("warming") modifications would be-
come GOODLIST constraints on generation. Numerous variations on this theme can
be envisioned, and work has been started on one of them.

7. Choice of programming language is still an issue. We have yet to see a language
that combines the flexibility and debugging power of INTERLISP with the running
speed and exportability of FORTRAN. This language conflict causes a dilemma at the
start of a large programming effort whenever the designers hope for widespread use
of the resulting program. Networking provides a partial answer to the exportability
question, since widespread use can be accomplished by long-distance sharing of a com-
plex program.

8. Providing assistance to problem solvers is a more realistic goal than doing their
jobs for them. In the first place it removes some of the psychological barriers that
people often exhibit toward machines. Also, the amount of work involved in automat-
ing the whole task may far outweigh the benefits and in any case will delay the appear-
ance of any benefits considerably. This is the theme of much of Norbert Wiener's writ-
ing [e.g., Wiener (1964)] .

9. Record keeping is an important adjunct to problem solving. Every laboratory
assistant is expected to keep a good laboratory notebook: the same should be true for
a computer apprentice. Of the many ways of realizing the goal of helpful records, only
some have been explored in the context of DENDRAL.
We expect the DENDRAL programs to provide three different kinds of notes: (1)
A record of initial conditions, intermediate conclusions, and final results; (2) a com-
plete record of the interaction between chemist and program (including false starts and
typing mistakes); (3) a trace of the program's reasoning steps.
Each of these is important for a different reason. The final results, of course, are
the sine qua non of the assistant's work. The record of initial conditions and major in-
termediate conclusions give the chemist at a glance the context in which the problem
was solved and the major steps in its solution. This record serves as a useful reminder


150 APPLICATIONS OF ARTIFICIAL 1NTELLIGENCE FOR ORGANIC CHEMISTRY

of scope and limits; in addition, disagreement on initial conditions or intermediate
conclusions would be sufficient reason to request the assistant to start over. Meta-
DENDRAL, for instance, immediately precedes its stored and printed results with a
summary of the context specified by the chemist. Because they are together, there is
less chance that the results will be interpreted without proper regard for the context.

The record of the chemist's interaction with the program is a detailed account of
what the investigator requests of the assistant. Failure to find a solution to a problem
can often be attributed to ill-specified requests, so it is helpful to review the complete
record of specifications made by the investigator. For example, the requests for help
and the program's responses are important entries in the experimental record.

Finally, the trace of the assistant's reasoning steps is helpful for keeping track of
the inferential steps of an assistant that might otherwise not be open to scrutiny by
th.: investigator. In any case it is often useful to have a record to justify moving from
one point to the next. For example, before the DENDRAL PLANNER prints the fmal
results, it prints the plausible molecular ions it inferred from the data and the data it
associates with each of the separate fragmentations.

  10. In order to use a program intelligently, a user needs to understand the pro-
gram's scope and limits. The scope, roughly, is the broad class of problems that the
program is designed to solve and the context in which solutions will be found. The
limitations of a program are the idiosyncrasies that must be remembered to obtain re-
liable solutions and are less fundamental to the whole procedure. For example, enu-
merating polymeric structures is outside the scope of CONGEN, while its working def-
inition of aromaticity is a limitation that is more easily changed. Operationally, the
scope is the broad definition of the problem that can only be changed at the cost of
writing an entirely new procedure. The limitations are the explicit and implicit items
in the problem definition that are added to make the problem solvable and that may
be changed or removed more readily. It is not a sharp distinction; the point is that a
chemist needs to understand the program's interpretation of the problem before the
program can be used responsibly and confidently.

  11. The context in which problem solving proceeds is essential information for
interpreting the solutions. The more an assistant can make explicit the assumptions
and initial conditions of a problem, the easier it is for an investigator to understand the
answers. This has always been true, but the emergence of computer programs as assis-
tants brings the problem clearly into focus.

In a program the assumptions are often completely hidden. One effect of this fact
has been to divide the scientific community into roughly three camps: scientists who
mistrust all computer programs, scientists who will believe anything generated by a
computer, and scientists who write their own programs. As computer science matures,
however, this division will fade because programs will be able to convey many of their
own assumptions and limitations.

The only step we have made along these lines with DENDRAL programs is to
keep a good laboratory notebook, as described above. One of the items we try to make
explicit at the time problem solutions are printed is the set of assumptions under
which the program arrived at those solutions.

  12. DENDRAL employs uniformity of representation as a means of understand-
ing (and conveying) the contents of the knowledge base as well as problems of acquir-


RESULTS 151

ing new knowledge. In DENDRAL, knowledge is uniformly represented in a very gen-
eral form: production rules. The uses to which the knowledge is put, however, are
many. This arrangement achieves the best of both worlds: we have uniformity of rep-
resentation with its virtues of modularity, simplicity of control structure, and perspi-
cuity, and we have the inherent power of multiple sources adding to and making varied
uses of the common knowledge base.

8.8.2 Applying the Lessons Elsewhere

Particularly in the physical sciences there is a great emphasis on precision and instru-
mentation. Mass spectrometry is no exception. A premium is placed on achieving
greater and greater resolution of the instrument, on the elimination of noise and im-
purities, and on obtaining the cleanest possible data. Then and only then does one get
on with the business of analysis.

Experience with DENDRAL suggests that there is, at least, an alternative ap-
proach. The same amount of effort spent on refining the means of hypothesis gen-
eration and testing will often yield far greater dividends. The power of hypothesize-
and-test is unmatched by the method of construction (by deduction from previously
verified premises), not only at the grand level of theory construction, but at the mun-
dane level of day-to-day experimentation.

Constructive, deductive methods, in which each step follows from the last, have an
understandable appeal. Such methods are conservative: they may fail but they will not
err. This reason, we believe, operates against the acceptance of heuristic programming
methods. If there is such a thing as a classical view of programming, it is that there can
be no program without an algorithm. With the important exception of the algorithm
underlying the cyclic structure generator, the programs we have described contain no
glimmer of elegant, formal theory. MOLION, for example, would not pass muster as a
theory, and yet it works. The most important and powerful knowledge any working
scientist has is unformalized intuition about his field. Heuristic programming offers a
means of capturing and amplifying this knowledge. Exploitation of this technique
could put computers in the service of science to an extent that would eclipse the con-
tributions of the traditional programming approaches.

A conscious effort was made to incorporate many of DENDRAL's design princi-
ples in another knowledge-based program written at Stanford, the MYCIN program
[Shortliffe (1976)]. MYCIN incorporates knowledge of bacterial infections and anti-
biotic drugs in production rules to aid physicians with the task of selecting appropriate
antibiotic therapy for patients. MYCIN's success is due, in part, to experience gained
in organizing and manipulating large knowledge bases for DENDRAL.

In selecting research projects, the following guidelines have proved valuable: (1)
Do not count on breakthroughs; (2) fmd a real star as your expert; (3) make sure your
star will devote at least one-third time to the project; and (4) pick one who knows or
is willing to learn about computers.

8.8.3 Project Organization
There have been few successful interdisciplinary projects in the history of science, but
we believe DENDRAL should be counted among them. The project has worked cohe-


152 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

sively for a decade, and it has involved in productive interaction researchers from the
disciplines of chemistry, computer science, genetics, philosophy, physics, mathematics,
electrical engineering, management science, and psychology.

It is difficult to give a recipe for this success, but we believe we can list some im-
portant ingredients. First, the task was conceived in such a way as to appeal to many
interests; it could have been described as a "pure" mass spectrometry problem, or a
"content-free" hypothesis formation problem, but it was not. This task is not prohib-
itively difficult: it can be understood (with a moderate effort) by anyone with a mod-
est technical background. One scientist, with knowledge of both chemistry and com-
puter science, was willing to coordinate and arbitrate the often-conllicting efforts of
the group, and was able to do it because others felt sufficient respect for this man's
ideas and vision to sacrifice some of the traditional autonomy and rugged individual-
ism of scientists. Not the least important, a natural selection has occurred, resulting in
a staff of specialists each of whom is truly willing to go more than half way to under-
stand the other's discipline, paradigms, and arcane jargon.

We may offer no magic advice here, but the lessons are important, and mistakes
are costly. In spite of the advantages this project has had, the going has been rough. In-
terdisciplinary work is antithetical to most scientists, no matter how wistfully they
long for it. It is expensive folly to establish a project or institute and fill it with scien-
tists from a variety of disciplines, selected only on the basis of scientific credentials.
Without leadership, specific common goals, mutual empathy and human consideration,
and a great deal of effort, the result will be a collection of scientists none of whom has
a colleague. Finally, it should be noted that it is not easy to get funds for a large, inter-
disciplinary project. It is important to find a sponsoring agency that is willing to invest
in long-term research, because continuity is critical. A team cannot be brought together
for productive research and disbanded more than once. We are grateful to ARPA and
NIH for providing such funding support.


CHAPTER
NINE

SUMMARY AND CONCLUSIONS

A key to DENDRAL `s success is its knowledge of chemistry, mass spectromeny,
graph mani~lation, and other technical material. Engineering the acquisition and use
of that knowledge was an enormous task. Both Dendral and Meta-DENDRAL are built
on a three-stage model of hypothesis formation-plan, generate, and test-that consti-
tu tes a model of scien tific discovery.

9.1 INTRODUCTION

The DENDRAL Project is a study of scientific reasoning. One major thrust of this
work has been the exploration of methods for acquisition, representation, and use of
knowledge. We have referred to the design of such methods as knowledge engineering.
In this chapter we will elaborate on this theme, which is the basic engineering aspect of
the work. An implicit second preoccupation of this work has been the collection of
observations about scientific discovery that might be pertinent to a more systematic
theory of discovery. In this chapter we will elaborate also on this theme, which is the
basic scientific aspect of the work.

9.2 KNOWLEDGE ENGINEERING

At the time of inception of the DENDRAL Project, the major emphasis of most AI re-
search was a search for general methods of problem solving. Relatively little effort was
devoted to the design of systems that embodied and used specialized knowledge. The
paradigm case of the search for general methods was research on the resolution method
of proving theorems in the predicate calculus, as developed by Robinson (1965) and

153


154 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

applied to a variety of problems [e.g., robotics; Raphael (1972)] by a number of com-
puter scientists. There were other important elaborations of this theme, for example,
the General Problem Solver [Ernst and Newell (1969)] , which we discussed in Chap-
ter 3. There were also notable exceptions, projects in which emphasis was placed on
specialized knowledge (chess and checker programs are good examples, as are symbolic
mathematics aids such as MACSYMA [Martin and Fateman (1971)] ; such work, how-
ever, was in the minority.

The situation today is quite the opposite. The search for general methods of prob-
lem solving is no longer the mainstream of AI research, while many significant projects
can best be characterized as the development and application of knowledge-based sys-
tems. Thus approximately 30 percent of the papers at the 1977 International Joint
Conference on Artificial Intelligence reported applications and specialized systems. It
is interesting that game-playing programs, particularly for chess, continue to thrive.

From the beginning, the DENDRAL Project pursued a strategy of encoding large
amounts of task-specific information into heuristic programs, a strategy now known as
"knowledge engineering." Indeed, the success and example of the Project in all likeli-
hood played an important role in the establishment of the new emphasis in AI, though
it was not the only force acting in this direction. We now are more convinced than ever
that the design of knowledge-based systems is an important emphasis, and a more pro-
ductive path at the moment than the search for general methods of problem solving.
We do not wish to argue that general methods of problem solving are a logical impossi-
bility. However, even if such methods are possible and attainable, they will not replace,
but merely augment, systems foi acquiring and using specific knowledge. With the ben-
efit of hindsight and a mature design of the DENDRAL system at hand, it is possible
to make this case more concretely.

We take it to be self-evident that problem solving in a specific task domain requires
special knowledge of that task domain. This was not contested, merely not empha-
sized, a decade ago. In a predicate calculus-based system, specialized knowledge was
encoded in the axioms, the theorem-proving procedures, and the criteria of interest; it
was not ignored. In GPS, specialized knowledge was encoded into the definitions of
the problem space and transformations; it was not ignored. What was not fully appre-
ciated was the sheer amount and variety of such knowledge underlying intelligent be-
havior. General methods went awry when the unavoidable profusion of specialized
knowledge swamped the heuristic methods and, further, outran the abilities of the
programmers to encode it all. This breakdown happened as soon as attention was di-
rected away from highly abstracted, simplified "toy" problems toward applications of
utility outside AI itself.

A surprisingly large amount of specialized knowledge is needed to achieve expertise
in even a very circumscribed field. The fact that long periods of time are required to
become an "expert" is evidence that expertise is knowledge-intensive. For example,
Simon and Barenfeld (1969) present evidence that the difference between expert and
novice chess players lies almost exclusively in their differing degrees of familiarity with
commonly occurring patterns of chess pieces, a familiarity reflected in speed of recog-
nition and ability to recall, and acquired by extended experience. It is estimated that
the chess expert is familiar with between 10,000 and 100,000 such patterns, which is


SUMMARY AND CONCLUSIONS 155

also the range of the word-recognition vocabulary of a fluent speaker. In addition to
pattern familiarity is a host of other knowledge that novice and expert alike must
share, and that passes unnoticed in a casual analysis of game playing. This knowledge
includes, for example, information about the nature and purpose of games and of com-
petition generally. In the case of mass spectrometry, the knowledge base includes not
only specialized knowledge of technique, but a large amount of information about the
underlying subjects of chemistry and graph theory, any portion of which may profit-
ably be brought to bear in the solution of a particular structure elucidation problem. A
prerequisite of successful performance by DENDRAL was the encoding of significant
portions of this knowledge base, a job that has taken thousands of man-hours.

To gain sufficient problem-solving power in the face of the needed quantity of
knowledge, a knowledge representation scheme must be sufficiently specialized;making
it so is a major part of the engineering problem. Consequently, successful knowledge
engineering initially requires decisions about knowledge representation; in particular,
specialized representations for specialized applications. A representation that is uni-
form for all tasks is doomed to impotence in problem-solving power, although we have
argued previously that uniformity of representation has significant advantages, within a
given task and for a given purpose. Thus the basic representation used by DENDRAL,
chemical graphs, is, we have noted, the glue that holds the system together and permits
various qualities of knowledge to combine effectively. However, chemical graphs are
manifestly not the appropriate knowledge representation for chess, or for speech un-
derstanding, or even for quantum mechanics. Furthermore, even though it is conceiv-
able though unlikely that some form of graph structure will suffice for encoding all
knowledge (just as it is conceivable though unlikely that some linear logical calculus
will suffice), it appears that the requirements of any given problem domain are so
specialized that the appropriate form of graph will be in turn so specialized as to di-
minish seriously the importance of whatever insight such a commonality of language
might hold. Therefore, knowledge representation takes on a status equal to that of
heuristic exploration in the struggle against combinatorial complexity.

To elaborate: the goal of knowledge engineering is to achieve a productive inter-
action of knowledge in the service of problem solving. An appropriate knowledge rep-
resentation is an encoding that productively relates information that is naturally related
in important ways in the referent application area. Further, it ought to do so in ways
that ease the burden of inference [see Lindsay (1961) and Lindsay (1973)] . To the
extent that a measure of the inferential burden can be borne by the representation
scheme, we have reduced the burden that must be borne by search and generation
heuristics.

To summarize: successful problem solving in nontrivial domains (1) requires sur-
prisingly large amounts of specialized as well as general knowledge, (2) requires differ-
ent forms of organization for different tasks, and for different purposes within a given
problem domain, (3) requires the productive interaction of this knowledge, not merely
its accumulation, and (4) can benefit from representation schemes that bear part of
the burden of the inferential process. For these reasons, which have the status of em-
pirical propositions about cognitive systems generally and human minds specifically,
we conclude that the current emphasis on knowledge engineering within AI, for which


156 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

DENDRAL is a key example and important case study, is both central and prerequisite
to the development of artifacts of general intelligence.

9.2.1 How Much Does DENDRAL Know?

It is frequently asked how much DENDRAL "knows." Unfortunately there is no
straightforward answer to this question. We can say, qualitatively, that DENDRAL em-
ploys a lot of knowledge, perhaps the equivalent of much of high school-level organic
chemistry, plus some specialized facts from college-level and even graduate-level chem-
istry. However, at present no theory offers a means to quantify knowledge, even when
knowledge is embodied in a form (such as a computer program) whose structure is in
principle completely explicit. Many difficulties impede the development of a quantita-
tive theory of knowledge.'

For example, it has frequently been pointed out that humans, and, with qualifica-
tions, computers, know in essence an infinite number of facts (to cite one instance, we
know the successor of any integer); and yet our memories are finite. Therefore, quanti-
tative theory must be able to handle inferential, generative knowledge of this sort.

Two additional major difficulties are, first, that any piece of knowledge is mean-
ingful only in a larger context of other knowledge, and, second, that cognitive capacities
can be represented in indefinitely many ways.

  For example, we may assert that DENDRAL knows that the valence of carbon
is 4. Knowing this fact, however, presupposes that the concepts of valence, atom,
and a constellation of related concepts are also in some sense understood. (Even so,
DENDRAL's concept of valence is clearly not the same as a chemist's, which is im-
bedded in an even richer context of related knowledge.) It is, furthermore, knowledge
that is distributed throughout many subprograms that define and manipulate chemical
graphs, or in some way make use of facts such as "the valence of carbon is 4." It
would be nearly impossible to separate those pieces of DENDRAL computer code that
in one way or another are associated with an understanding of valence from those that
are not.2

In analyzing the issue of multiple representations of knowledge, the conventional
distinction between "knowing how" and "knowing that," though itself not precise, is
a helpful starting point. In the case of the majority of programmed algotithms (Section
3.2.1) it is often possible to distinguish processes from propositions (facts, data, and
parameters), corresponding to the distinction between knowing how and knowing that.
Even when this division is possible, however, it must be remembered that there exist
many different but functionally equivalent, and hence equally "knowledgeable ," pro-
grams that divide their knowledge in different ways between processes and facts. For
example, a stored table of logarithms and a program for computing just those loga-

lWhile we are not prepared to propose such a theory, we can make an important terminologi-
cal suggestion. In analogy to the accepted unit of information, the bit, we propose to call the unit
of knowledge the knit. The unit of wisdom would then, of course, be the purl.
2Some of the programs have been more meticulously written in this regard than others. For ex-
ample, INTSUM always references the valence of chemical atoms through a single function. How-
ever, the more general concept of connectivity of graphs, which subsumes valence, is part of the
whole framework assumed by almost all functions.


SUMMARY AND CONCLUSIONS 157

rithms know the same amount, although the former program is based on knowing that,
while the latter is based on knowing how. Further complications arise from program
structures such as productions. A set of productions is a peculiar combination ofknow-
ing how and knowing that; it is a propositional description of a process, a sort of
"knowing that this is how."

A count of how many facts DENDRAL knows, even if this were possible, would
not be a fair description of its total knowledge, since much of its knowledge is em-
bodied in executable code. In combining different kinds of knowledge we almost need
to abandon static metrics altogether in favor of comparing the dynamic uses of the
facts and procedures. For example, we might compare the times each of two bodies of
knowledge takes to reach a result.

Heuristics further muddy the waters. To mention just one major problem, much
heuristic knowledge is uncertain ("this method frequently works but is not guaran-
teed"). While information theory tells us how to quantify the information content of
an assertion based on its a priori probability of truth, we have no comparable means
of deciding the quantity of knowledge conveyed by probabilistic statements such as
heuristics. Gaschnig (1977) explores related problems of measuring the power of
heuristics. All such measurements, however, are dependent on the actual implementa-
tion of the knowledge in the program.

Finally, even knowledge that appears to be neatly parceled into individual facts
cannot simply be counted. To do so meaningfulIy would require, first, the develop-
ment of a precise calculus permitting decomposition of each complex fact into canoni-
cal form so that its components could be counted. One candidate for such a calculus
would be computer machine code: amount of knowledge would be the number of
compiled instructions needed to store it. For many reasons, among them the sensitivity
of this measure to the seemingly irrelevant factor of compiler efficiency, this enumera-
tion is not a satisfactory answer. Instead, the thrust of the initial question presupposes
a semantically interpreted calculus of a form that corresponds to human cognitive
organization. Needless to say, such a calculus is not at hand. We do not know what a
maximally compact form for knowledge would be, nor would we know how to prove
that it is such. We use abstractions for complex facts and procedures (e.g., macros, in
programming terms) as a means for compacting the symbols used for expressing the
knowledge. But we must not forget that these compact forms embody much semantic
information. One of the most important issues of science is the organization of knowl-
edge including the use of abstractions for condensing it.

For these reasons any list of what DENDRAL knows in terms of concepts, facts,
and processes is of limited descriptive power. Nonetheless, we will attempt to classify
the content of DENDRAL's knowledge of chemistry in the table below. [See a similar
discussion of what Winograd's SHRDLU knows in Boden (1977) pages 134-142.1

DENDRAL's Knowledge of Chemical Concepts and Procedures
1. Knowledge of chemical graphs
  a. Atom types (C, H, N, 0 plus provision for adding others)
b. Valence of each atom type
  c. Atomic weight of each atom type


158 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

d. Bond types (single, double, triple, aromatic)
e. How to detect topological symmetry
f.  How to compute degree of unsaturation from empirical formula
g. How to draw reasonable planar projections of molecular structures
h. How to generate all isomers including fused rings, spiro forms, etc.
i.  How to generate all stereoisomers
j.  How to find cycles and arbitrarily complex subgraphs
k. How to find the greatest common subgraph among a set of graphs
1.  How to label nodes and edges of graphs in all distinct ways, taking account of
  symmetry

m. How to simulate specific chemical transformations, such as synthetic reactions
2. Knowledge of chemical stability
  a. Twenty classes of unstable acyclic structures known; any others can be specified
b. How to recognize keto-enol tautomerism; other tautomers can be specified
c. Terpene rule
d. Isoprene rule
e. Bredt's rule

3. Knowledge of mass spectrometry
  a.  How to infer the formula of any molecular ion
b. How to compute results of any specified fragmentation and rearrangement
  c. How to predict metastable peaks and use them for confirmation of inferences
d. Rule of charge placement on fragments (but not on atoms)
  e. Half-order theory produces rough prediction of actual spectra
f.  Refined theory can be added for any family of structures (now available for
  ketones, ethers, alcohols, amines, thiols, thioethers, estrogenic steroids, keto-
   androstanes, marine sterols, and aromatic acids)
g. McLafferty rearrangement, water elimination, carbon monoxide elimination,
   carbon dioxide elimination, and elimination of other user-defined "neutral
   species"
h. Distinguishes high- and low-resolution spectra
i.  Distinguishes low voltage and high voltage measurements
4. Knowledge not available to DENDRAL
  a. Three-dimensional structure (except of stereoisomerism)
b. Polymeric structures
  c. Quantum mechanical explanations of mass spectrometry processes
d. Electronegativity
e. Physical properties such as dipole moment, molecular susceptibility, melting
   point, crystal structure, and many others

In addition, all the knowledge of LISP is presupposed by the DENDRAL programs.
For example, arithmetic and set theoretic operations, symbol manipulation, interpreta-
tion of complex procedures, and countless bookkeeping operations. Considerable
amounts of code are devoted to keeping track of intermediate results in the overall
processing. This "specialized bookkeeping" knowledge is not very profound, yet it is
indispensable for the integration of many complex procedures.


SUMMARY AND CONCLUSIONS 159

Almost all DENDRAL's knowledge is tailored to the task of molecular structure
elucidation. In spite of the elegance and simplicity of computing concepts we have to
work with, the problem-solving procedures in DENDRAL are still very special purpose,
complex, and voluminous. Making the procedures, and knowledge base, more general
would have increased the burden of debugging them in most cases.3

9.2.2 How Is Knowledge Employed in Heuristic DENDRAL and
Meta-DENDRAL?

In Chapter 3 we described the organization of problem-solving systems. The major bi-
furcation was between algorithms and heuristic programs. Heuristic programs were
further characterized as either search through a space of subproblems or as generation
of candidates from a space of potential solutions. It is also possible that a problem
space consists of partial solutions, as in the HEARSAY speech-understanding system,
[Erman and Lesser (1978) among others] . A space of partial solutions is in effect a
combination of a space of solutions and a space of subproblems.

In either case, search or generation, the alternatives considered may be limited to
those known to be legal according to a given rule, or to those that are merely plausible.
In each case, problem solving may terminate with the discovery of a satisfactory solu-
tion, or proceed until the optimal solution is found.

To this initial division of heuristic programs, we added the concept of planning as
exemplified by the planning phase of DENDRAL's basic solution generation method.
More generally, the use of planning can lead to computational economies in two ways.
Planning can prune the space (of subproblems or solutions) by eliminating sections of
it and directing search to certain other sections, or it can guide the problem solving,
either by ordering the search/generation sequence, or by modifying one subproblem/
solution candidate to produce the next, using a hill-climbing (evolutionary) method.
In the hybrid case of a space of partial solutions, both pruning and guidance methods
are applicable.

Planning, furthermore, may be characterized along a different dimension. It may
be data-driven or expectation-driven. Data-driven planning begins by examination of
data (from instruments, perhaps) and attempts to induce hypotheses to account for it.
Expectation-driven planning begins with a model of the phenomenon and uses it to es-
tablish expectations.

  It is possible to establish a taxonomy of problem-solving systems based on these
four binary characteristics: (1) subproblem space versus solution space, (2) legal versus
plausible alternatives considered, (3) pruning heuristics versus guidance heuristics, and
(4) data-driven versus expectation-driven. While such a taxonomy is useful, it should
be remembered that the values of these dimensions are not mutually exclusive nor ex-
haustive, and indeed greater power will probably derive from future systems that com-
bine these methods in various ways.

Heuristic DENDRAL may be characterized as a generaroor of 1eguZ solutions with

3For these reasons, we look forward to advances in automatic programming that will simplify
the programming, debugging, and interfacing of complex procedures.


160 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

pruning by expectation-driven heuristics. Meta-DENDRAL may be characterized as a
generator of plausible solutions with pruning by both expectation-driven and dara-
driven heuristics. Within this design remain several variations. For example, the
DENDRAL generator is based upon a canonical form of hypothesis, and is nonredun-
dant and exhaustive. These are desirable features but will not be available for all ap-
plications. However, if a particular application does not yield a generator with these
properties, planning may still be possible, and the system can achieve considerable
power simply from a systematic application of knowledge.

9.3 SCIENTIFIC DISCOVERY

Meta-DENDRAL evolved in a natural way from Heuristic DENDRAL. The concept
of a generator of hypotheses is particularly transparent in the case of Heuristic
DENDRAL, and the hypotheses themselves were simple in structure. The under-
standing achieved from the Heuristic DENDRAL system made possible the evolution
of Meta-DENDRAL, in which the hypotheses took on a complexity much closer to
that of the usual conception of a scientific hypothesis. We now feel that we have gamed
some insight into the larger issues of scientific discovery in the Baconian spirit of ra-
tional directions to the uninitiated for formulating scientific hypotheses.

9.3.1 Historical Background

There is a substantial literature on the problem of induction (briefly, how one may
pass from particular statements to universal statements), which, following Bacon, has
traditionally been proposed as the basis of scientific discovery, and is so presumed to
be in ordinary discourse. However, most contemporary philosophers of science disa-
gree with this view. For example, Medawar (1969) discusses induction at length and
concludes that it is not the basis of scientific discovery. He argues, as have other recent
writers, that science proceeds by a hypotheticodeductive scheme, that is by discovery-
the invention of theories-followed by verification-the comparison of theoretical pre-
dictions with empirical observations. These two components pose two basic questions
for the philosophy of science. The first is the problem of discovery, that is, how hy-
potheses arise. The second is the problem of verification, that is, the relation of a given
hypothesis to evidence.

The question of scientific discovery, when not ignored altogether, is frequently
relegated to psychology, which has yet to embrace it. There is no disciplined effort to
collect well-documented narratives of discovery in science. The result is that almost
nothing has been established about the nature of scientific discovery other than a col-
lection of poorly documented anecdotes about how ideas "arise" in scientists' mind,
often while they are engaged in nonscientific pursuits: the eureka hypothesis. For ex-
ample, Medawar characterizes the discovery process as "an imaginative preconception
of what might be true" (p. 51) that is mediated by "inductive intuition": ". . . thinking
up or hitting on a hypothesis from which whatever we may wish to explain will follow
logically" (p. 56). This process he calls the generative act of scientific discovery and is


SUMMARY AND CONCLUSIONS 161

bold enough to suggest "That `creativity' is beyond analysis is a romantic illusion we
must now outgrow" (p. 57).

Some writers have indeed harbored this "romantic illusion," dismissing the possi-
bility of any serious study of the question of scientific discovery. For example, Popper
(1968, p. 31) states, in a book entitled The Logic of Scientific Discovery:

I said above that the work of the scientist consists in putting forward and testing theories.
  The initial stage, the act of conceiving or inventing a theory, seems to me neither to call
for logical analysis nor to be susceptible of it. The question how it happens that a new idea
occurs to a man-whether it is a musical theme, a dramatic conflict, or a scientific theory-
may be of great interest to empirical psychology; but it is irrelevant to the logical analysis of
scientific knowledge.

9.3.2 The Plan-Generate-Test Model of Discovery

Our central point here is to elaborate the idea that scientific discovery can be profit-
ably viewed as a systematic exclusion of hypotheses. This view is another instantiation
of the plan-generate-test paradigm. The conditions under which this view makes sense
are an important part of the elaboration. Two necessary conditions are that the space
of relevant hypotheses is definable, and that criteria of rejection and acceptability
exist. Because the space of hypotheses is immense for most interesting problems, it is
also desirable that criteria exist for guiding the systematic search.

The method of proof by eliminative induction, advanced by Bacon and Hooke,
was dropped after Condillac, Newton, and L&age argued successfully that it is impos-
sible to exhaustively enumerate all the hypotheses that could conceivably explain a set
of events [Laudan (1973)]. The method advanced in our work is in some sense a re-
vival of those old ideas on induction by elimination, but with machine methods of gen-
eration and search substituted for exhaustive enumeration. Instead of enumerating all
sentences in the language of science and trying each one in turn, a computer program
can use heuristics enabling it to discard large classes of hypotheses and search only a
small number of remaining possibilities. However, a high price may be paid for reduc-
ing the search: sometimes the inquirer will not see the best solution, or perhaps may
not see any solution.

9.3.2.1 The source of scientific hypotheses Kuhn (1962), in his well-known analysis
of the history of science, introduces the concept of a scientific paradigm. Before the
establishment of a paradigm, a science is in a presystematic, natural history stage,
characterized by competing theories and emphases. With the ascendence of a theory
that gains wide acceptance-the paradigm-research is of a different type, which Kuhn
calls normal science. This stage is characterized by general agreement as to what are
the key conceptual problems and accepted experimental techniqu&, and what empiri-
cal data demand explanation. Discovering hypotheses in the natural history stage of a
science is not like discovering hypotheses in the more advanced theoretical stages of
the science. (But it should be remembered that these stages may be found in one
science at the same time, and that they are not clearly separable.) In the natural his-
tory stage the discovered hypotheses are often universal generalizations about observ-


162 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

ables. These hypotheses serve less as explanations than as descriptions of regularities in
the universe; one might well ask why the generalization holds, thus asking for a higher-
level statement to explain the observed regularity, that is, for a theory in terms of
which the regularity can be explained. On the level of descriptive science, the inductive
generalization is a reasonable discovery to expect, but on the level of explanatory
theory we expect more than a description of what is the case; we expect to discover
hypotheses that explain why the lower-level generalizations hold.

As a result of distinguishing descriptive science from explanatory science, it would
seem that simple inductive inferences, using the vocabulary of a fured model, may lead
to discoveries of useful hypotheses in the descriptive stage but not in the more ad-
vanced, theoretical stage. Also it becomes apparent that in the two different stages
there are different criteria for what will count as a useful hypothesis. The purpose of
hypotheses in the natural history stage of science are mainly for description and classi-
fication, but in the explanatory stage they are to explain phenomena and unify diverse
explanations. This separation of the descriptive from the explanatory aspects of scien-
tific inquiry also suggests that there are probably different logics of discovery for these
activities.

In general, the problem for a logic of discovery is twofold: to choose a language L
in which to express hypotheses explaining data in a scientific domain, and to choose a
satisfactory sentence of L that explains the data. In paradigm revision, the first half of
the problem is crucial, for the choice of the language establishes boundaries on the
factual content of the paradigm. Choosing to speak of light as traveling, to use an ex-
ample suggested by Touhnin (1961), determines in large measure the kinds of ques-
tions we ask about light and the kinds of answers the paradigm will furnish. On the
other hand, in normal science choosing a language is not part of the problem, for the
language in which hypotheses are expressed is just the language of the current para-
digm. That is, once a paradigm is established, normal scientists describe their work
within that language; only when description and explanation within the language of
normal science fail do scientists again face the problem of choosing a new language in
which to express their hypothesis.

Although we have not learned how to engineer the formulation of new vocabular-
ies, we believe that combinatorial play at various levels of abstraction is the key to
thinking about it. We disagree with the widely held view that there is no method un-
derlying the creation of new terms in the language of science.4

The second half of the problem-choosing one of the sentences of L to serve as a
hypothesis-is a problem that the DENDRAL program addresses. The problem, in gen-
eral terms, is to find efficient methods for picking out sentences of L that are most
likely to succeed as hypotheses in a given class so that the inefficient process of enu-
merating sentences and trying one can be avoided. It is clear that scientists do not re-
sort to an enumeration and one-by-one trial of sentences of L, for we would expect
little or no progress in science with such inefficiency.

4For example, Bronowski (1966, p. 6) clearly states this view: "We do not know; and there is
no logical way in which we can know. . . The step by which a new axiom is added cannot itself be
mechanized. It is a free play of the mind, an invention outside the logical process."


SUMMARY AND CONCLUSIONS 163

We could consider discovery to be merely successful guessing, as is often suggested,
and program a machine to perform random generation of hypotheses-perhaps re-
strained within the correct subject area. It could test each random hypothesis against
the criteria of success and stop when a hypothesis met the criteria of reasonableness.
Although some inquiring minds may work in this random manner, it hardly recom-
mends itself as a rational method.

The trial-and-error method might not be as irrational as first appears, however, for
the trials can be selected by other than random means. As Polya (19.54, p. 26) sees this
method :

   . . . it consists of a series of trials, each of which attempts to correct the error committed
by the preceding and, on the whole, the errors diminish as we proceed and the successive trials
come closer and closer to the desired final result.

Because the method does not rely on random trials, Polya prefers calling this the
"method of successive approximation." He notes the widespread use of the method in
mathematics and from such tasks as finding a word in a dictionary to proposing scien-
tific theories that are better and better explanations of phenomena. Using this progres-
sive warming (hill-climbing) method, however, depends on (1) seeing what is wrong
with any guess and (2) seeing how to correct it. If either of these conditions is not
met, then the method does degenerate into random guessing, for the inquirer (either
human or machine) has no direction for further guessing. Moreover, the techniques for
performing (1) and (2) must be highly sophisticated in order to transform an initial
guess into a solution of the problem in a reasonable amount of time. For instance,
hundreds of things may be wrong with one of the initial guesses at a solution, but the
techniques for (1) should point to the error whose correction will most advance our
progress toward a solution. And, correspondingly, the techniques for (2) should cor-
rect the error in the way that most closely approximates a solution.

Hill-climbing methods to reach scientific truths from approximation were perhaps
first advocated by Hartley and L&age in the eighteenth century [Laudan (1973)].
Borrowing from the success of the mathematical method of successive approximation,
they argued that positing hypotheses and correcting them will lead to truths in science.
Unfortunately, they did not specify the technique for modifying or replacing false hy-
potheses. Even through the nineteenth century, as Laudan (1973, p. 285) notes, "Every-
one assumes that science is self-corrective (and thereby progressive), but no one both-
ers to show that any of the methods actually being proposed by methodologists are, in
fact, self-corrective methods."

Another method we could consider using is means-ends analysis, as used success-
fully in several computer programs, most notably the General Problem Solver (GPS).
As we saw earlier (Section 3.2.2.1), this method is also a form of hill climbing. The
procedure may be applicable for transforming the data into an explanation and for sys-
tematization of the data. Reducing the differences would be a powerful tool for hy-
pothesis formation if the conditions that define "explanation and systematization"
can themselves be made precise.


164 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

9.3.2.2 Guiding the consideration of hypotheses Philosophers of science have not
framed the problem of hypothesis formation and testing to include formulation of con-
straints on acceptable hypotheses. We suggest that it is important to do so. That is to
say, the planning stage of the process is of key importance.

9.3.2.3 Checking the hypothesis Another necessary condition for any successful
problem-solving activity is that a solution to the problem can be recognized if it is
found; that is, that there be well-defined boundaries on what will count as a solution
to the problem.

In the search for a reasonable hypothesis for some purpose, the inquirer must,
then, have some criteria by which to judge when the search terminates successfully.
And for this reason, criteria of reasonableness must be made precise before a logic of
suggestion can be developed. Thus, alI the problems of making the criteria precise
carry over to the search for methods of hypothesis formation; without the criteria the
methods could not be developed systematically.

9.3.3 Outline of a Model of Scientific Discovery

Embodied in both the Heuristic DENDRAL and the Meta-DENDRAL systems is a
method of discovery. We here propose that this method might underlie scientific dis-
covery in other areas and suggest that its basic characteristics have the status of a the-
ory of scientific discovery, though possibly incorrect and clearly incomplete (as mea-
sured against the suggestions we have just discussed). The basic claims of such a theory
are the following.

1. Scientific discovery uses the same basic methods of problem solving as do
other scientific reasoning and other forms of problem solving.
We note that Meta-DENDRAL is not much different in organization from Heuris-
tic DENDRAL. Both are a species of plan-generate-test. Both are guided by a strong
model of the domain, although MetaDENDRAL does coarse search first. It was a sur-
prisingly small step from Heuristic DENDRAL to Meta-DENDRAL. No basic additions
or reorganizations of the problem-solving methbd were required, even though in the
latter case the results of problem solving are hypotheses (in the form of productions)
that embody a limited scientific theory (concerning the behavior of a class of com-
pound in the mass spectrometer).

2. Scientific discovery is judicious selection from a `space of possible hypotheses
by heuristic exploration.

A cognitive agent has means for generating either the members of a set of possible
hypotheses or the states of a problem space. This ability is productive in the sense that
human language is productive (as discussed by linguist Noam Chomsky): a large set of
novel combinations of a ftite set of elements can be generated even though none has
been previously encountered in the experience of the scientists.
3. In exploring the space of possible hypotheses, the scientist is strongly influ-
enced by initial assumptions.

Heuristic DENDRAL is a theory-driven mechanism: it finds only what it is look-


SUMMARY AND CONCLUSIONS 165

ing for. For example, if it does not expect to find solutions (organic compounds) con-
taining certain substructures, as signified by the presence of these substructures on
BADLIST, then they are not generated. It is just such biases, (and the more the better),
that allow the programs to discover a manageable set of candidates at all.
The question arises from whence these biases issue when they take the form of
predisposition toward certain types of theories. The answer in the case of Meta-
DENDRAL is that they arise from presystematic notions about mechanisms underly-
ing the phenomena of MS behavior, as derived from yet other theories: the scientific
paradigm of the discipline. The particular forms that the generated theories take is ini-
tially dictated by observations (data) and refined by interactions of data and criteria
of explanatory power. We have nothing to say about the origins of new paradigms; the
nature of the ways in which the initial forms arise and are refined are the subjects of
items 4 and 5.

4. Scientific problem solving in general, and discovery in particular, outside the
well-codified areas of science, involves the employment of a large number of vague and
unverified ideas, rather than the application of logical deduction to previously verified
propositions.

It is clear that Heuristic DENDRAL does not have at its core a formal theory of
chemical stability, but rather employs a large collection of weak partial assumptions
each of limited range. Nor does Meta-DENDRAL have at its core a formal metatheory
of MS theories. We propose that this lack of formal theory is the rule in scientific dis-
covery, in contrast to the classical description of scientific method as tight reasoning
from established premises. Again, contemporary writers have expressed a similar opin-
ion; what DENDRAL contributes is substantive detail in elaboration of this view.
5. Scientific problem solving in general, and discovery in particular, is an interac-
tion of top-down (expectation-driven) exploration, and bottom-up (data-driven) ex-
ploration. Both are necessary.

Heuristic DENDRAL is driven largely in a top-down manner. However, the
data (spectra) are employed by MOLION in planning and after the hypotheses are at
hand, when PREDICTOR attempts to winnow the set of candidate solutions. Meta-
DENDRAL by contrast is driven in both directions. First the spectra are used, by
INTSUM, to establish the hypothesis space. The hypothesis space is then used, by
RULEGEN, to produce candidate solutions (hypotheses). Finally, the data are again
used to refine the set of hypotheses into a more manageable, parsimonious theory.
6. A generator that fails to guarantee completeness is not wholly satisfactory,
since one then cannot say with certainty what hypotheses h&e been excluded from
consideration.

7. A generator that cannot avoid duplicate (or equivalent) expressions of the
same hypothesis is not wholly satisfactory, since the generation may never terminate.
8. Knowledge employed early in the exploration constrains the search more effi-
ciently than knowledge employed later.

9. Knowledge about classes of hypotheses is more effective than knowledge about
individual hypotheses.

10. A small set of plausible alternative hypotheses resulting from the generation
and testing may be as valuable as a single hypothesis.


166 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

The upper bound on the acceptable size of the found set varies with problem
complexity and with the ease of discriminating among the alternatives by other means.

Aside from the plausibility of this theory that inheres in the existence of success-
ful programs, no specific data support it. The theory itself suggests where we might
look for support, of course, since we now have it as a source of expectations. There is
anecdotal support in abundance. If the normal mode of processing empirical data is to
verify expectations, as our theory has it, then science should appear essentially con-
servative, that is, exhibit few novel theoretical formulations. Kuhn (1962) argues this
point at length. However, it is not our intent here to argue the validity of this theory,
only its plausibility. The proposed elements characterize a theory of scientific discov-
ery that, we have noted, has few competitors. The details of the DENDRAL programs
as presented in the earlier chapters richly illustrate ways of making this theory specific
and suggest numerous alternative specifications.

As an example of one particular form such a theory might assume, we present
the following description that follows in some detail the existing architecture of
Meta-DENDRAL.

1. Presupposed is a paradigm that provides a set of concepts deemed relevant and
important, a model of their interrelationships, and a generative grammar that
defines the ways in which these elements may be meaningfulIy combined to state
hypotheses.

2. Empirical observations, assumed to be sufficiently reproducible, are selectively ex-
amined by looking at those features of them that the paradigm suggests are signifi-
cant. These abstracted descriptions of the data are examined by simple pattern-
recognition processes to detect important regularities.
3. Separate hypotheses are constructed to explain each detected regularity by gener-
ation (using the grammar described by the paradigm) guided by planning (based
on limitations of complexity also proposed by the paradigm).
4. The collected set of hypotheses is examined and reduced by the elimination of
those that make small or redundant contributions to the account of the data.
5. The set of hypotheses is modified by generalizing each in turn, and specializing
each in turn, in an iterative procedure that refines the set under control of the na-
ture and quantity of correct and incorrect predictions made by the changing set of
hypotheses, until criteria of generality and simplicity are met.
6. At each of the above steps, highly task-specific knotiledge is employed in varied
ways as heuristic methods of search, as stopping rules, and as measures of good-
ness of fit. Any particular theory of scientific discovery must perforce be domain-
specific in large measure.

Under our analysis the traditional problem of finding an effective method for dis-
covering true hypotheses that best explain phenomena has been transformed into fmd-
ing heuristic methods that generate plausible explanations. The problem of giving rules
for producing true scientific statements has been replaced by the problem of fmding
efficient heuristic rules for culling the reasonable candidates for an explanation from
an appropriate set of possible candidates.


SUMMARY AND CONCLUSIONS 167

In the most creative heights of science, hypothesis formation is farthest from the
"reach of method" as Whewell (1858) says. But within the comfort of an established
scientific theory, paradigm, or conceptual scheme, hypothesis formation usually does
not involve the introduction of new concepts. The concepts are given and the task of a
logic of suggestion is to show how hypotheses should be formulated in terms of these
concepts. Depending on the purposes at hand, and in part on the science, the hypothe-
sis may either explain a puzzling phenomenon (or set of phenomena) or describe ob-
jects and events within the scope of the science.

The problems with formulating this kind of logic of discovery are both difficult
and numerous. Before any methods, heuristic or otherwise, can be given for "discover-
ing" explanations or regularities, a precise conception of success for the logic must be
formulated. When criteria are clarified and refined for the specific science considered,
then the methods could be said to succeed when they produce hypotheses that meet
the criteria. The methods themselves will also be difficult to formulate in specific in-
stances because of the difficulties in understanding the problem, representing the space
of possible solutions, dividing the task into subproblems, and planning a solution, to
mention the outstanding ones.

To a modest degree, the Heuristic DENDRAL and MetaDENDRAL programs cap-
ture many of the notions of a logic of discovery. They are more systematic and less
random than we have come to expect of creative guessers in science, but their methods
are also more teachable and their results more reproducible.

9.3.4 Limitations of Computer-Aided Discovery by Heuristic Search

The major limitation of the heuristic search method in any domain is the necessity of
fmding (or inventing) a generator of possible solutions. In the rule-formation domain,
that necessity means that we have to invent a program that generates possible rules.
That, in turn, requires a strict definition of the allowable forms of the rules and a def-
inition of the allowable primitive terms that add content to the form. The representa-
tion we have found for expressing rules is fixed for any one run, but can, at least, be
modified or extended manually between runs. In the case of molecular structures,
finding the generating algorithm took many years. Lederberg's notational algorithm
for unringed graph structures was mapped into a generating algorithm with little diffi-
culty, but the symmetries of cyclic graphs complicated the generation problem irn-
mensely. Not until considerable mathematical expertise had been focused on the prob-
lem was a generator Invented that carried guarantees of complete and nonredundant
generation.

A second major limitation on heuristic search is the necessity of finding heuristics,
rules of thumb, that guide the generator and constrain it from producing all syntacti-
cally allowable hypotheses. For rule generation it is necessary to find heuristics that
steer the generator toward the small number of interesting rules and away from the
very large number of uninteresting rules. The problem is that it is difficult to find
these guiding principles. In addition, putting confidence in the heuristics requires an
act of faith. Once that step is made, however, the temptation is often to put too much
faith in the heuristics and forget that the solutions were found in the context of a large
number of assumptions. For example, one might tend to forget the criteria for data frl-


168 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

tering, or the range of allowable hydrogen transfers, or the restrictions on how com-
plex the rules were allowed to become, or the criteria for filtering the rules. All the
heuristics together define the range of rules considered and thus should temper our
judgments about the generality of the rules.

Another limitation on the use of heuristic search is that the computer programs
are often slow, not because they are inefficient so much as that they must do a lot of
computation. The Meta-DENDRAL program is also inefficient now because it is still in
the development stage. This practical difficulty limits the sizes of the problems the
programs can solve now. Since CONGEN can readily solve some problems complex
enough to challenge and interest human chemists (as can Meta-DENDRAL, with some
difficulty), the method at least has proved feasible.

Limitations are also imposed by the domain of chemistry, which have been men-
tioned elsewhere. To reiterate, the programs work with a connectivity model of chemi-
cal structures, without knowledge of geometric properties. Nearly everything that a
chemist can tell the programs needs to be expressed in terms of subgraphs. Also, the
programs depend on a chemist's judgment for their chemical heuristics. (This depen-
dence is also a strength as well as a limitation.)

9.4 THE PROSPECTS FOR AUTOMATIC SCIENCE

DENDRAL illustrates the state of the art in automatic hypothesis formation. It can
lay claim to this position not merely because it has few competitors at the moment,
but because it has been a thorough, sustained effort by an interdisciplinary group of
scientists. The scope and power of the program are therefore a good indication of what
can be done with the technology of today. Our forecast for the immediate future is
optimistic for projects of modest scope, attacking well-defined scientific problems in a
manner that allows the full power of the human mind to be augmented by the comple-
mentary powers of the computer.

How far this endeavor can be carried and what ways it will change in the future
we can only guess, We realize that proposing significant mechanization of scientific
thought, or of any cognitive ability that to date has been uniquely human, is contro-
versial and problematic and leaves one open to accusations of committing the sin of
pride. But surely, since man did not design man, it is no more prideful to suppose that
the human mind was created to be sufficiently percipient, sentient, and conscious to
understand itself than to suppose that it is not. Our reverence for the human mind is
undiminished, indeed is enhanced, as we explore it more deeply. We recognize that the
bases for its abilities and the boundaries of its potential are yet shrouded in mystery.
Nonetheless, we remain impressed by the rapid growth of knowledge and technology
and are tempted to extrapolate it beyond our vision. From Pascal, Babbage, and Turing
to the hand-held, programmable, microsecond computer of today is a step of awesome
compass. Yet the human mind has been neither replaced nor enslaved, but freed for
grander enterprises. That is a prospect with which we can live.


CHAPTER
TEN

PROJECT PUBLICATIONS

This chapter contains a partially annotated, chronoZogicaZ list (by date of writing) of
DENDR4L Project publications. A complete, alphabetized list of references for the
citations in the text follows. That list includes all items from this list of Project publi-
cations, without annotations.

1. Lederberg, J. Computation of molecular formulas for mass spectrometry. San Francisco:
Holden-Day, 1964.
A brief text in the Holden-Day series on physical techniques in chemistry. Presents mass spec-
trometry as a useful tool for organic chemists, and introduces procedures for simplifying the
anaiysis of mass spectrometry data. Intended for calculations performed without the aid of a
computer.

2. Lederberg, J. DENDRAL64, a system for computer construction, enumeration, and notation
of organic molecules as tree structures and cyclic graphs, part I. Notational algorithm for tree
structures. Report No. CR-57029 and STAR No. N6S-13158. National Aeronautics and Space
Administration, 1964.
The first of a series of three technical reports to NASA. Introduces the DENDRAL notation
and the DENDRAL algorithm for generating aII the structural isomers of a given formula.
Deals with those chemical graphs that are pure trees.
3. Lederberg, J. DENDRAL64, a system for computer construction,`enumeration and notation
of organic molecules as tree structures and cyclic graphs, part II. Topology of cyclic graphs.
Report No. CR-68898 and STAR No. N66-14074. National Aeronautics and Space Adminis-
tration, 1965.
The second of three technicaI reports to NASA. Introduces the notion of Hamilton circuits as
a scheme for constructing canonical names of cyclic graphs. This notational algorithm did not
bear fruit as a generating algorithm.
4. Lederberg, J. TopologicaI mapping of organic molecules. Proceedings of the NationaI Academy
ofsciences, 1965,53:1,134-139.
Summarizes the notions introduced in the series of technkai reports to NASA [Lederberg
(1964b), (1965b), and (1970)]. A clear and nontechnical presentation of an algorithmic
approach to the topological mapping of organic molecules.

169


170 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

5. Lederberg, J. Systematics of organic molecules, graph topology and Hamilton circuits, a general
outline of the DENDRAL system. Report No. CR-68899 and STAR No. N66-14075. National
Aeronautics and Space Administration, 1966.
A general introduction to the DENDRAL system for chemical structure notation; an intro-
ductory survey of the notions underlying that notation.
6. Lederberg, J. Hamilton circuits of convex trivalent polyhedra (up to 18 vertices). American
Muthematicu~Monthly, 1961,74:5,522-521.
The first six papers contain the seminal ideas of the DENDRAL project. This paper discusses
procedures for finding Hamilton circuits and presents an algorithm for finding Hamilton clr-
cuits of acyclic graphs.
7. Sutherland, G. L. DENDRAL-A computer program for generating and filtering chemical struc-
tures. Stanford Artificial Intelligence Project Memo No. 49. Stanford, Callf.: Stanford Univer-
sity, Computer Science Department, 1967.
The first paper to discuss the DENDRAL computer program, in an early version. A fairly tech-
nical paper intended for the computer science or the chemistry audience. Gives the specific
details of the subprograms that constitute this version of DENDRAL. Contains a BADLIST
but as yet no GOODLIST. This version has been superseded by later work.

8. Lederberg, J., and E. A. Feigenbaum. Mechanization of inductive inference in organic chemi-
stry. In B. Kleinmuntz (Ed.), Formal representation of human judgment. New York: Wiley,
1968, 187-218. Also Stanford Artificial Intelligence Project Memo No. 54. Stanford, Calif.:
Stanford University, Computer Science Department, 1967.
A summary description of the Heuristic DENDRAL program from the standpoint of artificial
intelligence research. A general discussion of the notions involved in the DENDRAL approach;
does not presuppose much technical chemistry knowledge. (The program now includes a
GOODLIST.) A very clear discussion and evaluation of the DENDRAL approach.
9. Feigenbaum, E. A., J. Lederberg, and B. G. Buchanan. Heuristic DENDRAL: A program for
generating explanatory hypotheses ln organic chemistry. In B. K. Kinariwala and F. F. Kuo
(Eds.), Proceedings of the HQWQii International Conference on System Sciences. Honolulu:
University of Hawaii Press, 1968,482-485.
A brief general description of Heuristic DENDRAL for the artificial intelligence community.
Gives an overview of the selection of the problem area, the data for the program, and its capa-
bilities at an early stage of development.

10. Lederberg, J. On line computation of molecular formulas from mass number. Report No. CR-
94977. National Aeronautics and Space Administration, 1968.
A brief technical report to NASA describing a program written at Systems Development Corpo-
ration for computing molecular formulas from mass number. Primarily announcing the exis-
  tence and value of this program.

11. Buchanan, B. G., G. L. Sutherland, and E. A. Feigenbaum. Heuristic DENDRAL: A program
for generating explanatory hypotheses in organic chemistry. In B. Meltzer and D. Michie (Eds.),
Machine intelligence 4. Edinburgh: Edinburgh University Press, 1969,X%254. Also Stanford
Artijkiul Intelligence Project Memo AZ-62. Stanford, Calif.: Stanford University, Computer
  Science Department, 1968.
The first description of a complete Heuristic DENDRAL program, using the acyclic generator.
Includes a description of the DENDRAL notation and the algorithm for generating acyclic
structures. Readily readable paper directed to the nonchemistry audience. Includes much of
the special-purpose chemistry information relating to certain classes of compounds that were
used in what was caBed the preliminary inference maker. (NOTE: The earlier descriptions of
  the program were formulated before the plangenerate-test paradigm was explicitly stated, SO
the program described here is broken down into a different set of structures. The correspon-
  dences of the earlier versions to the plan-generate-test paradigm are as follows: Preliminary
Inference Maker and Data Adjuster correspond to the PLANNER; the Structure Generator corre-
sponds to the GENERATOR, and Predictor and Evaluation function corresponds to the
  PREDICTOR.)


PROJECT PUBLICATIONS 171

12. Churchman, C. W., and B. G. Buchanan. On the design of inductive systems: Some philosophi-
cal problems. British Journal for the Philosophy of Science, 1969,20,311-323.
A discussion of the problem of designing a system for performing induction; directed to the
audience of professional philosophers. Views the DENDRAL program as a specific case study
in the systems approach to the design of inductive systems.
13. Lederberg, J., G. L. Sutherland, B. G. Buchanan, E. A. Feigenbaum, A. V. Robertson, A. M.
Duffield, and C. Djerassi. Applications of artificial intelligence for chemical inference, I. The
number of possible organic compounds. Acyclic structures containing C, H, 0, and N. Journal
  of theAmen*cun ChemicalSociety, 1969,91:11,2973-2916.
Paper I in a continuing series of publications for chemists on the DENDRAL project, called
"Applications of artificial intelligence for chemical inference." Describes the use of the DEN-
DRAL generator in constructing the total number of possible acyclic structures of C, H, N and
  0. Illustrates the use of GOODLIST and BADLIST; gives examples of the linear notation
used and a summary of the results. Presents the generator as a means of defining the scope and
  boundaries of organic chemistry problems.

14. Duffield, A. M., A. V. Robertson, C. Djerassi, B. G. Buchanan, G. L. Sutherland, E. A. Feigen-
baum, and J. Lederberg. Applications of artificial intelligence for chemical inference, II. Inter-
pretation of low-resolution mass spectra of ketones. Journalof the American Chemical Society,
  1969,91:11,2977-2981.
Paper II in the series of DENDRAL publications for chemists. An application of the program
described in Buchanan, Sutherland, and Feigenbaum (1968) to the ketones. Describes the
  Heuristic DENDRAL program in the form of the Preliminary Inference Maker, Predictor,
Structure Generator, and Scoring Function, applied to the interpretation of low-resolution
mass spectra of ketones. Program limited to monofunctional acyclic structures. Gives a general
introductory description of the DENDRAL approach and a detailed description of some of
  the heuristics embodied in the program.

15. Feigenbaum, E. A. Artificial intelligence: Themes in the second decade. In A. J. H. Morrell
(Ed.), Information Processing 68, Proceedings of IFIP Congress 1968. Amsterdam: North-
Holland, 1969, volume II, 1008-1023. Also Stanford Artificial IntelligenceProject Memo AI-
67. Stanford, Calif.: Stanford University, Computer Science Department, 1968.
A survey of artificial intelligence research over the period 1963-1968. Discusses the topics of
heuristic programming, problem solving, and closely related learning models, and the problem
of representation for problemsolving systems. Includes a description of Heuristic DENDRAL
  as a representative endeavor.

16. Lederberg, J. Topology of molecules. In the National Research Council's Committee on Sup-
port of Research in the Mathematical Sciences (COSRIMS), The mQthemQticQl sciences-A
collection of essays. Published for the National Academy of Sciences (National Research Coun-
  cil). Cambridge: M. I. T. Press, 1969,37-51.
A published form of the first six papers, summarizing the notions introduced there. A detailed
but not highly technical presentation. This paper introduces the notion of vertex graphs and is
an attempt to extend the acyclic DENDRAL notation scheme to cyclic structures.
17. Lederberg, J., G. L. Sutherland, B. G. Buchanan, and E. A. Feigenbaum. A heuristic program
for solving a scientific inference problem: Summary of motivation and implementation, In
R. Banerji and M. D. Mesarovic (Eds.), Theoretical approaches to non-numerical problem solv-
ing. New York: Springer-Verlag, 1970.
Describes Heuristic DENDRAL as a study of scientific inference making. Discusses the per-
formance level of the program and indicates further areas of development. A nontechnical
  paper.

18. S&roll, G., A. M. Duffield, C. Djerassi, B. G. Buchanan, G. L. Sutherland, E. A. Feigenbaum,
and J. Lederberg. Applications of artificial intelligence for chemical inference, III. Aliphatic
ethers diagnosed by their low-resolution mass spectra and nuclear magnetic resonance data.
Joui?IQl of the American ChemicalSociety, 1969,91:26,1440-7445.
Paper III in the series of DENDRAL papers for chemists. The application of the program to


172 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

aliphatic ethers. The program incorporates the use of nuclear magnetic resonance data in the
Predictor as a final filter on the structures generated.

19. Sutherland, G. L. Heuristic DENDRAL: A family of LISP programs. Stanford Artificial Intelli-
gence Project Memo AI-SO. Stanford, Calif.: Stanford University, Computer Science Depart-
  ment, 1969.
Describes the Heuristic DENDRAL program as an application of the programming language
LISP. Directed to the computer science audience. Emphasizes the nonchemistry aspects of the
program, particularly the generation of all tree graphs of a collection of nodes. Concentrates
  on indicating how automation of the DENDRAL algorithm was acomphshed, in the form of
  the structure generator. Includes the addition of the Preliminary Inference Maker, the Predictor,
  and an Evaluator called "Scoring Function."

20. Buchanan, B. G., G. L. Sutherland, and E. A. Feigenbaum. Rediscovering some problems of
  artficial intelligence in the context of organic chemistry. In B. Meltzer and D. Michie (Eds.),
Muchine intelligence 5. Edinburgh: Edinburgh University Press, 1970, 253-280. Also Stanford
Artificial Intelligence Project Memo AIM-99, under the title "Toward an understanding of
  information processes of scientific inference ln the context of organic chemistry." Stanford,
  Callf.: Stanford University, Computer Science Department, 1969.
  A paper for the artificial intelligence audience. Describes Heuristic DENDRAL ln the format
  of the Preliminary Inference Maker, Structure Generator, Predictor, and Tester. Presents and
analyzes a lengthy sample session of eliciting chemistry knowledge from an expert for the
Predictor's theory of mass spectrometry. Discusses the design problems faced in writing DEN-
DRAL. A generally nontechnical paper that gives a good discursive view of the working DEN-
  DRAL project.

21. Buchs, A., A. M. Duffreld,G. S&roll, C. Djerassi, A. B. DelfIno, B. G. Buchanan, G. L. Suther-
land, E. A. Feigenbaum, and J. Lederberg. Applications of artificial intelligence for chemical
inference, IV. Saturated amines diagnosed by their low resolution mass spectra and nuclear
magnetic resonance spectra. Journal of the American Chemical Society, 1970,92:23,6831-
  6838.

Paper IV in the series of DENDRAL papers for chemists. Application of the program to satu-
rated amlnes (nitrogen compounds). Also used nuclear magnetic resonance data but in the
planning stage instead of the faltering or testing stage. Only the Preliminary Inference Maker
is used in this program. It was not necessary to generate structures, since the Preliminary In-
ference Maker (using mass spectrometry and nuclear magnetic resonance data) sufficiently
constrained the set of possible compounds so as to yield only the correct ones.

22. Lederberg, J. DENDRAL, a system for computer construction, enumeration and notation of
organic molecules as tree structures and cyclic graphs, part III. Complete chemical graphs;
embedding rings in trees. Technical report, National Aeronautics and Space Administration,
  1970.

The third of three technical reports to NASA, dealing with complete structures. Written to
facilitate the programming of DENDRAL for cyclic structures; deals with some of the problems
faced by a computer generator program.

23. Sheikh, Y. M., A. Buchs, A. B. Delfmo, G. S&roll, A. M. Duffield, C. Djerassi, B. G. Buchanan,
G. L. Sutherland, E. A. Feigenbaum, and J. Lederberg. Applications of artificial intelligence
for chemical inference. An approach to the computer generation of cyclic structures. Differen-
tiation between all the possible isomeric ketones of composition C, H,, 0. Organic MUSS Spec-
trometry, 1970, 4, 493501. Part V in the series "Applications of artificial intelligence for
  chemical inference."

Paper V in the series of DENDRAL papers for chemists. Describes the first implementation of
a cyclic structure generator. The approach is no longer used because it proved to be insuffi-
ciently general.

24. Buchs, A., A. B. Delfmo, A. M. Duffield, C. Djerassi, B. G. Buchanan, E. A. Felgenbaum,and
  J. Lederberg. Applications of "artificial intelligence" for chemical inference, VI. Approach to
a general method of interpreting low resolution mass spectra with a computer. Helvetica Chi-
  mica Acta, 1970,53:6,1394-1417.


PROJECT PUBLICATIONS 173

Paper VI in the series of DENDRAL papers for chemists. Important use of mass spectrometry
theory to generate planning rules; results of papers H-V are duplicated using this method.
Also describes the use to date of proton nuclear magnetic resonance data.

25. Buchanan, B. G., A. M. Duffield, and A. V. Robertson. An application of artificial intelligence
to the interpretation of mass spectra, In G. W. A. Mllne (Ed.), Mass spectrometry: Techniques
  and applications. New York: Wiley-Interscience, 1971.
The most comprehensive introduction to DENDRAL for chemists. Gives a very clear description
of the acyclic generator and of the DENDRAL notation. Also describes the early version of
  the Heuristic DENDRAL program, basically as it appeared in Buchanan, Sutherland, and
  Feigenbaum (1969). The fist part of the paper is good introductory material for understanding
  the basic concepts of the generator. Presents extensively the results of the DENDRAL program
  to 1971.
26. Buchanan, B. G., E. A. Feigenbaum, and I. Lederberg. A heuristic programming study of theory
  formation in science.SecondInternational Joint Conference on Artificial Intelligence. London:
  The British Computer Society, 1971, 4040. Also Stanford Artijkkl Intelligence Project
  Memo AIM-145, and Report No. CS-221. Stanford, Calif.: Stanford University, Computer
  Science Department, 1971.
The fist description of the developing Meta-DENDRAL program, presented as the first steps
toward a goal of the Heuristic DENDRAL project: studying processes underlying theory for-
mation. A fairly general nontechnical discussion of the Heuristic DENDRAL program as a
  specific inference maker, whose inference-making processes are to be studied.

27. Buchs, A., A. B. Delfmo, C. Djerassi, A. hi. Duffield, B. G. Buchanan, E. A. Feigenbaum, J.
  Lederberg, G. Schroll, and G. L. Sutherland. The application of artificial intelligence in the
  interpretation of low-resolution mass spectra. In A. Quayle (Ed.), Advances in mass spectro-
metry, volume 5. London: The Institute of Petroleum, 1971,314-318.
A brief, somewhat technical paper for the chemistry audience. Describes the DENDRAL ap-
  proach to a general computer interpretation of low-resolution mass spectra of organic com-
  pounds and presents the results obtained with aliphatic amines. The program uses only the
  Preliminary Inference Maker and the Structure Generator.

28. Feigenbaum, E. A., B. G. Buchanan, and J. Lederberg. On generality and problem solving: A
case study using the DENDRAL program. In B. Meltzer and D. Michie (Eds.), Machine intelli-
gence 6. Edinburgh: Edinburgh University Press, 1971, 165-190. Also Stanford Artijicial In-
  telligence Project Memo AIM-131 and Report No. CSI 76. Stanford, Calif.: Stanford Univer-
  sity, Computer Science Department, 1970.
  A paper for the artificial intelligence community. A very good summary. Uses the design of
Heuristic DENDRAL and its performance on the problems it has solved as a springboard for
discussing design for generality, performance problems attendant on too much generality, the
coupling of expertise to the general problem+olvhtg processes, and the relationship between
generality and expertness. Uses the terminology of Planner-Structure Generator-Predictor.
Discusses DENDRAL as a combination of universal and "big switch" approaches to problem
  solving.

29. Buchanan, B. G., and J. Lederberg. The heuristic DENDRAL program for explaining empirical
data. In C. V. Freiman (Ed.), Information Processing 71, Procegdings of the IFIP Congress
  71. Amsterdam: Ehevier-North Holland, 1972, 1, 179-188. Also Stanford Artificial Zntelli-
gence Project Memo AIM-141 and Report No. CS-203. Stanford, Calif.: Stanford University,
  Computer Science Department, 1971.
  Brief paper written for the computer science audience. Gives the global picture of DENDRAL
  without going into a detailed presentation. Uses the format of Planner, Structure Generator,
  and Evaluator. Presents all the DENDRAL results up to 1971.
30. Buchanan, B. G., E. A. Feigenbaum, and N. S. Sridharan. Heuristic theory formation: Data
  interpretation and rule formation. In B. Meltzer and D. Michie (Eds.), Machine intelligence 7.
  Edinburgh: Edinburgh University Press, 1972,267-290.
  A Meta-DENDRAL paper for the computer science audience. Describes a program developed
  to deal with estrogenic steroids, written to test quickly some of the ideas developed on theory


174 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

formation. Program aimed at discovering theories that will help predict mass spectra for mole-
cules given their chemical structure. Discusses the rule-formation task for Meta-DENDRAL in
the context of estrogenic steroids.

31. Lederberg, J. Rapid calculation of molecular formulas from mass values. Journal of Chemical
  Education, 1972,49,613.
  A brief technical note addressed to the chemistry education audience. Presents a simple me-
  thod for the calculation of molecular compositions consistent with a given range of mass values.
This compilation is a greatly shortened version of the tables published in Lederberg (1964a).
32. J. Lederberg. Use of a computer to identify unknown compounds: The automation of scientific
  inference. In G. R. Wailer (Ed.), Biochemical applications of mass spectrometty. New York:
  Wiley-Interscience, 1972,193-207.
  Paper VII in the series of DENDRAL papers for chemists.

33. Smith, D. H., B. G. Buchanan, R. S. Engelmore, A. M. Duffleld, A. Yeo, E. A. Feigenbaum,
J. Lederberg, and C. Djerassi. Applications of artificial intelligence for chemical inference, VIII.
  An approach to the computer interpretation of the high resolution mass spectra of complex
molecules. Structure elucidation of estrogenic steroids. Journal of the American Chemical
  Society, 1972,94:17,5962-5971.
Paper VIII in the series of DENDRAL papers for chemists. The first description of the PLAN-
NER program, basically in the same form as it exists at present: a general program that is
  written to permit the chemist to enter information about heuristics in mass spectrometry in a
  uniform way, as opposed to a detailed presentation of such Information, as in the previous ver-
  sion. Describes the application of PLANNER to estrogens, the most extensive use of PLANNER
  so far. This paper is the basis for Chapter 5 of this book.

34. Buchanan, B. G., and N. S. Sridharan. Analysis of behavior of chemical molecules: Rule for-
mation on nonhomogeneous classes of objects. Third International Joint Conference on Arti-
  ficial Intelligence, Menlo Park, Calif.: Stanford Research Institute, Publications Department,
  1973,67-76. Also Stanford Artificial Intelligence Laboratory Memo AIM-215 and STAN-CS-
  73-387. Stanford, Calif.: Stanford University, Computer Science Department, 1973.
  A description of Meta-DENDRAL for the computer science audience. The program is given
  mass spectrometry data from several chemical molecules, separates these molecules into sub-
  classes, and selects from the space of all explanatory processes the characteristic processes for
  each subclass. Discusses some results of the program.

35. Buchanan, B. G. Review of Hubert Dreyfus's What computers can't do: A critique of artificial
  reason, Computing Reviews, 1973, 18-21. Also Stanford Artificial Intelligence Project Memo
AIM-181 and STAN-CS-72-325. Stanford, Calif.: Stanford University, Computer Science De-
  partment, 1972.
Review of a controversial critique of artificial intelligence. Takes the position that the philo-
  sophical approach of the book is interesting, but the attack on artificial intelligence is not well
  reasoned.

36. Smith, D. H., B. G. Buchanan, R. S. Engelmore, H. Adlercreutz, and C. Djerassi. Applications
of artificial intelligence for chemical inference, IX. Analysis of mixtures without prior separa-
  tion as illustrated for estrogens. Journal of the American Chemical Society, 1973, 95:18,
  60786084.

Paper IX in the series of DENDRAL papers for chemists. Describes the use of PLANNER in
the analysis of mixtures, as illustrated for estrogens. Essentially the same program as before
but now used to analyze mixtures of compounds, which go through the mass spectrometer
without prior separation. The program is able to discriminate these, determining from the total
composite spectrum which pieces of it correspond to which compounds in the mixture. (The
problem of analyzing mixtures is one that chemists find especially difficult.) The program uses
a variety of mass spectra, from unseparated mixtures, including high-resolution mass spectra,
low-ionizing voltage spectra, and metastable ion spectra.

37. Smith, D. H., B. G. Buchanan, W. C. White, E. A. Feigenbaum, J. Lederberg, and C. Djerassi.
  Applications of artificial intelligence for chemical inference-X. Intsum. A data interpretation
and summary program applied to the collected mass spectra of estrogenic steroids. Tetrahedron,
  1973,29,3117-3134.


PROJECT PUBLICATIONS 175

Paper X in the series of DENDRAL papers for chemists. A description of INTSUM, one of the
Meta-DENDRAL programs. Application of the program to high-resolution mass spectral data
from estrogenic steroids. Important because this paper describes the first new chemistry (mass
spectrometry) results from Meta-DENDRAL.

38. Carhart, R. E., and C. Djerassi. Applications of artificial intelligence for chemical inference,
part XI. Analysis of carbon-13 nuclear magnetic resonance data for structure elucidation of
acyclic amines. Journal of the Chemical Society, Perkin Transactions II, 1973,1753-1759.
Paper XI in the series of DENDRAL papers for chemists. Describes the use of a PLANNER
  with carbon-13 nuclear magnetic resonance data. Describes a computer program called AMINE,
  which uses a set of predictor rules to deduce the structures of acyclic amines from their em-
pirical formulas and carbon-13 nuclear magnetic resonance spectra. Important extension of
  DENDRAL ideas beyond mass spectrometry.

39. Sridharan, N. S. Computer generation of vertex-graphs. STAN-G-73-381. Stanford, Calif:
  Stanford University, Computer Science Department, 1973.
  A fairly technical paper directed to the mathematics and computer-programming audience.
  Describes the cyclic structure generator; deals with the basic set of vertex graphs that the
  cyclic structure generator draws upon.
40. Sridharan, N. S. Search strategies for the task of organic chemical synthesis. Stanford Artificial
Intelligence Laboratory Memo AIM-21 7 and STAN-CS-73391. Stanford, Calif.: Stanford Uni-
  versity, Computer Science Department, 1973. Presented at the Third International Joint Con-
  ference on Artificial Intelligence, Stanford, California, 1973.
  A paper for the computer science audience. Describes a computer program, written elsewhere,
  that successfully discovers syntheses for complex organic molecules. This paper describes the
  deftition of the search space and strategies for heuristic search. This work is of tangential
  interest to the DENDRAL activities.

41. Sridharan, N. S., H. Gelernter, A. J. Hart, W. F. Fowler, and H. J. Shue. A heuristic program
  to discover syntheses for complex organic molecules. Stanford Artificial Intelligence Labora-
tory Memo AIM-205 and STAN-CS-73-370. Stanford, Calif.: Stanford University, Computer
  Science Department, 1973.
A paper for the computer science audience. Describes a synthesis program, developed else-
where, for complex organic molecules, giving its organization as a heuristic search and dis-
  cussing the design of the problem+olving tree and the search procedures. This program is not
directly related to the DENDRAL programs.

42. Brown, H., L. Hjehneland, and L. M. Masinter. Constructive graph labeling using double cosets.
  Discrete Mathematics, 1974, 7, l-30. Also STAN-CS- 72-318. Stanford, Calif.: Stanford Uni-
  versity, Computer Science Department, 1972.
  A highly technical mathematical paper, describing the mathematical basis of the cyclic genera-
  tor, addressed to graph theorists. Presents algorithms for labeling graphs based on a group
  theoretic formulation of the labeling problem. Companion to Brown and Masinter (1974).
43. Brown, H., and L. M. Masinter. Algorithm for the construction of the graphs of organic mole-
cules. Discrete Mathematics, 8, 1974, 227-244. Also STAN-CS- 73-361. Stanford, Calif.: Start-
  ford University, Computer Science Department, 1973.
  A highly detailed mathematical description of the cyclic generator aIgorithm, including some
  theorems to show that it works: for example, that the algorithm produces no redundancies. A
  technical paper suited for the mathematician or computer programmer. Companion to Brown,
  Hjelmeland, and Masinter (1974a).

44. Buchanan, B. G. Scientific theory formation by computer. In Proceedings of NATO Advanced
  Study Institute on Computer Oriented Learning Processes, 1974, Bonas, France.
  A general tutorial on Meta-DENDRAL notions. Presents artificial intelligence and chemistry
  information sufficient to understand the functioning of Meta-DENDRAL. Suitable for a
  general audience.

45. Feigenbaum, E. A. Computer applications: Introductory remarks. In ProceedingsofFederation
  ofAmerican Societies for Experimental Biology, 1974,33:12,2331-2332.
  Introductory remarks to a computer science audience on computer applications in artificial
intelligence research. Describes the basic concepts on which artificial intelligence research is


176 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

based, gives performance levels of existing programs, and gives an introduction to the concept
of knowledge-based systems.

46. Masinter, L. M., N. S. Sridharan, J. Lederberg, and D. H. Smith. Applications of artificial in-
  telligence for chemical inference, XII. Exhaustive generation of cyclic and acyclic isomers.
  Journal of the American Chemical Society, 1914, 96:25, 7102-1714. Also Stanford Artifi-
  cial Intelligence Laboratory Memo AIM-216 and STAN-CS-73-389. Stanford, Cahf.: Stanford
  University, Computer Science Department, 1973.
  Paper XII in the series of DENDRAL papers for chemists. Another description of the cyclic
  generator; does not require special knowledge of mathematics or computer programming but
  is a fairly exhaustive and detailed presentation. Chemistry analog of Brown and Masinter
  (1974).

47. Masinter, L. M., N. S. Sridharan, R. E. Carhart, and D. H. Smith. Applications of artificial
  intelligence for chemical inference, XIII. Labeling of objects having symmetry. Journal of the
American ChemicalSociety, 1974,96:25,7714-1723.
  Paper XIII in the series of DENDRAL papers for chemists. Concerns the cyclic generator. The
  "labeling of objects having symmetry" refers to a part of the cyclic generator. The paper is
  divided into sections presenting a brief tutorial on the nature of the problem and an introduc-
  tion to the terminology found in more technical treatment, a textual description of a method
  for the solution to this type of problem, a summary of the procedure in a more algorithmic
  form, generalizations on the basis of the algorithm, and a sample application of the method to
  a complex isomerism problem in organic chemistry. Chemistry analog of Brown, Hjelmebmd,
  and Masinter (1974a) and companion to Masiuter et al. (1974b).

48. MI&e, D., and B. G. Buchanan. Current status of the heuristic DENDRAL program for apply-
  ing artificial intelligence to the interpretation of mass spectra. In R. A. G. Carrington (Ed.),
Computers for spectroscopists. London: A&m Hilger 1974, 114-131, Also Experimental
  Programming Report No. 32, under the title Artif%al intelligence in mass spectroscopy: A
  review of the heuristic DENDRAL program. Edinburgh: University of Edinburgh, School of
  Artificial Intelligence, 1973.
  A technical paper intended for mass spectrometrists. A concise introduction to the DENDRAL
  programs (in the form of the Planner-Structure Generator-Predictor-Evaluator). Presents an
  introduction to artificial intelligence work for the chemist.

49. Smith, D. H., L. M. Masinter, and N. S. Sridharan. Heuristic DENDRAL: Analysis of molecular
  structure. In W. T. Wipke, S. Heller, R. N. Feldman, and E. Hyde (Eds.), Proceedings of the
NATOICNNA Advanced Study Institute on Computer Representation and Manipulation of
  Chemical Information. New York: Wiley, 1974,287-315.
  A straightforward description of the cyclic generator algorithm in nonmathematical termin-
  ology for chemists. (This paper contrasts with Brown, Hjehneland, and Masinter (1974a),
  which is a rigorous mathematical description of this algorithm, and with Brown and Masinter
  (1974), which is also a highly formalized description of the algorithm. In the current paper, the
  algorithm is described in ordinary language.) Describes the generation, representation, and
manipulation of molecular structures in the context of the Heuristic DENDRAL algorithm,
with emphasis on the cyclic generator. Also describes the then current work on the Meta-
  DENDRAL program.

50. Buchanan, B. G. Applications of artificial intelligence to scientific reasoning. In Proceedings
of the Second USA-Japan Computer Conference. American Federation of Information Pro-
  cessing Societies Press, 1975.
  A paper for computer scientists. Describes the design criteria for heuristic systems. Describes
the Heuristic DENDRAL and Meta-DENDRAL programs from the point of view of the design
  choices that have made the computer programs transferable to the chemistry laboratory.
51. Carhart, R. E., S. hi. Johnson, D. H. Smith, B. G. Buchanan, R. G. Dromey, and J. Lederberg.
  Networking and a collaborative research community: A case study using the DENDRAL pro-
  grams. In P. Lykos (Ed.), Proceedings of the American Chemical Society Symposium on Net-
  working and Chemistry, Chicago, August 19 75.
  Describes the SUMEX-AIM computer facility In general and the DENDRAL programs in parti-


PROJECT PUBLICATIONS 177

cular as examples of shareable programming efforts. Gives a good overview of the working
  DENDRAL programs and an assessment of the SUMEX-AIM facility.
52. Dromey, R. G., B. G. Buchanan, D. H. Smith, J. Lederberg, and C. Djerassi. Applications of
artificial intelligence for chemical inference, XIV. A general method for predicting molecular
  ions in mass spectra. Journal of Organic Chemistry, 1975,40:6,770-774.
  Paper XIV in the series of DENDRAL papers for chemists. Describes the MOLION program,
  discussed in Chapter 5 of this book.

53. Smith, D. H. Applications of artificial intelligence for chemical inference. Constructive graph
  labeling applied to chemical problems. Chlorinated hydrocarbons. Analytical Chemistry, 1975,
  47:7,1176-1179.
Paper XV in the series of DENDRAL papers for chemists. Describes an application of the la-
beling algorithm in the cyclic generator to chlorinated hydrocarbons. Application of ideas
  discussed in Masinter et al. (1974a).

54. Carhart, R. E., D. H. Smith, H. Brown, and N. S. Sridharan. Applications of artificial inteRi-
gence for chemical inference, XVI. Computer generation of vertex-graphs and ring systems.
Journal of Chemical Information and Computer Sciences (formerly Journal of Chemical
  Documentation), 1975,15:2, 124-130.
  Paper XVI in the series of DENDRAL papers for chemists. Describes a program for enumerating
  vertex graphs that is used to construct the CATALOG for the cyclic generator.
55. Carhart, R. E., D. H. Smith, H. Brown, and C. Djerassi. Applications of artificial intelligence
  for chemical inference, XVII. An approach to computer-assisted elucidation of molecular
  structure. Journalof theAmerican ChemicalSociety, 1975,97:20,5755-5762.
  Paper XVII in the series of DENDRAL papers for chemists. Describes the CONGEN program.
  Another description for chemists of the cyclic generator, mentioning heuristic constraints for
  the first time, together with a moderately elaborate example of how the program works on a
  problem that is of potential interest to working chemists.
56. Smith, D. H. The scope of structural isomerism. Journal of Chemical Information and Com-
  puter Sciences, 1975,15:4,203-207.
  Paper XVIII in the series of DENDRAL papers for chemists.
57. Smith, D. H., J. P. Konopelski, and C. Djerassi. Applications of artificial intelligence for chem-
  ical inference, XIX. Computer generation of ion structures. Organic Mass Spectrometty, 1976,
  11,86-100.

58. Carhart, R. E., and D. H. Smith. Applications of artificial intelligence for chemical inference,
  XX. `Intelligent' use of constraints in computer*ssisted structure elucidation. Computers in
  Chemistry, 1976, I, 79.

59. Cheer, C., D. H. Smith, C. Djerassi, B. Tursch, J. C. Braekman,and D. Daloze. Applications of
  artificial intelligence for chemical Inference, XXI. The computer*ssisted identification of [+]-
palustrol in the marine organism cespitularia ap., aff. subvirdis. Tetrahedron, 1976,32,1807.
60. Buchanan, B. G., D. H. Smith, W. C. White, R. Gritter, E. A. Feigenbaum, J. Lederberg, and
  C. Djerassi. Applications of artificial intelligence for chemical inference, XXII. Automatic rule
  formation in mass spectrometry by means of the Meta-DENDRAL program. Journal of the
  American Chemical Society, 1976,98,6168.

61. Dromey, R. G., M. J. Stefii, T. Rindfleisch, and A. M. Duffield. Extraction of mass spectra
free of background and neighboring component contributions from gas chromatography/mass
  spectrometry data. Analytical Chemistry, 1976,48,1368.
62. Varkony, T. H., R. E. Carhart, and D. H. Smith. Applications of artificial intelligence for
  chemical Inference, XXIII. Computerassisted structure elucidation. Modelling chemical reaction
  sequences used in molecular structure problems. In W. T. Wipke (Ed.), Computer-assisted
organic synthesis. Washington, D.C.: American Chemical Society, 1977.
63. Smith, D. H., and R. E. Carhart. Applications of artificial intelligence for chemical Inference,
XXIV. Structural isomerism of mono- and sesquiterpenoid skeletons. Tetrahedron, 1976,32,
  2513.

64. Carhart, R. E. A model-based approach to the teletype printing of chemical structures. Journal
  of Chemical Information and Computer Sciences, 1976,16,82.


178 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

65. Dromey, R. G., M. J. Stefik, T. C. Rindfleisch, and A. M. Duffield. Extraction of mass spectra
  free of background and neighboring component contributions from gas chromatography/mass
  spectrometry data. Analytical Chemistry, 1976,48,1368.
66. Buchanan, B. G., and D. Smith. Computer assisted chemical reasoning. In E. V. Ludena, N. H.
  SabeUi, and A. C. Wahl (Eds.), Computers in chemical education and research. New York:
  PIenum Press, 1977.

67. Schwenzer, G. E., and T. M. Mitchell. Computer assisted structure elucidation using automati-
cally acquired 13C NMR rules. In D. Smith (Ed.), Computer assisted structure elucidation,
  ACS Symposium Series, 1977,54,58.

68. Nourse, J. G. Generalized stereoisomerization modes. Journal of the American Chemical So-
  ciety, 1977,99,2063.

69. Varkony, T. H., R. E. Carhart, and D. H. Smith. Computer assisted structure elucidation, rank-
  ing of candidate structures, based on comparison between predicted and observed mass spectra.
In Proceedings of the Twenty-Fifth Annual Conference on Mass Spectrometry and Allied
  Topics, Washington, D. C., 1977.
70. Mitchell, T. M. Version spaces: A candidate elimination approach to rule leasning.Proceedings
of the Fifth ZJCAZ, 1,305, August 1977.

71. Feigenbaum, E. A., J. Lederberg, and B. G. Buchanan. Final technical report for contract
period August 1, 1973 through July 31, 1977, Contract DAHC-73-C-0435. Submitted to
Advanced Research Projects Agency, Department of Defense, October, 1977.
72. Mitchell, T. M., and G. M. Schwenzer. Applications of artificia intelbgence for chemical infer-
erence, XXV. A computer program for automated empirical 13C NMR rule formation. Organic
  Magnetic Resonance, 1978,11,No. 8,378.

73. Schwenzer, G. E. Applications of artificial intelligence for chemical inference, XXVI. Analysis
of C-l 3 NMR for mono-hydroxy steroids incorporating geometric distortions. Journal Of Or-
ganicChemistry,1978,43,No.6.

74. Buchanan, B. G., T. Mitchell, R. G. Smith, and C. R. Johnson, Jr. ModelI of learning systems.
In J. Belzer (Ed.), Encyclopedti of computer sciences and technology, 11. New York: Marcel
  Dekker, 1978.

75. Buchanan, B. G., and E. A. Felgenbaum. DENDRAL and Meta-DENDRAL: Their applications
  dimension. Artificial Intelligence, 1978,ll.

76. Varkony, T. H., R. E. Carhart, D. H. Smith, and C. Djerassi. Computer-assisted simulation of
chemical reaction sequences: Applications to problems of structure elucidation. Journal of
  Chemical Information and Computer Sciences, 1978,18,168.
77. Carhart, R. E. Erroneous claims concerning the perception of topological symmetry. Journal
  of Chemical Information and Computer Sciences, 1978,18,197.
78. Gray, N. A. B., D. H. Smith, T. H. Varkony, R. E. Carhart, and B. G. Buchanan. Use of a com-
  puter to identify unknown compounds: The automation of scientific inference. In G. R.
WaBer (Ed.), Biochemical applications of mass spectrometty (supplement). New York: Wiley-
  Interscience, 1978.

79. Smith, D. H., and P. C. Jurs. Prediction of 13C NMR chemical shifts. Journal of the American
  ChemicalSociety, 1978,100,3316.

80. Smith, D. H., T. C. Rindfleisch, and W. J. Yeager. Exchangeof comments: Analysisofcomplex
volatile mixtures by a combined gas chromatography-mass spectrometry system, Analytical
  Chemistry, 1978,50,1585.

81. Nourse, J. G. Applications of the permutation group in dynamic stereochemistry. In The
permutation group in physics and chemistry. Lecture notes in chemistry, volume 12. New
  York: Springer-Verhtg, 1979,28.

82. Nourse, J. G. Application of the permutation group to stereoisomer generation for computer
  assisted structure elucidation. In The permutation group in physics and chemistry. Lecture
notes in chemistry, volume 12. New York: Springer-Verlag, 1979,19.
83. Nourse, J. G., Applications of artificial intelligence to chemical inference, 28. The contigura-
tion symmetry group and its application to stereoisomer generation, specification and enumer-
  ation. Journal of the American ChemicalSociety, 1979,101,1210.


PROJECT PUBLICATIONS I79

84. Smith, D. H., and R. E. Carhart. Structure elucidation based on computer analysis of high and
low resolution maas spectral data. In M. .L. Gross (Ed.), Proceedings of the Symposium on
Chemical Applications of High Performance Spectrometry. Washington, D. C.: American
  Chemical Society, 1978, 325.

85. Varkony, T., D. Smith and C. Djerassi. Computer~ssisted structure manipulation: Studies in
the biosynthesis of natural products. Tetrahedron, 1978,34,841-852.
86. Mitchell, T. M. Version spaces: An approach to concept learning. Doctoral dissertation. Stan-
ford University, Department of Electrical Engineering, December 1978.
87. Wegmann, A. Variations in mass spectral fragmentation produced by active sites in a mass
spectrometer source. Analytical Chemistry, 1978,50, No. 6,830-832.
88. Nourse, J. G., R. E. Carhart, D. H. Smith, and C. Djerassi. Applications of artificial intelligence
to chemical inference, 29. Exhaustive generation of stereoisomers for structure elucidation.
Journal of the American Chemical Society, 1979,101,1216.
89. Fitch, W. L., P. J. Anderson, and D. H. Smith. Isolation, identification and quantitation of
urinary organic acids. Journal of Chromatography, 1979, 162,249-259.
90. Fitch, W. L., E. T. Everhart, and D. H. Smith. Characterization of carbon black adsorbates and
artifacts formed during extraction. Analytical Chemistry, 1978,50,2122-2126.
91. Fitch, W. L., and D. H. Smith. Analysis of adsorption properties and adsorbed species of com-
mercial polymeric carbons. Environmental Science and Technology, 1979, 13,341-346.
92. Djerassi, C., D. H. Smith, and T. H. Varkony. A novel role of computers in the natural products
field. Naturwissenschaften, 1979,66,9.

93. Rindfleisch, T. C., and D. H. Smith. Advances in data acquisition and analysis systems for ap
plications of gas chromatography/mass spectrometry. In G. R. Waller (Ed.), Biomedical appli-
cations of mass spectrometry. New York: Wiley-Interscience, 1978.
94. Buchanan, B. G., and T. Mitchell. Model-directed learning of production rules. In D. A. Water-
man and F. Hayes-Roth (Eds.), Patterndirected inference systems. New York: Academic press,
  1978.

95. Buchanan, B. G. Issues of representation in conveying the scope and limitations of intelligent
assistant programs. In I. E. Hayes, D. Michie, and L. I. Mikulich, Machine intelligence 9.
Chichester, England: Ellis Horwood Ltd. and New York: Wiley, 1979.
96. Nourse, J. G., and D. H. Smith. Nonnumerical mathematical methods in the problem of stereo-
  isomer generation. March, 1979,6,259.

REFERENCES

Beynon, J. H., and R. M. Caprioli. Metastable ions as an aid in the interpretation of mass spectra.
  In G. R. Waller (Ed.), Biochemical applications of mass spectrometry. New York: Wiley-
  Interscience, 1972,157-176.

Boden, M. Artifickrr intelligence and natural man. New York: Basic Book;, 1977.
Bronowski, J. The logic of the mind.American Scientist, 1966,54,1-14.
Brown, H., L. Hjehneland, and L. M. Maslnter. Constructive graph labeling using double cosets.
  Discrete Mathematics, 1974,7, l-30. Also STAN-CS-72-318. Stanford, Calif.: Stanford Uni-
  versity, Computer Science Department, 1972.

Brown, H., and L. M. Masinter. Algorithm for the construction of the graphs of organic molecules.
Discrete Mathematics, 1974, 8, 227-244, Also STAN-CS-73-361. Stanford Calif.: Stanford
  University, Computer Science Department, 1973.
Buchanan, B. G. Review of Hubert Dreyfus's What computers can't do: A critique of artificial rea-
  son, Computing Reviews, 1973, 18-21. Also Stanford Artificial Intelligence Project Memo
AIM-181 and STAN-CS-72-325. Stanford, Calif.: Stanford University, Computer Science De-
  partment, 1972.


180 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Buchanan, B. G. Applications of artificial intelligence to scientific reasoning. In Proceedings of the
  Second USA-Japan Computer Conference. American Federation of Information Processing
  Societies Press, 1975.

Buchanan, B. G. Issues of representation in conveying the scope and limitations of intelligent assis-
  tant programs. In J. E. Hayes, D. Michie, and L. I. Mikulich, Machine intelligence 9. Chiches-
  ter, England: Ellis Horwood Ltd. and New York: Wiley, 1979.
Buchanan, B. G., A. M. Duffield, and A. V. Robertson. An application of artificial intelligence to
  the interpretation of mass spectra. In G. W. A. Milne (Ed.), Mass spectrometty: Techniques
  and applications. New York: Wiley-Interscience, 1971.
Buchanan, B. G., and E. A. Feigenbaum. DENDRAL and meta-DENDRAL: Their applications
  dimension. Arrificial Intelligence, 1978,ll.

Buchanan, B.G., E. A. Feigenbaum, and J. Lederberg. A heuristic programming study of theory
  formation in science. Second International Joint Conference on Artificial Intelligence. Lon-
  don: The British Computer Society, 1971,40-50. Also Stanford Artificial Intelligence Project
  Memo AIM-145 and Report No. CS-221. Stanford, Calif.: Stanford University, Computer
  Science Department, 1971.

Buchanan, B. G., E. A. Feigenbaum, and N. S. Srldharan. Heuristic theory formation: Data inter-
  pretation and rule formation. In B. Meltzer and D. Michie (Eds.), Machine intelligence 7.
  Edinburgh: Edinburgh University Press, 1972,267-290.

Buchanan, B. G., and J. Lederberg, The heuristic DENDRAL program for explaining empirical data.
  In C. V. Frelman (Ed), Information Processing 71, Proceedings of the ZFIP Congress 71.
  Amsterdam: Elsevier-North Holland, 1972, 1, 179- 188. Also Stanford Artificial Intelligence
  Project Memo AIM-141 and Report No. CS-203. Stanford, Calif.: Stanford University, Com-
  puter Science Department, 1971.

Buchanan, B. G., and T. Mitchell. Model-directed learning of production rules. In D. A. Waterman
  and F. Hayes-Roth (Eds.), Pattern directed inference systems. New York: Academic Press,
   1978.

Buchanan, B. G., T. Mitchell, R. G. Smith, and C. R. Johnson, Jr. Models of learning systems.
  In J. Belzer (Ed.), Encyclopedia of computer sciences and technology, 11, New York: Marcel
  Dekker, 1978.

Buchanan, B. G., and D. H. Smith. Computer assisted chemical reasoning. In E. V. Ludena,N. H.
  Sabelli, and A. C. Wahl (Fds.), Computers in chemical educarion and research. New York:
  Plenum Press, 1977.

Buchanan, B. `G., D. H. Smith, W. C. White, R. Gritter, E. A. Feigenbuam, J. Lederberg, and C.
  Djerassi. Applications of artificial intelligence for chemical inference, XXII. Automatic rule
  formation in mass spectrometry by means of the meta-DENDRAL program. Journal of the
  American Chemical Society, 1976.

Buchanan, B. G., and N. S. Sridharan. Analysis of behavior of chemical molecules: Rule formation
  on nonhomogeneous classes of objects. Third International Joint Conference on Artificial
Znrelligence. Menlo Park, Calif.: Stanford Research Institute, Publications Department, 1973,
  67-76. AlsoStanfordArtificialIntelligence Laboratory MemoAIM-215 andSTAN-CS- 73.387.
  Stanford, Callf.: Stanford University, Computer Science Department, 1973.

Buchanan, B. G., G. L. Sutherland, and E. A. Feigenbaum. Heuristic DENDRAL: A program for
generating exPlanatorY hypotheses in organic chemistry. In B. Meltzer and D. Michie (E&J,
MacAine intelligence 4. Edinburgh: Edinburgh University Press, 1969,209-254. Also Stanford
Artificial Intelligence Project Memo AI-62. Stanford, Calif.: Stanford University, Computer
  Science Department, 1968.

Buchanan, B. G., G. L. Sutherland, and E. A. Feigenbaum. Rediscovering some problems of artifi-
  cial intelligence ln the context of organic chemistry. In B. Meltzer and D. Michie (Eds.), Ma-
  chine intelligence 5. Edinburgh: Edinburgh University Press, 1970, 253-280. Also Stanford
  Artificial Intelligence Project Memo AIM-99, under the title "Toward an understanding of
  information processes of scientific inference in the context of organic chemistry." Stanford,
  Calif.: Stanford University,Computer Science Department, 1969.
Buchs, A., A. B. Del&o, C. Djerassi, A. M. Duftieid, B. G. Buchanan, E. A. Feigenbaum, I. Leder-
  berg, G. Schroll, and G. L. Sutherland. The application of artificial intelligence in the interpre-


PROJECT PUBLICATIONS 18 1

  tation of low-resolution mass spectra. In A. Quayle (Ed.), Advances in mass spectromerty,
  volume 5. London: The Institute of Petroleum, 1971,314-318.
Buchs, A., A. B. Deltino, A. M. Duftield, C. Djerassi, B. G. Buchanan, E. A. Feigenbaum, and J.
  Lederberg. Applications of "artificial intelligence" for chemical inference, VI. Approach to a
  general method oflnterpretinglowresolutionmass spectra with a computer. Helvetica Chimica
  Acta, 1970(a), 53:6,1394-1417.

Buchs, A., A. M. Duffield, G. SchroIl, C. Djerassi, A. B. Deltimo, B. G. Buchanan, G. L. Sutherland,
  E. A. Feigenbaum, and J. Lederberg. Applications of artificial intelligence for chemical infer-
  ence, N. Saturated amines diagnosed by their low resolution mass spectra and nuclear mag-
  netic resonance spectra. Journal of the American Chemical Society, 1970(b), 92~23, 6831-
  6838.

Carhart, R. E. A model-based approach to the teletype printing of chemical structures. Journal of
  Chemical Information and Computer Sciences, 1976,16,82.
Carhart, R. E. Erroneous claims concerning the perception of topological symmetry. Journal of
  Chemical Information and Computer Sciences, 1978,18,197.
Carhart, R. E., and C. Djerassi. Applications of artificial intelligence for chemical inference, part XI.
  Analysis of carbon-13 nuclear magnetic resonance data for structure elucidation of acyclic
  amines. Journal of the Chemical Society, Perkln Transactions II, 1973,1753-1759.
Carhart, R. E., S. M. Johnson, D. H. Smith, B. G. Buchanan, R. G. Dromey, and J. Lederberg.
  Networking and a collaborative research community: A case study using the DENDRAL pro-
  grams. In P. Lykos (Ed.), Proceedings of the American Chemical Society Symposium on Net-
  working and Chemistry, Chicago, August 1975(a).
Carhart, R. E., and D. H. Smith. Applications of artificial intelligence for chemical inference, XX.
  `Intelligent' use of constraints ln computerassisted structure elucidation. Computers in Chem-
  istry, 1976, 1,79.

Carhart, R. E., D. H. Smith, H. Brown, and C. Djerassl. Applications of artificial intelligence for
  chemical inference, XVII. An approach to computerassisted elucidation of molecular structure.
  Journal of the American Chemical Society, 1975(b), 97:20,5755-5762.
Carhart, R. E., D. H. Smith, H. Brown, and N. S. Sridharan. Applications of artificial intelligence
  for chemical inference, XVI. Computer generation of vertex-graphs and ring systems. Journal
  of Chemical Information and Computer Sciences, 1975(c), 15:2,124-130.
Cheer, C., D. H. Smith, C. Djerassi, B. Tursch, J. C. Braekman, and D. Daloze. Applications of
  artificial intelligence for chemical inference, XXI. The computer-assisted identification of
  [+I-palustrol in the marine organism cespitularia ap., aff. subvirdis. Tetrahedron, 1976, 32,
   1807.

Churchman, C. W., and B. G. Buchanan. On the design of inductive systems: Some philosophical
  problems. British Journal for the Philosophy of Science, 1969,20,311-323.
Davis, R. Applications of meta level knowledge to the construction, maintenance and use of large
  knowledge bases. Ph.D. dissertation, Department of Computer Science, Stanford University,
  July 1976.

Djerassi, C., D. H. Smith, and T. H. Varkony. A novel role of computers in the natural products
  field. Naturwissenschaften, 1979,66,9.

Dromey, R. G., B. G. Buchanan, D. H. Smith, J. Lederberg, and C. Dj&rassi. Applications of artlfl-
  cial intelligence for chemical inference, XN. A general method for predicting molecular ions
  in mass spectra. Journal of Organic Chemistry, 1975,40:6,770-774.
Dromey, R. G., M. J. Stefik, T. C. Rindfleisch, and A. M. Duffield. Extraction of mass spectra
  free of background and neighboring component contributions from gas chromatography/mass
  spectrometry data.Analytical Chemistry, 1976,48,1368.
Duffield, A.M., A. V. Robertson,C. Djerassl, B. G. Buchanan,G. L. Sutherland, E. A. Feigenbaum,
  and J. Lederberg. Applications of artificial intelligence for chemical inference, II. Interpreta-
  tion of low-resolution mass spectra of ketones. Journal of the American Chemical society,
  1969,91:11,2977-2981.

Emnut, L. D., and V. R. Lesser. The HEARSAY-II speech understanding system: A tutorial intro-
  duction and retrospective view. CMU-CS-78-117. Pittsburgh, Pa.: Department of Computer
  Science, Carnegie-Mellon University, May 1978.


182 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Ernst, G. W., and A. Newell. GPS: A case study in generality and problem solving. New York: Aca-
  demic Press, 1969.

Friedberg, R. M. A learning machine: part I. IBM Journal of Research and Development, 1958,2,
  2-13.

Feigenbaum, E. A. Artificial intelligence: Themes in the second decade. In A. J. H. Morrell (Ed.),
  Information Processing 68, Proceedings of IFIP Congress 1968. Amsterdam: North-Holland,
  1969, volume II, 1008-1023. Also Stanford Artificial Intelligence Project Memo AI-67.
  Stanford, Calif.: Stanford University, Computer Science Department, 1968.
Feigenbaum, E. A. Computer applications: Introductory remarks. In Proceedings of Federation of
  American Societies for ExperimentalBiology, 1974,33:12,2331-2332.
Feigenbaum, E. A., B. G. Buchanan, and J. Lederberg. On generality and problem solving: A case
  study using the DENDRAL program. In B. Meltzer and D. Michie (Eds.), Machine intelligence
  6. Edinburgh: Edinburgh University Press, 1971,165-19O.AlsoStanford ArtificiaZ Inteihgence
  Project Memo AIM-131 and Report No. CSI 76. Stanford, Calif.: Stanford University, Com-
  puter Science Department, 1970.

Feigenbaum, E. A., J. Lederberg, and B. G. Buchanan. Heuristic DENDRAL: A program for gener-
  ating explanatory hypotheses in organic chemistry. In B. K. Kinariwala and F. F. Kuo (Eds.),
  Proceedings of the Hawaii International Conference on System Sciences. Honolulu: University
  of Hawaii Press, 1968,482-485.

Feigenbaum, E. A., J. Lederberg, and B. G. Buchanan. Final Technical Report for Contract Period
  August 1,1973 through July 31,1977, Contract DAHC73Ca435. Submitted to Advanced
  Research Projects Agency, Department of Defense, October 1977.
Fitch, W. L., P. J. Anderson, and D. H. Smith. Isolation, identification and quantitation of urinary
  organic acids, Journal of Chromatography, 1979, 162,249-259.
Fitch, W. L., E. T. Everhart, and D. H. Smith. Characterization of carbon black adsorbates and arti-
  facts formed during extraction. Analytical Chemistry, 1978,50, 2122-2126.
Fitch, W. L., and D. H. Smith. Analysis of adsorption properties and adsorbed species of commer-
  cial polymeric carbons. Environmental Science and Technology 1979, 13,341-346.
Gaschnig, J. Exactly how good are heuristics ?: Toward a realistic predictive theory of best-fiist
  search. Fifth International Joint Conference of Artificial Intelligence-l 977. Proceedings of
  the conference held August 22-25,1977 at Massachusetts Institute of Technology, Cambridge,
  Mass. 434-441.

Gray, N. A. B., D. H. Smith, T. H. Varkony, R. E. Carhart, and B. G. Buchanan. Use of a Computer
  to identify unknown compounds: The automation of scientific inference. In G. R. Waller
  (Ed.), Biochemical applications of mass spectrometty (supplement). New York: Wiley-Inter-
  science, 1978.

Green, C. Theorem-proving by resolution as a basis for question-answering. Machine intelligence 4.
  New York: American Elsevier, 1969,183-205.
Hearn, A. C. REDUCE 2: A system and language for algebraic manipulation. In S. R. Petrick (Ed.),
  Proceedings of the ACM Second Symposium on Symbohc and Algebraic Manipulafion. Los
  Angeles, 1971.

Heller, S. R., G. W. A. Milne, and R. J. Feldman. Acomputer-based chemical information system.
  Science, 1977,195,4275.

Jennings, K. R. Someaspects of metastable transitions. In G. W. A. Mihte (Ed.),Mass spectrometry.'
  Techniques and applications. New York: Wiley-Inters**************************2
 1064.75300 4.415339+0 1065.85025 4.207016+0 1067.34650 3.927344+06637 3  1 2103
 1067.74550 3.853972+0 1068.34400 3.722730+0 1069.74050 3.421744+06637 3  1 2104
 1070.78788 3.159460+0 1071.83525 2.903131+0 1071.93500 2.879459+06637 3  1 2105
 1072.88263 2.611486+0 1073.73050 2.380323+0 1073.93000 2.318458+06637 3  1 2106
 1074.67813 2.095499+0 1074.92750 2.024508+0 1075.42625 1.868008+06637 3  1 2107
 1076.17438 1.646431+0 1076.92250 1.442649+0 1077.42125 1.319874+06637 3  1 2108
 1077.64569 1.272113+0 1078.10080 1.188351+0 1078.14444 1.182350+06637 3  1 2109
 1078.39381 1.155680+0 1078.64319 1.136399+0 1078.83022 1.138798+06637 3  1 2110
 1079.01725 1.147787+0 1079.16688 1.160651+0 1079.18558 1.162900+06637 3  1 2111
 1079.27909 1.181193+0 1079.36638 1.200833+0 1079.46613 1.226306+06637 3  1 2112
 1079.54717 1.249604+0 1079.64069 1.279668+0 1079.66251 1.287205+06637 3  1 2113
 1079.69056 1.297434+0 1079.72797 1.314501+0 1079.80278 1.351072+06637 3  1 2114
 1079.86513 1.383682+0 1079.93994 1.425552+0 1080.01475 1.470634+06637 3  1 2115
 1080.08956 1.519178+0 1080.11450 1.536498+0 1080.15191 1.566600+06637 3  1 2116
 1080.22672 1.630461+0 1080.31401 1.710422+0 1080.36388 1.758940+06637 3  1 2117
 1080.46363 1.862686+0 1080.51350 1.919266+0 1080.55714 1.974546+06637 3  1 2118
 1080.65066 2.102449+0 1080.75041 2.250397+0 1080.85265 2.416480+06637 3  1 2119
 1080.86263 2.434315+0 1080.97484 2.653719+0 1081.06462 2.844494+06637 3  1 2120
 1081.16936 3.086250+0 1081.19180 3.143007+0 1081.27409 3.367917+06637 3  1 2121
 1081.37883 3.680280+0 1081.49105 4.047817+0 1081.61075 4.513562+06637 3  1 2122
 1081.73045 5.030418+0 1081.79030 5.318555+0 1081.85015 5.627749+06637 3  1 2123
 1081.97983 6.376317+0 1082.08955 7.095171+0 1082.11948 7.303094+06637 3  1 2124
 1082.25913 8.409556+0 1082.28905 8.682339+0 1082.39878 9.728859+06637 3  1 2125
 1082.48855 1.071734+1 1082.53843 1.129398+1 1082.67808 1.316527+16637 3  1 2126
 1082.68805 1.332203+1 1082.81773 1.545634+1 1082.88755 1.678323+16637 3  1 2127
 1082.92246 1.748200+1 1083.02720 1.986164+1 1083.08705 2.141999+16637 3  1 2128
 1083.13194 2.264337+1 1083.23668 2.592812+1 1083.34141 2.989940+16637 3  1 2129
 1083.38630 3.189167+1 1083.44615 3.466286+1 1083.53593 3.955595+16637 3  1 2130
 1083.55089 4.040901+1 1083.65563 4.747580+1 1083.67558 4.908807+16637 3  1 2131
 1083.76036 5.621335+1 1083.81024 6.125368+1 1083.86510 6.702914+16637 3  1 2132
 1083.94490 7.715296+1 1083.96984 8.042899+1 1084.03468 9.037690+16637 3  1 2133
 1084.03966 9.116287+1 1084.10949 1.036436+2 1084.12445 1.067489+26637 3  1 2134
 1084.20425 1.237258+2 1084.21423 1.262261+2 1084.29403 1.466986+26637 3  1 2135
 1084.30400 1.496839+2 1084.38380 1.741731+2 1084.40874 1.830432+26637 3  1 2136
 1084.47358 2.066911+2 1084.51348 2.234119+2 1084.56335 2.448059+26637 3  1 2137
 1084.61821 2.719407+2 1084.67308 2.996513+2 1084.72295 3.284437+26637 3  1 2138
 1084.77283 3.578384+2 1084.86260 4.169040+2 1084.87258 4.236088+26637 3  1 2139
 1085.02220 5.357927+2 1085.06210 5.688328+2 1085.42120 8.680164+26637 3  1 2140
 1085.58080 9.835433+2 1085.73043 1.063926+3 1085.74040 1.067288+36637 3  1 2141
 1085.86010 1.103806+3 1085.87008 1.106652+3 1085.90000 1.109280+36637 3  1 2142
 1085.98105 1.114465+3 1086.04963 1.105944+3 1086.10449 1.097200+36637 3  1 2143
 1086.19925 1.061986+3 1086.26908 1.033907+3 1086.37880 9.715727+26637 3  1 2144
 1086.57830 8.297756+2 1086.86758 6.101790+2 1086.91745 5.729421+26637 3  1 2145
 1087.01720 5.057642+2 1087.05710 4.794361+2 1087.15685 4.211869+26637 3  1 2146
 1087.19675 3.983725+2 1087.26159 3.665646+2 1087.33640 3.306187+26637 3  1 2147
 1087.36633 3.184064+2 1087.45610 2.826097+2 1087.47106 2.775455+26637 3  1 2148
 1087.57580 2.429524+2 1087.68553 2.132290+2 1087.69550 2.105903+26637 3  1 2149
 1087.79525 1.885456+2 1087.81520 1.842380+2 1087.90498 1.680557+26637 3  1 2150
 1087.93490 1.627851+2 1088.01470 1.510127+2 1088.05460 1.452566+26637 3  1 2151
 1088.12443 1.370952+2 1088.23415 1.245549+2 1088.34388 1.148211+26637 3  1 2152
 1088.40373 1.096090+2 1088.45360 1.061735+2 1088.59325 9.675438+16637 3  1 2153
 1088.62318 9.477310+1 1088.73290 8.906704+1 1088.84263 8.348753+16637 3  1 2154
 1088.94238 7.939345+1 1089.06208 7.460170+1 1089.15185 7.176073+16637 3  1 2155
 1089.36133 6.528387+1 1089.39125 6.437493+1 1089.57080 6.015063+16637 3  1 2156
 1089.72043 5.669521+1 1089.81020 5.503904+1 1090.04960 5.070633+16637 3  1 2157
 1090.28900 4.725274+1 1090.40870 4.555606+1 1090.64810 4.277557+16637 3  1 2158
 1090.76780 4.141208+1 1091.00720 3.919755+1 1091.24660 3.702215+16637 3  1 2159
 1091.36630 3.618497+1 1091.66056 3.416025+1 1091.96480 3.209330+16637 3  1 2160
 1092.00969 3.186269+1 1092.53338 2.921968+1 1092.68300 2.847662+16637 3  1 2161
 1093.05706 2.702535+1 1093.40120 2.571044+1 1093.58075 2.517647+16637 3  1 2162
 1094.10444 2.364223+1 1094.37875 2.284904+1 1094.77775 2.195520+16637 3  1 2163
 1095.37625 2.063480+1 1095.52588 2.038038+1 1096.27400 1.912876+16637 3  1 2164
 1096.87250 1.814074+1 1097.02213 1.795106+1 1097.77025 1.701785+16637 3  1 2165
 1098.46850 1.616178+1 1098.66800 1.592042+1 1099.08155 1.542611+16637 3  1 2166
 1099.23890 1.524220+1 1099.49510 1.492614+1 1099.77080 1.459516+16637 3  1 2167
 1100.04650 1.427582+1 1100.25328 1.404872+1 1100.39113 1.390716+16637 3  1 2168
 1100.52898 1.377847+1 1100.60780 1.371493+1 1100.63236 1.368448+16637 3  1 2169
 1100.73575 1.357363+1 1100.83914 1.348871+1 1100.91513 1.345010+16637 3  1 2170
 1100.97743 1.343885+1 1101.03973 1.345123+1 1101.10202 1.349327+16637 3  1 2171
 1101.16432 1.357222+1 1101.22662 1.369676+1 1101.28891 1.387704+16637 3  1 2172
 1101.35121 1.412468+1 1101.41351 1.445285+1 1101.47580 1.487608+16637 3  1 2173
 1101.48826 1.498286+1 1101.53810 1.546089+1 1101.60455 1.623870+16637 3  1 2174
 1101.65439 1.694555+1 1101.67100 1.720587+1 1101.73745 1.843124+16637 3  1 2175
 1101.80390 1.985794+1 1101.82051 2.026841+1 1101.87035 2.161559+16637 3  1 2176
 1101.93680 2.363631+1 1101.98664 2.536427+1 1102.03648 2.723051+16637 3  1 2177
 1102.12286 3.089676+1 1102.14280 3.180459+1 1102.28234 3.883681+16637 3  1 2178
 1102.28899 3.919311+1 1102.44182 4.764824+1 1102.57472 5.531436+16637 3  1 2179
 1102.70762 6.197424+1 1102.83056 6.686597+1 1102.90531 6.896676+16637 3  1 2180
 1102.93355 6.964459+1 1103.00000 7.059358+1 1103.09303 7.099640+16637 3  1 2181
 1103.10300 7.098463+1 1103.21264 6.954768+1 1103.27245 6.813362+16637 3  1 2182
 1103.31896 6.684131+1 1103.34554 6.585193+1 1103.47844 6.036695+16637 3  1 2183
 1103.54489 5.726285+1 1103.61134 5.394249+1 1103.78411 4.489823+16637 3  1 2184
 1103.92366 3.822207+1 1104.01669 3.425694+1 1104.09643 3.120648+16637 3  1 2185
 1104.16288 2.891361+1 1104.22933 2.684108+1 1104.27916 2.544327+16637 3  1 2186
 1104.29578 2.501953+1 1104.36223 2.351796+1 1104.42868 2.219053+16637 3  1 2187
 1104.49513 2.101743+1 1104.52835 2.049813+1 1104.56158 2.004736+16637 3  1 2188
 1104.61972 1.935360+1 1104.66956 1.881969+1 1104.71939 1.833438+16637 3  1 2189
 1104.76923 1.789102+1 1104.77754 1.782312+1 1104.81907 1.755130+16637 3  1 2190
 1104.86891 1.725587+1 1104.91874 1.698653+1 1104.99350 1.662253+16637 3  1 2191
 1105.06826 1.629645+1 1105.12640 1.606521+1 1105.14301 1.601774+16637 3  1 2192
 1105.21777 1.582568+1 1105.29253 1.564979+1 1105.39220 1.543349+16637 3  1 2193
 1105.51679 1.518314+1 1105.64139 1.494722+1 1105.65800 1.491716+16637 3  1 2194
 1105.80751 1.473960+1 1105.97364 1.455244+1 1106.22283 1.428354+16637 3  1 2195
 1106.38895 1.410964+1 1106.58830 1.390612+1 1106.72120 1.381843+16637 3  1 2196
 1107.07006 1.359672+1 1107.41893 1.338078+1 1107.88408 1.309890+16637 3  1 2197
 1108.34923 1.282171+1 1108.44890 1.276313+1 1109.04695 1.252328+16637 3  1 2198
 1109.51210 1.233937+1 1110.44240 1.197574+1 1110.85625 1.181569+16637 3  1 2199
 1111.37270 1.166499+1 1112.30300 1.139615+1 1113.39575 1.108285+16637 3  1 2200
 1114.49000 1.077163+1 1115.03488 1.063148+1 1116.67400 1.021356+16637 3  1 2201
 1117.90250 9.902773+0 1119.13100 9.594322+0 1120.35950 9.288636+06637 3  1 2202
 1121.58800 8.986649+0 1122.40700 8.788074+0 1123.08950 8.625053+06637 3  1 2203
 1123.22600 8.579959+0 1124.04500 8.313303+0 1124.86400 8.052057+06637 3  1 2204
 1125.00050 8.009623+0 1125.47825 7.810627+0 1126.09250 7.560668+06637 3  1 2205
 1126.63850 7.345325+0 1126.65556 7.336250+0 1127.11625 7.098013+06637 3  1 2206
 1127.57694 6.868121+0 1127.66225 6.827656+0 1128.03763 6.583876+06637 3  1 2207
 1128.34475 6.392901+0 1128.65188 6.210865+0 1128.68600 6.191933+06637 3  1 2208
 1128.95900 5.983174+0 1129.24053 5.781321+0 1129.30025 5.742142+06637 3  1 2209
 1129.52206 5.546342+0 1129.80359 5.321144+0 1129.91450 5.245295+06637 3  1 2210
 1130.08513 5.087493+0 1130.27281 4.939145+0 1130.32400 4.906279+06637 3  1 2211
 1130.46050 4.790748+0 1130.63966 4.674692+0 1130.81881 4.608342+06637 3  1 2212
 1130.93825 4.603570+0 1131.05769 4.643809+0 1131.07475 4.658587+06637 3  1 2213
 1131.17713 4.786225+0 1131.21125 4.850743+0 1131.26670 4.985986+06637 3  1 2214
 1131.31363 5.135801+0 1131.34775 5.261359+0 1131.35628 5.297040+06637 3  1 2215
 1131.41600 5.611420+0 1131.45695 5.865288+0 1131.49278 6.137161+06637 3  1 2216
 1131.53885 6.536974+0 1131.54397 6.589831+0 1131.59516 7.175239+06637 3  1 2217
 1131.62075 7.502718+0 1131.64634 7.884413+0 1131.69753 8.732396+06637 3  1 2218
 1131.70265 8.827385+0 1131.74872 9.788752+0 1131.76408 1.014574+16637 3  1 2219
 1131.79991 1.106491+1 1131.82550 1.178548+1 1131.84086 1.226167+16637 3  1 2220
 1131.88693 1.381608+1 1131.93299 1.567690+1 1131.94835 1.635562+16637 3  1 2221
 1131.97906 1.783125+1 1132.00978 1.943954+1 1132.02513 2.031133+16637 3  1 2222
 1132.07120 2.315118+1 1132.12580 2.715453+1 1132.14798 2.894198+16637 3  1 2223
 1132.18040 3.178888+1 1132.22476 3.606869+1 1132.24183 3.782971+16637 3  1 2224
 1132.27595 4.168315+1 1132.29813 4.434753+1 1132.35103 5.126883+16637 3  1 2225
 1132.35956 5.246248+1 1132.41245 6.045777+1 1132.42610 6.271401+16637 3  1 2226
 1132.49435 7.476183+1 1132.52848 8.134821+1 1132.56260 8.833049+16637 3  1 2227
 1132.61038 9.890779+1 1132.64450 1.069031+2 1132.75370 1.347364+26637 3  1 2228
 1132.86290 1.662723+2 1133.12225 2.453208+2 1133.24510 2.806752+26637 3  1 2229
 1133.28605 2.911691+2 1133.38160 3.129963+2 1133.40890 3.180135+26637 3  1 2230
 1133.51810 3.346038+2 1133.53175 3.360247+2 1133.60000 3.412405+26637 3  1 2231
 1133.61365 3.419370+2 1133.70238 3.420643+2 1133.73650 3.411764+26637 3  1 2232
 1133.79110 3.365739+2 1133.87300 3.274605+2 1133.91395 3.208893+26637 3  1 2233
 1133.98220 3.080432+2 1134.07775 2.867390+2 1134.09140 2.834563+26637 3  1 2234
 1134.28250 2.318294+2 1134.39853 1.996363+2 1134.52138 1.665692+26637 3  1 2235
 1134.55550 1.577718+2 1134.61693 1.431278+2 1134.67835 1.292009+26637 3  1 2236
 1134.71248 1.221340+2 1134.80120 1.048416+2 1134.80803 1.036544+26637 3  1 2237
 1134.89675 8.924858+1 1134.92405 8.508629+1 1134.97865 7.786516+16637 3  1 2238
 1135.04690 6.942594+1 1135.06055 6.798308+1 1135.12198 6.190228+16637 3  1 2239
 1135.17060 5.733673+1 1135.18340 5.632773+1 1135.24483 5.176175+16637 3  1 2240
 1135.29601 4.815830+1 1135.30625 4.756001+1 1135.36768 4.417925+16637 3  1 2241
 1135.42142 4.137726+1 1135.42910 4.104655+1 1135.49053 3.855232+16637 3  1 2242
 1135.54683 3.639796+1 1135.57072 3.562123+1 1135.63044 3.381310+16637 3  1 2243
 1135.66030 3.305818+1 1135.74988 3.095551+1 1135.79765 2.989937+16637 3  1 2244
 1135.83945 2.916828+1 1135.92903 2.769332+1 1135.96486 2.712704+16637 3  1 2245
 1135.98875 2.683261+1 1136.10819 2.543222+1 1136.21568 2.423591+16637 3  1 2246
 1136.22763 2.413216+1 1136.34706 2.314600+1 1136.46650 2.219739+16637 3  1 2247
 1136.61227 2.133898+1 1136.75804 2.051560+1 1136.90381 1.972426+16637 3  1 2248
 1137.04958 1.914071+1 1137.14068 1.879770+1 1137.23179 1.847617+16637 3  1 2249
 1137.34111 1.812749+1 1137.41400 1.797754+1 1137.48688 1.785722+16637 3  1 2250
 1137.55977 1.777300+1 1137.63265 1.773244+1 1137.69070 1.773688+16637 3  1 2251
 1137.76326 1.779562+1 1137.83583 1.792188+1 1137.90839 1.812455+16637 3  1 2252
 1137.92290 1.818197+1 1137.98095 1.846713+1 1138.05351 1.891464+16637 3  1 2253
 1138.12608 1.945750+1 1138.21315 2.025322+1 1138.23492 2.047841+16637 3  1 2254
 1138.36989 2.215263+1 1138.45116 2.331719+1 1138.56726 2.514713+16637 3  1 2255
 1138.68916 2.707547+1 1138.75882 2.828991+1 1138.90975 3.053351+16637 3  1 2256
 1139.04907 3.202531+1 1139.16518 3.268912+1 1139.17678 3.275132+16637 3  1 2257
 1139.20000 3.280435+1 1139.31030 3.275273+1 1139.40898 3.229997+16637 3  1 2258
 1139.50186 3.153225+1 1139.52508 3.130685+1 1139.67601 2.931741+16637 3  1 2259
 1139.68762 2.914751+1 1139.98948 2.418430+1 1140.01996 2.365053+16637 3  1 2260
 1140.15057 2.160660+1 1140.24853 2.025756+1 1140.34649 1.908151+16637 3  1 2261
 1140.41179 1.839338+1 1140.47710 1.777859+1 1140.54966 1.717582+16637 3  1 2262
 1140.62223 1.664987+1 1140.69479 1.619194+1 1140.74921 1.588762+16637 3  1 2263
 1140.80363 1.561261+1 1140.82540 1.551288+1 1140.85805 1.538937+16637 3  1 2264
 1140.91248 1.520577+1 1140.98504 1.499026+1 1141.05760 1.480217+16637 3  1 2265
 1141.13016 1.463586+1 1141.20273 1.448659+1 1141.27529 1.435052+16637 3  1 2266
 1141.34785 1.422456+1 1141.45669 1.404943+1 1141.52200 1.395120+16637 3  1 2267
 1141.56554 1.391018+1 1141.71066 1.378461+1 1141.92835 1.360975+16637 3  1 2268
 1142.14604 1.344344+1 1142.39275 1.326059+1 1142.74105 1.300856+16637 3  1 2269
 1142.91520 1.288529+1 1143.26350 1.273105+1 1143.78595 1.250586+16637 3  1 2270
 1144.30840 1.228467+1 1145.00500 1.199402+1 1145.70160 1.181060+16637 3  1 2271
 1146.39820 1.162963+1 1147.52354 1.134099+1 1148.54143 1.108294+16637 3  1 2272
 1148.64888 1.106368+1 1149.77421 1.086445+1 1150.89955 1.066730+16637 3  1 2273
 1152.02489 1.047210+1 1152.53000 1.038519+1 1153.50500 1.021891+16637 3  1 2274
 1154.35000 1.007679+1 1154.98375 9.971939+0 1155.61750 9.869249+06637 3  1 2275
 1155.91000 9.823041+0 1156.04000 9.792001+0 1156.49500 9.685552+06637 3  1 2276
 1156.83625 9.607775+0 1157.17750 9.532474+0 1157.51875 9.460655+06637 3  1 2277
 1157.74625 9.415469+0 1157.86000 9.394560+0 1158.02250 9.334246+06637 3  1 2278
 1158.26625 9.249055+0 1158.42875 9.196223+0 1158.59125 9.147979+06637 3  1 2279
 1158.75375 9.106538+0 1158.78625 9.100073+0 1158.87563 9.051639+06637 3  1 2280
 1158.99750 8.994744+0 1159.07875 8.964284+0 1159.16000 8.942339+06637 3  1 2281
 1159.23313 8.932426+0 1159.30625 8.935006+0 1159.37938 8.954094+06637 3  1 2282
 1159.45250 8.994925+0 1159.52563 9.064138+0 1159.57438 9.130097+06637 3  1 2283
 1159.61500 9.201073+0 1159.62313 9.216105+0 1159.67188 9.328814+06637 3  1 2284
 1159.72063 9.467856+0 1159.76938 9.637438+0 1159.81813 9.842201+06637 3  1 2285
 1159.86688 1.008721+1 1159.91563 1.037790+1 1159.97250 1.078252+16637 3  1 2286
 1160.03750 1.134307+1 1160.04156 1.138550+1 1160.06188 1.161068+16637 3  1 2287
 1160.10250 1.208910+1 1160.16750 1.298796+1 1160.23250 1.403377+16637 3  1 2288
 1160.26500 1.463609+1 1160.29750 1.528915+1 1160.36250 1.676323+16637 3  1 2289
 1160.41775 1.820056+1 1160.46000 1.937780+1 1160.53800 2.182980+16637 3  1 2290
 1160.57050 2.294778+1 1160.61600 2.461096+1 1160.72325 2.891221+16637 3  1 2291
 1160.77200 3.097239+1 1160.87600 3.557240+1 1161.00600 4.159258+16637 3  1 2292
 1161.13600 4.704127+1 1161.16200 4.812952+1 1161.30500 5.288792+16637 3  1 2293
 1161.41550 5.534646+1 1161.43663 5.575742+1 1161.50000 5.642547+16637 3  1 2294
 1161.57800 5.663409+1 1161.60400 5.661808+1 1161.71450 5.548473+16637 3  1 2295
 1161.73400 5.511579+1 1161.82500 5.310168+1 1161.86075 5.203539+16637 3  1 2296
 1161.98100 4.805732+1 1162.04600 4.559758+1 1162.27675 3.613646+16637 3  1 2297
 1162.29300 3.551142+1 1162.39375 3.152299+1 1162.49125 2.800812+16637 3  1 2298
 1162.58875 2.486510+1 1162.66188 2.276395+1 1162.70250 2.171730+16637 3  1 2299
 1162.73500 2.092707+1 1162.80813 1.935601+1 1162.88125 1.797655+16637 3  1 2300
 1162.93609 1.705650+1 1162.94625 1.690249+1 1162.99094 1.629347+16637 3  1 2301
 1163.04578 1.562588+1 1163.10063 1.502932+1 1163.15547 1.449538+16637 3  1 2302
 1163.19000 1.419354+1 1163.21031 1.404385+1 1163.26516 1.368675+16637 3  1 2303
 1163.32000 1.336995+1 1163.37688 1.307744+1 1163.43375 1.281567+16637 3  1 2304
 1163.49063 1.257935+1 1163.53125 1.242556+1 1163.54750 1.238112+16637 3  1 2305
 1163.60438 1.224271+1 1163.66125 1.211826+1 1163.74656 1.195205+16637 3  1 2306
 1163.83188 1.180428+1 1163.91719 1.166981+1 1164.00250 1.154491+16637 3  1 2307
 1164.10000 1.141111+1 1164.11625 1.139773+1 1164.23000 1.131230+16637 3  1 2308
 1164.39250 1.119952+1 1164.55500 1.109386+1 1164.71750 1.099297+16637 3  1 2309
 1164.96125 1.084774+1 1165.07500 1.078237+1 1165.20500 1.073825+16637 3  1 2310
 1165.44875 1.065917+1 1165.66813 1.059029+1 1165.94438 1.050590+16637 3  1 2311
 1166.35875 1.038289+1 1166.44000 1.035936+1 1166.77313 1.030458+16637 3  1 2312
 1167.18750 1.023856+1 1167.74000 1.015284+1 1168.36960 1.005740+16637 3  1 2313
 1168.99920 9.963559+0 1169.56000 9.880979+0 1169.62879 9.875575+06637 3  1 2314
 1170.57319 9.802841+0 1171.51759 9.731310+0 1172.77678 9.637140+06637 3  1 2315
 1173.99936 9.546555+0 1175.83323 9.411755+0 1178.01032 9.252898+06637 3  1 2316
 1178.27838 9.237991+0 1180.72354 9.102980+0 1182.55741 9.002280+06637 3  1 2317
 1184.81056 8.879308+0 1186.50042 8.787716+0 1188.19028 8.696914+06637 3  1 2318
 1188.73982 8.667696+0 1189.31685 8.620687+0 1190.44343 8.529617+06637 3  1 2319
 1191.28836 8.461996+0 1192.05650 8.401263+0 1192.78625 8.344447+06637 3  1 2320
 1193.51600 8.288841+0 1194.24575 8.234983+0 1194.69750 8.202930+06637 3  1 2321
 1194.73225 8.197035+0 1195.21875 8.116079+0 1195.70525 8.037292+06637 3  1 2322
 1196.07013 7.980162+0 1196.43500 7.925348+0 1196.79988 7.873717+06637 3  1 2323
 1197.04313 7.841703+0 1197.06050 7.839601+0 1197.28638 7.772765+06637 3  1 2324
 1197.56438 7.694722+0 1197.79894 7.633659+0 1198.03350 7.578813+06637 3  1 2325
 1198.15513 7.554144+0 1198.18988 7.538291+0 1198.34625 7.472487+06637 3  1 2326
 1198.50263 7.414706+0 1198.61991 7.379221+0 1198.71113 7.358420+06637 3  1 2327
 1198.81538 7.345088+0 1198.89356 7.329282+0 1198.97175 7.325479+06637 3  1 2328
 1199.04994 7.337785+0 1199.12813 7.371668+0 1199.20631 7.434319+06637 3  1 2329
 1199.25844 7.496544+0 1199.31056 7.578992+0 1199.36269 7.685545+06637 3  1 2330
 1199.41481 7.820712+0 1199.46694 7.989593+0 1199.52775 8.236990+06637 3  1 2331
 1199.57988 8.499623+0 1199.63200 8.847139+0 1199.66675 9.120134+06637 3  1 2332
 1199.68413 9.269617+0 1199.73625 9.788282+0 1199.80575 1.060423+16637 3  1 2333
 1199.84050 1.109298+1 1199.87525 1.162773+1 1199.94475 1.287969+16637 3  1 2334
 1199.96821 1.337051+1 1200.01425 1.440842+1 1200.07506 1.595850+16637 3  1 2335
 1200.09591 1.655931+1 1200.15325 1.833059+1 1200.22362 2.077566+16637 3  1 2336
 1200.23144 2.106652+1 1200.30963 2.427405+1 1200.35133 2.615825+16637 3  1 2337
 1200.41388 2.914947+1 1200.47903 3.258455+1 1200.59110 3.877608+16637 3  1 2338
 1200.60500 3.956671+1 1200.77180 4.943791+1 1200.81350 5.193650+16637 3  1 2339
 1200.97335 6.052946+1 1201.09150 6.571802+1 1201.10540 6.616592+16637 3  1 2340
 1201.21660 6.934523+1 1201.27220 7.030310+1 1201.30000 7.066343+16637 3  1 2341
 1201.39730 7.078174+1 1201.42510 7.068326+1 1201.54325 6.873485+16637 3  1 2342
 1201.54673 6.863957+1 1201.58495 6.746611+1 1201.66835 6.465124+16637 3  1 2343
 1201.73090 6.197202+1 1201.84210 5.667974+1 1201.93940 5.171173+16637 3  1 2344
 1202.14790 4.041397+1 1202.27300 3.428001+1 1202.37725 2.969987+16637 3  1 2345
 1202.45544 2.661304+1 1202.47455 2.593204+1 1202.53363 2.395128+16637 3  1 2346
 1202.61181 2.161909+1 1202.63788 2.093119+1 1202.69000 1.965396+16637 3  1 2347
 1202.74864 1.837807+1 1202.80728 1.722685+1 1202.81163 1.714976+16637 3  1 2348
 1202.86592 1.628338+1 1202.92456 1.544695+1 1202.98320 1.469760+16637 3  1 2349
 1202.98538 1.467255+1 1203.04184 1.411810+1 1203.10048 1.360698+16637 3  1 2350
 1203.15913 1.315078+1 1203.21777 1.274085+1 1203.24600 1.256206+16637 3  1 2351
 1203.27641 1.240927+1 1203.34373 1.210996+1 1203.40020 1.188508+16637 3  1 2352
 1203.45667 1.167957+1 1203.51314 1.148988+1 1203.52400 1.145640+16637 3  1 2353
 1203.59784 1.128201+1 1203.68255 1.110322+1 1203.76725 1.093991+16637 3  1 2354
 1203.80200 1.087754+1 1203.85195 1.081212+1 1203.93666 1.070944+16637 3  1 2355
 1204.04959 1.058179+1 1204.21900 1.040367+1 1204.35800 1.026614+16637 3  1 2356
 1204.39275 1.024413+1 1204.56650 1.014121+1 1204.74025 1.004330+16637 3  1 2357
 1205.00088 9.903135+0 1205.26150 9.768751+0 1205.40050 9.699288+06637 3  1 2358
 1205.52213 9.663576+0 1205.75669 9.597356+0 1206.05206 9.516673+06637 3  1 2359
 1206.34744 9.438295+0 1206.79050 9.323912+0 1206.99900 9.271388+06637 3  1 2360
 1207.23356 9.237998+0 1207.67663 9.176918+0 1208.13992 9.114615+06637 3  1 2361
 1208.64368 9.048216+0 1209.31535 8.961269+0 1209.82470 8.896325+06637 3  1 2362
 1209.98703 8.884369+0 1210.65870 8.835835+0 1211.66621 8.764284+06637 3  1 2363
 1212.67373 8.693799+0 1213.87189 8.610850+0 1214.54879 8.564424+06637 3  1 2364
 1215.45135 8.520715+0 1217.03080 8.445017+0 1218.61026 8.369869+06637 3  1 2365
 1220.71621 8.270309+0 1221.76918 8.220762+0 1223.87083 8.122298+06637 3  1 2366
 1225.97249 8.024451+0 1228.07414 7.927392+0 1229.47524 7.863294+06637 3  1 2367
 1230.87635 7.799874+0 1231.17030 7.786743+0 1231.92717 7.729267+06637 3  1 2368
 1232.97800 7.650271+0 1233.78125 7.590615+0 1234.58450 7.531821+06637 3  1 2369
 1235.38775 7.474218+0 1236.15275 7.420980+0 1236.19100 7.415557+06637 3  1 2370
 1236.72650 7.340964+0 1237.26200 7.267842+0 1237.72100 7.206733+06637 3  1 2371
 1238.18000 7.147567+0 1238.63900 7.091031+0 1238.79200 7.073410+06637 3  1 2372
 1239.09800 7.002731+0 1239.40400 6.934874+0 1239.71000 6.870089+06637 3  1 2373
 1239.99688 6.813053+0 1240.05425 6.802616+0 1240.28375 6.727218+06637 3  1 2374
 1240.57063 6.639659+0 1240.76188 6.586385+0 1240.83838 6.567301+06637 3  1 2375
 1240.95313 6.512958+0 1241.14438 6.429988+0 1241.30216 6.369617+06637 3  1 2376
 1241.42647 6.329398+0 1241.55078 6.298458+0 1241.56513 6.296449+06637 3  1 2377
 1241.67509 6.251940+0 1241.76833 6.227101+0 1241.86156 6.218111+06637 3  1 2378
 1241.95480 6.231259+0 1242.01695 6.256601+0 1242.07911 6.299110+06637 3  1 2379
 1242.14127 6.363053+0 1242.20342 6.453638+0 1242.25602 6.555704+06637 3  1 2380
 1242.31100 6.695515+0 1242.32056 6.724999+0 1242.38511 6.976040+06637 3  1 2381
 1242.44966 7.290465+0 1242.50225 7.609035+0 1242.51420 7.692908+06637 3  1 2382
 1242.57875 8.237320+0 1242.64330 8.889720+0 1242.64569 8.918545+06637 3  1 2383
 1242.70784 9.739272+0 1242.74036 1.024177+1 1242.77239 1.077733+16637 3  1 2384
 1242.83407 1.196614+1 1242.83694 1.202609+1 1242.90148 1.355874+16637 3  1 2385
 1242.92778 1.427565+1 1242.98038 1.581389+1 1243.02149 1.719794+16637 3  1 2386
 1243.06644 1.881682+1 1243.11521 2.081336+1 1243.15250 2.243951+16637 3  1 2387
 1243.20892 2.518511+1 1243.23856 2.671357+1 1243.30263 3.033339+16637 3  1 2388
 1243.32463 3.164247+1 1243.39634 3.629855+1 1243.45085 4.001519+16637 3  1 2389
 1243.51205 4.448900+1 1243.64975 5.501950+1 1243.85630 7.126836+16637 3  1 2390
 1243.98635 8.031142+1 1244.02460 8.254249+1 1244.10110 8.660926+16637 3  1 2391
 1244.19673 9.029566+1 1244.23498 9.148754+1 1244.30000 9.266749+16637 3  1 2392
 1244.34590 9.296917+1 1244.40710 9.286915+1 1244.48743 9.162819+16637 3  1 2393
 1244.50655 9.124255+1 1244.51420 9.105910+1 1244.62130 8.718483+16637 3  1 2394
 1244.75135 8.012177+1 1244.78960 7.783908+1 1244.88140 7.162940+16637 3  1 2395
 1245.09560 5.621345+1 1245.12620 5.412135+1 1245.23330 4.675022+16637 3  1 2396
 1245.32510 4.092267+1 1245.37100 3.825870+1 1245.42838 3.510471+16637 3  1 2397
 1245.51444 3.085093+1 1245.56225 2.872509+1 1245.60050 2.714988+16637 3  1 2398
 1245.65788 2.501277+1 1245.70569 2.337246+1 1245.71525 2.307106+16637 3  1 2399
 1245.77263 2.141869+1 1245.83000 1.990966+1 1245.84913 1.945217+16637 3  1 2400
 1245.89455 1.849240+1 1245.95909 1.727268+1 1246.02364 1.617804+16637 3  1 2401
 1246.04038 1.592198+1 1246.08819 1.531071+1 1246.15273 1.457623+16637 3  1 2402
 1246.21728 1.391769+1 1246.25075 1.360885+1 1246.28183 1.337752+16637 3  1 2403
 1246.34638 1.294869+1 1246.41092 1.256186+1 1246.47547 1.220886+16637 3  1 2404
 1246.48025 1.218485+1 1246.54958 1.192409+1 1246.61173 1.171190+16637 3  1 2405
 1246.70497 1.142170+1 1246.79820 1.115657+1 1246.82450 1.108683+16637 3  1 2406
 1246.89144 1.096778+1 1247.01575 1.076608+1 1247.14006 1.057950+16637 3  1 2407
 1247.26438 1.040317+1 1247.43650 1.017101+1 1247.45084 1.015834+16637 3  1 2408
 1247.60863 1.002735+1 1247.79988 9.875858+0 1247.99113 9.730268+06637 3  1 2409
 1248.20150 9.576023+0 1248.27800 9.540931+0 1248.56488 9.416334+06637 3  1 2410
 1248.85175 9.296781+0 1249.20556 9.154379+0 1249.53069 9.027146+06637 3  1 2411
 1249.65500 8.979488+0 1249.85581 8.935256+0 1250.34350 8.831416+06637 3  1 2412
 1250.83119 8.730708+0 1251.31888 8.632261+0 1251.79700 8.537402+06637 3  1 2413
 1251.81628 8.535135+0 1252.33312 8.475754+0 1253.02224 8.398196+06637 3  1 2414
 1253.71136 8.322001+0 1254.40048 8.246807+0 1255.01000 8.181092+06637 3  1 2415
 1255.43415 8.154863+0 1256.46783 8.092111+0 1257.56074 8.026640+06637 3  1 2416
 1258.77212 7.954830+0 1260.38729 7.860038+0 1262.00246 7.765978+06637 3  1 2417
 1263.61763 7.672535+0 1265.19401 7.581910+0 1266.77039 7.491916+06637 3  1 2418
 1268.34678 7.402682+0 1269.39770 7.343814+0 1269.70441 7.326852+06637 3  1 2419
 1270.44862 7.268989+0 1271.23681 7.208419+0 1272.02500 7.148749+06637 3  1 2420
 1272.74375 7.095501+0 1273.28281 7.056647+0 1273.82188 7.019159+06637 3  1 2421
 1274.02500 7.005639+0 1274.18125 6.983425+0 1274.54063 6.933521+06637 3  1 2422
 1274.90000 6.885245+0 1275.24375 6.841210+0 1275.50156 6.810114+06637 3  1 2423
 1275.75938 6.781338+0 1275.90000 6.767438+0 1276.01719 6.739541+06637 3  1 2424
 1276.18906 6.701247+0 1276.34531 6.669062+0 1276.48594 6.643174+06637 3  1 2425
 1276.62656 6.621662+0 1276.73203 6.609829+0 1276.79063 6.606320+06637 3  1 2426
 1276.83750 6.594948+0 1276.94297 6.577465+0 1277.01328 6.572179+06637 3  1 2427
 1277.08359 6.573797+0 1277.15391 6.584376+0 1277.22422 6.606552+06637 3  1 2428
 1277.29453 6.643624+0 1277.34727 6.683631+0 1277.40000 6.736366+06637 3  1 2429
 1277.45859 6.812776+0 1277.51719 6.911554+0 1277.57578 7.036972+06637 3  1 2430
 1277.63438 7.193814+0 1277.69297 7.387403+0 1277.75156 7.623524+06637 3  1 2431
 1277.81016 7.908364+0 1277.86875 8.248411+0 1277.90000 8.462751+06637 3  1 2432
 1277.92734 8.661179+0 1277.93906 8.759899+0 1277.98594 9.173151+06637 3  1 2433
 1278.05234 9.849104+0 1278.13438 1.082844+1 1278.21641 1.204476+16637 3  1 2434
 1278.28594 1.322578+1 1278.29844 1.344987+1 1278.40781 1.568319+16637 3  1 2435
 1278.43281 1.626303+1 1278.53438 1.872827+1 1278.57969 1.993796+16637 3  1 2436
 1278.72656 2.402117+1 1278.92500 2.975230+1 1278.95000 3.048448+16637 3  1 2437
 1279.10000 3.422478+1 1279.23282 3.673852+1 1279.31875 3.778005+16637 3  1 2438
 1279.35157 3.812993+1 1279.40000 3.840671+1 1279.48750 3.849961+16637 3  1 2439
 1279.50625 3.848679+1 1279.61875 3.770035+1 1279.65625 3.722447+16637 3  1 2440
 1279.73125 3.614280+1 1279.78750 3.504343+1**************************cience, 1971,419-458.
Kuhn, T. S. The structure of scientific revolutions. Chicago: The University of Chicago Press, 1962.
Laudan, L. Peirce and the trivialization of the selfcorrecting thesis. In R. N. Giere and R. S. Westfall
  (Eds.), Foundations of scientific method: The nineteenth century. Bloomington: Indiana Uni-
  versity Press, 1973.

Lederberg, J. Computation of molecular formulas for mass spectrometty. San Francisco: Holden-
  Day, 1964(a).

Lederberg, J. DENDRAL-64, a system for computer construction, enumeration and notation of
  organic molecules as tree structures and cyclic graphs, part I. Notational algorithm for tree
  structures. Report No. CR-57029 and STAR No. N65-13158. National Aeronauticsand Space
  Administration, 1964(b).


PROJECT PUBLICATIONS I83

Lederberg, J. DENDRAL-64, a system for computer construction, enumeration and notation of
  organic molecules as tree structures and cyclic graphs, part II. Topology of cyclic graphs.
  Report No. CR-68898 and STAR No. N66-14074. National Aeronautics and Space Admini-
  stration, 1965(a).

Lederberg, J. Topological mapping of organic molecules. Proceedings of the National Academy of
  Sciences, 1965(b),53:1,134-139.

Lederberg, J. Systematics of organic molecules, graph topology and Hamilton circuits, a general
  outline of the DENDRAL system. Report No. CR-68899 and STAR No. N66-14075. National
  Aeronautics and Space Administration, 1966.

Lederberg, J. Hamilton circuits of convex trivalent polyhedra (up to 18 vertices). American Mathe-
  maticalMonthly, 1967,74:5,522-527.

Lederberg, J. Online computation of molecular formulas from mass number. Report No. CR-959 77.
  National Aeronautics and Space Administration, 1968.
Lederberg, J. Topology of molecules. In the National Research Council's Committee on Support of
  Research in the Mathematical Sciences (COSRIMS), The mathematical sciences-A cohection
  of essays. Published for the National Academy of Sciences (National Research Council). Cam-
  bridge: M.I.T. press, 1969,37-51.

Lederberg, J. DENDRAL, a system for computer construction, enumeration and notation of or-
  ganic molecules as tree structures and cyclic graphs, part III. Complete chemical graphs; em-
  bedding rings in trees. Technical report, National Aeronautics and Space Administration,
   1970.

Lederberg, J. Rapid calculation of molecular formulas from mass values. Journal of Chemical Edu-
  cation, 1972(a), 49,613.

Lederberg, J. Use of a computer to identify unknown compounds: The automation of scientific
  inference. In G. R. Waller (Ed.), Biochemical applications of mass spectrometty. New York:
  Wiley-Interscience, 1972(b), 193-207.

Lederberg, J., and E. A. Feigenbaum. Mechanization of inductive inference in organic chemistry. In
  B. Kleinmuntz (Ed.), Formal representation of human judgment. New York: Wiley, 1968,
  187-218. Also Stanford ArtificialIntelligenceProjectMemo No. 54. Stanford, Calif.: Stanford
  University, Computer Science Department, 1967.

Lederberg, J., G. L. Sutherland, B. G. Buchanan, and E. A. Feigenbaum. A heuristic program for
  solving a scientific inference problem: Summary of motivation and implementation. Stanford
  Artificial Intelligence Project Memo AIM-104. Stanford, Calif.: Stanford University, Com-
  puter Science Department, 1969(a). Also in R. Baneji and M. D. Mesarovic (Eds.), Theoretical
  approaches to nonnumerical problem solving. New York: Springer-Verlag, 1970.
Lederberg, J., G. L. Sutherland,B. G.Buchanan,E. A. Feigenbaum, A. V. Robertson, A. M. Duffield,
  and C. Djerassi. Applications of artificial intelligence for chemical inference, I. The number of
  possible organic compounds. Acyclic structures containing C, H, 0, and N. Journal of the
  American ChemicalSociety,1969(b),91:11,2973-2976.
Lindsay, R. K. Toward the development of machines which comprehend. Doctoral dissertation,
  Carnegie Institute of Technology, 1961.

Lindsay, R. K. In defense of ad hoc systems. In R. C. Schank and K. M, Colby (Eds.), Computer
  models of thought and language. San Francisco: W. H. Freeman, 1973,372-395.
Martin, W. A., and R. J. Fateman. The MACSYMA system. In S. R. Petrick (Ed&Proceedings of
  the ACM Second Symposium on Symbolic and Algebraic Manipulation. Los Angeles, 1971.
Masinter, L. M., N. S. Sridharan, R. E. Carhart, and D. H. Smith. Applications of artificial intelli-
  gence for chemical inference, XIII. Labeling of objects having symmetry. Journal of the
  American Chemical Society, 1974(a), 96:25,7714-7723.
Masinter, L. M., N. S. Sridharan, J. Lederberg, and D. H. Smith. Applications of artificial intelli-
  gence for chemical inference, XII. Exhaustive generation of cyclic and acyclic isomers. Journal
  of the American Chemical Society, 1974(b), 96:25, 7702-7714. Also Stanford Artificial
  Intelligence Laboratory Memo AIM-216 and STAN-CS-73-389. Stanford, Calif.: Stanford Uni-
  versity , Computer Science Department, 19 7 3.

McCarthy, J. Recursive functions of symbolic expressions and their computation by machine, part
  1. Communications of the ACM, 1960,3:4,184-195.


184 APPLICATIONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

McLafferty, F. W. Interpretation of massspectra: An introduction. New York: W. A. Benjamin, 1967.
McLafferty, F. W., and R. Venkataraghaven. Computer applications in mass spectometry. In M. L.
Gross (Ed.), Htgh performance mass spectrometry: Chemical applications, ACS symposium
  series 70, Washington, D.C.: American Chemical Society, 1978.
Medawar, P. B. Induction and intuition in scientific thought, volume 75 in the series Memoirs of
the American Philosophical Society. Philadelphia: American Philosophical Society. 1969.
Michie, D., and B. G. Buchanan. Current status of the heuristic DENDRAL program for applying
artificial intelligence to the interpretation of mass spectra. In R. A. G. Carrington (Ed.), Com-
puters for spectroscopists. London: Adam Hilger, 1974, 114-131. Also Experimental Pro-
gramming Report No. 32, under the title Artificial intelligence in mass spectroscopy: A review
of the heuristic DENDRAL program. Edinburgh: University of Edinburgh, School of Artificial
  Intelligence, 1973.

Milne, G. W. A. (Ed.). Mass spectrometry: Techniques and applications. New York: Wiley-
  Interscience, 1971.

Mitchell, T. M. Version spaces: A candidate elimination approach to rule learning. Proceedings of
  the Fifth ZJCAZ, August 1977,1,305.

Mitchell, T. M. Version spaces: An approach to concept learning. Doctoral dissertation, Stanford
  University, Department of Electrical Engineering, December 1978.
Mitchell, T. M., and G. M. Schwenzer. Applications of artificial intelligence for chemical inference,
XXV. A computer program for automated empirical 13C NMR rule formation. Organic Mag-
  netic Resonance, 1978,11, No. 8,378.

Mortimer, C. E. Chemistry: A conceptual approach (2d ed.). New York: Van Nostrand Reinhold,
  1971.

Newell, A. Production systems: Models of control structures. In W. Chase (Ed.), VisuaZ information
  processing. New York: Academic Press, 1972.

Newell, A., and H. A. Simon. Human problem solving. Englewood Cliffs, N. J.: Prentice-Hall, 1972.
Nilsson, N. Problem-solving methods in artificial intelligence. New York: McGraw-Hill, 1971.
Nourse, J. G. Generalized stereoisomertiation modes. Journal of the American Chemical Society,
  1977,99,2063.

Nourse, J. G. Applications of the permutation group in dynamic sterochemistry. In The permuta-
tion group in physics and chemistry. Lecture notes in chemistry, vol. 12. New York: Springer-
  Verlag, 1979(a), 28.

Nourse, J. G. Application of the permutation group to stereoisomer generation for computer assisted
structure elucidation. In The permutation group in physics and chemistry. Lecture notes in
  chemistry, vol. 12. New York: Springer-Verlag, 1979(b), 19.
Nourse, J. G. Applications of artificial intelligence to chemical inference, 28. The configuration
  symmetry group and its application to stereoisomer generation, specification and enumeration.
  In Journalof the American ChemicalSociety, 1979(c), 101,121O.
Nourse, J. G., and D. H. Smith. Nonnumerical mathematical methods in the problem of stereo-
  isomer generation. Match, 1979(d), 6,259.

Nourse, J. G., R E. Carhart, D. H. Smith, and C. Djerassi. Applications of artificial intelligence to
  chemical inference, 29. Exhaustive generation of steroisomers for structure elucidation. Jour-
nal of the American ChemicalSociety, 1979(b), 101, 1216.    '
Polya, G. Mathematics and pkzusible reasoning, volume 2. Princeton, N. J.: Princeton University
  Press, 1954.

Popper, K. R. The logic of scientific discovery. New York: Harper & Row, 1968.
Raphael, B. Robot research at Stanford research institute. Artificial Intelligence Center Technical
Note 64, SRI Report 1530. Menlo Park, Calif.: Stanford Research Institute, February 1972.
Reddy, D. R., L. D. Errnan, and R. B. Neely. A model and a system for machine recognition of
speech. IEEE Transactions on Audio and Eiectroacoustics, 1973, AU-21~3.
Rindfleisch, T. C., and D. H. Smith. Advances in data acquisition and analysis systems for applica-
tions of gas chromatography/mass spectrometry. In G. R. Waller (Ed .), BiomedicaZ applications
  of mass spectromerry. New York: Wiley-Interscience, 1978.
Robinson, J. A. A machineoriented logic based on the resolution principle. Journal of the ACM,
  1965,12:1,23-41.


PROJECT PUBLICATIONS 185

Rouvray, D. H. Chemistry in Britain, 1974, 10: 11.
Schroil, G., A. M. Duffield, C. Djerassi, B. G. Buchanan, G. L. Sutherland, E. A. Feigenbaum, and
J. Lederberg. Applications of artificial intelligence for chemical inference, III. Aliphatic ethers
diagnosed by their low-resolution mass spectra and nuclear magnetic resonance data. Journal
  of the American Chemical Sociery, 1969,91:26,7440-7445.
Schwenzer, G. E. Applications of artificial intelligence for chemical inference, XXVI, Analysis of
G13 NMR for mono-hydroxy steroids incorporating geometric distortions. Journal of Organic
  Chemistry, 1978,43, No. 6.

Schwenzer, G. E., and T. M. Mitchell. Computer assisted structure elucidation using automatically
acquired 13C NMR rules. In D. Smith (Ed.), Computer assisted structure elucidation. ACS
  Symposium Series, 1977,54,58.

Sheikh, Y. M., A. Buchs, A. B. Dermo, G. S&roll, A. M. Duffield, C. Djerassi, B. G. Buchanan,
  G. L. Sutherland, E. A. Feigenbaum, and J. Lederberg. Applications of artificial intelligence
  for chemical inference. An approach to the computer generation of cyclic structures. Differen-
tiation between ail the possible isomeric ketones of composition C, H, 0 0. Organic Mass Spec-
  trometry, 1970,4,493-501.

Shortliffe, E. H. Computer-based medical consultations: MYCIN. New York: American Elsevier,
  1976.

Simon, H. A. The sciences of the artificial. Cambridge: M. I. T. Press, 1969.
Simon, H. A., and M. Barenfeld. Information-processinganalysis of perceptual processes in problem
  solving.PsychologicalReview, 1969,76:5,473-483.
Smith, D. I-I. Applications of artificial intelligence for chemical inference. Constructive graph label-
ing applied to chemical problems. Chlorinated hydrocarbons. Analytical Chemistry, 1975(a),
  47:7,1176-1179.

Smith, D. H. The scope of structural isomerism. Journal of Chemical Information and Computer
  Sciences, 1975(b), 15:4,203-207.

Smith, D. H., B. G. Buchanan, R. S. Engelmore, A. M. Duffield, A. Yeo, E. A. Feigenbaum, J.
Lederberg, and C. Djerassi. Applications of artificial intelligence for chemical inference, VIII.
An approach to the computer interpretation of the high resolution mass spectra of complex
molecules. Structure elucidation of estrogemc steroids. Journal of the American Chemical
  Society, 1972,94:17,5962-5971.

Smith, D. H., B. G. Buchanan, R. S. Engelmore, H. Adlercreutz, and C. Djerassi. Applications of
artificial intelligence for chemical inference, IX. Analysis of mixtures without prior separation
as illustrated for estrogens. Journal of the American Chemical Society, 1973(a), 95:18,6078-
  6084.

Smith, D. H., B. G. Buchanan, W. C. White, E. A. Feigenbaum, J. Lederberg, and C. Djerassi. AppIi-
cations of artificial intelligence for chemical inference-X. Intsum. A data interpretation and
summary program applied to the collected mass spectra of estrogenic steroids. Tetrahedron,
  1973(b), 29,3117-3134.

Smith, D. H., and R. E. Carhart. Applications of artificialintelhgence for chemical inference, XXIV.
Structural isomerism of monoand sesquiterpenoid skeletons. Tetrahedron, 1976,32,2513.
Smith, D. H., and R. E. Carhart. Structure elucidation based on computer analysis of high and low
resolution mass spectral data. In M. L. Gross (Ed.), Proceedings of the Symposium on Chemi-
cal Applications of High Performance Spectrometry. Washington, D. C.: American Chemical
  Society, 1978, 325.

Smith, D. H., and P. C. Jurs. Prediction of 13C NMR chemical shifts. Journal of the American
  ChemicolSociety, 1978,100,3316.

Smith, D. H., J. P. Konopelski, and C. Djerassi. Applications of artificial intelligence for chemical
inference, XIX. Computer generation of ion structures. Organic MassSpectrometry, 1976,11,
  86-100.

Smith, D. H., L. M. Masinter, and N. S. Sridharan. Heuristic DENDRAL: Analysis of molecular
structure. In W. T. Wipke, S. Heller, R. N. Feldman, and E. Hyde (Eds.), Proceedings of the
NATOICNNA Advanced Study Institute on Computer Representation and Manipulation of
  ChemicalInformation. New York: Wiley, 1974,287-315.


186 APPLICATlONS OF ARTIFICIAL INTELLIGENCE FOR ORGANIC CHEMISTRY

Smith, D. H., T. C. Rindfleisch, and W. J. Yeager. Exchange of comments: Analysis of complex
  volatile mixtures by a combined gas chromatography-mass spectrometry system. Analytical
  Chemistry, 1978,50,1585.

Sridharan, N. S. Computer generation of vertex-graphs. STAN-CS-73-381. Stanford, Cahf.: Stan-
  ford University, Computer Science Department, 1973(a).
Sridharan, N. S. Search strategies for the task of organic chemical synthesis. Stanford Artificial Zn-
  telligence Laboratory Memo AIM-21 7 and STAN-CS-73-391. Stanford, CaIif.: Stanford Uni-
  versity, Computer Science Department, 1973(b). Presented at the Third International Joint
  Conference on Artificial Intelligence, Stanford, California, 1973.
Sridharan, N. S., H. Gelemter, A. J. Hart, W. F. Fowler, and H. J. Shue. A heuristic program to dis-
  cover syntheses for complex organic molecules. Stanford Artificial Intelligence Laboratory
  Memo AIM-205 and STAN-CS-73-370. Stanford, Calif.: Stanford University, Computer Sci-
  ence Department, 1973.

Sutherland, G. L. DENDRAL-A computer program for generating and filtering chemical structures.
  Stanford Artificial Intelligence Project Memo No. 49. Stanford, Calif.: Stanford University,
  Computer Science Department, 1967.

Sutherland, G. L. Heuristic DENDRAL: A family of LISP programs. Stanford Artificial Intelligence
  Project Memo AZ-80. Stanford, CaIif.: Stanford University, Computer Science Department,
  1969.

Teitelman, W. ZNTERLISP reference manual, 2d ed. Palo Alto, Calif.: Xerox Palo Alto Research
  Center, 1975.

Toulmin, S. E. Foresight and understanding. Bloomington: Indiana University Press, 1961.
VanLehn, K. A, SAIL User Manual. Stanford Artificial Intelligence Laboratory Memo AIM-204
  and Compurer Science Department Reporr STAN-CS-73-373. Stanford, Calif.: Stanford Uni-
  versity, Computer Science Department, 1973.

Varian MAT GmbH.: Operating manual for mass spectrometer MAT 711. Bremen: Varian MAT
  GmbH., 1971.

Varkony, T. H., R. E. Carhart, and D. H. Smith. Applications of artificial intelligence for chemical
  inference, XXIII. Computerassisted structure elucidation. Modeiling chemical reaction se-
  quences used in molecular structure problems. To appear in W. T. Wipke (Ed.), Computer-
  assisted organic synthesis. Washington, D. C.: American Chemical Society, 1976.
Varkony, T. H., R. E. Carhart, and D. H. Smith. Computer assisted structure elucidation, ranking of
  candidate structures, based on comparison between predicted and observed mass spectra. In
  Proceedings of the Twenty-Fifth Annual Conference on Mass Spectrometry and Allied Topics,
  Washington, D. C., 1977.

Varkony, T. H., R. E. Carhart, D. H. Smith, and C. Djerassi. Computer-assisted simulation of chem-
  ical reaction sequences: Applications to problems of structure elucidation. Journal of Chemj-
  cal Information and Computer Sciences 1978(a), 18,168.
Varkony, T., D. Smith, and C. Djerassi. Computer-assisted structure manipulation: Studies in the
  biosynthesis of natural products. Tetrahedron, 1978(b), 34,841.
WaIIer, G. R. (Ed.). Biochemical applications of mass spectrometry. New York: Wiley-Interscience,
   1972.

Wegmann, A. Variations in mass spectral fragmentation produced by active sites in a mass spectro-
  meter source. Analytical Chemistry, 1978,50,No. 6,830-832.
Whewell, W. Novum organum renovtum (3d ed.). London: John Parker & Son, 1858.
Wiener, N. God and golem, inc. Cambridge: M. I. T. Press, 1964.
Woodruff, H B., and M. E. Munk Computer-assisted interpretation of infrared spectra. Analytica
  Chimica Acta, 1977,95,13-23.


NAMEINDEX

Achenbach, M., xii
Adlercreutz, H., 174, 185
Anderson, P., 179,182

Bacon, F., 160-161
Banerji, R., 171
Barenfeld, M., 154,185
Belzer, J., 178, 180
Beynon, J., 22,179
Boden, M., 157,179
Braekman, J., 177, 181
Bronowski, J., 162n., 179
Brown, H., xi, xii, 40,48, 175, 177, 179, 181
Buchanan, B.,49,5ln., 68, 108, 125, 131-133, 14-l-
  145,170- 185
Buchs, A.,xii, 68,172-173,180-181,185

Caprioli, R., 179
Carhart, R.,xi, xii, 14,24, 101, 108,134-135,175-179,
  181- 186
Car&ton, R., 176, 184
Cheer, C., 134,177, 181
Chomsky, N., 164
Churchman, C., 171, 181
Condillac, E., 161
Creary, L., xii

Daloze, D., 177, 181
Davis, R., 108, 181

Deltino,A.,xii, 172-173, 180-181,185
Djemssi, C.,x,xii, 24,131,133,135,171-175,177-181,

  183-186
Dreyfus, H., 174, 179
Dromey, R., xi, xii, 24n., 70,142-143,176-178, 181
Doftield,A.,xii, 171-174, 177-178, 180-181, 183, 185
Dunham, L., xii

Eggert, H., xii
Engelmore, R., xii, 174, 185
Erman, L., 159, 181,184

Ernst, G., 29, 154, 182
Everhart, E., 179,182

Fateman, R., 127,154, 183
Feigenbaum, E.,68,108, 132,,170-175,177-178,180-
  183,185
Feldman, R., 176,182, 185
Fisher, F., xii
Fitch, W., 179,182
Fowler, W., 175, 1%
Freiman, C., 173,180
Friedberg, R., 182

Gaschnig, J., 157, 182
Gelemter, H., 175, 186
Giere, R., 182
Gray, N., xii, 104, 178, 182
Green, C., 38, 182
Gritter, R., xii, 177, 180
Gross, M., 179,185

Hammerom, S., xii
Hart, A., 175, 186
Hartley, D., 163
Hayes, J., 179-180
Hayes-Roth, F., 179- 18.p
Hearn, A., 127,182
Heller, S., 26, 176,182,185
Hjelmelaod, L., xii, 40,48, 175- 176, 179
Hooke, R., 161
Hyde, E., 176, 185

Jennings, K., 182
Johnson, C., Jr., 178, 180
Johnson, S., xii, 176,181
Jordan, C., 49
Jurs, P., 178, 185

Kibens, M., xi
Kinariwala, B., 170,182

187


188 NAME INDEX

Kleinmuntz, B., 170, 183
Konopelski, J., xii, 135,177,185
Kuhn, T., 161, 166,182
Kuo, F., 170,182

Laudan, L., 161,163,182
Lavanchy, A., xii
Lederberg, J., 2, 19,40, 127,129, 131-133,167,169-
  174, 176-178,180-183, 185
LeSage, G., 161,163
Lesser, V., 159, 181
Lindsay, R., 14,155,183
Ludena, E., 178, 180
Lykos, P.. 181

McCarthy, J., 39, 183
Mdafferty, F., 16n.. 26, 184
Martin, W., 127,154,183
Masinter, L., x&40,43,46,48, 175-177, 179, 183, 185
Medawar, P., 160,184
Meltzer, B., 170,172-173, 180,182
Mesarovic, M., 171
Michle, D., 170,172-173,176,179-180,182,184
Mikulich, L., 179-180
Milne,G., 23,5ln.,l73,180, 182,184
Mitchell, T., xii, 118n.. 178- 180,184- 185
Momll, A., 171,182
Monill, K., xii

Mortimer, C., 184
Munk, M., ZSn., I86

Neely, R., 184
Newell, A., 29,87,154,182,184
Newton, I., 161
Nilsson, N., xi, 30, 184
Nourse, J., xii, Sn., 178- 179, 184

Peirce, C., 182
Petrlck, S., 182- 183
Polya, G., 163, 184
Popper, K., 161, 184

Raphael, B., 154, 184
Reddy, R., 184

Rindfleisch, T., xii, 177-179, 181, 184, 186
Robertson, A., xii,49,5ln., 171,173,180-181,183
Robinson, J., 29, 153, 184
Rouvray, D., 127,185

Sabelli, N., 178, 180
Schroll,G.,xii, 17l-l72,180-181,185
Schwettzer, G., xii, 178.184-185
Sheikh, Y., xii, 133, 172, 185
Shortliffe, E., 151,185
Shue, H., 175,186
Simon, H., 147,154, 184-185
Smith, D., xi, xii, 43,46,66,85,101, 128, 134- 135,

  137-138,141,176-186
Smith, R., 178,180
Sridharan,N., xii, 43,46,173-174, l76-177,180-181,
  183, 185- 186
Steftk, M., xii, 177-178.181
Sutherland, G.,xU, 4On., 68,108, 170-173, 181,183,
  185-186

Teitelman, W., 39, 186
Toulmin, S., 162,186
Tursch, B., 177,181

VanAntwerp, C.,xii
VanLehn. K.. 39.186
Varkony,T.,xii,`66-67,135,177-179,181-182,186
Venkatataghaven, R., 26,184

Wahl, A., 178, 180
Waller,G., 104,174,178-179,182-184,186
Waterman, D., 179-180
Wegmann, A., xii, 179,186
Westfrdl, R., 182
WheweU, W., 167,186
White, W., xii,4On., 174, 177, 180, 185
Wiener, N., 149, 186
Winograd, T., 157
Wipke, W., 176- 177,185- 186
Woodruff, H., 25n., 186

Quayle, A., 173

Yeager, W., xii, 178,186
Yeo, A., xii, 174,185


SUBJECTINDEX

Absorption spectra, 15
Abstraction, 33
Abstraction planning, 33,35
Acetaldehyde, 10
Acetals, 129,143
Acetamide, 10
Acetic acid, 7, 10
Acetone, 10
Acid(s), 7, 129, 142
acetic, 7, 10
ammo (see Amino acids)
aromatic, 158
formic, 10
methanoic, 7, IO, 87
organic, 134
urinary organic, 179
Action-part of productions, 87.89-91, 122
Acyclic compounds, 9
Acyclic DENDRAL algorithm, 48
Acyclic DENDRAL notation, 171
Acyclic generator, 38,40-41,48,53,69.106,127,170,173
Acyclic heuristic DENDRAL, 130
Acyclic isomers, 127,176
Acyclic structure diagram, 49
Acyclic structures, 2,40,48,52,171
ADRAW. 79
AdvancedResearchProjectsAgency(ARPA),xii. 152,
  178
AI (artificial intelligence), 1.28, 147
Alcohols, 7.9, 1 I, 69,89,95, 131. 142-143, 158
Aldehydes, 7, 10.92.95, 129
Algorithm(s), 32,151,156,159
acyclic DENDRAL, 48
Chinese menu, 84
DENDRAL (see DENDRAL algorithm)
generating, 167
labeling, 48
notation, 167
Aliphatic compounds, 2,9,49n., 106
amines, 109,131,143,173
ethers, 171-172
ketones, 69, 131
planning rules for, 68
Aliphatic isomer, 129
Aliphatic structure, 48
Alkanes, 6

Alkenes, 6
Alkyl side chain, 67
Alkyls, 6
Alkynes, 7,66
ALLBREAKS, 101
ALLBRKS, 38
Amides, 8, 10
Amines, 8,10-11,69-70,93,95,133,143, I58
methyl, 10
saturated, 69-70.172
Aminoacids.8, 11.69, 101, 130-131, 134
derivatives, 136,143
Amino group, 8
Ammonia, 8, IO
Amu (atomic mass units), 16
Androstane, 111,114-118
skeleton, 110, 118
Antibiotic therapy, 151
Apical node, 5 1
Aromatic acids, 158
Aromatic bond, 101,158
Aromatic ring, 109-110
Aromaticity, 150
ARPA(AdvancedResearchProjectsAgency),xii, 152,
  178
Artificial intelligence (AI), 1,28, 147
ATNAME, 57-59.61
Atom:
primary, 47
quaternary, 47 ;
secondary, 47
TAGed, 54
tertiary, 47
univalent, 11,44
vertex, 41
Atom type, 119
ATOMPV command, 56
Atomic mass units (Amu), 16
Atomic number, 52
Automatic pmgtamming, 159n.
AZOCINE, 65

Bad compositions, 72-73
Bad losses, 72-73,75
BADLIST, 38,84,126,129-133,165,170-171

189


I!)0 SUBJECT INDEX

Ball-and-stick model, 4, 27
Barbiturates, 136
BCPL, 39
B/E (break environment), 118- 120
B/E set, 119, 122
Benzene, 12
Biosynthetic constraint, 67
Bit, 156n.
Body fluids, 134
Bonding sites, 4
Bonds, 4
alpha, beta, gamma, 13n.
equivalent, 7
single, double, triple, 4
Bottom-up exploration, 165
BRANCH, 79-80
Breadth-first search, 148
Break analysis, 137
Break environment (B/E), 118 119
Break function, 90
BREAKS. 82-83

    ,~~
Bredt's rule, 158
Butane, 6,52
Butanone, 10
Butyl radical, 52

Canons of order, acyclic DENDRAL, 49-50.53
Carbon black adsorbates, 179
Carbon dioxide elimination, 158
Carbon monoxide elimination, 158
Catbonyl group, 7,47,55,103
Carboxyl radical, 7
CATALOG, 42,47,177
Centroid, 49-51,53
CHAIN, 56,58-59.61.79
Chemicalgraph, 5,49, 149, 155, 157
Chemical nomenclature, 48
Chemical reactions, 66
Chemical stability, 126, 130n., 133n., 158
Chemical structure notation, 170
Chess, 31,34,39, 108, 154
Chinese menu algorithm, 84
Chlorinated hydrocarbons, 177
Chromatography, 24
Ciliated skeleton, 46,48
Class-specific fragmentation rules, 103, 105, 144
CLEANUP, 24n.
Cleavage, 13
alpha, 13n., 70, 104, 143
beta, 13n., 104, 143
gamma, 13n., 91,143
Cluster, 71
Coarse search, 119,124- 125
Completeness, 32,41, 165
Comoounds:

a&k, 9
aliphatic (see Aliphatic compounds)
biologically active, 6
cyclic, 9
drug, 143
mixtures of, 24n., 136, 139
saturated acyclic monofunctional, 69
Computer technology, 29, 168
Condenser, deflection, 15.20
Contiguration symmetry group, 178
CONGEN (constrained generator), 2,37-38,41,
  53-57,64-65,67-68,79,85,100-101,103, 105-
  106, 127,133-135, 144, 147-150, 168, 177
Conjugation, 55,58

Connectivity, 27
Connectivity isomer, 4,6,41,49,54,64, 107
CONSTRAINTS, 57
ISOPRENE, 54
LOOP, 60
PROTON, 54-55,60
RING, 54,6&62
SUBSTRUCTURE, 54,60-62
Constraints, 38,54,68,83-84,86, 106, 120, 164, 177
geometric, 4
heuristic, 177
topological, 4
Crystal structure, 159
Custom crafting, 107
Cyclic compounds, 9
Cyclic isomers, 176
Cyclic ketones, 9- 10
Cyclic skeleton, 46-48
Cyclic structuregenerator,49n.,53,68,151,172,175-177
(See also CONGEN)
Cyclohexanone, 10

Data-driven exploration, 165
Data-driven heuristics, 160
Data-driven planning, 159
Daughter ion, 77
Daughter peak, 87
DB,90
Decane, 5.2
DEFINE, 54,56-59,61
Degree, 47
ofunsaturation, 44,158
Degree list, 46-47
DENDRAL al